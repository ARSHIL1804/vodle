<ion-header>
  <ion-toolbar style="padding-right:11px;">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>How to use vodle</ion-title>
    <ion-thumbnail slot="end">
        <ion-img src="/assets/topright_icon.png"></ion-img>
    </ion-thumbnail>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list lines="full" no-padding no-margin>

    <ion-item button (click)="e_short = !e_short" no-padding color="primary">
      <ion-icon [name]="e_short?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
      <ion-label><b>{{'help.h1'|translate}}</b></ion-label>
    </ion-item>
    <ng-template [ngIf]="e_short">
      <ion-item>
        <ion-label text-wrap>
          <span [innerHtml]="'help.p11a'|translate"></span>&nbsp;<a routerLink="/mypolls"><span [innerHtml]="'help.p11b'|translate"></span></a>&nbsp;<span [innerHtml]="'help.p11c'|translate"></span>
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <span [innerHtml]="'help.p12a'|translate"></span>
          <ul>
            <li [innerHtml]="'help.p12b'|translate"></li>
            <li [innerHtml]="'help.p12c'|translate"></li>
            <li [innerHtml]="'help.p12d'|translate"></li>
          </ul>
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <span [innerHtml]="'help.p13a'|translate"></span>
          <ul>
            <li [innerHtml]="'help.p13b'|translate"></li>
            <li [innerHtml]="'help.p13c'|translate"></li>
          </ul>
        </ion-label>
      </ion-item>
<!--      <ion-item>
        <ion-label text-wrap>
          See <b>more information</b> on a poll or option by pressing the <b>dropdown buttons</b> on the right.
        </ion-label>
      </ion-item>-->
      <ion-item>
        <ion-label text-wrap [innerHtml]="'help.p14'|translate">
          <!--If you want to <b>freeze</b> the current sorting of options on your screen, 
          use the <b>refresh button</b> in the top-right corner to disable automatic resorting.
          If that button shows an <b>exclamation mark</b>, the ordering needs a refresh.-->
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <span [innerHtml]="'help.p15a'|translate"></span>
          <ul>
            <li><!--TODO: make icons align better vertically:-->
              <span [innerHtml]="'help.p15b1'|translate"></span>&nbsp;<ion-icon name="trophy"></ion-icon>&nbsp;<span [innerHtml]="'help.p15b2'|translate"></span> 
            </li>
            <li>
              <span [innerHtml]="'help.p15c1'|translate"></span>&nbsp;<ion-icon name="cut"></ion-icon>&nbsp;<span [innerHtml]="'help.p15c2'|translate"></span> 
            </li>
          </ul>
        </ion-label>
      </ion-item>
    </ng-template>

    <ion-item button (click)="e_long = !e_long" no-padding color="primary">
      <ion-icon [name]="e_long?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
      <ion-label><b>How to vote – longer explanation</b></ion-label>
    </ion-item>
    <ng-template [ngIf]="e_long">
      <ion-item>
        <ion-label text-wrap>
            Your “willingness to approve” ratings determine which options (or targets) you <b>approve</b>. 
            At any moment in time, every voter approves some number of options – zero, one, or more than one.
            When the poll closes, the approval is used to determine the winner or budget shares in a way explained further down.
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>                 
            But first: 
            <i>How does your willingness to approve determine whether you actually approve an option or not?</i> 
            If you rate an option at 100, it means you definitely approve that option, 
            and if you rate it at zero, you definitely don't approve that option.
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>
            <i>But what if your rating of some option is somewhere between 0 and 100?</i>
            The main thing to understand is that whether or not you approve the option then 
            <i>also</i> depends on the <i>other</i> voters' willingness to approve that option! 
            The main idea is that your “willingness to approve” rating is a kind of promise. 
            By giving an option a rating larger than zero, you promise to approve that option 
            <i>if enough other voters do so as well</i>. 
            How many are “enough”? That depends on how far to the right you move your rating slider. 
            If your rating is at, say, 83,
            that means you promise to approve the option if less than 83% of the voters <i>dis</i>approve the option
            – or, equivalently: if more than 17% of the voters <i>do</i> approve the option.
            In other words, the larger your rating, the fewer voters you require to also approve the option 
            before you are willing to approve it as well.<br/>
            In the app, you can see very easily whether you currently approve an option, 
            because we show you the percentage of current approvers 
            as a light bar coming in from the right of the screen. 
            If your slider, coming in from the left, meets that bar, 
            then the percentage of voters approving that option is lower than your rating,
            so your condition for approval is met and you are counted as approving the opion.
            Your slider then turns from blue to green to indicate that you approve the option.
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>                
            Now that we have understood how approval is calculated, 
            we can turn to the question of how the <b>winning probabilities</b> (budget shares) are found
            and how the actual winner is determined if the poll is about picking a single option. 
            If exactly one option has 100% approval, it will win for sure (or get all of the budget).
            If several options each have 100% approval, 
            the one among them that has the largest total rating will win for sure (or get all of the budget).
            If no option has 100% approval,
            <i>vodle</i> distributes the winning probability or budget among two or more options.
            In that case, the option with the largest approval will win most likely or get the largest share. 
            But other options that have at least some approval may then win as well with some smaller probability,
            or also get some smaller share of the budget. 
            For polls selecting a single option this means that then there is 
            a certain chance element involved to determine the actual winner. 
            This is because we must make sure that no group of voters 
            can simply be ignored by the other voters as it is the case with majority rule. 
            This way, <i>vodle</i> gives every voter the exact same influence 
            and gives every faction an influence that matches its size.
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>                  
            If the poll is about selecting one option, 
            the exact procedure to find the winner when no option has 100% approval is very simple. 
            One voter is determined by lot, everyone having the same chance of being that voter. 
            Among the options that this voter approves, the one with the largest overall approval is the winner.
            The pie piece to the left of each option shows the resulting probability that this option wins. 
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>                  
            If the poll is about allocating a budget, 
            the size of each option's shares is calculated the same way: 
            the share is proportional to the number of voters that 
            (i) approve this option but (ii) do not approve any other option that has a larger overall approval.
          </ion-label>
        </ion-item>
        <ion-item>
          <ion-label text-wrap>                  
            So now we know how the winner or the shares are found. 
            <b><i>But how should you now set your “willingness to approve” ratings?</i></b> 
            The following rule of thumb usually works quite well to find a good consensus: 
            <b>Give your favourite a rating of 100. 
            Give all options which are better than average some rating larger than zero, 
            scaling your ratings according to relative preference.
            Finally, give all options which are worse than average a rating of zero.</b>      
        </ion-label>
      </ion-item>
    </ng-template>

    <ion-item button (click)="e_faq = !e_faq" no-padding color="primary">
      <ion-icon [name]="e_faq?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
      <ion-label><b>FAQ</b></ion-label>
    </ion-item>
    <ng-template [ngIf]="e_faq">
      <ion-item *ngFor="let q of faqs" button (click)="e_q[q[0]] = !(e_q[q[0]] || false)">
        <ion-icon [name]="e_q[q[0]]?'chevron-down-outline':'chevron-forward-outline'" no-padding no-margin size="small"></ion-icon>
        <ion-label button text-wrap>
          <div [innerHTML]="'<b>'+q[0]+'</b>'"></div>
          <ng-template [ngIf]="e_q[q[0]]">
            <div [innerHTML]="q[1]"></div>
          </ng-template>
        </ion-label>
      </ion-item>
    </ng-template>
  
  </ion-list>
<!--    <li>
      If you feel a good option is missing, just add it at the bottom of the list!<br/>
      <small>
        Options are sorted by descending approve, so your option will move upwards as it gains approve.
        vodle works best with at least a handful of options.
      </small><br/>&nbsp;
    </li>-->
<!--  
      <small>
        A rating of, say, 80 means you would approve this option if less then 80% oppose it
        (or, equivalently, if more than 20% approve it).
        If your slider meets the light approve bar to the right, then you approve the option and the slider turns green.
        A rating of zero implies that you won't ever approve this option.
      </small><br/>&nbsp;
  <h3>How to set up a new poll</h3>
  <ul>
    <li>...</li>
  </ul>
-->

</ion-content>

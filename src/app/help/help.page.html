<ion-header>
  <ion-toolbar style="padding-right:11px;">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>How to use vodle</ion-title>
    <ion-thumbnail slot="end">
        <ion-img src="/assets/topright_icon.png"></ion-img>
    </ion-thumbnail>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list lines="full" no-padding no-margin>

    <ion-item button (click)="e_short = !e_short" no-padding color="primary">
      <ion-icon [name]="e_short?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
      <ion-label><b>How to vote – short version</b></ion-label>
    </ion-item>
    <ng-template [ngIf]="e_short">
      <ion-item>
        <ion-label text-wrap>
          Select a poll from&nbsp;<a routerLink="/mypolls">My polls</a><!-- or open a poll invitation that was sent to you-->.
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <b>Rate</b> the options by using the sliders:
          <ul>
            <li>
              Give your <b>favourite</b> option a rating of <b>100</b> (drag the slider completely to the right).
            </li>
            <li>
              Give every option that you find <b>better than average</b> a rating <b>larger than zero</b> (slider gets blue or green).
            </li>
            <li>
              Leave options that you find <b>worse than average</b> at <b>zero</b> (slider is a red dot).
            </li>
          </ul>
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <b>Adjust</b> your ratings as the poll develops:
          <ul>
            <li>
              The <b>light bars</b> to the right show what options currently get large <b>support</b>.
              If you think an option is an acceptable <b>compromise</b> or is even a potential <b>consensus</b>, 
              then <b>increase your rating</b> until the slider enters the bar and gets green.   
            </li>
          </ul>
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          See <b>more information</b> on a poll or option by pressing the <b>dropdown buttons</b> on the right.
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          Options are <b>listed by descending support</b>, the most supported option is always on top. 
          If you want to <b>freeze</b> the current sorting of options on your screen, 
          use the <b>refresh button</b> in the top-right corner to disable automatic resorting.
          If that button shows an <b>exclamation mark</b>, the ordering needs a refresh.
        </ion-label>
      </ion-item>
      <ion-item>
        <ion-label text-wrap>
          <b>The pie chart to the left determine the result of the poll in the end:</b>
          <ul>
            <li>
              In a poll for selecting a <i>single option</i>&nbsp;<ion-icon name="trophy"></ion-icon>
              the pie pieces show the winning probabilities of the options.
            </li>
            <li>
              In a poll for allocating <i>shares</i> of a budget <ion-icon name="cut"></ion-icon>
              the pie pieces show the shares that will be allocated to the options.
            </li>
          </ul>
        </ion-label>
      </ion-item>
    </ng-template>

    <ion-item button (click)="e_long = !e_long" no-padding color="primary">
        <ion-icon [name]="e_long?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
        <ion-label><b>How to vote – longer explanation</b></ion-label>
      </ion-item>
      <ng-template [ngIf]="e_long">
        <ion-item>
          <ion-label text-wrap>
              Your ratings determine which options you <b>support</b>. In the end, every
              voter supports some number of options – zero, one, or more than one –
              and then the winner is found in a way I explain later.
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>                 
              But first: <i>How does your rating determine whether you end up supporting
              an option?</i> If you rate an option at 100, it means you definitely support that
              option, and if you rate it at zero, you definitely don't support the
              option.
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>
              <i>But what if your rating of some option is somewhere between 0 and 100?</i>
              The main thing to understand is that whether or not you support the
              option then <i>also</i> depends on the <i>other</i> voters' ratings for that option! 
              The main idea
              is that your rating is a kind of promise. By giving an option a rating
              larger than zero, you promise to support that option <i>if enough other
              voters do so as well</i>. How many are "enough"? That depends on how far to
              the right you move your rating slider. If your rating is at, say, 83,
              that means you promise to support the option if at least 17% of the
              voters do so as well. Why 17%? Because 83 + 17 = 100. In other words,
              the larger your rating, the fewer voters you require to also support the option 
              before you are willing to support it as well.<br/>
              In the app, you
              can see very easily whether you currently support an option, because we
              show you the percentage of current supporters as a light bar coming in
              from the right of the screen. If your slider, coming in from the left,
              meets that bar, then your rating plus the percentage of current
              supporters is at least 100, which means you support the option as well.
              Your slider then turns from blue to green to indicate that you support the option.
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>                
              Now that we have understood how support is calculated, we can turn to
              the question of how the <b>winning option</b> is found 
              (if the poll is about picking a single option). If one option
              has 100% support, it will win for sure. If no option has 100% support,
              the one with the largest support will win most likely, but <i>not</i> for
              sure! All other options that have at least some support may win then as
              well. In other words: there is a chance element involved to determine
              the actual winner. This is because we must make sure that no group of
              voters can simply be ignored by the other voters as it is the case in
              majority-based decision methods. 
              This way, vodle gives every voter the exact same influence.
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>                  
              The exact procedure to find the winner when no option has 100%
              support is very simple: One voter is determined by lot, everyone having
              the same chance of being that voter. Among the options that this voter
              supports, the one with the largest overall support is the winner.
              The pie piece to the left of each option shows the resulting probability
              that this option wins. 
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>                  
              If the poll is about allocating a budget, the size of each option's shares
              is calculated the same way: the share is proportional to the number of voters
              that support this option but no other option with a larger overall support.
            </ion-label>
          </ion-item>
          <ion-item>
            <ion-label text-wrap>                  
              So now we know how the winner or the shares are found. <b><i>But how should you now set
              your ratings?</i></b> The following rule of thumb usually
              works quite well to find a good consensus: <b>Give your favourite a rating
              of 100. Give all options which are better than average some rating
              larger than zero, scaling your ratings according to relative preference.
              Finally, give all options which are worse than average a rating of zero.</b>      
          </ion-label>
        </ion-item>
      </ng-template>

      <ion-item button (click)="e_faq = !e_faq" no-padding color="primary">
        <ion-icon [name]="e_faq?'caret-down-outline':'caret-forward-outline'" no-padding no-margin></ion-icon>
        <ion-label><b>FAQ</b></ion-label>
      </ion-item>
      <ng-template [ngIf]="e_faq">
        <ion-item *ngFor="let q of faqs" button (click)="e_q[q[0]] = !(e_q[q[0]] || false)">
          <ion-icon [name]="e_q[q[0]]?'caret-down-outline':'caret-forward-outline'" no-padding no-margin size="small"></ion-icon>
          <ion-label button text-wrap>
            <div [innerHTML]="'<b>'+q[0]+'</b>'"></div>
            <ng-template [ngIf]="e_q[q[0]]">
              <div [innerHTML]="q[1]"></div>
            </ng-template>
          </ion-label>
        </ion-item>
      </ng-template>
  
  </ion-list>
<!--    <li>
      If you feel a good option is missing, just add it at the bottom of the list!<br/>
      <small>
        Options are sorted by descending support, so your option will move upwards as it gains support.
        vodle works best with at least a handful of options.
      </small><br/>&nbsp;
    </li>-->
<!--  
      <small>
        A rating of, say, 80 means you would support this option if less then 80% oppose it
        (or, equivalently, if more than 20% support it).
        If your slider meets the light support bar to the right, then you support the option and the slider turns green.
        A rating of zero implies that you won't ever support this option.
      </small><br/>&nbsp;
  <h3>How to set up a new poll</h3>
  <ul>
    <li>...</li>
  </ul>
-->

</ion-content>

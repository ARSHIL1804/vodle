;
(self.AMP=self.AMP||[]).push({m:0,v:"2203281422000",n:"amp-skimlinks",ev:"0.1",l:!0,f:function(t,n){!function(){function n(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function i(t,n){return(i=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function r(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&i(t,n)}function e(t){return(e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,n){if(n&&("object"===u(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function s(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=e(t);if(n){var u=e(this).constructor;i=Reflect.construct(r,arguments,u)}else i=r.apply(this,arguments);return o(this,i)}}var c="load-start",a=Array.isArray;function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}var h,l=Object.prototype;function v(t){var n=Object.create(null);return t&&Object.assign(n,t),n}function d(t){return(t.ownerDocument||t).defaultView}function p(t,n){return t.replace(/^|,/g,"$&".concat(n," "))}function m(t,n,i){return function(t,n){for(var i in n)t.setAttribute(i,n[i]);return t}(t.createElement(n),i)}l.hasOwnProperty,l.toString;var b=self.AMP_CONFIG||{},w=("string"==typeof b.thirdPartyFrameRegex?new RegExp(b.thirdPartyFrameRegex):b.thirdPartyFrameRegex,("string"==typeof b.cdnProxyRegex?new RegExp(b.cdnProxyRegex):b.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function y(t){if(!self.document||!self.document.head)return null;if(self.location&&w.test(self.location.origin))return null;var n=self.document.head.querySelector('meta[name="'.concat(t,'"]'));return n&&n.getAttribute("content")||null}b.thirdPartyUrl,b.thirdPartyFrameHost,b.cdnUrl||y("runtime-host"),b.errorReportingUrl,b.betaErrorReportingUrl,b.localDev,b.geoApiUrl||y("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var k,g=self.__AMP_LOG;function j(t,n){throw new Error("failed to call initLogConstructor")}function O(t){return j()}function S(){return g.dev||(g.dev=j())}function N(t,n,i,r,e,u,o,s,c,a,f){return t}function x(t,n,i,r,e,u,o,s,c,a,f){return(g.user||(g.user=O()),void g.user.win?g.userForEmbed||(g.userForEmbed=O()):g.user).assert(t,n,i,r,e,u,o,s,c,a,f)}function I(){return k||(k=Promise.resolve(void 0))}var U=function(){var t=this;this.promise=new Promise((function(n,i){t.resolve=n,t.reject=i}))};function A(t,n){return P(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function T(t,n){return P(D(C(t)),n)}function E(t,n){return function(t,n){var i=$(t,n);if(i)return i;var r,e,u,o,s=J(t);return s[n]=(e=(r=new U).promise,u=r.reject,o=r.resolve,e.catch((function(){})),{obj:null,promise:e,resolve:o,reject:u,context:null,ctor:null}),s[n].promise}(D(t),n)}function R(t,n){return $(D(t),n)}function C(t){return t.nodeType?(n=d(t),A(n,"ampdoc")).getAmpDoc(t):t;var n}function D(t){var n=C(t);return n.isSingleDoc()?n.win:n}function P(t,n){N(function(t,n){var i=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!i||!i.ctor)}(t,n));var i=J(t)[n];return i.obj||(N(i.ctor),N(i.context),i.obj=new i.ctor(i.context),N(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}function $(t,n){var i=J(t)[n];return i?i.promise?i.promise:(P(t,n),i.promise=Promise.resolve(i.obj)):null}function J(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var L,z,M=function(t){return C(t)},q=function(t){return function(t,n,i,r){var e=R(t,n);if(e)return e;var u=C(t);return u.whenExtensionsKnown().then((function(){var t=u.getExtensionVersion(i);return t?A(u.win,"extensions").waitForExtension(i,t):null})).then((function(i){return i?E(t,n):null}))}(t,"amp-analytics-instrumentation","amp-analytics")},B=function(t){return T(t,"documentInfo").get()},_=function(t){return A(t,"extensions")},F=function(t,n){this.syncResponse=t,this.asyncResponse=n},Z=function(){function t(t){this.St=t,this.It=0,this.Ct=0,this.Ot=v()}var n=t.prototype;return n.has=function(t){return!!this.Ot[t]},n.get=function(t){var n=this.Ot[t];if(n)return n.access=++this.Ct,n.payload},n.put=function(t,n){this.has(t)||this.It++,this.Ot[t]={payload:n,access:this.Ct},this.Rt()},n.Rt=function(){if(!(this.It<=this.St)){var t,n=this.Ot,i=this.Ct+1;for(var r in n){var e=n[r].access;e<i&&(i=e,t=r)}void 0!==t&&(delete n[t],this.It--)}},t}();function G(){for(var t="",n=0;n<8;n++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}function K(t){return function(t,n){return L||(L=self.document.createElement("a"),z=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new Z(100))),function(t,n,i){if(i&&i.has(n))return i.get(n);t.href=n,t.protocol||(t.href=t.href);var r,e={href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:"0"==t.port?"":t.port,pathname:t.pathname,search:t.search,hash:t.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname),("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)&&(e.port="",e.host=e.hostname),r=t.origin&&"null"!=t.origin?t.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href,e.origin=r;var u=e;return i&&i.put(n,u),u}(L,t,z)}(t).hostname.replace(/^www\./,"")}function H(t){return t?t.hostname.replace(/^www\./,""):""}function W(t,n){var i=n.excludedDomains;return i&&-1!==i.indexOf(t)}function Q(t,n){return W(H(t),n)}new Set(["c","v","a","ad"]);var V="affiliate",X="ignore",Y="unknown",tt=function(){function t(t,n,i){this.Sr=t,this.tN=n,this.nN=i,this.iN={},this.firstRequest=null}var n=t.prototype;return n.fetchDomainResolverApi=function(t){var n={"pubcode":this.tN.pubcode,"page":"","domains":t},i=this.tN.config.beaconUrl;return i="".concat(i,"?data=").concat(JSON.stringify(n)),this.Sr.fetchJson(i,{method:"GET",ampCors:!1,credentials:"include"}).then((function(t){return t.json()}))},n.resolveUnknownAnchors=function(t){var n=this.rN(t),i=null,r=this.eN(t);if(r.length){this.uN(r);var e=this.oN(t,r);i=this.sN(e,r)}return new F(n,i)},n.rN=function(t){var n=this;return t.map((function(t){var i=null,r=n.cN(n.aN(t));return(r===V||r===Y)&&(i=n.nN.getAffiliateUrl(t)),{anchor:t,replacementUrl:i}}))},n.cN=function(t){return W(t,this.tN)?X:this.iN[t]||Y},n.eN=function(t){var n=this;return t.reduce((function(t,i){var r=n.aN(i),e=n.iN[r],u=W(r,n.tN),o=-1!==t.indexOf(r);return e||u||o||t.push(r),t}),[])},n.uN=function(t){var n=this;t.forEach((function(t){n.iN[t]||(W(t,n.tN)&&(n.iN[t]=X),n.iN[t]=Y)}))},n.oN=function(t,n){var i=this;return t.filter((function(t){var r=i.aN(t);return-1!==n.indexOf(r)}))},n.sN=function(t,n){var i=this,r=this.fetchDomainResolverApi(n);return this.firstRequest||(this.firstRequest=r),r.then((function(r){var e=r.merchant_domains||[];return i.fN(n,e),i.rN(t)}))},n.fN=function(t,n){var i=this;t.forEach((function(t){var r=-1!==n.indexOf(t);i.iN[t]=r?V:"non-affiliate"}))},n.aN=function(t){return H(t)},t}(),nt="data-skimlinks-custom-tracking-id",it="amp@1.0.3",rt="amp-skimlinks",et="https://t.skimresources.com/api",ut={pageTrackingUrl:"".concat(et,"/track.php?data=${data}"),linksTrackingUrl:"".concat(et,"/link?data=${data}"),nonAffiliateTrackingUrl:"".concat(et,"/?call=track&rnd=${rnd}&data=${data}"),beaconUrl:"https://r.skimresources.com/api"},ot=["facebook.com","go.redirectingat.com","go.skimresources.com","instagram.com","twitter.com","youtube.com"],st="PAGE_SCANNED",ct="CLICK",at="data-link-rewriter-original-url";var ft=function(){function t(){this.ve=[]}var n,i=t.prototype;return i.peek=function(){var t=this.length;return t?this.ve[t-1].item:null},i.enqueue=function(t,n){if(isNaN(n))throw new Error("Priority must not be NaN.");var i=this.de(n);this.ve.splice(i,0,{item:t,priority:n})},i.de=function(t){for(var n=-1,i=0,r=this.length;i<=r&&(n=Math.floor((i+r)/2))!==this.length;)if(this.ve[n].priority<t)i=n+1;else{if(!(n>0&&this.ve[n-1].priority>=t))break;r=n-1}return n},i.forEach=function(t){for(var n=this.length;n--;)t(this.ve[n].item)},i.dequeue=function(){var t=this.ve.pop();return t?t.item:null},(n=[{key:"length",get:function(){return this.ve.length}}])&&function(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,n),t}();function ht(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,r)}return i}function lt(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?ht(Object(r),!0).forEach((function(i){n(t,i,r[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}var vt,dt=function(){function t(){this.vt=null}var n=t.prototype;return n.add=function(t){var n=this;return this.vt||(this.vt=[]),this.vt.push(t),function(){n.remove(t)}},n.remove=function(t){var n,i,r;this.vt&&(i=t,-1!=(r=(n=this.vt).indexOf(i))&&n.splice(r,1))},n.removeAll=function(){this.vt&&(this.vt.length=0)},n.fire=function(t){if(this.vt)for(var n,i=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return f(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(t,n):void 0}}(t))||t&&"number"==typeof t.length){i&&(t=i);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.vt.slice());!(n=i()).done;)(0,n.value)(t)},n.getHandlerCount=function(){var t,n;return null!==(t=null===(n=this.vt)||void 0===n?void 0:n.length)&&void 0!==t?t:0},t}(),pt=function(){function t(){this.hN=[],this.lN=[]}var n=t.prototype;return n.updateLinkList=function(t){this.lN=t.map(this.getReplacementUrlForAnchor.bind(this)),this.hN=t},n.updateReplacementUrls=function(t){var n=this;t.forEach((function(t){var i=t.anchor,r=t.replacementUrl,e=n.hN.indexOf(i);-1!==e&&(n.lN[e]=r)}))},n.getReplacementUrlForAnchor=function(t){var n=this.hN.indexOf(t);return-1!==n?this.lN[n]:null},n.isInCache=function(t){return-1!==this.hN.indexOf(t)},n.getAnchorReplacementList=function(){var t=this;return this.hN.map((function(n){return{anchor:n,replacementUrl:t.getReplacementUrlForAnchor(n)}}))},t}(),mt=["Webkit","webkit","Moz","moz","ms","O","o"];function bt(t,n,i,r,e){var u=function(t,n,i){if(n.startsWith("--"))return n;vt||(vt=v());var r=vt[n];if(!r||i){if(r=n,void 0===t[n]){var e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),u=function(t,n){for(var i=0;i<mt.length;i++){var r=mt[i]+n;if(void 0!==t[r])return r}return""}(t,e);void 0!==t[u]&&(r=u)}i||(vt[n]=r)}return r}(t.style,n,e);if(u){var o,s=r?i+r:i;t.style.setProperty((o=u.replace(/[A-Z]/g,(function(t){return"-"+t.toLowerCase()})),mt.some((function(t){return o.startsWith(t+"-")}))?"-".concat(o):o),s)}}var wt=!1,yt="CHUNK",kt=/nochunking=1/.test(self.location.hash),gt=I();var jt="not_run",Ot=function(){function t(t){this.state=jt,this.pe=t}var n=t.prototype;return n.be=function(t){if("run"!=this.state){this.state="run";try{this.pe(t)}catch(t){throw this.ge(t),t}}},n.ye=function(){return this.pe.displayName||this.pe.name},n.ge=function(t){},n.we=function(){return!1},n.Ae=function(){return!1},t}(),St=function(t){r(i,t);var n=s(i);function i(t,i,r){var e;return(e=n.call(this,t)).Ee=r,e}var e=i.prototype;return e.ge=function(t){var n;N((n=self.document).defaultView),wt||(wt=!0,function(t){!function(t,n){for(var i in n)bt(t,i,n[i])}(t.body,{opacity:1,visibility:"visible","animation":"none"})}(n))},e.we=function(){return this.xe()},e.Ae=function(){return this.Ee.Oe},e.xe=function(){return this.Ee.ampdoc.isVisible()},i}(Ot),Nt=function(){function t(t){var n,i=this;this.ampdoc=t,this.t=t.win,this.Te=new ft,this.Ie=this.Pe.bind(this),this.Se=0,this.Me=!(!this.t.navigator.scheduling||!this.t.navigator.scheduling.isInputPending),this.ke=!1,this.me=this.t.document.documentElement.hasAttribute("i-amphtml-no-boilerplate"),this.t.addEventListener("message",(function(t){"amp-macro-task"==t.data&&i.Pe(null)})),this.Oe=!1,(n=t,E(n,"viewer")).then((function(){i.Oe=!0})),t.onVisibilityChanged((function(){t.isVisible()&&i._e()}))}var n=t.prototype;return n.run=function(t,n){var i=new Ot(t);this.Re(i,n)},n.runForStartup=function(t){var n=new St(t,this.t,this);this.Re(n,Number.POSITIVE_INFINITY)},n.Re=function(t,n){this.Te.enqueue(t,n),this._e()},n.Ne=function(t){for(var n=this.Te.peek();n&&n.state!==jt;)this.Te.dequeue(),n=this.Te.peek();return n&&t&&this.Te.dequeue(),n},n.Pe=function(t){var n,i=this,r=this.Ne(!0);if(!r)return this.ke=!1,this.Se=0,!1;try{n=Date.now(),r.be(t)}finally{gt.then().then().then().then().then().then().then().then().then((function(){i.ke=!1,i.Se+=Date.now()-n,S().fine(yt,r.ye(),"Chunk duration",Date.now()-n,i.Se),i._e()}))}return!0},n.Ce=function(t){var n=this;if(this.me&&(this.Me?this.t.navigator.scheduling.isInputPending():this.Se>5))return this.Se=0,void this.je();gt.then((function(){n.Ie(t)}))},n._e=function(){if(!this.ke){var t=this.Ne();if(t)return t.we()?(this.ke=!0,void this.Ce(null)):void(t.Ae()&&this.t.requestIdleCallback?(n=this.t,i=2e3,r=this.Ie,e=Date.now(),n.requestIdleCallback((function t(u){if(u.timeRemaining()<15){var o=i-(Date.now()-e);o<=0||u.didTimeout?(S().fine(yt,"Timed out",i,u.didTimeout),r(u)):(S().fine(yt,"Rescheduling with",o,u.timeRemaining()),n.requestIdleCallback(t,{timeout:o}))}else S().fine(yt,"Running idle callback with ",15),r(u)}),{timeout:i})):this.je())}var n,i,r,e},n.je=function(){this.t.postMessage("amp-macro-task","*")},t}(),xt=function(){function t(t,n,i,r){this.events=new dt,this.id=n,this.Nu=t,this.vN=i,this.dN=r.linkSelector||"a",this.pN=300,this.mN=new pt}var n=t.prototype;return n.getReplacementUrl=function(t){return this.isWatchingLink(t)?this.mN.getReplacementUrlForAnchor(t):null},n.getAnchorReplacementList=function(){return this.mN.getAnchorReplacementList()},n.isWatchingLink=function(t){return this.mN.isInCache(t)},n.rewriteAnchorUrl=function(t){var n=this.getReplacementUrl(t);return!(!n||n===t.href||(t.setAttribute(at,t.href),t.href=n,setTimeout((function(){t.href=t.getAttribute(at),t.removeAttribute(at)}),this.pN),0))},n.onDomUpdated=function(){var t=this;return new Promise((function(n){!function(t,n,i){if(kt)gt.then(n);else{var r=function(t){return n="chunk",i=Nt,function(t,n,i,r,e,u){var o=J(t),s=o[i];s||(s=o[i]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),s.ctor||(s.ctor=r,s.context=n,s.sharedInstance=!1,s.resolve&&P(t,i))}(D(r=C(t)),r,n,i),T(t,"chunk");var n,i,r}(t);r.run(n,i)}}(t.Nu.nodeType==Node.DOCUMENT_NODE?t.Nu.documentElement:t.Nu,(function(){return t.bN().then((function(){t.events.fire({type:st}),n()}))}),10)}))},n.bN=function(){var t=this,n=this.wN(),i=this.oN(n);if(this.mN.updateLinkList(n),!i.length)return I();this.mN.updateReplacementUrls(i.map((function(t){return{anchor:t,replacementUrl:null}})));var r=this.vN(i);return x(r instanceof F,'Invalid response from provided "resolveUnknownLinks" function."resolveUnknownLinks" should return an instance of TwoStepsResponse'),r.syncResponse&&this.mN.updateReplacementUrls(r.syncResponse),r.asyncResponse?r.asyncResponse.then((function(n){t.mN.updateReplacementUrls(n)})):I()},n.oN=function(t){var n=this,i=[];return t.forEach((function(t){n.isWatchingLink(t)||i.push(t)})),i},n.wN=function(){var t=this.Nu.querySelectorAll(this.dN);return[].slice.call(t)},t}(),It=function(){function t(t){var n;this.Nu=t.getRootNode(),this.yN=this.kN(t),this.gN=[],this.jN(this.Nu),(n=t,T(n,"navigation")).registerAnchorMutator(this.maybeRewriteLink.bind(this),0)}var n=t.prototype;return n.registerLinkRewriter=function(t,n,i){var r=new xt(this.Nu,t,n,i);return this.ON(this.gN,r,this.yN),r.onDomUpdated(),r},n.maybeRewriteLink=function(t,n){var i=this.SN(t);if(i.length){for(var r=null,e=0;e<i.length;e++)if(i[e].rewriteAnchorUrl(t)){r=i[e];break}var u={linkRewriterId:r?r.id:null,anchor:t,clickType:n.type};i.forEach((function(t){var n={type:ct,eventData:u};t.events.fire(n)}))}},n.kN=function(t){var n=t.getMetaByName("amp-link-rewriter-priorities");return n?n.trim().split(/\s+/):[]},n.jN=function(t){t.addEventListener("amp:dom-update",this.NN.bind(this))},n.NN=function(){this.gN.forEach((function(t){t.onDomUpdated()}))},n.xN=function(t){var n=t.hasAttribute("data-link-rewriters")?t.getAttribute("data-link-rewriters").trim():null;return n?n.split(/\s+/):[]},n.ON=function(t,n,i){return t.push(n),t.sort((function(t,n){var r=i.indexOf(t.id),e=i.indexOf(n.id);return-1===r&&-1===e?0:-1===r?1:-1===e?-1:r>e?1:-1})),t},n.SN=function(t){var n=this,i=this.xN(t);return this.gN.reduce((function(r,e){return e.isWatchingLink(t)&&n.ON(r,e,i),r}),[])},t}();function Ut(t,n){x(t,"<amp-skimlinks> Invalid option => ".concat(n))}function At(t,n){var i=[].concat(n).concat(ot),r=t.getAttribute("excluded-domains");return r&&(i=i.concat(r.trim().split(/\s+/).map((function(t){return t.replace(/^www\./,"")})))),i}function Tt(t){var n=t.getAttribute("publisher-code");return Ut(n,'"publisher-code" is required.'),n}function Et(t){var n=t.getAttribute("tracking");return!n||(Ut("true"===n||"false"===n,'"tracking" possible values are "true" or "false".'),"true"===n)}function Rt(t){var n=t.getAttribute("custom-tracking-id");return n&&Ut(n.length<=50,'"custom-tracking-id" should be <=50 characters and only contain upper and lowercase characters, numbers, underscores and pipes.'),n}function Ct(t){return t.getAttribute("link-selector")||null}function Dt(t){var n=[];return t.canonicalUrl&&n.push(K(t.canonicalUrl)),t.sourceUrl&&n.push(K(t.sourceUrl)),n}function Pt(t){var n=t.getAttribute("custom-redirect-domain");return n?(n=n.replace(/^\/\/|^https?:\/\/|\/$/g,""),"http://".concat(n)):"https://go.skimresources.com"}function $t(t){try{var n=function(t){var n,i,r,e,u=(n=t,/^[\w-]+$/.test(i="script"),r=n,e="> ".concat(i),(void 0!==h?h:h=function(t){try{var n=t.ownerDocument,i=n.createElement("div"),r=n.createElement("div");return i.appendChild(r),i.querySelector(":scope div")===r}catch(t){return!1}}(r))?r.querySelectorAll(p(e,":scope")):function(t,n){var i=t.classList,r="i-amphtml-scoped";i.add(r);var e=p(n,".".concat(r)),u=t.querySelectorAll(e);return i.remove(r),u}(r,e)),o=u.length;if(1!==o)throw new Error("Found ".concat(o," <script> children. Expected 1."));var s,c=u[0];if(!function(t){var n;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(n=t.getAttribute("type"))||void 0===n?void 0:n.toUpperCase())}(c))throw new Error('<script> child must have type="application/json"');try{var a;return s=null!==(a=c.textContent)&&void 0!==a?a:"",JSON.parse(s)}catch(t){throw new Error("Failed to parse <script> contents. Is it valid JSON?")}}(t);return{pageTrackingUrl:n.pageTrackingUrl||ut.pageTrackingUrl,linksTrackingUrl:n.linksTrackingUrl||ut.linksTrackingUrl,nonAffiliateTrackingUrl:n.nonAffiliateTrackingUrl||ut.nonAffiliateTrackingUrl,beaconUrl:n.beaconUrl||ut.beaconUrl}}catch(t){return ut}}var Jt=function(){function t(t,n){var i=this;for(var r in N(n.triggers),this.Ei=t.getResourceId(),this.ei=t,this.IN=n,n.triggers){var e=n.triggers[r].on;N(e);var u=this.UN(e);n.triggers[r].on=u}this.ei.signals().whenSignal(c).then((function(){!function(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],e=t.ownerDocument,u=m(e,"amp-analytics",{"sandbox":"true","trigger":r?"":"immediate"}),o=m(e,"script",{"type":"application/json"});if(o.textContent=JSON.stringify(n),u.appendChild(o),u.CONFIG=n,i){var s=_(d(t)),c=M(t);s.installExtensionForDoc(c,"amp-analytics")}else q(t).then((function(t){N(t)}));t.appendChild(u)}(i.ei,n,!0)}))}var n=t.prototype;return n.trigger=function(t,n){N(this.IN.triggers[t]),function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];q(t).then((function(e){e&&e.triggerEventForTarget(t,n,i,r)}))}(this.ei,this.UN(t),n,!1)},n.UN=function(t){return"sandbox-".concat(this.Ei,"-").concat(t)},t}(),Lt=function(){function t(t){this.ei=t,this.IN={"requests":{},"triggers":{}}}var n=t.prototype;return n.setTransportConfig=function(t){this.IN.transport=t},n.setExtraUrlParams=function(t){this.IN.extraUrlParams=t},n.track=function(t,n){n=a(n)?n:[n],N(!this.IN.triggers[t]);for(var i=[],r=0;r<n.length;r++){var e="".concat(t,"-request-").concat(r);this.IN.requests[e]=n[r],i.push(e)}return this.IN.triggers[t]={"on":t,"request":i},this},n.build=function(){N(this.IN);var t=new Jt(this.ei,this.IN);return this.IN=null,t},t}(),zt="page-impressions",Mt="link-impressions",qt="non-affiliate-click",Bt=function(){function t(t,n,i){this.tg=n.tracking,this.AN={customTrackingId:n.customTrackingId,guid:null,pageImpressionId:G(),pageUrl:"CANONICAL_URL",pubcode:n.pubcode,referrer:i,timezone:"TIMEZONE"},this.tN=n,this.TN=this.EN(t)}var n=t.prototype;return n.getTrackingInfo=function(){return this.AN},n.setTrackingInfo=function(t){Object.assign(this.AN,t)},n.sendImpressionTracking=function(t){if(this.tg){var n=this.AN,i=n.guid,r=n.pageImpressionId,e=n.pageUrl,u={"pub":n.pubcode,"pag":e,"guid":i,"uuid":r,"tz":n.timezone,"jv":it},o=this.RN(t),s=o.numberAffiliateLinks,c=o.urls;this.CN(u,s),this.DN(u,s,c)}},n.sendNaClickTracking=function(t){if(this.tg&&!Q(t,this.tN)){var n=this.AN,i=n.customTrackingId,r=n.pageImpressionId,e=n.pageUrl,u=n.pubcode,o=n.referrer,s=n.timezone,c={"pubcode":u,"referrer":e,"pref":o,"site":"false","url":t.href,"custom":t.getAttribute(nt)||i,"xtz":s,"uuid":r,"product":"1","jv":it};this.TN.trigger(qt,{"data":JSON.stringify(c),"rnd":"RANDOM"})}},n.CN=function(t,n){var i=this.AN,r=i.customTrackingId,e=lt({"slc":n,"jsl":0,"pref":i.referrer,"uc":r,"t":1},t);this.TN.trigger(zt,{"data":JSON.stringify(e)})},n.DN=function(t,n,i){if(0!==n){var r=lt({"dl":i,"hae":n?1:0,"typ":"l"},t);this.TN.trigger(Mt,{"data":JSON.stringify(r)})}},n.EN=function(t){var n=new Lt(t),i=this.tN.config,r=i.linksTrackingUrl,e=i.nonAffiliateTrackingUrl,u=i.pageTrackingUrl;return n.track(zt,u),n.track(Mt,r),n.track(qt,e),n.setTransportConfig({"beacon":!0,"image":!0,"xhrpost":!1}),n.build()},n.RN=function(t){var n=this,i=0,r={};return t.forEach((function(t){var e=t.anchor,u=t.replacementUrl,o=Q(e,n.tN);Boolean(u)&&!o&&(r[e.href]=r[e.href]||{"ae":1,"count":0},r[e.href].count+=1,i+=1)})),{numberAffiliateLinks:i,urls:r}},t}(),_t=function(){function t(t,n,i,r){this.tg=i,this.PN=r,this.$N=B(t).canonicalUrl,this.JN="".concat((new Date).getTimezoneOffset()),this.tN=n}return t.prototype.getAffiliateUrl=function(t){if(!t)return null;var n=this.tg.getTrackingInfo(),i=n.customTrackingId,r=n.guid,e=n.pageImpressionId,u=n.pubcode,o=t.getAttribute(nt)||i,s={"id":u,"url":t.href,"sref":this.$N,"pref":this.PN,"xguid":r,"xuuid":e,"xtz":this.JN,"xs":"1","jv":it};return o&&(s.xcust=o),function(t,n,i){if(!n)return t;var r=t.split("#",2),e=r[0].split("?",2);return e[0]+(e[1]?"?".concat(e[1],"&").concat(n):"?".concat(n))+(r[1]?"#".concat(r[1]):"")}(this.tN.waypointBaseUrl,function(t){var n,i,r,e=[];for(var u in t){var o=t[u];if(null!=o){o=a(r=o)?r:[r];for(var s=0;s<o.length;s++)e.push((n=u,i=o[s],"".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i))))}}return e.join("&")}(s))},t}(),Ft=function(t){r(e,t);var i=s(e);function e(t){var n;return(n=i.call(this,t)).Sr=null,n.LN=null,n.zN=null,n.co=null,n.MN=null,n.tN={},n.qN=null,n.BN=null,n.nN=null,n._N=null,n.FN=null,n}var u=e.prototype;return u.buildCallback=function(){var t,n,i=this;return this.Sr=A(this.win,"xhr"),this.LN=this.getAmpDoc(),this.zN=B(this.LN),this.co=T(this.LN,"viewer"),this.MN=new It(this.LN),this.tN=(t=this.element,n=this.zN,{pubcode:Tt(t),excludedDomains:At(t,Dt(n)),tracking:Et(t),customTrackingId:Rt(t),linkSelector:Ct(t),waypointBaseUrl:Pt(t),config:$t(t)}),this.LN.waitForBodyOpen().then((function(){return i.co.getReferrerUrl()})).then((function(t){i.FN=t,i.ZN()}))},u.ZN=function(){this.qN=this.GN(),this.nN=new _t(this.LN,this.tN,this.qN,this.FN),this.BN=new tt(this.Sr,this.tN,this.nN),this._N=this.KN()},u.HN=function(t){var n=this;this.qN.setTrackingInfo({guid:t.guid}),this.LN.whenFirstVisible().then((function(){n.qN.sendImpressionTracking(n._N.getAnchorReplacementList())}))},u.WN=function(){return(this.BN.firstRequest||this.BN.fetchDomainResolverApi([])).then(this.HN.bind(this))},u.KN=function(){var t,i,r,e,u,o=this,s={linkSelector:this.tN.linkSelector},c=this.MN.registerLinkRewriter(rt,(function(t){return o.BN.resolveUnknownAnchors(t)}),s),a=(n(t={},st,(i=this.WN.bind(this),r=!1,e=null,u=i,function(){if(!r){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e=u.apply(self,n),r=!0,u=null}return e})),n(t,ct,this.yE.bind(this)),t);return c.events.add((function(t){var n=a[t.type];n&&n(t.eventData)})),c},u.GN=function(){return this.signals().signal(c),new Bt(this.element,this.tN,this.FN)},u.yE=function(t){t.linkRewriterId!==rt&&"contextmenu"!==t.clickType&&this.qN.sendNaClickTracking(t.anchor)},u.isLayoutSupported=function(){return!0},e}(t.BaseElement);t.registerElement("amp-skimlinks",Ft)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-skimlinks-0.1.js.map
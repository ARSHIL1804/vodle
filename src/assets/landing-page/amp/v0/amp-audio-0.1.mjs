;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-audio",ev:"0.1",l:!0,f:function(t,n){(()=>{var{isArray:n}=Array;function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,i=new Array(n);r<n;r++)i[r]=t[r];return i}function i(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,n){if(t){if("string"==typeof t)return r(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var e,{hasOwnProperty:o,toString:s}=Object.prototype,u="nodisplay";function l(t,r,e,o){for(var s,u,l=i(n(s=t)?s:[s],!0);!(u=l()).done;){const t=u.value,n=r.getAttribute(t);null!==n?e.setAttribute(t,n):o&&e.removeAttribute(t)}}function a(t){const n=Object.getOwnPropertyDescriptor(t,"message");if(null!=n&&n.writable)return t;const{message:r,stack:i}=t,e=new Error(r);for(const n in t)e[n]=t[n];return e.stack=i,e}function c(t){let n=null,r="";for(var e,o=i(arguments,!0);!(e=o()).done;){const t=e.value;t instanceof Error&&!n?n=a(t):(r&&(r+=" "),r+=t)}return n?r&&(n.message=r+": "+n.message):n=new Error(r),n}function f(t){const n=c.apply(null,arguments);return n.expected=!0,n}function h(t,...n){var r,i,e;r=f.apply(null,n),null===(i=(e=self).__AMP_REPORT_ERROR)||void 0===i||i.call(e,r)}var d=["Webkit","webkit","Moz","moz","ms","O","o"];function p(t,n){const r=(i=()=>t.play(!!n),new Promise((t=>{t(i())})));var i;return r.catch((t=>{h(0,t)})),r}var v=self.AMP_CONFIG||{},m=("string"==typeof v.thirdPartyFrameRegex?new RegExp(v.thirdPartyFrameRegex):v.thirdPartyFrameRegex,("string"==typeof v.cdnProxyRegex?new RegExp(v.cdnProxyRegex):v.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function y(t){if(!self.document||!self.document.head)return null;if(self.location&&m.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}v.thirdPartyUrl,v.thirdPartyFrameHost,v.cdnUrl||y("runtime-host"),v.errorReportingUrl,v.betaErrorReportingUrl,v.localDev,v.geoApiUrl||y("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b=self.__AMP_LOG;function g(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function w(t,n,r,i,e,o,s,u,l,a,c){return t}function A(t,n,r,i,e,o,s,u,l,a,c){return(b.user||(b.user=g()),void b.user.win?b.userForEmbed||(b.userForEmbed=g()):b.user).assert(t,n,r,i,e,o,s,u,l,a,c)}function _(t,n){return I(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function P(t,n){return function(t,n){const r=M(t,n);if(r)return r;const i=O(t);return i[n]=function(){const t=new class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}},{promise:n,reject:r,resolve:i}=t;return n.catch((()=>{})),{obj:null,promise:n,resolve:i,reject:r,context:null,ctor:null}}(),i[n].promise}(j(t),n)}function E(t,n){return M(j(t),n)}function k(t){return t.nodeType?(n=t,r=(n.ownerDocument||n).defaultView,_(r,"ampdoc")).getAmpDoc(t):t;var n,r}function j(t){const n=k(t);return n.isSingleDoc()?n.win:n}function I(t,n){w(R(t,n));const r=O(t)[n];return r.obj||(w(r.ctor),w(r.context),r.obj=new r.ctor(r.context),w(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function M(t,n){const r=O(t)[n];return r?r.promise?r.promise:(I(t,n),r.promise=Promise.resolve(r.obj)):null}function O(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function R(t,n){const r=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!r||!r.ctor)}var S,T=t=>function(t,n,r,i){const e=E(t,n);if(e)return e;const o=k(t);return o.whenExtensionsKnown().then((()=>{const t=o.getExtensionVersion(r);return t?_(o.win,"extensions").waitForExtension(r,t):null})).then((r=>r?i?E(t,n):P(t,n):null))}(t,"amp-analytics-instrumentation","amp-analytics"),V=t=>function(t,n){const r=j(k(t));return R(r,n)?I(r,n):null}(t,"url");function x(t,n,r={},i=!0){T(t).then((e=>{e&&e.triggerEventForTarget(t,n,r,i)}))}function C(t,n,r,i){return function(t,n,r,i){let e=t,o=r,s=t=>{try{return o(t)}catch(t){var n,r;throw null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,t),t}};const u=function(){if(void 0!==S)return S;S=!1;try{const t={get capture(){return S=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return S}(),l=!(null==i||!i.capture);return e.addEventListener(n,s,u?i:l),()=>{null==e||e.removeEventListener(n,s,u?i:l),o=null,e=null,s=null}}(t,n,r,i)}var L,$={"title":"","artist":"","album":"","artwork":[{"src":""}]};function z(t,n,r="source"){var i;return A(null!=t,"%s %s must be available",n,r),A("https:"==(i=(t=>"string"==typeof t?function(t,n){return L||(L=self.document.createElement("a")),function(t,n,r){return t.href="",new URL(n,t.href)}(L,t)}(t):t)(i=t)).protocol||"localhost"==i.hostname||"127.0.0.1"==i.hostname||function(t,n){const r=t.length-n.length;return r>=0&&t.indexOf(n,r)==r}(i.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,r,t),t}new Set(["c","v","a","ad"]);var F=class extends t.BaseElement{constructor(t){super(t),this.kb=null,this.xg=$,this.isPlaying=!1}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t}(t)}buildCallback(){this.getLayout()===u&&(this.element.removeAttribute("autoplay"),this.buildAudioElement()),this.element.classList.add("i-amphtml-media-component"),this.registerAction("play",this.jb.bind(this)),this.registerAction("pause",this.Ob.bind(this))}mutatedAttributesCallback(t){if(!this.kb)return;const n=t.src,r=t.controlsList,i=t.loop;void 0===n&&void 0===r&&void 0===i||(void 0!==n&&z(n,this.element),l(["src","loop","controlsList"],this.element,this.kb));const e=t.artist,o=t.title,s=t.album,u=t.artwork;void 0===e&&void 0===o&&void 0===s&&void 0===u||this.Sb()}buildAudioElement(){const t=this.element.ownerDocument.createElement("audio");if(!t.play)return void this.toggleFallback(!0);t.controls=!0,function(t,n,r,i,o){const s=function(t,n,r){if(n.startsWith("--"))return n;e||(e=Object.create(null));let i=e[n];if(!i||r){if(i=n,void 0===t[n]){const r=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),e=function(t,n){for(let r=0;r<d.length;r++){const i=d[r]+n;if(void 0!==t[i])return i}return""}(t,r);void 0!==t[e]&&(i=e)}r||(e[n]=i)}return i}(t.style,"width",void 0);if(!s)return;t.style.setProperty(function(t){const n=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return d.some((t=>n.startsWith(t+"-")))?`-${n}`:n}(s),"100%")}(t);const n=this.Tb("src");var r;n&&z(n,this.element),l(["src","preload","autoplay","muted","loop","aria-label","aria-describedby","aria-labelledby","controlsList"],this.element,t),t.classList.add("i-amphtml-fill-content"),(r=this.element,function(t,n){const r=[];for(let n=t.firstChild;n;n=n.nextSibling)!(function(t){let n;var r;return"string"==typeof t?n=t:1==(null==(r=t)?void 0:r.nodeType)&&(n=t.tagName),!!n&&n.toLowerCase().startsWith("i-")}(i=n)||i.nodeType===Node.ELEMENT_NODE&&(i.hasAttribute("placeholder")||i.hasAttribute("fallback")||i.hasAttribute("overflow")))&&r.push(n);var i;return r}(r)).forEach((n=>{n.getAttribute&&n.getAttribute("src")&&z(n.getAttribute("src"),n),t.appendChild(n)})),this.element.appendChild(t),this.kb=t,C(this.kb,"playing",(()=>this.Vb())),C(this.kb,"play",(()=>x(this.element,"audio-play"))),C(this.kb,"pause",(()=>x(this.element,"audio-pause")))}layoutCallback(){return this.getLayout()!==u&&this.buildAudioElement(),this.Sb(),"none"===this.element.getAttribute("preload")?this.kb:this.loadPromise(this.kb)}Sb(){const{document:t}=this.getAmpDoc().win,n=this.Tb("artist")||"",r=this.Tb("title")||this.Tb("aria-label")||t.title||"",i=this.Tb("album")||"",e=this.Tb("artwork")||function(t){const n=t.querySelector('script[type="application/ld+json"]');if(!n)return;const r=function(t,n){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null}}(n.textContent);return r&&r.image?"string"==typeof r.image?r.image:r.image["@list"]&&"string"==typeof r.image["@list"][0]?r.image["@list"][0]:"string"==typeof r.image.url?r.image.url:"string"==typeof r.image[0]?r.image[0]:void 0:void 0}(t)||function(t){const n=t.querySelector('meta[property="og:image"]');return n?n.getAttribute("content"):void 0}(t)||function(t){const n=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return n?n.getAttribute("href"):void 0}(t)||"";this.xg={title:r,artist:n,album:i,artwork:[{src:e}]}}renderOutsideViewport(){return!0}Tb(t){return this.element.getAttribute(t)}pauseCallback(){this.kb&&(this.kb.pause(),this.xb(!1))}Cb(){return!!this.kb}Ob(){this.Cb()&&(this.kb.pause(),this.xb(!1))}jb(){this.Cb()&&(p(this.kb),this.xb(!0))}xb(t){}Vb(){(function(t,r){const i=V(t);if(r&&r.artwork){const{artwork:t}=r;w(n(t)),t.forEach((t=>{if(t){const r=(n=t,"[object Object]"===s.call(n)?t.src:t);A(i.isProtocolValid(r))}var n}))}})(this.element,this.xg),function(t,n,r,i){const{navigator:e}=t;"mediaSession"in e&&t.MediaMetadata&&(e.mediaSession.metadata=new t.MediaMetadata($),e.mediaSession.metadata=new t.MediaMetadata(n),e.mediaSession.setActionHandler("play",r),e.mediaSession.setActionHandler("pause",i))}(this.win,this.xg,(()=>{p(this.kb),this.xb(!0)}),(()=>{this.kb.pause(),this.xb(!1)}))}};t.registerElement("amp-audio",F)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-audio-0.1.mjs.map
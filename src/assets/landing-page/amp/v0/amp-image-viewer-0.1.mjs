;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-image-viewer",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,h=new Array(i);s<i;s++)h[s]=t[s];return h}function s(t,s){var h="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(h)return(h=h.call(t)).next.bind(h);if(Array.isArray(t)||(h=function(t,s){if(t){if("string"==typeof t)return i(t,s);var h=Object.prototype.toString.call(t).slice(8,-1);return"Object"===h&&t.constructor&&(h=t.constructor.name),"Map"===h||"Set"===h?Array.from(t):"Arguments"===h||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?i(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){h&&(t=h);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h;function e(){return h||(h=Promise.resolve(void 0))}var n=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:r}=Array;function o(t,i){const s=[];let h=0;for(let e=0;e<t.length;e++){const n=t[e];i(n,e,t)?s.push(n):(h<e&&(t[h]=n),h++)}return h<t.length&&(t.length=h),s}function u(t){return"string"==typeof t}var{hasOwnProperty:c,toString:a}=Object.prototype;function l(t){return 1==(null==t?void 0:t.nodeType)}function f(t,i,s,h){return e=>P.solveYValueFromXValue(e,0,0,t,i,s,h,1,1)}var _,P=class{static solveYValueFromXValue(t,i,s,h,e,n,r,o,u){return P.yr(P.Ir(t,i,h,n,o),s,e,r,u)}static Ir(t,i,s,h,e){const n=1e-6;let r=(t-i)/(e-i);if(r<=0)return 0;if(r>=1)return 1;let o=0,u=1,c=0;for(let a=0;a<8;a++){c=P.Mr(r,i,s,h,e);const a=(P.Mr(r+n,i,s,h,e)-c)/n;if(Math.abs(c-t)<n)return r;if(Math.abs(a)<n)break;c<t?o=r:u=r,r-=(c-t)/a}for(let a=0;Math.abs(c-t)>n&&a<8;a++)c<t?(o=r,r=(r+u)/2):(u=r,r=(r+o)/2),c=P.Mr(r,i,s,h,e);return r}static Mr(t,i,s,h,e){if(0==t)return i;if(1==t)return e;let n=P.Rr(i,s,t),r=P.Rr(s,h,t);const o=P.Rr(h,e,t);return n=P.Rr(n,r,t),r=P.Rr(r,o,t),P.Rr(n,r,t)}static yr(t,i,s,h,e){if(0==t)return i;if(1==t)return e;let n=P.Rr(i,s,t),r=P.Rr(s,h,t);const o=P.Rr(h,e,t);return n=P.Rr(n,r,t),r=P.Rr(r,o,t),P.Rr(n,r,t)}static Rr(t,i,s){return t+s*(i-t)}},A={LINEAR:t=>t,EASE:t=>P.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1),EASE_IN:t=>P.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1),EASE_OUT:t=>P.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1),EASE_IN_OUT:t=>P.solveYValueFromXValue(t,0,0,.42,0,.58,1,1,1)},d={"linear":A.LINEAR,"ease":A.EASE,"ease-in":A.EASE_IN,"ease-out":A.EASE_OUT,"ease-in-out":A.EASE_IN_OUT};function M(t){if(!t)return null;if(u(t)){if(-1!=(t=t).indexOf("cubic-bezier")){const i=t.match(/cubic-bezier\((.+)\)/);if(i){const t=i[1].split(",").map(parseFloat);if(4==t.length){for(let i=0;i<4;i++)if(isNaN(t[i]))return null;return f(t[0],t[1],t[2],t[3])}}return null}return d[t]}return t}function m(t){return l(t)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t}function p(t,i,s,h,e,n,r,o,u,c,a){return t}function v(t,i,s,h,e,n,r,u,c,a,l){return function(t,i,s="Assertion failed",h){var e,n;if(i)return i;t&&-1==s.indexOf(t)&&(s+=t);let r=3;const u=s.split("%s");let c=u.shift();const a=[c];for(;u.length;){const t=arguments[r++],i=u.shift();c+=m(t)+i,a.push(t,i.trim())}const l=new Error(c);throw l.messageArray=o(a,(t=>""!==t)),null===(e=(n=self).__AMP_REPORT_ERROR)||void 0===e||e.call(n,l),l}("​​​",t,i,s,h,e,n,r,u,c,a,l)}function E(t,i,s,h){return{left:t,top:i,width:s,height:h,bottom:i+h,right:t+s,x:t,y:i}}function T(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:h}=t,e=new Error(s);for(const i in t)e[i]=t[i];return e.stack=h,e}function g(t){let i=null,h="";for(var e,n=s(arguments,!0);!(e=n()).done;){const t=e.value;t instanceof Error&&!i?i=T(t):(h&&(h+=" "),h+=t)}return i?h&&(i.message=h+": "+i.message):i=new Error(h),i}function I(t){var i,s;null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t)}function R(t,...i){try{return t.apply(null,i)}catch(t){!function(t){const i=g.apply(null,arguments);setTimeout((()=>{throw I(i),i}))}(t)}}var V=["Webkit","webkit","Moz","moz","ms","O","o"],w={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function b(t,i,s,h,e){const n=function(t,i,s){if(i.startsWith("--"))return i;_||(_=Object.create(null));let h=_[i];if(!h||s){if(h=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),e=function(t,i){for(let s=0;s<V.length;s++){const h=V[s]+i;if(void 0!==t[h])return h}return""}(t,s);void 0!==t[e]&&(h=e)}s||(_[i]=h)}return h}(t.style,i,e);if(!n)return;const r=h?s+h:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return V.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(n),r)}function y(t,i){for(const s in i)b(t,s,i[s])}function S(t){return`${t}px`}function D(t,i){return"number"==typeof t?i(t):t}function k(t){return(t.ownerDocument||t).defaultView}var C=/vertical/,x=new WeakMap,X=new WeakMap,Y=new WeakMap;function O(t){let i=x.get(t);return i||(i=new t.ResizeObserver(z),x.set(t,i)),i}function z(t){const i=new Set;for(let s=t.length-1;s>=0;s--){const h=t[s],{target:e}=h;if(i.has(e))continue;i.add(e);const n=X.get(e);if(n){Y.set(e,h);for(let t=0;t<n.length;t++){const{callback:i,type:s}=n[t];$(s,i,h)}}}}function $(t,i,s){if(0==t){const{contentRect:t}=s,{height:h,width:e}=t;R(i,{width:e,height:h})}else if(1==t){const{borderBoxSize:t}=s;let h;if(t)h=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=s,i=k(t),e=C.test(function(t,i){return t.getComputedStyle(i)||w}(i,t).writingMode),{offsetHeight:n,offsetWidth:r}=t;let o,u;e?(u=r,o=n):(o=r,u=n),h={inlineSize:o,blockSize:u}}R(i,h)}}function Z(t,i,h,e){for(var n,o,u=s(r(n=t)?n:[n],!0);!(o=u()).done;){const t=o.value,s=i.getAttribute(t);null!==s?h.setAttribute(t,s):e&&h.removeAttribute(t)}}function j(t,i){return t.closest?t.closest(i):function(t,i,s){let h;for(h=t;h&&void 0!==h;h=h.parentElement)if(i(h))return h;return null}(t,(t=>function(t,i){const s=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!s&&s.call(t,i)}(t,i)))}var N=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g,G=class{constructor(t){v(t.length>0,"Srcset must have at least one source"),this.kw=t;let i=!1,s=!1;for(let h=0;h<t.length;h++){const e=t[h];i=i||!!e.width,s=s||!!e.dpr}v(!(i===s),"Srcset must have width or dpr sources, but not both"),t.sort(i?U:B),this.jw=i}select(t,i){p(t),p(i);let s=0;return s=this.jw?this.Ow(t*i):this.Tw(i),this.kw[s].url}Ow(t){const i=this.kw;let s=0,h=1/0,e=1/0;for(let r=0;r<i.length;r++){var n;const o=null!==(n=i[r].width)&&void 0!==n?n:0,u=Math.abs(o-t);if(!(u<=1.1*h||t/e>1.2))break;s=r,h=u,e=o}return s}Tw(t){const i=this.kw;let s=0,h=1/0;for(let e=0;e<i.length;e++){const n=Math.abs(i[e].dpr-t);if(!(n<=h))break;s=e,h=n}return s}getUrls(){return this.kw.map((t=>t.url))}stringify(t){const i=[],s=this.kw;for(let h=0;h<s.length;h++){const e=s[h];let n=e.url;t&&(n=t(n)),this.jw?n+=` ${e.width}w`:n+=` ${e.dpr}x`,i.push(n)}return i.join(", ")}};function U(t,i){return v(t.width!=i.width,"Duplicate width: %s",t.width),t.width-i.width}function B(t,i){return v(t.dpr!=i.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-i.dpr}function L(t,i){return s=>t+(i-t)*s}function W(t,i,s,h){return p(i<=s),function(t,i,s){return p(i<=s),Math.min(Math.max(t,i),s)}(t,i-h,s+h)}function F(t,i){return Math.sqrt(t*t+i*i)}var H=self.AMP_CONFIG||{},q=("string"==typeof H.thirdPartyFrameRegex?new RegExp(H.thirdPartyFrameRegex):H.thirdPartyFrameRegex,("string"==typeof H.cdnProxyRegex?new RegExp(H.cdnProxyRegex):H.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function J(t){if(!self.document||!self.document.head)return null;if(self.location&&q.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}H.thirdPartyUrl,H.thirdPartyFrameHost,H.cdnUrl||J("runtime-host"),H.errorReportingUrl,H.betaErrorReportingUrl,H.localDev,H.geoApiUrl||J("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var K=self.__AMP_LOG;function Q(t,i){throw new Error("failed to call initLogConstructor")}function tt(t){return K.user||(K.user=it()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(K.user.win,t)?K.userForEmbed||(K.userForEmbed=it()):K.user}function it(t){return Q()}function st(){return K.dev||(K.dev=Q())}function ht(t,i,s,h,e,n,r,o,u,c,a){return t}function et(t,i,s,h,e,n,r,o,u,c,a){return tt().assert(t,i,s,h,e,n,r,o,u,c,a)}function nt(t,i){return ut(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function rt(t,i){return ut(function(t){const i=ot(t);return i.isSingleDoc()?i.win:i}(ot(t)),i)}function ot(t){return t.nodeType?(i=k(t),nt(i,"ampdoc")).getAmpDoc(t):t;var i}function ut(t,i){ht(function(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}(t,i));const s=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return s.obj||(ht(s.ctor),ht(s.context),s.obj=new s.ctor(s.context),ht(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}var ct,at,lt=t=>rt(t,"owners"),ft=t=>nt(t,"vsync"),_t="Animation",Pt=function(){},At=class{static animate(t,i,s,h){return new At(t).setCurve(h).add(0,i,1).start(s)}constructor(t,i){this.wr=t,this.br=i||ft(self),this.Vr=null,this.Sr=[]}setCurve(t){return t&&(this.Vr=M(t)),this}add(t,i,s,h){return this.Sr.push({delay:t,func:i,duration:s,curve:M(h)}),this}start(t){return new dt(this.br,this.wr,this.Sr,this.Vr,t)}},dt=class{constructor(t,i,s,h,e){this.br=t,this.wr=i,this.Sr=[];for(let t=0;t<s.length;t++){const i=s[t];this.Sr.push({delay:i.delay,func:i.func,duration:i.duration,curve:i.curve||h,started:!1,completed:!1})}this.Or=e,this.hr=Date.now(),this.Re=!0,this.mi={};const r=new n;this.Cr=r.promise,this.Xs=r.resolve,this.kr=r.reject,this.Nr=this.br.createAnimTask(this.wr,{mutate:this.Dr.bind(this)}),this.br.canAnimate(this.wr)?this.Nr(this.mi):this.Lr(!1,0)}then(t,i){return t||i?this.Cr.then(t,i):this.Cr}thenAlways(t){const i=t||Pt;return this.then(i,i)}halt(t){this.Lr(!1,t||0)}Lr(t,i){if(this.Re){if(this.Re=!1,0!=i){this.Sr.length>1&&this.Sr.sort(((t,i)=>t.delay+t.duration-(i.delay+i.duration)));try{if(i>0)for(let t=0;t<this.Sr.length;t++)this.Sr[t].func(1,!0);else for(let t=this.Sr.length-1;t>=0;t--)this.Sr[t].func(0,!1)}catch(i){st().error(_t,"completion failed: "+i,i),t=!1}}t?this.Xs():this.kr()}}Dr(t){if(!this.Re)return;const i=Date.now(),s=Math.min((i-this.hr)/this.Or,1);for(let t=0;t<this.Sr.length;t++){const i=this.Sr[t];!i.started&&s>=i.delay&&(i.started=!0)}for(let t=0;t<this.Sr.length;t++){const i=this.Sr[t];i.started&&!i.completed&&this.Ur(i,s)}1==s?this.Lr(!0,0):this.br.canAnimate(this.wr)?this.Nr(this.mi):this.Lr(!1,0)}Ur(t,i){let s,h;if(t.duration>0){if(s=Math.min((i-t.delay)/t.duration,1),h=s,t.curve&&1!=h)try{h=t.curve(s)}catch(t){return st().error(_t,"step curve failed: "+t,t),void this.Lr(!1,0)}}else s=1,h=1;1==s&&(t.completed=!0);try{t.func(h,t.completed)}catch(t){return st().error(_t,"step mutate failed: "+t,t),void this.Lr(!1,0)}}};function Mt(t,i,s,h){let e=s;const n=function(t,i,s,h){let e=t,n=s,r=t=>{try{return n(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const o=function(){if(void 0!==ct)return ct;ct=!1;try{const t={get capture(){return ct=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return ct}(),u=!(null==h||!h.capture);return e.addEventListener(i,r,o?h:u),()=>{null==e||e.removeEventListener(i,r,o?h:u),n=null,e=null,r=null}}(t,i,(t=>{try{e(t)}finally{e=null,n()}}),h);return n}function mt(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}var pt=class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var i,h=s(this.Tt.slice(),!0);!(i=h()).done;)(0,i.value)(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Tt)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},vt="__AMP_Gestures",Et=class{static get(t,i=!1,s=!1){let h=t[vt];return h||(h=new Et(t,i,s),t[vt]=h),h}constructor(t,i,s){this.yf=t,this.EI=[],this.h_=[],this.ui=[],this.TI=[],this.RI=null,this.VI=i,this.xI=s,this.kI=!1,this.be=new class{constructor(t,i,s){this.Ee=ut(t,"timer"),this.Te=i,this.ye=s||0,this.Ie=-1,this.Me=0,this.Re=!1,this.we=()=>{this.be()}}isPending(){return-1!=this.Ie}schedule(t){let i=t||this.ye;this.Re&&i<10&&(i=10);const s=Date.now()+i;return(!this.isPending()||s-this.Me<-10)&&(this.cancel(),this.Me=s,this.Ie=this.Ee.delay(this.we,i),!0)}be(){this.Ie=-1,this.Me=0,this.Re=!0,this.Te(),this.Re=!1}cancel(){this.isPending()&&(this.Ee.cancel(this.Ie),this.Ie=-1)}}(k(t),this.Ip.bind(this)),this.SI=new pt,this.DI=Object.create(null),this.CI=this.py.bind(this),this.zI=this.yy.bind(this),this.GI=this.my.bind(this),this.jI=this.d_.bind(this);const h=function(t){if(void 0!==at)return at;at=!1;try{const i={get passive(){return at=!0,!1}};t.addEventListener("test-options",null,i),t.removeEventListener("test-options",null,i)}catch(t){}return at}(t.ownerDocument.defaultView);this.yf.addEventListener("touchstart",this.CI,!!h&&{passive:!0}),this.yf.addEventListener("touchend",this.zI),this.yf.addEventListener("touchmove",this.GI,!!h&&{passive:!0}),this.yf.addEventListener("touchcancel",this.jI),this.OI=!1}cleanup(){this.yf.removeEventListener("touchstart",this.CI),this.yf.removeEventListener("touchend",this.zI),this.yf.removeEventListener("touchmove",this.GI),this.yf.removeEventListener("touchcancel",this.jI),delete this.yf[vt],this.be.cancel()}onGesture(t,i){const s=new t(this),h=s.getType();let e=this.DI[h];return e||(this.EI.push(s),e=new pt,this.DI[h]=e),e.add(i)}removeGesture(t){const i=new t(this).getType(),s=this.DI[i];if(s){s.removeAll();const t=function(t,s){for(let s=0;s<t.length;s++)if(t[s].getType()==i)return s;return-1}(this.EI);return!(t<0||(this.EI.splice(t,1),this.ui.splice(t,1),this.TI.splice(t,1),this.h_.splice(t,1),delete this.DI[i],0))}return!1}onPointerDown(t){return this.SI.add(t)}py(t){const i=Date.now();this.kI=!1,this.SI.fire(t);for(let s=0;s<this.EI.length;s++)this.ui[s]||(this.TI[s]&&this.TI[s]<i&&this.f_(s),this.EI[s].onTouchStart(t)&&this.p_(s));this.XI(t)}my(t){const i=Date.now();for(let s=0;s<this.EI.length;s++)this.h_[s]&&(this.TI[s]&&this.TI[s]<i?this.f_(s):this.EI[s].onTouchMove(t)||this.f_(s));this.XI(t)}yy(t){const i=Date.now();for(let s=0;s<this.EI.length;s++){if(!this.h_[s])continue;if(this.TI[s]&&this.TI[s]<i){this.f_(s);continue}this.EI[s].onTouchEnd(t);const h=!this.TI[s],e=this.TI[s]<i;this.RI==this.EI[s]||!h&&!e||this.f_(s)}this.XI(t)}d_(t){for(let t=0;t<this.EI.length;t++)this.$I(t);this.XI(t)}ny(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.EI.length;h++)this.EI[h]==t&&(this.ui[h]=s+i,this.TI[h]=0);this.OI=!0}HI(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.EI.length;h++)this.EI[h]==t&&(this.TI[h]=s+i)}LI(t){this.RI==t&&(this.RI=null,this.kI=!0)}UI(t,i,s){ht(this.RI==t);const h=this.DI[t.getType()];h&&h.fire(new class{constructor(t,i,s,h){this.type=t,this.data=i,this.time=s,this.event=h}}(t.getType(),i,Date.now(),s))}XI(t){let i=!!this.RI||this.kI;if(this.kI=!1,!i){const t=Date.now();for(let s=0;s<this.EI.length;s++)if(this.ui[s]||this.TI[s]&&this.TI[s]>=t){i=!0;break}}i?(t.stopPropagation(),this.VI||t.preventDefault()):this.xI&&t.stopPropagation(),this.OI&&(this.OI=!1,this.Ip())}Ip(){const t=Date.now();let i=-1;for(let s=0;s<this.EI.length;s++)this.ui[s]?(-1==i||this.ui[s]>this.ui[i])&&(i=s):this.TI[s]&&this.TI[s]<t&&this.f_(s);if(-1==i)return;let s=0;for(let i=0;i<this.EI.length;i++)!this.ui[i]&&this.h_[i]&&(s=Math.max(s,this.TI[i]-t));s<2?this.YI(i):this.be.schedule(s)}YI(t){const i=this.EI[t];for(let i=0;i<this.EI.length;i++)i!=t&&this.$I(i);this.ui[t]=0,this.TI[t]=0,this.RI=i,i.acceptStart()}p_(t){this.h_[t]=!0,this.TI[t]=0}f_(t){this.h_[t]=!1,this.TI[t]=0,this.ui[t]||this.EI[t].acceptCancel()}$I(t){this.ui[t]=0,this.f_(t)}},Tt=class{constructor(t,i){this.TT=t,this.E_=i}getType(){return this.TT}signalReady(t){this.E_.ny(this,t)}signalPending(t){this.E_.HI(this,t)}signalEnd(){this.E_.LI(this)}signalEmit(t,i){this.E_.UI(this,t,i)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}},gt=function(){},It=.02,Rt=Math.round(-16.67/Math.log(.95));function Vt(t,i,s){i<1&&(i=1);const h=t/i,e=.5+Math.min(i/33.34,.5);return h*e+s*(1-e)}function wt(t,i,s,h,e,n,r){return new bt(t,i,s,h,e,n,r).start()}var bt=class{constructor(t,i,s,h,e,r,o){this.br=o||ft(self),this.wr=t,this.st=r,this.wV=i,this.EV=s,this.MC=h,this.dC=e,this.yV=0,this.xV=0;const u=new n;this.Cr=u.promise,this.Xs=u.resolve,this.kr=u.reject,this.mC=!1}start(){return this.mC=!0,Math.abs(this.MC)<=It&&Math.abs(this.dC)<=It?(this.EC(),this.vC(!0)):this.TC(),this}halt(){this.mC&&this.vC(!1)}then(t,i){return t||i?this.Cr.then(t,i):this.Cr}thenAlways(t){const i=t||gt;return this.then(i,i)}TC(){this.yV=this.MC,this.xV=this.dC;const t=this.gC.bind(this),i=this.vC.bind(this,!0);return this.br.runAnimMutateSeries(this.wr,t,5e3).then(i,i)}gC(t,i){if(!this.mC)return!1;if(this.wV+=i*this.yV,this.EV+=i*this.xV,!this.EC())return!1;const s=Math.exp(-t/Rt);return this.yV=this.MC*s,this.xV=this.dC*s,Math.abs(this.yV)>It||Math.abs(this.xV)>It}vC(t){this.mC&&(this.mC=!1,this.EC(),t?this.Xs():this.kr())}EC(){return this.st(this.wV,this.EV)}},yt=class extends Tt{constructor(t){super("tap",t),this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.o=null}onTouchStart(t){const{touches:i}=t;return this.o=t.target,!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,0))}onTouchMove(t){const i=t.changedTouches||t.touches;if(i&&1==i.length){this.wV=i[0].clientX,this.EV=i[0].clientY;const t=Math.abs(this.wV-this.MV)>=8,s=Math.abs(this.EV-this.bV)>=8;if(t||s)return!1}return!0}onTouchEnd(t){this.signalReady(0)}acceptStart(){this.signalEmit({clientX:this.wV,clientY:this.EV,target:this.o},null),this.signalEnd()}},St=class extends Tt{constructor(t){super("doubletap",t),this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.tz=0,this.sz=null}onTouchStart(t){if(this.tz>1)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,this.wV=i[0].clientX,this.EV=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){this.wV=i[0].clientX,this.EV=i[0].clientY;const t=Math.abs(this.wV-this.MV)>=8,s=Math.abs(this.EV-this.bV)>=8;return!t&&!s||(this.acceptCancel(),!1)}return!1}onTouchEnd(t){this.tz++,this.tz<2?this.signalPending(200):(this.sz=t,this.signalReady(0))}acceptStart(){this.tz=0,this.signalEmit({clientX:this.wV,clientY:this.EV},this.sz),this.signalEnd()}acceptCancel(){this.tz=0}},Dt=class extends Tt{constructor(t,i,s,h){super(t,i),this.AV=s,this.PV=h,this.RI=!1,this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.TV=0,this.IV=0,this.hr=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){const{touches:i}=t;return!!(this.RI&&i&&i.length>1)||!(!i||1!=i.length)&&(this.hr=Date.now(),this.MV=i[0].clientX,this.bV=i[0].clientY,!0)}onTouchMove(t){const{touches:i}=t;if(i&&i.length>=1){const{clientX:s,clientY:h}=i[0];if(this.wV=s,this.EV=h,this.RI)this.kV(!1,!1,t);else{const t=Math.abs(s-this.MV),i=Math.abs(h-this.bV);if(this.AV&&this.PV)(t>=8||i>=8)&&this.signalReady(-10);else if(this.AV){if(t>=8&&t>i)this.signalReady(-10);else if(i>=8)return!1}else{if(!this.PV)return!1;if(i>=8&&i>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:i}=t;i&&0==i.length&&this.SV(t)}acceptStart(){this.RI=!0,this.TV=this.MV,this.IV=this.bV,this.VV=this.hr,this.MV=this.wV,this.bV=this.EV,this.kV(!0,!1,null)}acceptCancel(){this.RI=!1}kV(t,i,s){this.RV=Date.now();const h=this.RV-this.VV;if(!i&&h>4||i&&h>16){const t=Vt(this.wV-this.TV,h,this.yV),s=Vt(this.EV-this.IV,h,this.xV);(!i||h>32||0!=t||0!=s)&&(this.yV=Math.abs(t)>1e-4?t:0,this.xV=Math.abs(s)>1e-4?s:0),this.TV=this.wV,this.IV=this.EV,this.VV=this.RV}this.signalEmit({first:t,last:i,time:this.RV,deltaX:this.wV-this.MV,deltaY:this.EV-this.bV,startX:this.MV,startY:this.bV,lastX:this.wV,lastY:this.EV,velocityX:this.yV,velocityY:this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}},kt=class extends Dt{constructor(t){super("swipe-xy",t,!0,!0)}},Ct=class extends Tt{constructor(t){super("tapzoom",t),this.RI=!1,this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.tz=0,this.TV=0,this.IV=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){if(this.RI)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){if(this.wV=i[0].clientX,this.EV=i[0].clientY,this.RI)this.kV(!1,!1,t);else{const t=Math.abs(this.wV-this.MV)>=8,i=Math.abs(this.EV-this.bV)>=8;if(t||i){if(0==this.tz)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1}onTouchEnd(t){this.RI?this.SV(t):(this.tz++,1!=this.tz?this.acceptCancel():this.signalPending(400))}acceptStart(){this.tz=0,this.RI=!0,this.kV(!0,!1,null)}acceptCancel(){this.tz=0,this.RI=!1}kV(t,i,s){this.RV=Date.now(),t?this.yV=this.xV=0:this.RV-this.VV>2&&(this.yV=Vt(this.wV-this.TV,this.RV-this.VV,this.yV),this.xV=Vt(this.EV-this.IV,this.RV-this.VV,this.xV)),this.TV=this.wV,this.IV=this.EV,this.VV=this.RV,this.signalEmit({first:t,last:i,centerClientX:this.MV,centerClientY:this.bV,deltaX:this.wV-this.MV,deltaY:this.EV-this.bV,velocityX:this.yV,velocityY:this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}},xt=class extends Tt{constructor(t){super("pinch",t),this.RI=!1,this.iz=0,this.hz=0,this.nz=0,this.ez=0,this.rz=0,this.oz=0,this.uz=0,this.cz=0,this.az=0,this.lz=0,this.fz=0,this._z=0,this.hr=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){const{touches:i}=t;return!!i&&(1==i.length||!!(this.RI&&i.length>2)||2==i.length&&(this.hr=Date.now(),this.iz=i[0].clientX,this.hz=i[0].clientY,this.nz=i[1].clientX,this.ez=i[1].clientY,!0))}onTouchMove(t){const{touches:i}=t;return!(!i||0==i.length||1!=i.length&&(this.rz=i[0].clientX,this.oz=i[0].clientY,this.uz=i[1].clientX,this.cz=i[1].clientY,this.RI?(this.kV(!1,!1,t),0):this.Pz()||(this.Az()&&this.signalReady(0),0)))}Az(){const t=this.rz-this.iz,i=this.oz-this.hz,s=this.uz-this.nz,h=this.cz-this.ez,e=t*s<=0&&i*h<=0,n=Math.abs(t-s)>=4,r=Math.abs(i-h)>=4;return e&&(n||r)}Pz(){const t=this.rz-this.iz,i=this.oz-this.hz,s=this.uz-this.nz,h=this.cz-this.ez,e=t*s>0||i*h>0,n=Math.abs(t+s)>=10,r=Math.abs(i+h)>=10;return e&&(n||r)}onTouchEnd(t){const{touches:i}=t;i&&i.length<2&&this.SV(t)}acceptStart(){this.RI=!0,this.VV=this.hr,this.az=0,this.lz=0,this.fz=.5*(this.iz+this.nz),this._z=.5*(this.hz+this.ez),this.kV(!0,!1,null)}acceptCancel(){this.RI=!1}kV(t,i,s){this.RV=Date.now();const h=this.RV-this.VV,e=this.pz(),n=this.Mz();(!i&&h>4||i&&h>16)&&(this.yV=Vt(e-this.az,h,this.yV),this.xV=Vt(n-this.lz,h,this.xV),this.yV=Math.abs(this.yV)>1e-4?this.yV:0,this.xV=Math.abs(this.xV)>1e-4?this.xV:0,this.az=e,this.lz=n,this.VV=this.RV);const r=this.dz(this.iz,this.nz,this.hz,this.ez),o=this.dz(this.rz,this.uz,this.oz,this.cz);this.signalEmit({first:t,last:i,time:this.RV,centerClientX:this.fz,centerClientY:this._z,dir:Math.sign(o-r),deltaX:.5*e,deltaY:.5*n,velocityX:.5*this.yV,velocityY:.5*this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}dz(t,i,s,h){return(t-i)*(t-i)+(s-h)*(s-h)}pz(){return Math.abs(this.rz-this.iz-(this.uz-this.nz))}Mz(){return Math.abs(this.oz-this.hz-(this.cz-this.ez))}},Xt=f(.4,0,.2,1.4),Yt="amp-image-viewer",Ot=["aria-label","aria-describedby","aria-labelledby"],zt=new Set(["AMP-IMG","AMP-ANIM","IMG"]),$t=class extends t.BaseElement{constructor(t){super(t),this.ZD=null,this.ND=null,this.Ez=0,this.vz=0,this.Tz=null,this.GD=null,this.Rz=null,this.UD=null,this.Iz=1,this.Vz=1,this.LD=1,this.bz=1,this.wz=2,this.MV=0,this.bV=0,this.Sz=0,this.kz=0,this.Cz=0,this.Dz=0,this.Xz=0,this.Yz=0,this.cV=null,this.Oz=null,this.WD=null,this.wi=null,this.dR=this.dR.bind(this)}buildCallback(){this.element.classList.add("i-amphtml-image-viewer");const t=function(t,i){const s=[];for(let i=t.firstElementChild;i;i=i.nextElementSibling)!(function(t){let i;return u(t)?i=t:l(t)&&(i=t.tagName),!!i&&i.toLowerCase().startsWith("i-")}(h=i)||h.nodeType===Node.ELEMENT_NODE&&(h.hasAttribute("placeholder")||h.hasAttribute("fallback")||h.hasAttribute("overflow")))&&s.push(i);var h;return s}(this.element);et(1==t.length,"%s should have its target element as its one and only child",Yt),et(this.FD(t[0]),"%s is not supported by %s",t[0].tagName,Yt),this.WD=t[0],lt(this.element).setOwner(this.WD,this.element)}layoutCallback(){if(this.wi)return this.wi;if(j(this.element,"[i-amphtml-scale-animation]"))return e();const t=this.WD,i=!!this.ZD,s=i?e():"IMG"===t.tagName?function(t){let i,s;if(function(t){return!!(t.complete||"complete"==t.readyState||mt(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}(t))return Promise.resolve(t);const h=mt(t);return h&&t.__AMP_MEDIA_LOAD_FAILURE_SRC===t.currentSrc?Promise.reject(t):new Promise(((e,n)=>{if(i=h?Mt(t,"loadedmetadata",e,{capture:!0}):Mt(t,"load",e),!t.tagName)return;let r=t;if(h&&!t.hasAttribute("src")&&(r=function(t,i){for(let s=t.lastElementChild;s;s=s.previousElementSibling)if(i(s))return s;return null}(t,(t=>"SOURCE"===t.tagName)),!r))return n(new Error("Media has no source."));s=Mt(r,"error",n)})).then((()=>(s&&s(),t)),(()=>{i&&i(),function(t){mt(t)&&(t.__AMP_MEDIA_LOAD_FAILURE_SRC=t.currentSrc||!0);let i=t;throw i&&i.src&&(i=i.src),tt().createError("Failed to load:",i)}(t)}))}(t):t.signals().whenSignal("load-end");return i||lt(this.element).scheduleLayout(this.element,t),this.wi=s.then((()=>this.Cu())).then((()=>this.qD())).then((()=>this.eC())),this.wi}pauseCallback(){this.wi&&this.wi.then((()=>{this.qD(),this.rC()}))}resumeCallback(){this.wi&&this.wi.then((()=>{this.qD(),this.eC()}))}unlayoutCallback(){return this.rC(),this.wi=null,function(t,i,s){const h=X.get(t);if(h&&(o(h,(t=>t.callback===s&&0===t.type)),0==h.length)){X.delete(t),Y.delete(t);const i=t.ownerDocument.defaultView;i&&O(i).unobserve(t)}}(this.element,0,this.dR),!0}isLayoutSupported(t){return"fill"==t}getImageBox(){return this.GD}getImage(){return this.ZD}getImageBoxWithOffset(){if(0==this.Sz&&0==this.kz||!this.GD)return this.GD;const t=(this.Iz-1)/2;return function(t,i,s){return 0==i&&0==s||0==t.width&&0==t.height?t:E(t.left+i,t.top+s,t.width,t.height)}((s=t,h=t,E((i=this.GD).left-i.width*s,i.top-i.height*h,i.width*(1+2*s),i.height*(1+2*h))),this.Sz,this.kz);var i,s,h}FD(t){return zt.has(t.tagName)}JD(t){const i=(s=t,p(/^[\w-]+$/.test("img")),s.querySelector("img"));var s;this.measureElement((()=>{i?(this.Ez=i.naturalWidth||t.offsetWidth,this.vz=i.naturalHeight||t.offsetHeight):(this.Ez=t.offsetWidth,this.vz=t.offsetHeight)}))}Cu(){if(this.ZD)return e();this.ZD=this.element.ownerDocument.createElement("img"),this.ZD.classList.add("i-amphtml-image-viewer-image");const t=this.WD;return this.JD(t),this.ND=function(t){const i=t.getAttribute("srcset");if(i)return function(t){const i=[];let s;for(;s=N.exec(t);){const t=s[1];let h,e;if(s[2]){const t=s[3].toLowerCase();if("w"==t)h=parseInt(s[2],10);else{if("x"!=t)continue;e=parseFloat(s[2])}}else e=1;i.push({url:t,width:h,dpr:e})}return new G(i)}(i);const s=t.getAttribute("src");return v(s,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new G([{url:s,width:void 0,dpr:1}])}(t),function(t,i,s){const h=t.ownerDocument.defaultView;if(!h)return;let e=X.get(t);if(e||(e=[],X.set(t,e),O(h).observe(t)),!e.some((t=>t.callback===s&&0===t.type))){e.push({type:0,callback:s});const i=Y.get(t);i&&setTimeout((()=>$(0,s,i)))}}(this.element,0,this.dR),this.mutateElement((()=>{var i,s;return y(this.ZD,{top:0,left:0,width:0,height:0}),i=t,void 0===(s=!1)&&(s=i.hasAttribute("hidden")),s?i.removeAttribute("hidden"):i.setAttribute("hidden",""),this.element.appendChild(this.ZD),"IMG"===t.tagName?(Z(Ot,t,this.ZD),e()):t.getImpl().then((t=>Z(Ot,t.element,this.ZD)))}))}dR(){j(this.element,"[i-amphtml-scale-animation]")||this.qD()}sx(){var t;this.Tz=(t=this.element.getBoundingClientRect(),E(Number(t.left),Number(t.top),Number(t.width),Number(t.height)));const i=this.Ez/this.vz;let s=Math.min(this.Tz.width/i,this.Tz.height),h=Math.min(this.Tz.height*i,this.Tz.width);Math.abs(h-this.Ez)<=16&&Math.abs(s-this.vz<=16)&&(h=this.Ez,s=this.vz),this.GD=E(Math.round((this.Tz.width-h)/2),Math.round((this.Tz.height-s)/2),Math.round(h),Math.round(s));const e=this.Tz.width/this.Tz.height,n=Math.max(e/i,i/e);this.wz=Math.max(2,n),this.Vz=this.Iz=1,this.MV=this.Sz=0,this.bV=this.kz=0,this.Lz(this.Iz)}qD(){return this.measureElement((()=>this.sx())).then((()=>{const t=this.ZD;return this.mutateElement((()=>{y(t,{top:S(this.GD.top),left:S(this.GD.left),width:S(this.GD.width),height:S(this.GD.height)}),this.iC()}),t)})).then((()=>this.oM()))}oM(){if(!this.ND)return e();this.LD=Math.max(this.LD,this.Iz);const t=Math.max(this.GD.width*this.LD,this.Ez),i=this.ND.select(t,class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}}.getDevicePixelRatio());return i==this.ZD.getAttribute("src")?e():this.mutateElement((()=>{this.ZD.setAttribute("src",i)}),this.ZD)}rC(){this.cV&&(this.cV.cleanup(),this.cV=null)}eC(){this.cV=Et.get(this.element),this.cV.onGesture(St,(t=>{const{data:i}=t,s=1==this.Iz?this.wz:this.bz,h=this.Tz.width/2-i.clientX,e=this.Tz.height/2-i.clientY;this.RC(s,h,e,!0).then((()=>this.qz()))})),this.cV.onGesture(yt,(t=>{this.KD(t.data.target)})),this.cV.onGesture(Ct,(t=>{const{data:i}=t;this.QD(i.centerClientX,i.centerClientY,i.deltaX,i.deltaY),i.last&&this.tX(i.centerClientX,i.centerClientY,i.deltaX,i.deltaY,i.velocityY,i.velocityY)})),this.cV.onGesture(xt,(t=>{const{data:i}=t;this.lC(i.centerClientX,i.centerClientY,i.deltaX,i.deltaY,i.dir),i.last&&this.qz()}))}KD(t){const i=function(t,i,s,h){const e={detail:null};return Object.assign(e,{bubbles:!0}),new t.CustomEvent("click",e)}(this.win);t.dispatchEvent(i)}iX(){this.Rz=this.cV.onGesture(kt,(t=>{const{data:i}=t;this.oC(i.deltaX,i.deltaY,!1),i.last&&this.fC(i.velocityX,i.velocityY)})),this.UD=this.cV.onPointerDown((()=>{this.Oz&&this.Oz.halt()}))}sX(){this.Rz&&(this.Rz(),this.Rz=null,this.cV.removeGesture(kt)),this.UD&&(this.UD(),this.UD=null)}AC(t,i){return W(t,this.bz,this.wz,i?.25:0)}Uz(t,i){return W(t,this.Cz,this.Xz,i&&this.Iz>1?.25*this.Tz.width:0)}Wz(t,i){return W(t,this.Dz,this.Yz,i?.25*this.Tz.height:0)}Lz(t){let i=0,s=0;const h=this.Tz.height-this.GD.height*t;h>=0?s=i=0:(s=h/2,i=-s);let e=0,n=0;const r=this.Tz.width-this.GD.width*t;r>=0?n=e=0:(n=r/2,e=-n),this.Cz=n,this.Dz=s,this.Xz=e,this.Yz=i}iC(){var t,i,s;y(this.ZD,{transform:(i=this.Sz,s=this.kz,(null==s?`translate(${D(i,S)})`:`translate(${D(i,S)}, ${D(s,S)})`)+" "+(t=this.Iz,`scale(${t})`))})}oC(t,i,s){const h=this.Uz(this.MV+t,!1),e=this.Wz(this.bV+i,!1);this.Fz(this.Iz,h,e,s)}fC(t,i){this.Oz=wt(this.ZD,this.Sz,this.kz,t,i,((t,i)=>{const s=this.Uz(t,!1),h=this.Wz(i,!1);return!(Math.abs(s-this.Sz)<1&&Math.abs(h-this.kz)<1||(this.Fz(this.Iz,s,h,!1),0))})),this.Oz.thenAlways((()=>(this.Oz=null,this.uC())))}lC(t,i,s,h,e){this.hX(t,i,s,h,e)}QD(t,i,s,h){const e=Math.abs(h)>Math.abs(s)?Math.sign(h):Math.sign(-s);this.hX(t,i,s,h,e)}hX(t,i,s,h,e){if(0==e)return;const n=F(s,h),r=this.Vz*(1+e*n/100),o=this.Tz.width/2-t,u=this.Tz.height/2-i;s=Math.min(o,o*(n/100)),h=Math.min(u,u*(n/100)),this.RC(r,s,h,!1)}RC(t,i,s,h){const e=this.AC(t,!0);if(e==this.Iz)return;this.Lz(e);const n=this.Uz(this.MV+i*e,!1),r=this.Wz(this.bV+s*e,!1);return this.Fz(e,n,r,h)}tX(t,i,s,h,n,r){let o;return o=0==n&&0==r?e():wt(this.ZD,s,h,n,r,((s,h)=>(this.QD(t,i,s,h),!0))).thenAlways(),o.then((()=>{this.qz()}))}qz(){const t=this.Iz>this.Vz;return this.uC().then((()=>{t&&this.oM(),this.Iz>1?this.iX():this.sX()}))}Fz(t,i,s,h){const n=t-this.Iz,r=(o=this.Sz,u=this.kz,F(i-o,s-u));var o,u;let c,a=0;if(h){const t=250;a=Math.min(t,Math.max(t*r*.01,t*Math.abs(n)))}if(a>16&&h){const h=L(this.Iz,t),e=L(this.Sz,i),n=L(this.kz,s);c=At.animate(this.ZD,(t=>{this.Iz=h(t),this.Sz=e(t),this.kz=n(t),this.iC()}),a,Xt).thenAlways((()=>{this.Iz=t,this.Sz=i,this.kz=s,this.iC()}))}else this.Iz=t,this.Sz=i,this.kz=s,this.iC(),c=h?e():void 0;return c}uC(){const t=this.AC(this.Iz,!1);t!=this.Iz&&this.Lz(t);const i=this.Uz(this.Sz/this.Iz*t,!1),s=this.Wz(this.kz/this.Iz*t,!1);return this.Fz(t,i,s,!0).then((()=>{this.Vz=this.Iz,this.MV=this.Sz,this.bV=this.kz}))}};t.registerElement(Yt,$t,".i-amphtml-image-viewer-image{position:absolute;-o-object-fit:contain;object-fit:contain}.i-amphtml-image-viewer{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-viewer>amp-img{min-width:1px;min-height:1px}\n/*# sourceURL=/extensions/amp-image-viewer/0.1/amp-image-viewer.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-viewer-0.1.mjs.map
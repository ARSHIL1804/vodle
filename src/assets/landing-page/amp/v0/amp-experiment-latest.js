;
(self.AMP=self.AMP||[]).push({m:0,v:"2203281422000",n:"amp-experiment",ev:"0.1",l:!0,f:function(n,t){!function(){function t(n,r){return(t=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,r)}function r(n){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function u(n,t){if(t&&("object"===e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(n)}Array.isArray;var i=Object.prototype,o=i.hasOwnProperty,f=i.toString;function c(n,t){return o.call(n,t)}var a=self.AMP_CONFIG||{},l=("string"==typeof a.thirdPartyFrameRegex?new RegExp(a.thirdPartyFrameRegex):a.thirdPartyFrameRegex,("string"==typeof a.cdnProxyRegex?new RegExp(a.cdnProxyRegex):a.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function s(n){if(!self.document||!self.document.head)return null;if(self.location&&l.test(self.location.origin))return null;var t=self.document.head.querySelector('meta[name="'.concat(n,'"]'));return t&&t.getAttribute("content")||null}a.thirdPartyUrl,a.thirdPartyFrameHost,a.cdnUrl||s("runtime-host"),a.errorReportingUrl,a.betaErrorReportingUrl,a.localDev,a.geoApiUrl||s("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var v,p=self.__AMP_LOG;function m(n){return function(n,t){throw new Error("failed to call initLogConstructor")}()}function h(n,t,r,e,u,i,o,f,c,a,l){return n}function b(n,t,r,e,u,i,o,f,c,a,l){return(p.user||(p.user=m()),void p.user.win?p.userForEmbed||(p.userForEmbed=m()):p.user).assert(n,t,r,e,u,i,o,f,c,a,l)}var y=function(){var n=this;this.promise=new Promise((function(t,r){n.resolve=t,n.reject=r}))};function d(n,t){return O(n=function(n){return n.__AMP_TOP||(n.__AMP_TOP=n)}(n),t)}function g(n,t){return function(n,t){var r=P(n,t);if(r)return r;var e,u,i,o,f=S(n);return f[t]=(u=(e=new y).promise,i=e.reject,o=e.resolve,u.catch((function(){})),{obj:null,promise:u,resolve:o,reject:i,context:null,ctor:null}),f[t].promise}(x(n),t)}function w(n,t){return P(x(n),t)}function j(n){return n.nodeType?(r=n,t=(r.ownerDocument||r).defaultView,d(t,"ampdoc")).getAmpDoc(n):n;var t,r}function x(n){var t=j(n);return t.isSingleDoc()?t.win:t}function O(n,t){h(function(n,t){var r=n.__AMP_SERVICES&&n.__AMP_SERVICES[t];return!(!r||!r.ctor)}(n,t));var r=S(n)[t];return r.obj||(h(r.ctor),h(r.context),r.obj=new r.ctor(r.context),h(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function P(n,t){var r=S(n)[t];return r?r.promise?r.promise:(O(n,t),r.promise=Promise.resolve(r.obj)):null}function S(n){var t=n.__AMP_SERVICES;return t||(t=n.__AMP_SERVICES={}),t}var R=/^[\w-]+$/,E=function(){function n(n){this.ampdoc=n,this.SP=new y}var t=n.prototype;return t.init=function(n){this.SP.resolve(n)},t.getVariants=function(){return this.SP.promise},t.whenReady=function(){return this.getVariants()},n}();function A(n,t,r){I(t),function(n){var t,r=n.variants;b((t=r,"[object Object]"===f.call(t)&&Object.keys(r).length>0),"Missing experiment variants config."),n.group&&I(n.group);var e=0;for(var u in r)if(c(r,u)){I(u);var i=r[u];b("number"==typeof i&&i>0&&i<100,"Invalid percentage %s:%s. Has to be greater than 0 and less than 100",u,i),e+=i}b(e.toFixed(6)<=100,"Total percentage is bigger than 100: "+e)}(r);var e=n.getParam("amp-x-"+t);if(e&&c(r.variants,e))return Promise.resolve(e);var u,i=!1!==r.sticky,o=r.cidScope||"amp-experiment",a=Promise.resolve(!0);return i&&r.consentNotificationId&&(a=(u=n.getHeadNode(),function(n,t,r,e){return function(n,t,r,e){var u=w(n,t);if(u)return u;var i=j(n);return i.whenExtensionsKnown().then((function(){var n=i.getExtensionVersion(r);return n?d(i.win,"extensions").waitForExtension(r,n):null})).then((function(r){return r?e?w(n,t):g(n,t):null}))}(n,t,r,e).then((function(n){return function(n,t,r){return b(n,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",t,r,r,r)}(n,t,r)}))}(u,"userNotificationManager","amp-user-notification")).then((function(n){return n.getNotification(r.consentNotificationId)})).then((function(n){return b(n,"Notification not found: ".concat(r.consentNotificationId)),n.isDismissed()}))),a.then((function(e){if(!e)return null;var u=r.group||t;return function(n,t,r){if(!r)return Promise.resolve(100*n.win.Math.random());var e,u,i=(e=n,g(e,"cid")).then((function(n){return n.get({scope:r,createCookieIfNotPresent:!0},v||(v=Promise.resolve(void 0)))}));return Promise.all([i,(u=n.win,d(u,"crypto"))]).then((function(n){return n[1].uniform(t+":"+n[0])})).then((function(n){return 100*n}))}(n,u,i?o:null).then((function(n){for(var t=0,e=Object.keys(r.variants).sort(),u=0;u<e.length;u++)if(n<(t+=r.variants[e[u]]))return e[u];return null}))}))}function I(n){b(R.test(n),"Invalid name: %s. Allowed chars are [a-zA-Z0-9-_].",n)}var N=function(n){!function(n,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),r&&t(n,r)}(f,n);var e,i,o=(e=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}(),function(){var n,t=r(e);if(i){var o=r(this).constructor;n=Reflect.construct(t,arguments,o)}else n=t.apply(this,arguments);return u(this,n)});function f(){return o.apply(this,arguments)}f.prerenderAllowed=function(){return!0};var c=f.prototype;return c.isLayoutSupported=function(n){return"nodisplay"==n||"container"==n},c.isBuildRenderBlocking=function(){return!0},c.buildCallback=function(){var n=this;return g(this.getAmpDoc(),"variant").then((function(t){try{var r=n._S(),e=Object.create(null),u=Object.keys(r).map((function(t){return A(n.getAmpDoc(),t,r[t]).then((function(n){e[t]=n}))})),i=Promise.all(u).then((function(){return e})).then(n.nnn.bind(n));t.init(i)}catch(n){throw t.init({}),n}}))},c._S=function(){var n,t=this.element.children;return b(1==t.length&&"SCRIPT"==t[0].tagName&&"APPLICATION/JSON"==t[0].getAttribute("type").toUpperCase(),'<amp-experiment> should contain exactly one <script type="application/json"> child.'),h((n=t[0].textContent,JSON.parse(n)))},c.nnn=function(n){return this.getAmpDoc().waitForBodyOpen().then((function(t){for(var r in n)n[r]&&t.setAttribute("amp-x-"+r,n[r]);return n}))},f}(n.BaseElement);n.registerServiceForDoc("variant",E),n.registerElement("amp-experiment",N)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-experiment-0.1.js.map
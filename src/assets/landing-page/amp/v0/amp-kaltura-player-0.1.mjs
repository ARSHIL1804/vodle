;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-kaltura-player",ev:"0.1",l:!0,f:function(t,e){(()=>{var{isArray:e}=Array;function n(t){return e(t)?t:[t]}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function i(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0;return function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var{hasOwnProperty:o,toString:a}=Object.prototype;function s(t,e){t.classList.add("i-amphtml-fill-content"),e&&t.classList.add("i-amphtml-replaced-content")}function l(t){const e=Object.getOwnPropertyDescriptor(t,"message");if(null!=e&&e.writable)return t;const{message:n,stack:r}=t,i=new Error(n);for(const e in t)i[e]=t[e];return i.stack=r,i}function c(t){let e=null,n="";for(var r,o=i(arguments,!0);!(r=o()).done;){const t=r.value;t instanceof Error&&!e?e=l(t):(n&&(n+=" "),n+=t)}return e?n&&(e.message=n+": "+e.message):e=new Error(n),e}function u(t){var e,n;null===(e=(n=self).__AMP_REPORT_ERROR)||void 0===e||e.call(n,t)}function f(t,...e){try{return t.apply(null,e)}catch(t){!function(t){const e=c.apply(null,arguments);setTimeout((()=>{throw u(e),e}))}(t)}}var h={"getPropertyPriority":()=>"","getPropertyValue":()=>""},p=/vertical/,d=new WeakMap,m=new WeakMap,y=new WeakMap;function v(t){let e=d.get(t);return e||(e=new t.ResizeObserver(b),d.set(t,e)),e}function b(t){const e=new Set;for(let n=t.length-1;n>=0;n--){const r=t[n],{target:i}=r;if(e.has(i))continue;e.add(i);const o=m.get(i);if(o){y.set(i,r);for(let t=0;t<o.length;t++){const{callback:e,type:n}=o[t];g(n,e,r)}}}}function g(t,e,n){if(0==t){const{contentRect:t}=n,{height:r,width:i}=t;f(e,{width:i,height:r})}else if(1==t){const{borderBoxSize:t}=n;let i;if(t)i=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=n,e=((r=t).ownerDocument||r).defaultView,o=p.test(function(t,e){return t.getComputedStyle(e)||h}(e,t).writingMode),{offsetHeight:a,offsetWidth:s}=t;let l,c;o?(c=s,l=a):(l=s,c=a),i={inlineSize:l,blockSize:c}}f(e,i)}var r}var w=self.AMP_CONFIG||{},$=("string"==typeof w.thirdPartyFrameRegex?new RegExp(w.thirdPartyFrameRegex):w.thirdPartyFrameRegex,("string"==typeof w.cdnProxyRegex?new RegExp(w.cdnProxyRegex):w.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function k(t){if(!self.document||!self.document.head)return null;if(self.location&&$.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}w.thirdPartyUrl,w.thirdPartyFrameHost,w.cdnUrl||k("runtime-host"),w.errorReportingUrl,w.betaErrorReportingUrl,w.localDev,w.geoApiUrl||k("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var C=self.__AMP_LOG;function I(t){return function(t,e){throw new Error("failed to call initLogConstructor")}()}function S(t,e,n,r,i,o,a,s,l,c,u){return t}function R(t,e){return function(t,e){S(function(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}(t,e));const n=function(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}(t)[e];return n.obj||(S(n.ctor),S(n.context),n.obj=new n.ctor(n.context),S(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),e)}new Set(["c","v","a","ad"]);var U=class extends t.BaseElement{constructor(t){super(t),this.Mv=null,this.ab="",this.lb="",this.cb="",this.pf=new class{constructor(t){this.yf=t,this.mf=!1,this.bf=!1,this._f=this._f.bind(this)}updatePlaying(t){t!==this.mf&&(this.mf=t,t?(this.bf=!1,function(t,e){!function(t,e,n){const r=t.ownerDocument.defaultView;if(!r)return;let i=m.get(t);if(i||(i=[],m.set(t,i),v(r).observe(t)),!i.some((t=>t.callback===n&&1===t.type))){i.push({type:1,callback:n});const e=y.get(t);e&&setTimeout((()=>g(1,n,e)))}}(t,0,e)}(this.yf,this._f)):function(t,e){!function(t,e,n){const r=m.get(t);if(r&&(function(t,e){const r=[];let i=0;for(let e=0;e<t.length;e++){const a=t[e];(o=a).callback===n&&1===o.type?r.push(a):(i<e&&(t[i]=a),i++)}var o;i<t.length&&(t.length=i)}(r),0==r.length)){m.delete(t),y.delete(t);const e=t.ownerDocument.defaultView;e&&v(e).unobserve(t)}}(t,0,e)}(this.yf,this._f))}_f({blockSize:t,inlineSize:e}){const n=e>0&&t>0;if(n===this.bf)return;this.bf=n;const r=this.yf;n||r.pause()}}(this.element)}preconnectCallback(t){var e;(e=this.win,R(e,"preconnect")).url(this.getAmpDoc(),`https://${encodeURIComponent(this.ab)}${t}`)}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}buildCallback(){var t,e,n,r,i,o,a,s,l,c,u;this.lb=(t=this.element.getAttribute("data-partner"),e="The data-partner attribute is required for <amp-kaltura-player> %s",n=this.element,(C.user||(C.user=I()),void C.user.win?C.userForEmbed||(C.userForEmbed=I()):C.user).assert(t,e,n,r,i,o,a,s,l,c,u)),this.element.classList.add("i-amphtml-media-component"),this.cb=this.element.getAttribute("data-entryid")||"default",this.ab=this.element.getAttribute("data-service-url")||"cdnapisec.kaltura.com"}layoutCallback(){const t=this.element.getAttribute("data-uiconf")||this.element.getAttribute("data-uiconf-id")||"default",e=this.element.ownerDocument.createElement("iframe");let r=`https://${encodeURIComponent(this.ab)}/p/${encodeURIComponent(this.lb)}/sp/${encodeURIComponent(this.lb)}00/embedIframeJs/uiconf_id/${encodeURIComponent(t)}/partner_id/${encodeURIComponent(this.lb)}?iframeembed=true&playerId=kaltura_player_amp&entry_id=${encodeURIComponent(this.cb)}`;return r=function(t,e,n){if(!e)return t;const r=t.split("#",2),i=r[0].split("?",2);let o=i[0]+(i[1]?`?${i[1]}&${e}`:`?${e}`);return o+=r[1]?`#${r[1]}`:"",o}(r,function(t){const e=[];for(const o in t){let a=t[o];if(null!=a){a=n(a);for(let t=0;t<a.length;t++)e.push((r=o,i=a[t],`${encodeURIComponent(r)}=${encodeURIComponent(i)}`))}}var r,i;return e.join("&")}(function(t,e,n){const r=(t=>`flashvars[${t}]`)||(t=>t),{dataset:i}=t,o={},a=/^param(.+)/;for(const t in i){const e=t.match(a);e&&(o[r(e[1][0].toLowerCase()+e[1].substr(1))]=i[t])}return o}(this.element))),e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.src=r,s(e),this.element.appendChild(e),this.Mv=e,this.pf.updatePlaying(!0),this.loadPromise(e)}unlayoutCallback(){const t=this.Mv;return t&&(this.element.removeChild(t),this.Mv=null),this.pf.updatePlaying(!1),!0}createPlaceholderCallback(){const t=this.win.document.createElement("img");!function(t,e,r,o){for(var a,s=i(n(["aria-label"]),!0);!(a=s()).done;){const t=a.value,n=e.getAttribute(t);null!==n&&r.setAttribute(t,n)}}(0,this.element,t),s(t),t.setAttribute("loading","lazy"),t.setAttribute("placeholder",""),t.setAttribute("referrerpolicy","origin"),t.hasAttribute("aria-label")?t.setAttribute("alt","Loading video - "+t.getAttribute("aria-label")):t.setAttribute("alt","Loading video");const e=this.element.getAttribute("width"),r=this.element.getAttribute("height");let o=`https://${encodeURIComponent(this.ab)}/p/${encodeURIComponent(this.lb)}/thumbnail/entry_id/${encodeURIComponent(this.cb)}`;return e&&(o+=`/width/${e}`),r&&(o+=`/height/${r}`),t.setAttribute("src",o),t}pauseCallback(){this.Mv&&this.Mv.contentWindow&&this.Mv.contentWindow.postMessage(JSON.stringify({"method":"pause","value":""}),"*")}};t.registerElement("amp-kaltura-player",U)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-kaltura-player-0.1.mjs.map
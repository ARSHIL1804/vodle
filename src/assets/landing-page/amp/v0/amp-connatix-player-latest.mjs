;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-connatix-player",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function e(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}var r={SUFFICIENT:1,INSUFFICIENT:2,UNKNOWN_NOT_REQUIRED:3,UNKNOWN:4},i={TCF_V1:1,TCF_V2:2,US_PRIVACY_STRING:3};function o(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function s(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return o(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c=class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}},{isArray:u}=Array,{hasOwnProperty:l,toString:a}=Object.prototype;function f(t){return(t.ownerDocument||t).defaultView}function h(t){const n=Object.getOwnPropertyDescriptor(t,"message");if(null!=n&&n.writable)return t;const{message:e,stack:r}=t,i=new Error(e);for(const n in t)i[n]=t[n];return i.stack=r,i}function d(t){let n=null,e="";for(var r,i=s(arguments,!0);!(r=i()).done;){const t=r.value;t instanceof Error&&!n?n=h(t):(e&&(e+=" "),e+=t)}return n?e&&(n.message=e+": "+n.message):n=new Error(e),n}function m(t){var n,e;null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t)}function p(t,...n){try{return t.apply(null,n)}catch(t){!function(t){const n=d.apply(null,arguments);setTimeout((()=>{throw m(n),n}))}(t)}}var v={"getPropertyPriority":()=>"","getPropertyValue":()=>""},b=/vertical/,y=new WeakMap,w=new WeakMap,g=new WeakMap;function P(t,n,e){const r=t.ownerDocument.defaultView;if(!r)return;let i=w.get(t);if(i||(i=[],w.set(t,i),_(r).observe(t)),!i.some((t=>t.callback===e&&t.type===n))){i.push({type:n,callback:e});const r=g.get(t);r&&setTimeout((()=>j(n,e,r)))}}function S(t,n,e){const r=w.get(t);if(r&&(function(t,r){const i=[];let o=0;for(let r=0;r<t.length;r++){const c=t[r];(s=c).callback===e&&s.type===n?i.push(c):(o<r&&(t[o]=c),o++)}var s;o<t.length&&(t.length=o)}(r),0==r.length)){w.delete(t),g.delete(t);const n=t.ownerDocument.defaultView;n&&_(n).unobserve(t)}}function _(t){let n=y.get(t);return n||(n=new t.ResizeObserver(I),y.set(t,n)),n}function I(t){const n=new Set;for(let e=t.length-1;e>=0;e--){const r=t[e],{target:i}=r;if(n.has(i))continue;n.add(i);const o=w.get(i);if(o){g.set(i,r);for(let t=0;t<o.length;t++){const{callback:n,type:e}=o[t];j(e,n,r)}}}}function j(t,n,e){if(0==t){const{contentRect:t}=e,{height:r,width:i}=t;p(n,{width:i,height:r})}else if(1==t){const{borderBoxSize:t}=e;let r;if(t)r=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=e,n=f(t),i=b.test(function(t,n){return t.getComputedStyle(n)||v}(n,t).writingMode),{offsetHeight:o,offsetWidth:s}=t;let c,u;i?(u=s,c=o):(c=s,u=o),r={inlineSize:c,blockSize:u}}p(n,r)}}var A=self.AMP_CONFIG||{},O=("string"==typeof A.thirdPartyFrameRegex?new RegExp(A.thirdPartyFrameRegex):A.thirdPartyFrameRegex,("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function C(t){if(!self.document||!self.document.head)return null;if(self.location&&O.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}A.thirdPartyUrl,A.thirdPartyFrameHost,A.cdnUrl||C("runtime-host"),A.errorReportingUrl,A.betaErrorReportingUrl,A.localDev,A.geoApiUrl||C("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var E=self.__AMP_LOG;function T(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function R(t,n,e,r,i,o,s,c,u,l,a){return t}function x(t,n){return V(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function k(t,n){return function(t,n){const e=U(t,n);if(e)return e;const r=$(t);return r[n]=function(){const t=new c,{promise:n,reject:e,resolve:r}=t;return n.catch((()=>{})),{obj:null,promise:n,resolve:r,reject:e,context:null,ctor:null}}(),r[n].promise}(z(t),n)}function N(t,n){return U(z(t),n)}function M(t){return t.nodeType?(n=f(t),x(n,"ampdoc")).getAmpDoc(t):t;var n}function z(t){const n=M(t);return n.isSingleDoc()?n.win:n}function V(t,n){R(function(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}(t,n));const e=$(t)[n];return e.obj||(R(e.ctor),R(e.context),e.obj=new e.ctor(e.context),R(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function U(t,n){const e=$(t)[n];return e?e.promise?e.promise:(V(t,n),e.promise=Promise.resolve(e.obj)):null}function $(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var F=t=>function(t,n){return V(z(M(t)),n)}(t,"documentInfo").get(),W=t=>function(t,n,e,r){const i=N(t,n);if(i)return i;const o=M(t);return o.whenExtensionsKnown().then((()=>{const t=o.getExtensionVersion(e);return t?x(o.win,"extensions").waitForExtension(e,t):null})).then((e=>e?r?N(t,n):k(t,n):null))}(t,"consentPolicyManager","amp-consent");new Set(["c","v","a","ad"]);var D=class extends t.BaseElement{constructor(t){super(t),this.Kv="",this.Qv="",this.Zv=null,this.Mv=null,this.tb=null,this.nb=null,this.eb=this.eb.bind(this),this.pf=new class{constructor(t){this.yf=t,this.mf=!1,this.bf=!1,this._f=this._f.bind(this)}updatePlaying(t){t!==this.mf&&(this.mf=t,t?(this.bf=!1,P(this.yf,1,this._f)):function(t,n){S(t,1,n)}(this.yf,this._f))}_f({blockSize:t,inlineSize:n}){const e=n>0&&t>0;if(e===this.bf)return;this.bf=e;const r=this.yf;e||r.pause()}}(this.element)}rb(t,n){this.tb&&this.tb.then((e=>{e&&e.contentWindow&&e.contentWindow.postMessage(JSON.stringify({"event":"command","func":t,"args":n||""}),this.Zv)}))}ib(){this.win.addEventListener("message",(t=>{if(!this.Mv||t.source!==this.Mv.contentWindow)return;const n=function(t,n){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null}}(t.data);if(n&&"command"===n.event)switch(n.func){case"cnxClose":this.ob(),this.attemptCollapse();break;case"cnxPlayerRendered":this.nb(this.Mv)}}))}sb(){const t=super.getConsentPolicy()||"default",n=function(t,n="default"){return W(t).then((t=>t?t.whenPolicyResolved(n):null))}(this.element,t),e=function(t,n="default"){return W(t).then((t=>t?t.getConsentStringInfo(n):null))}(this.element,t),o=(s=this.element,c=t,W(s).then((t=>t?t.getMergedSharedData(c):null)));var s,c;const u=function(t,n="default"){return W(t).then((t=>t?t.getConsentMetadataInfo(n):null))}(this.element,t);(function(t){function n(t){return{status:"fulfilled",value:t}}function e(t){return{status:"rejected",reason:t}}return Promise.all(t.map((t=>t.then(n,e))))})([n,e,o,u]).then((t=>{if(t&&4===t.length){const n=t[0],e=t[1],o=t[2],s=t[3],c={"consentPolicyStateEnum":r,"consentStringTypeEnum":i,"consentPolicyState":{"error":n.reason,"value":n.value},"rawConsentString":{"error":e.reason,"value":e.value},"consentSharedData":{"error":o.reason,"value":o.value},"consentMetadata":{"error":s.reason,"value":s.value}};this.rb("ampConsentInfo",c)}}))}ob(){var t,n;this.Mv&&(null===(n=(t=this.Mv).parentElement)||void 0===n||n.removeChild(t),this.Mv=null)}buildCallback(){const{element:t}=this;var n,e,r,i,o,s,u,l,a,f,h;!function(t){t.classList.add("i-amphtml-media-component")}(t),this.Kv=(n=t.getAttribute("data-player-id"),e="The data-player-id attribute is required for <amp-connatix-player> %s",r=t,(E.user||(E.user=T()),void E.user.win?E.userForEmbed||(E.userForEmbed=T()):E.user).assert(n,e,r,i,o,s,u,l,a,f,h)),this.Qv=t.getAttribute("data-media-id")||"";const d=t.getAttribute("data-elements-player")||!1;this.Zv=d?"https://cdm.elements.video":"https://cdm.connatix.com";const m=new c;this.tb=m.promise,this.nb=m.resolve}preconnectCallback(t){var n;(n=this.win,x(n,"preconnect")).url(this.getAmpDoc(),this.Zv,t)}layoutCallback(){const{element:t}=this,r=function(t){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}({"playerId":this.Kv||void 0,"mediaId":this.Qv||void 0,"url":F(t).sourceUrl},function(t,n,e){const{dataset:r}=t,i={},o=/^param(.+)/;for(const t in r){const n=t.match(o);n&&(i[n[1][0].toLowerCase()+n[1].substr(1)]=r[t])}return i}(t)),i=function(t,n,e){if(!n)return t;const r=t.split("#",2),i=r[0].split("?",2);let o=i[0]+(i[1]?`?${i[1]}&${n}`:`?${n}`);return o+=r[1]?`#${r[1]}`:"",o}(this.Zv+"/amp-embed/index.html",function(t){const n=[];for(const o in t){let s=t[o];if(null!=s){s=u(i=s)?i:[i];for(let t=0;t<s.length;t++)n.push((e=o,r=s[t],`${encodeURIComponent(e)}=${encodeURIComponent(r)}`))}}var e,r,i;return n.join("&")}(r)),o=t.ownerDocument.createElement("iframe");return o.setAttribute("frameborder","0"),o.setAttribute("allowfullscreen","true"),o.src=i,function(t,n){t.classList.add("i-amphtml-fill-content"),t.classList.add("i-amphtml-replaced-content")}(o),t.appendChild(o),this.Mv=o,this.ib(),this.sb(),function(t,n){P(t,0,n)}(this.element,this.eb),this.pf.updatePlaying(!0),this.loadPromise(o).then((()=>this.tb))}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}eb({height:t,width:n}){this.Mv&&this.rb("ampResize",{"width":n,"height":t})}pauseCallback(){this.Mv&&(this.rb("ampPause"),this.Mv.src=this.Mv.src)}unlayoutCallback(){this.ob();const t=new c;return this.tb=t.promise,this.nb=t.resolve,S(this.element,0,this.eb),this.pf.updatePlaying(!1),!0}};t.registerElement("amp-connatix-player",D)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-connatix-player-0.1.mjs.map
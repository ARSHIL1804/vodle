;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-viqeo-player",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,e=new Array(n);i<n;i++)e[i]=t[i];return e}function i(t,i){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,i){if(t){if("string"==typeof t)return n(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?n(t,i):void 0}}(t))||i&&t&&"number"==typeof t.length){e&&(t=e);var s=0;return function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var e;function s(){return e||(e=Promise.resolve(void 0))}var o=class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}};function r(t){return new Promise((n=>{n(t())}))}var{isArray:a}=Array,{hasOwnProperty:l,toString:u}=Object.prototype;function c(t){const n=Object.create(null);return t&&Object.assign(n,t),n}function h(t){return"number"==typeof t&&isFinite(t)}function d(t,n,i,e,s,o,r,a,l,u,c){return t}function f(t){return JSON.parse(t)}function m(t,n){try{return f(t)}catch(t){return null==n||n(t),null}}function p(t){return(t.ownerDocument||t).defaultView}var v={bubbles:!0,cancelable:!0};function g(t){var n;null===(n=t.parentElement)||void 0===n||n.removeChild(t)}function _(t,n,i,e){const s=i||{};d(t.ownerDocument);const o=t.ownerDocument.createEvent("Event");o.data=s;const{bubbles:r,cancelable:a}=e||v;o.initEvent(n,r,a),t.dispatchEvent(o)}function y(t){const n=parseFloat(t);return h(n)?n:void 0}function b(t,n){t.classList.add("i-amphtml-fill-content"),n&&t.classList.add("i-amphtml-replaced-content")}var A=self.AMP_CONFIG||{},P=("string"==typeof A.thirdPartyFrameRegex?new RegExp(A.thirdPartyFrameRegex):A.thirdPartyFrameRegex,("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function w(t){if(!self.document||!self.document.head)return null;if(self.location&&P.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}var M=A.thirdPartyUrl||"https://3p.ampproject.net",E=A.thirdPartyFrameHost||"ampproject.net",I=(A.cdnUrl||w("runtime-host"),A.errorReportingUrl,A.betaErrorReportingUrl,A.localDev,A.geoApiUrl||w("amp-geo-api"),/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g);function R(t,n=""){try{return decodeURIComponent(t)}catch(t){return n}}function T(t){const n=c();if(!t)return n;let i;for(;i=I.exec(t);){const t=R(i[1],i[1]),e=i[2]?R(i[2].replace(/\+/g," "),i[2]):"";n[t]=e}return n}function V(t){const{location:n}=t||self;return T(n.originalHash||n.hash)}var q="";function j(t){const n=t||self;return n.__AMP_MODE?n.__AMP_MODE:n.__AMP_MODE=function(t){return{localDev:!1,development:k(t,V(t)),esm:!0,test:!1,rtvVersion:O(t)}}(n)}function O(t){var n;return q||(q=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"012203281422000"),q}function k(t,n){const i=n||V(t);return["1","actions","amp","amp4ads","amp4email"].includes(i.development)||!!t.AMP_DEV_MODE}function x(t){const n=Object.getOwnPropertyDescriptor(t,"message");if(null!=n&&n.writable)return t;const{message:i,stack:e}=t,s=new Error(i);for(const n in t)s[n]=t[n];return s.stack=e,s}function S(t){let n=null,e="";for(var s,o=i(arguments,!0);!(s=o()).done;){const t=s.value;t instanceof Error&&!n?n=x(t):(e&&(e+=" "),e+=t)}return n?e&&(n.message=e+": "+n.message):n=new Error(e),n}function C(t){const n=S.apply(null,arguments);return n.expected=!0,n}function $(t,...n){var i,e,s;i=C.apply(null,n),null===(e=(s=self).__AMP_REPORT_ERROR)||void 0===e||e.call(s,i)}function F(t){let n=!1,i=null,e=t;return(...t)=>(n||(i=e.apply(self,t),n=!0,e=null),i)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var L=self.__AMP_LOG;function D(t){return L.user||(L.user=N()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(L.user.win,t)?L.userForEmbed||(L.userForEmbed=N()):L.user}function N(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function U(t,n,i,e,s,o,r,a,l,u,c){return t}function Y(t,n,i,e,s,o,r,a,l,u,c){return D().assert(t,n,i,e,s,o,r,a,l,u,c)}function z(t,n){return G(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function W(t,n){return G(Z(B(t)),n)}function J(t,n){const i=Z(B(t));return X(i,n)?G(i,n):null}function B(t){return t.nodeType?(n=p(t),z(n,"ampdoc")).getAmpDoc(t):t;var n}function Z(t){const n=B(t);return n.isSingleDoc()?n.win:n}function G(t,n){U(X(t,n));const i=H(t)[n];return i.obj||(U(i.ctor),U(i.context),i.obj=new i.ctor(i.context),U(i.obj),i.context=null,i.resolve&&i.resolve(i.obj)),i.obj}function H(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function X(t,n){const i=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!i||!i.ctor)}var K,Q,tt,nt=t=>J(t,"action"),it=t=>B(t),et=t=>z(t,"platform"),st=t=>z(t,"preconnect"),ot=t=>G(t,"timer"),rt=t=>W(t,"viewport");function at(t,n,i={}){const{needsRootBounds:e,rootMargin:s,threshold:o}=i,r=function(t){return t.parent&&t.parent!=t}(n)&&(e||s)?n.document:void 0;return new n.IntersectionObserver(t,{threshold:o,root:r,rootMargin:s})}function lt(t){var n;let i=null===(n=K)||void 0===n?void 0:n.get(t);if(!i){const n=function(t){K||(K=new WeakMap,Q=new WeakMap),d(Q);let n=Q.get(t);return n||(n=at((t=>{const i=new Set;for(let s=t.length-1;s>=0;s--){var e;const{target:o}=t[s];i.has(o)||(i.add(o),d(n),n.unobserve(o),d(K),null===(e=K.get(o))||void 0===e||e.resolve(t[s]),K.delete(o))}}),t,{needsRootBounds:!0}),Q.set(t,n)),n}(p(t));d(K),n.observe(t),i=new o,K.set(t,i)}return i.promise}new WeakMap,new WeakMap;var ut,ct=["Webkit","webkit","Moz","moz","ms","O","o"];function ht(t,n,i,e,s){const o=function(t,n,i){if(n.startsWith("--"))return n;tt||(tt=c());let e=tt[n];if(!e||i){if(e=n,void 0===t[n]){const i=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),s=function(t,n){for(let i=0;i<ct.length;i++){const e=ct[i]+n;if(void 0!==t[e])return e}return""}(t,i);void 0!==t[s]&&(e=s)}i||(tt[n]=e)}return e}(t.style,n,s);if(!o)return;const r=e?i+e:i;t.style.setProperty(function(t){const n=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return ct.some((t=>n.startsWith(t+"-")))?`-${n}`:n}(o),r)}function dt(t){return null==t.__AMP_AUTOPLAY&&(t.__AMP_AUTOPLAY=function(t){const n=t.document.createElement("video");var i;return n.setAttribute("muted",""),n.setAttribute("playsinline",""),n.setAttribute("webkit-playsinline",""),n.setAttribute("height","0"),n.setAttribute("width","0"),n.muted=!0,n.playsInline=!0,n.playsinline=!0,n.webkitPlaysinline=!0,function(t,n){for(const i in n)ht(t,i,n[i])}(n,{position:"fixed",top:"0",width:"0",height:"0",opacity:"0"}),i=n,r((()=>i.play())).catch((()=>{})),Promise.resolve(!n.paused)}(t)),t.__AMP_AUTOPLAY}function ft(t){return t.querySelector("video, iframe")}function mt(t,n){const i=r((()=>t.play(!!n)));return i.catch((t=>{$(0,t)})),i}function pt(t,n,i,e){let s=t,o=i,r=t=>{try{return o(t)}catch(t){var n,i;throw null===(n=(i=self).__AMP_REPORT_ERROR)||void 0===n||n.call(i,t),t}};const a=function(){if(void 0!==ut)return ut;ut=!1;try{const t={get capture(){return ut=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return ut}(),l=!(null==e||!e.capture);return s.addEventListener(n,r,a?e:l),()=>{null==s||s.removeEventListener(n,r,a?e:l),o=null,s=null,r=null}}function vt(t,n,i,e){const s={detail:i};return Object.assign(s,e),new t.CustomEvent(n,s)}function gt(t,n,i,e){return pt(t,n,i,e)}function _t(t){return t.data}var yt,bt=class{constructor(){this.m_=!1,this.v_=new class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,n){const i=t.indexOf(n);-1!=i&&t.splice(i,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var n,e=i(this.Tt.slice(),!0);!(n=e()).done;)(0,n.value)(t)}getHandlerCount(){var t,n;return null!==(t=null===(n=this.Tt)||void 0===n?void 0:n.length)&&void 0!==t?t:0}}}onSessionEnd(t){this.v_.add(t)}beginSession(){this.m_=!0}endSession(){this.m_&&this.v_.fire(),this.m_=!1}isSessionActive(){return this.m_}};function At(t){const n=t.ownerDocument||t;return yt&&yt.ownerDocument===n||(yt=n.createElement("div")),Pt}function Pt(t){return function(t,n){d(1===n.length),t.innerHTML=n[0];const i=t.firstElementChild;return d(i),d(!i.nextElementSibling),t.removeChild(i),i}(yt,t)}var wt=['<button aria-label="Unmute video" class="i-amphtml-video-mask i-amphtml-fill-content" tabindex=0></button>'],Mt=["<i-amphtml-video-icon class=amp-video-eq><div class=amp-video-eq-col><div class=amp-video-eq-filler></div><div class=amp-video-eq-filler></div></div></i-amphtml-video-icon>"];function Et(t,n,i){if(n[i])return n[i];const e=t.querySelector(`style[${i}], link[${i}]`);return e?(n[i]=e,e):null}function It(t,n){const i=t.styleSheets;for(let t=0;t<i.length;t++)if(i[t].ownerNode==n)return!0;return!1}var Rt={"title":"","artist":"","album":"","artwork":[{"src":""}]},Tt="autoplay",Vt="registered",qt="load",jt="playing",Ot="pause",kt="ended",xt="muted",St="unmuted",Ct="ad_start",$t="ad_end",Ft="playing_manual",Lt="paused",Dt="video-play",Nt="user-interacted";function Ut(t){t.signals().signal(Nt)}var Yt="video-manager",zt=(t,n)=>!!t&&(t.video===n||t.video.element===n);function Wt(t,n){const i=n.top+n.height/2,e=t.getSize().height/2;return Math.abs(i-e)}function Jt(t){return 10*t*5}var Bt=t=>!!t&&!isNaN(t)&&t>1;function Zt(t,n,i){const{video:e}=t;t.getAnalyticsDetails().then((t=>{i&&Object.assign(t,i),_(e.element,n,t)}))}function Gt(t){!function(t,n,i,e){const o=B(t),r=Z(o);!function(t,n,i,e,s,o){const r=H(t);let a=r[i];a||(a=r[i]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),a.ctor||(a.ctor=e,a.context=n,a.sharedInstance=!1,a.resolve&&G(t,i))}(r,o,n,class{constructor(t){this.ampdoc=t,this.installAutoplayStyles=F((()=>function(t){!function(t,n,i,e,s){const o=t.getHeadNode(),r=function(t,n,i,e){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=c());const o=!i&&e&&"amp-custom"!=e&&"amp-keyframes"!=e,r=i?"amp-runtime":o?`amp-extension=${e}`:null;if(r){const i=Et(t,s,r);if(i)return"STYLE"==i.tagName&&i.textContent!==n&&(i.textContent=n),i}const a=(t.ownerDocument||t).createElement("style");a.textContent=n;let l=null;return i?a.setAttribute("amp-runtime",""):o?(a.setAttribute("amp-extension",e||""),l=Et(t,s,"amp-runtime")):(e&&a.setAttribute(e,""),l=t.lastChild),function(t,n,i=null){if(!i)return void function(t,n){t.insertBefore(n,t.firstChild)}(t,n);const e=i.nextSibling;t.insertBefore(n,e)}(t,a,l),r&&(s[r]=a),a}(o,function(t,n){const i=t.__AMP_CSS_TR;return i?i(n):n}(o,n),e||!1,s||null);if(i){const n=t.getRootNode();if(It(n,r))return i(r),r;const e=setInterval((()=>{It(n,r)&&(clearInterval(e),i(r))}),4)}}(t,".i-amphtml-video-mask{display:block;z-index:1;-webkit-appearance:none;appearance:none;background:transparent;border:none}.amp-video-eq{display:none}.i-amphtml-video-interface:not(amp-video) .amp-video-eq,amp-story .amp-video-eq,amp-video[controls] .amp-video-eq{display:-ms-flexbox;display:flex}[noaudio] .amp-video-eq{display:none!important}.amp-video-eq{pointer-events:none!important;-ms-flex-align:end;align-items:flex-end;bottom:7px;height:12px;opacity:0.8;overflow:hidden;position:absolute;right:7px;width:20px;z-index:1}.amp-video-eq-col{-ms-flex:1;flex:1;height:100%;margin-right:1px;position:relative}.amp-video-eq-col div{animation-name:amp-video-eq-animation;animation-timing-function:linear;animation-iteration-count:infinite;animation-direction:alternate;background-color:#fafafa;height:100%;position:absolute;width:100%;will-change:transform;animation-play-state:paused}.amp-video-eq-play .amp-video-eq-col div{animation-play-state:running}.amp-video-eq-1-1{animation-duration:0.3s;transform:translateY(60%)}.amp-video-eq-1-2{animation-duration:0.45s;transform:translateY(60%)}.amp-video-eq-2-1{animation-duration:0.5s;transform:translateY(30%)}.amp-video-eq-2-2{animation-duration:0.4s;transform:translateY(30%)}.amp-video-eq-3-1{animation-duration:0.3s;transform:translateY(70%)}.amp-video-eq-3-2{animation-duration:0.35s;transform:translateY(70%)}.amp-video-eq-4-1{animation-duration:0.4s;transform:translateY(50%)}.amp-video-eq-4-2{animation-duration:0.25s;transform:translateY(50%)}@keyframes amp-video-eq-animation{0%{transform:translateY(100%)}to{transform:translateY(0)}}\n/*# sourceURL=/css/video-autoplay.css*/",null,!1,"amp-video-autoplay")}(this.ampdoc))),this.__=null,this.g_=null,this.y_=null,this.Ee=ot(t.win),this.A_=nt(t.getHeadNode()),this.P_=()=>this.b_(),this.M_=F((()=>new class{constructor(t,n){this.E_=n,this.Ci=t,this.I_=null,this.R_=null,this.__=[],this.T_=[],this.V_=()=>this.w_(),this.k_=t=>this.C_(t)==Ft,this.q_=(t,n)=>this.x_(t,n),this.S_(),this.O_()}dispose(){this.T_.forEach((t=>t())),this.T_.length=0}register(t){const{video:n}=t,{element:i}=n;this.j_(i)&&(this.__.push(n),gt(i,Ot,this.V_),gt(i,jt,this.V_),gt(i,kt,this.V_),n.signals().whenSignal(Nt).then(this.V_),this.w_())}O_(){const t=this.Ci.getRootNode(),n=()=>this.F_();this.T_.push(gt(t,"webkitfullscreenchange",n),gt(t,"mozfullscreenchange",n),gt(t,"fullscreenchange",n),gt(t,"MSFullscreenChange",n))}isInLandscape(){return(t=this.Ci.win).screen&&"orientation"in t.screen?t.screen.orientation.type.startsWith("landscape"):90==Math.abs(t.orientation);var t}j_(t){if("video"==ft(t).tagName.toLowerCase())return!0;const n=et(this.Ci.win);return!n.isIos()&&!n.isSafari()||function(t){return!!{"amp-dailymotion":!0,"amp-ima-video":!0}[t.tagName.toLowerCase()]}(t)}F_(){this.I_=null}S_(){const{win:t}=this.Ci,{screen:n}=t;if(n&&"orientation"in n){const t=n.orientation;this.T_.push(gt(t,"change",(()=>this.L_())))}this.T_.push(gt(t,"orientationchange",(()=>this.L_())))}L_(){this.isInLandscape()?null!=this.R_&&this.Y_(this.R_):this.I_&&this.U_(this.I_)}Y_(t){const n=et(this.Ci.win);this.I_=t,n.isAndroid()&&n.isChrome()?t.fullscreenEnter():this.z_(t).then((()=>t.fullscreenEnter()))}U_(t){this.I_=null,this.z_(t,"center").then((()=>t.fullscreenExit()))}z_(t,n=null){const{element:i}=t,e=this.N_();return this.D_().then((()=>lt(i))).then((({boundingClientRect:t})=>{const{bottom:o,top:r}=t,a=e.getSize().height;if(r>=0&&o<=a)return s();const l=n||(o>a?"bottom":"top");return e.animateScrollIntoView(i,l)}))}N_(){return rt(this.Ci)}D_(){return ot(this.Ci.win).promise(330)}w_(){if(this.isInLandscape())return Promise.resolve(this.R_);this.R_=null;const t=this.__.filter(this.k_).map((t=>lt(t.element)));return Promise.all(t).then((t=>{const n=t.sort(this.q_)[0];return n&&n.intersectionRatio>.5?n.target.getImpl().then((t=>this.R_=t)):this.R_}))}x_(t,n){const{boundingClientRect:i,intersectionRatio:e}=t,{boundingClientRect:s,intersectionRatio:o}=n,r=e-o;if(Math.abs(r)>.1)return r;const a=rt(this.Ci),l=Wt(a,i),u=Wt(a,s);return l<u||l>u?l-u:i.top-s.top}C_(t){return this.E_.getPlayingState(t)}}(this.ampdoc,this))),this.Ee.delay(this.P_,1e3)}dispose(){if(this.M_().dispose(),this.g_.disconnect(),this.g_=null,this.__)for(let t=0;t<this.__.length;t++)this.__[t].dispose()}b_(){for(let t=0;t<this.__.length;t++){const n=this.__[t];n.getPlayingState()!==Lt&&(Zt(n,"video-seconds-played"),this.W_(n))}this.Ee.delay(this.P_,1e3)}W_(t){const n="timeUpdate",i=t.video.getCurrentTime(),e=t.video.getDuration();if(h(i)&&h(e)&&e>0){const s=i/e,o=vt(this.ampdoc.win,`${Yt}.${n}`,{"time":i,"percent":s});this.A_.trigger(t.video.element,n,o,1)}}register(t){U(t);const n=t;if(this.B_(t),!t.supportsPlatform())return;if(this.J_(t))return;if(!this.g_){const t=t=>t.forEach((({isIntersecting:t,target:n})=>{this.Z_(n).updateVisibility(t)}));this.g_=at(t,this.ampdoc.win,{threshold:.5})}this.g_.observe(n.element),gt(n.element,"reloaded",(()=>i.videoLoaded())),this.__=this.__||[];const i=new class{constructor(t,n){this.E_=t,this.Ci=t.ampdoc,this.video=n,this.G_=!0,this.H_=!1,this.mf=!1,this.K_=!1,this.es=!1,this.Q_=new bt,this.Q_.onSessionEnd((()=>Zt(this,"video-session"))),this.X_=new bt,this.X_.onSessionEnd((()=>Zt(this,"video-session-visible"))),this.vg=F((()=>new class{constructor(t,n){this.Ee=ot(t),this.yg=n,this.T_=null,this.Ag=0,this.Pg=0}start(){const{element:t}=this.yg.video;this.stop(),this.T_=this.T_||[],this.bg()?this.Eg(this.Pg):this.T_.push(function(t,n,i,e){let s=i;const o=pt(t,"loadedmetadata",(t=>{try{s(t)}finally{s=null,o()}}),void 0);return o}(t,0,(()=>{this.bg()&&this.Eg(this.Pg)}))),this.T_.push(gt(t,kt,(()=>{this.bg()&&this.Ig(100)})))}stop(){if(this.T_){for(;this.T_.length>0;)this.T_.pop()();this.Pg++}}bg(){const{video:t}=this.yg,n=t.getDuration();if(!Bt(n))return!1;if(Jt(n)<250){const n=Math.ceil(5);this.Rg("This video is too short for `video-percentage-played`. Reports may be innacurate. For best results, use videos over",n,"seconds long.",t.element)}return!0}Rg(...t){D().warn.apply(D(),[Yt].concat(t))}Eg(t){if(t!=this.Pg)return;const{yg:n,Ee:i}=this,{video:e}=n,s=()=>this.Eg(t);if(n.getPlayingState()==Lt)return void i.delay(s,500);const o=e.getDuration();if(!Bt(o))return void i.delay(s,500);const r=(u=Jt(o),d(!0),Math.min(Math.max(u,250),4e3)),a=e.getCurrentTime()/o*100,l=5*Math.floor(a/5);var u;U(h(l)),this.Ig(l),i.delay(s,r)}Ig(t){t<=0||this.Ag!=t&&(this.Ag=t,this.Tg(t))}Tg(t){Zt(this.yg,"video-percentage-played",{"normalizedPercentage":t.toString()})}}(this.Ci.win,this))),this.Vg=!1,this.kg=!1,this.Cg=null,this.Z=!1,this.qg=!1,this.hasAutoplay=n.element.hasAttribute(Tt),this.hasAutoplay&&this.E_.installAutoplayStyles(),this.xg=Rt,this.Sg=()=>{mt(this.video,!1)},this.Og=()=>{this.video.pause()},gt(n.element,qt,(()=>this.videoLoaded())),gt(n.element,Ot,(()=>this.$g())),gt(n.element,"play",(()=>{this.qg=!0,Zt(this,Dt)})),gt(n.element,jt,(()=>this.jg())),gt(n.element,xt,(()=>this.Z=!0)),gt(n.element,St,(()=>{this.Z=!1,this.E_.pauseOtherVideos(this)})),gt(n.element,"amp:video:tick",(t=>{const n=_t(t),i=n.eventType;i&&this.Fg(i,n.vars)})),gt(n.element,kt,(()=>{this.K_=!1,Zt(this,"video-ended")})),gt(n.element,Ct,(()=>{this.K_=!0,Zt(this,"video-ad-start")})),gt(n.element,$t,(()=>{this.K_=!1,Zt(this,"video-ad-end")})),n.signals().whenSignal(Vt).then((()=>this.Lg())),this.Yg=F((()=>{const t="firstPlay",n=vt(this.Ci.win,t,{}),{element:i}=this.video;nt(i).trigger(i,t,n,1)})),this.Ug()}dispose(){this.vg().stop()}Fg(t,n){const i={"__amp:eventType":t};Object.keys(n).forEach((t=>{i[`custom_${t}`]=n[t]})),Zt(this,"video-hosted-custom",i)}Ug(){this.video.signals().whenSignal("playback-delegated").then((()=>{this.G_=!1,this.mf&&this.video.pause()}))}isMuted(){return this.Z}isPlaybackManaged(){return this.G_}Lg(){this.zg()&&this.E_.registerForAutoFullscreen(this),this.hasAutoplay&&this.Ng()}zg(){const{element:t}=this.video;return!(this.video.preimplementsAutoFullscreen()||!t.hasAttribute("rotate-to-fullscreen"))&&Y(this.video.isInteractive(),"Only interactive videos are allowed to enter fullscreen on rotate. Set the `controls` attribute on %s to enable.",t)}jg(){this.mf=!0,this.getPlayingState()==Ft&&(this.Yg(),this.E_.pauseOtherVideos(this));const{video:t}=this,{element:n}=t;t.preimplementsMediaSessionAPI()||n.classList.contains("i-amphtml-disable-mediasession")||(function(t,n){const i=(t=>J(t,"url"))(t);if(n&&n.artwork){const{artwork:t}=n;U(a(t)),t.forEach((t=>{if(t){const e=(n=t,"[object Object]"===u.call(n)?t.src:t);Y(i.isProtocolValid(e))}var n}))}}(n,this.xg),function(t,n,i,e){const{navigator:s}=t;"mediaSession"in s&&t.MediaMetadata&&(s.mediaSession.metadata=new t.MediaMetadata(Rt),s.mediaSession.metadata=new t.MediaMetadata(n),s.mediaSession.setActionHandler("play",i),s.mediaSession.setActionHandler("pause",e))}(this.Ci.win,this.xg,this.Sg,this.Og)),this.Q_.beginSession(),this.es&&this.X_.beginSession(),this.qg||Zt(this,Dt)}$g(){Zt(this,"video-pause"),this.mf=!1,this.kg?this.kg=!1:this.Q_.endSession()}videoLoaded(){this.H_=!0,this.Cg=ft(this.video.element),this.Dg(),this.vg().start(),this.es&&this.Wg()}Dg(){if(this.video.preimplementsMediaSessionAPI())return;this.video.getMetadata()&&(this.xg=c(this.video.getMetadata()));const t=this.Ci.win.document;if(!this.xg.artwork||0==this.xg.artwork.length){const n=function(t){const n=t.querySelector('script[type="application/ld+json"]');if(!n)return;const i=m(n.textContent);return i&&i.image?"string"==typeof i.image?i.image:i.image["@list"]&&"string"==typeof i.image["@list"][0]?i.image["@list"][0]:"string"==typeof i.image.url?i.image.url:"string"==typeof i.image[0]?i.image[0]:void 0:void 0}(t)||function(t){const n=t.querySelector('meta[property="og:image"]');return n?n.getAttribute("content"):void 0}(t)||function(t){const n=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return n?n.getAttribute("href"):void 0}(t);n&&(this.xg.artwork=[{"src":n}])}if(!this.xg.title){const n=this.video.element.getAttribute("title")||this.video.element.getAttribute("aria-label")||this.Cg.getAttribute("title")||this.Cg.getAttribute("aria-label")||t.title;n&&(this.xg.title=n)}}Bg(){this.H_&&this.Wg()}Wg(){this.Ci.isVisible()&&dt(this.Ci.win).then((t=>{this.hasAutoplay&&!this.userInteracted()&&t?this.Jg():this.Zg()}))}Ng(){this.video.isInteractive()&&this.video.hideControls(),dt(this.Ci.win).then((t=>{t||!this.video.isInteractive()?(this.video.mute(),this.Gg()):this.video.showControls()}))}Gg(){const{video:t}=this,{element:n,win:i}=this.video;if(n.hasAttribute("noaudio")||n.signals().get(Nt))return;const e=function(t,n){const i=At(n)(Mt),e=i.firstElementChild;for(let t=0;t<4;t++){const n=e.cloneNode(!0),s=n.children;for(let n=0;n<s.length;n++)s[n].classList.add(`amp-video-eq-${t+1}-${n+1}`);i.appendChild(n)}return g(e),i}(0,n),s=[e];function o(n){t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{!function(t,n){void 0===n&&(n=t.hasAttribute("hidden")),n?t.removeAttribute("hidden"):t.setAttribute("hidden","")}(t,n)}))}))}function r(n){t.mutateElementSkipRemeasure((()=>e.classList.toggle("amp-video-eq-play",n)))}const a=[gt(n,Ot,(()=>r(!1))),gt(n,jt,(()=>r(!0))),gt(n,Ct,(()=>{o(!1),t.showControls()})),gt(n,$t,(()=>{o(!0),t.hideControls()})),gt(n,St,(()=>Ut(t)))];if(t.isInteractive()){t.hideControls();const i=function(t,n){const i=At(t)(wt);return n&&n.title&&i.setAttribute("aria-label",n.title),i}(n,this.xg);s.push(i),a.push(gt(i,"click",(()=>Ut(t))))}t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{n.appendChild(t)}))})),this.K_&&o(!1),t.signals().whenSignal(Nt).then((()=>{this.Yg(),t.isInteractive()&&t.showControls(),t.unmute(),a.forEach((t=>{t()})),t.mutateElementSkipRemeasure((()=>{s.forEach((t=>{g(t)}))}))}))}Jg(){this.G_&&(this.es?(this.X_.beginSession(),mt(this.video,!0),this.Vg=!0):(this.mf&&this.X_.endSession(),this.video.pause(),this.kg=!0))}Zg(){this.es?this.X_.beginSession():this.mf&&this.X_.endSession()}updateVisibility(t){const n=this.es;this.es=t,t!=n&&this.Bg()}getPlayingState(){return this.mf?this.mf&&this.Vg&&!this.userInteracted()?"playing_auto":Ft:Lt}isRollingAd(){return this.K_}userInteracted(){return null!=this.video.signals().get(Nt)}getAnalyticsDetails(){const{video:t}=this;return Promise.all([dt(this.Ci.win),lt(t.element)]).then((n=>{const i=n[0],e=n[1],{height:s,width:o}=e.boundingClientRect,r=this.hasAutoplay&&i,a=t.getPlayedRanges(),l=a.reduce(((t,n)=>t+n[1]-n[0]),0);return{"autoplay":r,"currentTime":t.getCurrentTime(),"duration":t.getDuration(),"height":s,"id":t.element.id,"muted":this.Z,"playedTotal":l,"playedRangesJson":JSON.stringify(a),"state":this.getPlayingState(),"width":o}}))}}(this,t);this.__.push(i);const{element:e}=i.video;_(e,Vt),function(t){t.classList.add("i-amphtml-media-component")}(e),t.signals().signal(Vt),e.classList.add("i-amphtml-video-interface")}B_(t){i("play",(()=>mt(t,!1))),i("pause",(()=>t.pause())),i("mute",(()=>t.mute())),i("unmute",(()=>t.unmute()));const n=()=>t.fullscreenEnter();function i(n,i){t.registerAction(n,(()=>{Ut(t),i()}),1)}i("fullscreenenter",n),i("fullscreen",n)}J_(t){if(zt(this.y_,t))return this.y_;for(let n=0;this.__&&n<this.__.length;n++){const i=this.__[n];if(zt(i,t))return this.y_=i,i}return null}Z_(t){return U(this.J_(t))}registerForAutoFullscreen(t){this.M_().register(t)}Hg(){return this.M_()}getVideoStateProperty(t,n){const i=this.ampdoc.getRootNode(),e=D().assertElement(i.getElementById(t),`Could not find an element with id="${t}" for VIDEO_STATE`),o=this.Z_(e);return(o?o.getAnalyticsDetails():s()).then((t=>t?t[n]:""))}getPlayingState(t){return this.Z_(t).getPlayingState()}isMuted(t){return this.Z_(t).isMuted()}userInteracted(t){return this.Z_(t).userInteracted()}isRollingAd(t){return this.Z_(t).isRollingAd()}pauseOtherVideos(t){this.__.forEach((n=>{n.isPlaybackManaged()&&n!==t&&n.getPlayingState()==Ft&&n.video.pause()}))}})}(t,"video-manager")}var Ht=class{static generate(t){return function(t){const{length:n}=t;let i=5381;for(let e=0;e<n;e++)i=33*i^t.charCodeAt(e);return String(i>>>0)}(function(t){const n=[];let i=0;for(;1==(null==(e=t)?void 0:e.nodeType)&&i<25;){let e="";t.id&&(e=`/${t.id}`);const s=t.nodeName.toLowerCase();n.push(`${s}${e}${Xt(t)}`),i++,t=t.parentElement}var e;return n.join()}(t))}};function Xt(t){const{nodeName:n}=t;let i=0,e=0,s=t.previousElementSibling;for(;s&&e<25&&i<100;)s.nodeName==n&&e++,i++,s=s.previousElementSibling;return e<25&&i<100?`.${e}`:""}function Kt(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function Qt(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,e)}return i}function tn(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?Qt(Object(i),!0).forEach((function(n){Kt(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Qt(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}var nn,en="__AMP__EXPERIMENT_TOGGLES";function sn(t){var n,e,s,o,r;if(t[en])return t[en];t[en]=c();const l=t[en];d(l);const u=tn(tn({},null!==(n=t.AMP_CONFIG)&&void 0!==n?n:{}),null!==(e=t.AMP_EXP)&&void 0!==e?e:f((null===(s=t.__AMP_EXP)||void 0===s?void 0:s.textContent)||"{}"));for(const t in u){const n=u[t];"number"==typeof n&&n>=0&&n<=1&&(l[t]=Math.random()<n)}const h=null===(o=t.AMP_CONFIG)||void 0===o?void 0:o["allow-doc-opt-in"];if(a(h)&&h.length){const n=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(n)for(var m,p,v=i((null===(m=n.getAttribute("content"))||void 0===m?void 0:m.split(","))||[],!0);!(p=v()).done;){const t=p.value;h.includes(t)&&(l[t]=!0)}}Object.assign(l,function(t){var n;let e="";try{var s;"localStorage"in t&&(e=null!==(s=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==s?s:"")}catch(t){}const o=(null===(n=e)||void 0===n?void 0:n.split(/\s*,\s*/g))||[],r=c();for(var a,l=i(o,!0);!(a=l()).done;){const t=a.value;t&&("-"==t[0]?r[t.substr(1)]=!1:r[t]=!0)}return r}(t));const g=null===(r=t.AMP_CONFIG)||void 0===r?void 0:r["allow-url-opt-in"];if(a(g)&&g.length){const n=T(t.location.originalHash||t.location.hash);for(var _,y=i(g,!0);!(_=y()).done;){const t=_.value,i=n[`e-${t}`];"1"==i&&(l[t]=!0),"0"==i&&(l[t]=!1)}}return l}function on(t,n){return nn||(nn=self.document.createElement("a")),function(t,n,i){return t.href="",new URL(n,t.href)}(nn,t)}new Set(["c","v","a","ad"]);var rn={};function an(t,n,i,e,s={}){const{allowFullscreen:o=!1,initialIntersection:r}=s;U(void 0===n.isConnected||!0===n.isConnected);const a=function(t,n,i,e){const s=i||n.getAttribute("type");Y(s,"Attribute type required for <amp-ad>: %s",n);const o=function(t){let n=0;for(let i=t;i&&i!=i.parent;i=i.parent)n++;return String(n)+"-"+ln(t)}(t);let r={};return function(t,n){const{dataset:i}=t;for(const t in i)t.startsWith("vars")||(n[t]=i[t]);const e=t.getAttribute("json");if(e){const i=m(e);if(void 0===i)throw D().createError("Error parsing JSON in json attribute in element %s",t);for(const t in i)n[t]=i[t]}}(n,r),r=function(t,n,i,e){const s=Date.now(),o=n.getAttribute("width"),r=n.getAttribute("height");(e=e||{}).width=y(o),e.height=y(r),n.getAttribute("title")&&(e.title=n.getAttribute("title"));let a=t.location.href;"about:srcdoc"==a&&(a=t.parent.location.href);const l=it(n),u=W(n,"documentInfo").get(),c=(t=>W(t,"viewer"))(n).getUnconfirmedReferrerUrl(),h=function(t){const n=t.ownerDocument.body;let i=0,e=0;for(let s=t;s&&s!=n;s=s.offsetParent)i+=s.offsetLeft,e+=s.offsetTop;const{offsetHeight:s,offsetWidth:o}=t;return function(t,n,i,e){return{left:t,top:n,width:i,height:e,bottom:n+e,right:t+i,x:t,y:n}}(i,e,o,s)}(n);var d,f,m;e._context={"ampcontextVersion":"2203281422000","ampcontextFilepath":`${M}/2203281422000/ampcontext-v0.js`,"sourceUrl":u.sourceUrl,"referrer":c,"canonicalUrl":u.canonicalUrl,"pageViewId":u.pageViewId,"location":{"href":a},"startTime":s,"tagName":n.tagName,"mode":{localDev:!1,development:!1,esm:j(m).esm,test:!1,rtvVersion:j(m).rtvVersion},"canary":(d=t,!(null===(f=d.AMP_CONFIG)||void 0===f||!f.canary)),"hidden":!l.isVisible(),"initialLayoutRect":h?{"left":h.left,"top":h.top,"width":h.width,"height":h.height}:null,"domFingerprint":Ht.generate(n),"experimentToggles":sn(t),"sentinel":i};const p=n.getAttribute("src");return p&&(e.src=p),e}(t,n,o,r),r.type=s,Object.assign(r._context,e),r}(t,n,i,e);r&&(a._context.initialIntersection=r);const l=t.document.createElement("iframe");rn[a.type]||(rn[a.type]=0),rn[a.type]+=1;const u=function(t,n,i){return function(t,n,i){const e=n.getMetaByName("amp-3p-iframe-src");if(!e)return null;const s=function(t,n,i="source"){return Y(null!=t,"%s %s must be available",n,i),Y(function(t){return"https:"==(t=(t=>"string"==typeof t?on(t):t)(t)).protocol||"localhost"==t.hostname||"127.0.0.1"==t.hostname||function(t,n){const i=t.length-n.length;return i>=0&&t.indexOf(n,i)==i}(t.hostname,".localhost")}(t)||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,i,t),t}(e,'meta[name="amp-3p-iframe-src"]');Y(-1==s.indexOf("?"),"3p iframe url must not include query string %s in element %s.",s,e);const o=on(s);return Y("localhost"==o.hostname||o.origin!=on(t.location.href).origin,"3p iframe url must not be on the same origin as the current document %s (%s) in element %s. See https://github.com/ampproject/amphtml/blob/main/docs/spec/amp-iframe-origin-policy.md for details.",s,o.origin,e),`${s}?2203281422000`}(t,n)||function(t,n){return t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN=t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN||"d-"+ln(t),"https://"+t.__AMP_DEFAULT_BOOTSTRAP_SUBDOMAIN+`.${E}/2203281422000/frame.html`}(t)}(t,n.getAmpDoc()),c=on(u).hostname,h=JSON.stringify({"host":c,"bootstrap":(d=a.type,`${M}/2203281422000/vendor/${d}.mjs`),"type":a.type,"count":rn[a.type],"attributes":a});var d;return l.src=u,l.ampLocation=on(u),l.name=h,a.width&&(l.width=a.width),a.height&&(l.height=a.height),a.title&&(l.title=a.title),o&&l.setAttribute("allowfullscreen","true"),l.setAttribute("scrolling","no"),ht(l,"border","none"),l.onload=function(){this.readyState="complete"},l.setAttribute("allow","sync-xhr 'none';"),["facebook"].includes(i)||function(t){if(!t.sandbox||!t.sandbox.supports)return;const n=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let i=0;i<n.length;i++){const e=n[i];if(!t.sandbox.supports(e))return}t.sandbox=n.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(l),l.setAttribute("data-amp-3p-sentinel",a._context.sentinel),l}function ln(t){let n;if(t.crypto&&t.crypto.getRandomValues){const i=new Uint32Array(2);t.crypto.getRandomValues(i),n=String(i[0])+i[1]}else n=String(t.Math.random()).substr(2)+"0";return n}var un="amp-viqeo-player",cn={"ready":qt,"play":jt,"pause":Ot,"mute":xt,"unmute":St,"end":kt,"startAdvert":Ct,"endAdvert":$t},hn=class extends t.BaseElement{constructor(t){super(t),this.Mv=null,this.tb=null,this.nb=null,this.Xg=null,this.XM=!1,this.wI="",this.Yt={}}preconnectCallback(t){st(this.win).url(this.getAmpDoc(),"https://api.viqeo.tv",t),st(this.win).url(this.getAmpDoc(),"https://cdn.viqeo.tv",t)}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}buildCallback(){this.wI=Y(this.element.getAttribute("data-videoid"),"The data-videoid attribute is required for <amp-viqeo-player> %s",this.element),Y(this.element.getAttribute("data-profileid"),"The data-profileid attribute is required for <amp-viqeo-player> %s",this.element),this.XM=this.element.hasAttribute(Tt);const t=new o;var n;this.tb=t.promise,this.nb=t.resolve,Gt(this.element),(n=this.element,W(n,"video-manager")).register(this),this.nb(this.Mv)}layoutCallback(){const t=an(this.win,this.element,"viqeoplayer",{"autoplay":this.XM},{allowFullscreen:!0});return t.title=this.element.title||"Viqeo video",t.setAttribute("allow","autoplay"),this.Xg=gt(this.win,"message",this.MI.bind(this)),this.mutateElement((()=>{this.element.appendChild(t),this.Mv=t,b(t)})).then((()=>this.tb))}MI(t){const n=_t(t);if(!n||t.source!==(this.Mv&&this.Mv.contentWindow)||"ViqeoPlayer"!==n.source)return;const i=n.action;if(!function(t,n,i){if(null==i[n])return!1;const e=i[n];return(a(e)?e:[e]).forEach((n=>{_(t,n)})),!0}(this.element,i,cn)&&i.startsWith("update")){const t=i.replace(/^update([A-Z])(.*)$/,((t,n,i)=>n.toLowerCase()+i));this.Yt[t]=n.value}}unlayoutCallback(){this.Mv&&(g(this.Mv),this.Mv=null),this.Xg&&this.Xg();const t=new o;return this.tb=t.promise,this.nb=t.resolve,!0}createPlaceholderCallback(){const t=this.element.ownerDocument.createElement("img");return function(t,n,e,s){for(var o,r,l=i(a(o=["aria-label"])?o:[o],!0);!(r=l()).done;){const t=r.value,i=n.getAttribute(t);null!==i&&e.setAttribute(t,i)}}(0,this.element,t),b(t),t.setAttribute("loading","lazy"),t.setAttribute("placeholder",""),t.setAttribute("referrerpolicy","origin"),t.hasAttribute("aria-label")?t.setAttribute("alt","Loading video - "+t.getAttribute("aria-label")):t.setAttribute("alt","Loading video"),t.setAttribute("src",`https://cdn.viqeo.tv/preview/${encodeURIComponent(this.wI)}.jpg`),t}supportsPlatform(){return!0}isInteractive(){return!0}play(){this.rb("play")}pause(){this.rb("pause")}mute(){this.rb("mute")}unmute(){this.rb("unmute")}showControls(){}hideControls(){}fullscreenEnter(){this.Mv&&function(t){const n=t.requestFullscreen||t.requestFullScreen||t.webkitRequestFullscreen||t.webkitEnterFullscreen||t.msRequestFullscreen||t.mozRequestFullScreen;n&&n.call(t)}(this.Mv)}fullscreenExit(){this.Mv&&function(t){const n=t.cancelFullScreen||t.exitFullscreen||t.webkitExitFullscreen||t.webkitCancelFullScreen||t.mozCancelFullScreen||t.msExitFullscreen;if(n)return void n.call(t);const{ownerDocument:i}=t;if(!i)return;const e=i.cancelFullScreen||i.exitFullscreen||i.webkitExitFullscreen||i.webkitCancelFullScreen||i.mozCancelFullScreen||i.msExitFullscreen;e&&e.call(i)}(this.Mv)}isFullscreen(){return!!this.Mv&&function(t){const{webkitDisplayingFullscreen:n}=t;if(void 0!==n)return n;const{ownerDocument:i}=t;return!!i&&(i.fullscreenElement||i.webkitFullscreenElement||i.mozFullScreenElement||i.webkitCurrentFullScreenElement)==t}(this.Mv)}getMetadata(){}preimplementsMediaSessionAPI(){return!1}preimplementsAutoFullscreen(){return!1}getCurrentTime(){return this.Yt.currentTime||0}getDuration(){return this.Yt.duration||1}getPlayedRanges(){return this.Yt.playedRanges||[]}rb(t){if(!this.Mv)return;const{contentWindow:n}=this.Mv;n&&("string"==typeof t&&(t={action:t}),n.postMessage(t,"*"))}seekTo(t){this.user().error(un,"`seekTo` not supported.")}};t.registerElement(un,hn)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-viqeo-player-0.1.mjs.map
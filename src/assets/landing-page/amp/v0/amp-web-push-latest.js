;
(self.AMP=self.AMP||[]).push({m:0,v:"2203281422000",n:"amp-web-push",ev:"0.1",l:!0,f:function(t,n){!function(){function n(t,e){return(n=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,e)}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,n){if(n&&("object"===i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=r(t);if(n){var u=r(this).constructor;e=Reflect.construct(i,arguments,u)}else e=i.apply(this,arguments);return o(this,e)}}Array.isArray;var s=Object.prototype;function c(t){var n=Object.create(null);return t&&Object.assign(n,t),n}s.hasOwnProperty,s.toString;var a=/(\0)|^(-)$|([\x01-\x1f\x7f]|^-?[0-9])|([\x80-\uffff0-9a-zA-Z_-]+)|[^]/g;function f(t,n,e,r,i){return i||(n?"ï¿½":r?t.slice(0,-1)+"\\"+t.slice(-1).charCodeAt(0).toString(16)+" ":"\\"+t)}function h(t){return String(t).replace(a,f)}var l=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function v(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(t)}catch(t){return n}}function p(t){var n,e=c();if(!t)return e;for(;n=l.exec(t);){var r=v(n[1],n[1]),i=n[2]?v(n[2].replace(/\+/g," "),n[2]):"";e[r]=i}return e}function d(t){var n=(t||self).location;return p(n.originalHash||n.hash)}var m=self.AMP_CONFIG||{},w=("string"==typeof m.thirdPartyFrameRegex?new RegExp(m.thirdPartyFrameRegex):m.thirdPartyFrameRegex,("string"==typeof m.cdnProxyRegex?new RegExp(m.cdnProxyRegex):m.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function b(t){if(!self.document||!self.document.head)return null;if(self.location&&w.test(self.location.origin))return null;var n=self.document.head.querySelector('meta[name="'.concat(t,'"]'));return n&&n.getAttribute("content")||null}m.thirdPartyUrl,m.thirdPartyFrameHost,m.cdnUrl||b("runtime-host"),m.errorReportingUrl,m.betaErrorReportingUrl,m.localDev,m.geoApiUrl||b("amp-geo-api");var g="";function y(t){var n=t||self;return n.__AMP_MODE?n.__AMP_MODE:n.__AMP_MODE=function(t){return{localDev:!1,development:R(t,d(t)),esm:!1,test:!1,rtvVersion:E(t)}}(n)}function E(t){var n;return g||(g=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"01".concat("2203281422000")),g}function R(t,n){var e=n||d(t);return["1","actions","amp","amp4ads","amp4email"].includes(e.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var O=self.__AMP_LOG;function S(t,n){throw new Error("failed to call initLogConstructor")}function I(t){return O.user||(O.user=P()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(O.user.win,t)?O.userForEmbed||(O.userForEmbed=P()):O.user}function P(t){return S()}function k(){return O.dev||(O.dev=S())}function _(t,n,e,r,i,o,u,s,c,a,f){return t}var x="amp-web-push",A=x,T=x+"-service",M=x+"-widget",U="granted",C="denied",j="default";function L(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function N(t,n,e){return n&&L(t.prototype,n),e&&L(t,e),t}function D(t,n){t.insertBefore(n,t.firstChild)}var W=function(){var t=this;this.promise=new Promise((function(n,e){t.resolve=n,t.reject=e}))};function F(t,n){_(function(t,n){var e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}(t,n));var e=V(t)[n];return e.obj||(_(e.ctor),_(e.context),e.obj=new e.ctor(e.context),_(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function V(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}var G,K=function(t){e(r,t);var n=u(r);function r(t){return n.call(this,t)}var i=r.prototype;return i.isLayoutSupported=function(t){return"fixed"==t},i.buildCallback=function(){this.element.classList.add("amp-invisible")},r}(t.BaseElement),H="subscribed",q="unsubscribed",z="blocked";function B(t){return t.data}function Q(t,n,e,r){var i=e,o=function(t,n,e,r){var i=t,o=e,u=function(t){try{return o(t)}catch(t){var n,e;throw null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t),t}},s=function(){if(void 0!==G)return G;G=!1;try{var t={get capture(){return G=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return G}(),c=!(null==r||!r.capture);return i.addEventListener(n,u,s?r:c),function(){null==i||i.removeEventListener(n,u,s?r:c),o=null,i=null,u=null}}(t,n,(function(t){try{i(t)}finally{i=null,o()}}),r);return o}function Y(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}var Z,$,J=function(){function t(t,n){this.qi=t,this.pi=n,this.edt=null,this.Ui=new Promise((function(){}))}var n=t.prototype;return n.load=function(){var t=this;return this.qi.whenReady().then((function(){var n,e;return t.edt=t.qi.win.document.createElement("iframe"),n=t.edt,void 0===(e=!1)&&(e=n.hasAttribute("hidden")),e?n.removeAttribute("hidden"):n.setAttribute("hidden",""),t.edt.sandbox="allow-same-origin allow-scripts",t.edt.src=t.pi,t.qi.getBody().appendChild(t.edt),t.Ui=function(t){var n,e;if(function(t){return!!(t.complete||"complete"==t.readyState||Y(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}(t))return Promise.resolve(t);var r=Y(t);return r&&t.__AMP_MEDIA_LOAD_FAILURE_SRC===t.currentSrc?Promise.reject(t):new Promise((function(i,o){if(n=r?Q(t,"loadedmetadata",i,{capture:!0}):Q(t,"load",i),t.tagName){var u=t;if(r&&!t.hasAttribute("src")&&!(u=function(t,n){for(var e=t.lastElementChild;e;e=e.previousElementSibling)if(n(e))return e;return null}(t,(function(t){return"SOURCE"===t.tagName}))))return o(new Error("Media has no source."));e=Q(u,"error",o)}})).then((function(){return e&&e(),t}),(function(){n&&n(),function(t){Y(t)&&(t.__AMP_MEDIA_LOAD_FAILURE_SRC=t.currentSrc||!0);var n=t;throw n&&n.src&&(n=n.src),I().createError("Failed to load:",n)}(t)}))}(t.edt),t.whenReady()}))},n.getDomElement=function(){return this.edt},n.whenReady=function(){return this.Ui},t}(),X=function(){function t(t){this.St=t,this.It=0,this.Ct=0,this.Ot=c()}var n=t.prototype;return n.has=function(t){return!!this.Ot[t]},n.get=function(t){var n=this.Ot[t];if(n)return n.access=++this.Ct,n.payload},n.put=function(t,n){this.has(t)||this.It++,this.Ot[t]={payload:n,access:this.Ct},this.Rt()},n.Rt=function(){if(!(this.It<=this.St)){var t,n=this.Ot,e=this.Ct+1;for(var r in n){var i=n[r].access;i<e&&(e=i,t=r)}void 0!==t&&(delete n[t],this.It--)}},t}();function tt(t,n){return Z||(Z=self.document.createElement("a"),$=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new X(100))),function(t,n,e){if(e&&e.has(n))return e.get(n);t.href=n,t.protocol||(t.href=t.href);var r,i={href:t.href,protocol:t.protocol,host:t.host,hostname:t.hostname,port:"0"==t.port?"":t.port,pathname:t.pathname,search:t.search,hash:t.hash,origin:null};"/"!==i.pathname[0]&&(i.pathname="/"+i.pathname),("http:"==i.protocol&&80==i.port||"https:"==i.protocol&&443==i.port)&&(i.port="",i.host=i.hostname),r=t.origin&&"null"!=t.origin?t.origin:"data:"!=i.protocol&&i.host?i.protocol+"//"+i.host:i.href,i.origin=r;var o=i;return e&&e.put(n,o),o}(Z,t,n?null:$)}new Set(["c","v","a","ad"]);var nt=function(){function t(t){t||(t={debug:!1,windowContext:window}),this.et={},this._r={},this.Nr=t.debug,this.Wr=!1,this.Dr=!1,this.Fr=!1,this.$r=null,this.zr=null,this.Hr=null,this.Vr=null,this.Gr=null,this.Kr=t.windowContext||window}var n=t.prototype;return n.listen=function(n){var e=this;return new Promise((function(t,r){e.Fr?r(new Error("Already connected.")):e.Wr?r(new Error("Already listening for connections.")):Array.isArray(n)?(e.Hr=e.qr.bind(e,n,t,r),e.Kr.addEventListener("message",e.Hr),e.Nr&&k().fine(x,"Listening for a connection message...")):r(new Error("allowedOrigins should be a string array of allowed origins to accept messages from. Got:",n))})).then((function(){e.send(t.Topics.CONNECT_HANDSHAKE,null),e.Fr=!0}))},n.Jr=function(t,n){for(var e=tt(t).origin,r=0;r<n.length;r++)if(tt(n[r]).origin===e)return!0;return!1},n.qr=function(n,e,r,i){var o=B(i),u=i.origin,s=i.ports;this.Nr&&k().fine(x,"Window message for listen() connection received:",o),this.Jr(u,n)?o&&o.topic===t.Topics.CONNECT_HANDSHAKE?(k().fine(x,"Received expected connection handshake message:",o),this.Kr.removeEventListener("message",this.Hr),this.zr=s[0],this.Gr=this.Zr.bind(this),this.zr.addEventListener("message",this.Gr,!1),this.zr.start(),e()):k().fine(x,"Discarding connection message because it did not contain our expected handshake:",o):k().fine(x,"Discarding connection message from ".concat(u," ")+"because it isn't an allowed origin:",o," (allowed  origins are)",n)},n.connect=function(n,e){var r=this;return new Promise((function(i,o){n||o(new Error("Provide a valid Window context to connect to.")),e||o(new Error("Provide an expected origin for the remote Window or provide the wildcard *.")),r.Fr?o(new Error("Already connected.")):r.Dr?o(new Error("Already connecting.")):(r.$r=new MessageChannel,r.zr=r.$r.port1,r.Vr=r.Br.bind(r,r.zr,e,i),r.zr.addEventListener("message",r.Vr),r.zr.start(),n.postMessage({topic:t.Topics.CONNECT_HANDSHAKE},"*"===e?"*":tt(e).origin,[r.$r.port2]),k().fine(x,"Opening channel to ".concat(e,"...")))}))},n.Br=function(t,n,e){this.Fr=!0,this.Nr&&k().fine(x,"Messenger channel to ".concat(n," established.")),t.removeEventListener("message",this.Vr),this.Gr=this.Zr.bind(this),t.addEventListener("message",this.Gr,!1),e()},n.Zr=function(t){var n=B(t);if(this.et[n.id]&&n.isReply){var e=this.et[n.id];delete this.et[n.id];var r=e.promiseResolver;e.message=n.data,this.Nr&&k().fine(x,"Received reply for topic '%s': %s",n.topic,n.data),r([n.data,this.Qr.bind(this,n.id,e.topic)])}else{var i=this._r[n.topic];if(!i)return;this.Nr&&k().fine(x,"Received new message for "+"topic '".concat(n.topic,"': ").concat(n.data));for(var o=0;o<i.length;o++)(0,i[o])(n.data,this.Qr.bind(this,n.id,n.topic))}},n.on=function(t,n){this._r[t]?this._r[t].push(n):this._r[t]=[n]},n.off=function(t,n){if(n){var e=this._r[t].indexOf(n);-1!==e&&this._r[t].splice(e,1)}else this._r[t]&&delete this._r[t]},n.Qr=function(t,n,e){var r=this,i={id:t,topic:n,data:e,isReply:!0};return this.zr.postMessage(i),new Promise((function(t){r.et[i.id]={message:e,topic:n,promiseResolver:t}}))},n.send=function(t,n){var e=this,r={id:crypto.getRandomValues(new Uint8Array(10)).join(""),topic:t,data:n};return this.Nr&&k().fine(x,"Sending %s: %s",t,n),this.zr.postMessage(r),new Promise((function(i){e.et[r.id]={message:n,topic:t,promiseResolver:i}}))},N(t,null,[{key:"Topics",get:function(){return{CONNECT_HANDSHAKE:"topic-connect-handshake",NOTIFICATION_PERMISSION_STATE:"topic-notification-permission-state",SERVICE_WORKER_STATE:"topic-service-worker-state",SERVICE_WORKER_REGISTRATION:"topic-service-worker-registration",SERVICE_WORKER_QUERY:"topic-service-worker-query",STORAGE_GET:"topic-storage-get"}}}]),t}(),et="amp-web-push-widget.amp-invisible{visibility:hidden}\n/*# sourceURL=/extensions/amp-web-push/0.1/amp-web-push.css*/";function rt(t,n,e){if(n[e])return n[e];var r=t.querySelector("style[".concat(e,"], link[").concat(e,"]"));return r?(n[e]=r,r):null}function it(t,n){for(var e=t.styleSheets,r=0;r<e.length;r++)if(e[r].ownerNode==n)return!0;return!1}function ot(t){return n=T,function(t,n){var e=function(t,n){var e=V(t)[n];return e?e.promise?e.promise:(F(t,n),e.promise=Promise.resolve(e.obj)):null}(t,n);if(e)return e;var r,i,o,u,s=V(t);return s[n]=(i=(r=new W).promise,o=r.reject,u=r.resolve,i.catch((function(){})),{obj:null,promise:i,resolve:u,reject:o,context:null,ctor:null}),s[n].promise}((o=(e=t).nodeType?(i=e,r=(i.ownerDocument||i).defaultView,function(t,n){return F(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),"ampdoc")}(r)).getAmpDoc(e):e).isSingleDoc()?o.win:o,n);var n,e,r,i,o}var ut=function(){function t(t){this.ampdoc=t,function(t,n,e,r,i){var o=t.getHeadNode(),u=function(t,n,e,r){var i=t.__AMP_CSS_SM;i||(i=t.__AMP_CSS_SM=c());var o="amp-extension=".concat(r);if(o){var u=rt(t,i,o);if(u)return"STYLE"==u.tagName&&u.textContent!==n&&(u.textContent=n),u}var s=(t.ownerDocument||t).createElement("style");s.textContent=n;return s.setAttribute("amp-extension",r),function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e){var r=e.nextSibling;t.insertBefore(n,r)}else D(t,n)}(t,s,rt(t,i,"amp-runtime")),o&&(i[o]=s),s}(o,function(t,n){var e=t.__AMP_CSS_TR;return e?e(n):n}(o,"amp-web-push-widget.amp-invisible{visibility:hidden}\n/*# sourceURL=/extensions/amp-web-push/0.1/amp-web-push.css*/"),0,"amp-web-push");if(e){var s=t.getRootNode();if(it(s,u))return u;var a=setInterval((function(){it(s,u)&&clearInterval(a)}),4)}}(t,0,(function(){})),this.IN={"helper-iframe-url":null,"permission-dialog-url":null,"service-worker-url":null,debug:null},this.Nr=y().development,this.tb=null,this.rdt=null,this.idt=new nt({debug:this.Nr}),this.odt=null}var n=t.prototype;return n.start=function(t){var n=this;if(k().fine(x,"amp-web-push extension starting up."),!this.environmentSupportsWebPush())return I().warn(x,"Web push is not supported."),Promise.reject("Web push is not supported");this.initializeConfig(t);var e=this.installHelperFrame();return e.then((function(){return k().fine(x,"Helper frame ".concat(n.IN["helper-iframe-url"]," ")+"DOM loaded. Connecting to the frame via postMessage()..."),n.idt.connect(n.tb.getDomElement().contentWindow,tt(n.IN["helper-iframe-url"]).origin)})).then((function(){if(!n.isContinuingSubscriptionFromRedirect())return n.updateWidgetVisibilities();n.udt()})),e},n.initializeConfig=function(t){this.IN=t,this.IN},n.installHelperFrame=function(){var t=-1!==this.IN["helper-iframe-url"].indexOf("?")?"&":"?",n="".concat(this.IN["helper-iframe-url"]).concat(t)+"parentOrigin=".concat(this.ampdoc.win.location.origin);return this.tb=new J(this.ampdoc,n),this.tb.load()},n.isContinuingSubscriptionFromRedirect=function(){return-1!==(this.ampdoc.win.testLocation||this.ampdoc.win.location).search.indexOf(t.PERMISSION_POPUP_URL_FRAGMENT)},n.removePermissionPopupUrlFragmentFromUrl=function(n){return n.replace("?".concat(t.PERMISSION_POPUP_URL_FRAGMENT),"").replace("&".concat(t.PERMISSION_POPUP_URL_FRAGMENT),"")},n.sdt=function(t,n){var e=this;return this.tb.whenReady().then((function(){return e.idt.send(t,n)})).then((function(e){var r=e[0];if(r.success)return r.result;throw new Error("AMP page helper iframe query topic ".concat(t," ")+"and message ".concat(n," failed with: ").concat(r.error))}))},n.cdt=function(t,n){return this.sdt(nt.Topics.SERVICE_WORKER_QUERY,{topic:t,payload:n})},n.queryNotificationPermission=function(){return this.sdt(nt.Topics.NOTIFICATION_PERMISSION_STATE,null)},n.adt=function(){return this.sdt(nt.Topics.SERVICE_WORKER_STATE,null)},n.registerServiceWorker=function(){var t=this.IN["service-worker-url"],n=this.IN["service-worker-scope"];return this.sdt(nt.Topics.SERVICE_WORKER_REGISTRATION,{workerUrl:t,registrationOptions:n?{scope:n}:{}})},n.querySubscriptionStateRemotely=function(){return this.cdt("amp-web-push-subscription-state",null)},n.subscribeForPushRemotely=function(){return this.cdt("amp-web-push-subscribe",null)},n.unsubscribeFromPushRemotely=function(){return this.cdt("amp-web-push-unsubscribe",null)},n.isServiceWorkerActivated=function(){var t=this,n=this;return this.adt().then((function(e){var r=!0===e.isControllingFrame,i=t.isUrlSimilarForQueryParams(e.url,n.IN["service-worker-url"]),o="activated"===e.state;return r&&i&&o}))},n.isUrlSimilarForQueryParams=function(t,n){var e=tt(t),r=p(e.search),i=tt(n),o=p(i.search);for(var u in r)if(o[u]!==r[u])return!1;return e.origin===i.origin&&e.pathname===i.pathname},n.setWidgetVisibilities=function(t,n){for(var e=this.ampdoc.getRootNode().querySelectorAll("".concat(h(M),"[visibility=").concat(h(t),"]")),r="amp-invisible",i=0;i<e.length;i++){var o=e[i];n?o.classList.remove(r):o.classList.add(r)}},n.fdt=function(t){return this.ampdoc.getRootNode().querySelectorAll("".concat(h(M),"[visibility=").concat(h(t),"]")).length>0},n.hdt=function(t){if("boolean"==typeof t)return 1},n.ldt=function(){var t=this;return this.queryNotificationPermission().then((function(n){t.rdt=n}))},n.updateWidgetVisibilities=function(){var t=this;return this.ldt().then((function(){return t.vdt(nt.Topics.STORAGE_GET)})).then((function(n){return!0===n?t.pdt("amp-web-push-notification-permission"):Promise.resolve(j)})).then((function(n){if(n!==C)return t.isServiceWorkerActivated().then((function(n){n?t.ddt():t.mdt()}));t.fdt(z)?t.wdt():t.mdt()}))},n.ddt=function(){var n,e=this;return(n=this.ampdoc.win,F(n,"timer")).timeoutPromise(5e3,this.querySubscriptionStateRemotely().then((function(n){if(e.hdt(n)!==t.AMP_VERSION_INITIAL)throw I().createError("The controlling service worker replied to amp-web-push with an unexpected value.");n?(e.setWidgetVisibilities(q,!1),e.setWidgetVisibilities(H,!0),e.setWidgetVisibilities(z,!1)):e.mdt()})),"The controlling service worker does not support amp-web-push.")},n.mdt=function(){this.setWidgetVisibilities(q,!0),this.setWidgetVisibilities(H,!1),this.setWidgetVisibilities(z,!1)},n.wdt=function(){this.setWidgetVisibilities(q,!1),this.setWidgetVisibilities(H,!1),this.setWidgetVisibilities(z,!0)},n.subscribe=function(t){var n=this,e=[];return e.push(this.registerServiceWorker()),e.push(new Promise((function(e){if(n.rdt===U)return n.bdt().then((function(){e()}));var r=n.openPopupOrRedirect();n.gdt(r,t),n.odt=new nt({debug:n.Nr}),n.odt.listen([n.IN["permission-dialog-url"]]),n.onPermissionDialogInteracted().then((function(t){return n.handlePermissionDialogInteraction(t)})).then((function(){e()}))}))),Promise.all(e)},n.gdt=function(t,n){var e=this;if(t&&!t.closed)var r=this.ampdoc.win.setInterval((function(){t.closed&&(n(),e.ampdoc.win.clearInterval(r))}),500)},n.handlePermissionDialogInteraction=function(t){var n=t[0],e=t[1];switch(n){case C:case j:return e({closeFrame:!0}),this.updateWidgetVisibilities();case U:e({closeFrame:!0}),this.bdt();break;default:throw new Error("Unexpected permission value:",n)}},n.bdt=function(){var t=this;return this.subscribeForPushRemotely().then((function(){return t.updateWidgetVisibilities()}))},n.unsubscribe=function(){var t=this;return this.unsubscribeFromPushRemotely().then((function(){return t.updateWidgetVisibilities()}))},n.vdt=function(t){return this.sdt(nt.Topics.NOTIFICATION_PERMISSION_STATE,{isQueryTopicSupported:t})},n.pdt=function(t){return this.sdt(nt.Topics.STORAGE_GET,{key:t})},n.onPermissionDialogInteracted=function(){var t=this;return new Promise((function(n){t.odt.on(nt.Topics.NOTIFICATION_PERMISSION_STATE,(function(t,e){n([t,e])}))}))},t.ydt=function(){var t=Math.floor(Math.min(700,.9*screen.width)),n=Math.floor(Math.min(450,.9*screen.height));return{w:t,h:n,x:Math.floor((screen.width-t)/2),y:Math.floor((screen.height-n)/2)}},n.openPopupOrRedirect=function(){var n=-1!==this.ampdoc.win.location.href.indexOf("?")?"&":"?",e=this.ampdoc.win.location.href+n+t.PERMISSION_POPUP_URL_FRAGMENT,r=-1!==this.IN["permission-dialog-url"].indexOf("?")?"&":"?",i=this.IN["permission-dialog-url"]+r+"return=".concat(encodeURIComponent(e)),o=t.ydt(),u="height=".concat(o.h,",width=").concat(o.w,",left=").concat(o.x,",top=").concat(o.y),s="".concat(u,",resizable=yes,scrollbars=yes");return function(t,n,e,r){var i,o,u;try{i=t.open(n,e,r)}catch(t){k().error("DOM","Failed to open url on target: ",e,t)}return!i&&("number"!=typeof u&&(u=0),u+"noopener".length>(o=r||"").length||-1===o.indexOf("noopener",u))&&(i=t.open(n,"_top")),i}(this.ampdoc.win,i,"_blank",s)},n.udt=function(){var t=this;this.ampdoc.win.history.replaceState(null,"",this.removePermissionPopupUrlFragmentFromUrl(this.ampdoc.win.location.href)),this.queryNotificationPermission().then((function(n){switch(n){case C:case j:return t.updateWidgetVisibilities();case U:t.bdt();break;default:throw new Error("Unexpected permission value",n)}}))},n.environmentSupportsWebPush=function(){return this.Edt()&&this.Rdt()},n.Edt=function(){return void 0!==this.ampdoc.win.Notification&&void 0!==this.ampdoc.win.navigator.serviceWorker&&void 0!==this.ampdoc.win.PushManager},n.Rdt=function(){return"https:"===this.ampdoc.win.location.protocol||"localhost"===this.ampdoc.win.location.hostname||"127.0.0.1"===this.ampdoc.win.location.hostname||y().development||!1},N(t,null,[{key:"PERMISSION_POPUP_URL_FRAGMENT",get:function(){return"amp-web-push-subscribing=yes"}},{key:"AMP_VERSION_INITIAL",get:function(){return 1}}]),t}(),st={HELPER_FRAME_URL:"helper-iframe-url",PERMISSION_DIALOG_URL:"permission-dialog-url",SERVICE_WORKER_URL:"service-worker-url",SERVICE_WORKER_SCOPE:"service-worker-scope"},ct=function(t){e(r,t);var n=u(r);function r(t){return n.call(this,t)}var i=r.prototype;return i.validate=function(){this.Odt(),this.Sdt();var t,n,e={"helper-iframe-url":null,"permission-dialog-url":null,"service-worker-url":null,"service-worker-scope":null};for(var r in st){var i=st[r];t=this.element.getAttribute(i)||"service-worker-scope"===i,n="The ".concat(i," attribute is required for <").concat(A,">"),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,I().assert(t,n,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),e[i]=this.element.getAttribute(i)}if(!this.Idt(e["helper-iframe-url"]))throw I().createError("<".concat(A,"> must have a valid ")+"helper-iframe-url attribute. It should begin with the https:// protocol and point to the provided lightweight template page provided for AMP messaging.");if(!this.Idt(e["permission-dialog-url"]))throw I().createError("<".concat(A,"> must have a valid ")+"permission-dialog-url attribute. It should begin with the https:// protocol and point to the provided template page for showing the permission prompt.");if("https:"!==tt(e["service-worker-url"]).protocol)throw I().createError("<".concat(A,"> must have a valid ")+"service-worker-url attribute. It should begin with the https:// protocol and point to the service worker JavaScript file to be installed.");if(tt(e["service-worker-url"]).origin!==tt(e["permission-dialog-url"]).origin||tt(e["permission-dialog-url"]).origin!==tt(e["helper-iframe-url"]).origin)throw I().createError("<".concat(A,"> URL attributes ")+"service-worker-url, permission-dialog-url, and helper-iframe-url must all share the same origin.")},i.parseConfig=function(){var t={};for(var n in st){var e=st[n];t[e]=this.element.getAttribute(e)}return t},i.buildCallback=function(){this.validate();var t=this.parseConfig();ot(this.element).then((function(n){n.start(t).catch((function(){}))})),this.registerAction("subscribe",this.Pdt.bind(this)),this.registerAction("unsubscribe",this.kdt.bind(this))},i.Odt=function(){if(this.element.getAttribute("id")!==x)throw I().createError("<".concat(A,"> must have an id ")+"attribute with value '"+x+"'.")},i.Sdt=function(){if(this.getAmpDoc().getRootNode().querySelectorAll("#".concat(h(A))).length>1)throw I().createError("Only one <".concat(A,"> element may exist on a page."))},i.Pdt=function(t){var n=this,e=t.event.target;this._dt(e,!0),ot(this.element).then((function(t){t.subscribe((function(){n._dt(e,!1)})).then((function(){n._dt(e,!1)}))}))},i._dt=function(t,n){t.disabled=n},i.kdt=function(t){var n=this,e=t.event.target;this._dt(e,!0),ot(this.element).then((function(t){t.unsubscribe().then((function(){n._dt(e,!1)}))}))},i.Idt=function(t){try{var n=tt(t),e=n.pathname.length>1;return"https:"===n.protocol&&e}catch(t){return!1}},r}(t.BaseElement);t.registerServiceForDoc(T,ut),t.registerElement(A,ct),t.registerElement(M,K,et)}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-web-push-0.1.js.map
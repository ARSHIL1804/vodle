;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-onetap-google",ev:"0.1",l:!0,f:function(t,e){(()=>{var{hasOwnProperty:e,toString:n}=Object.prototype;var r,i=["Webkit","webkit","Moz","moz","ms","O","o"];function s(t,e){void 0===e&&(e=t.hasAttribute("hidden")),e?t.removeAttribute("hidden"):t.setAttribute("hidden","")}var o=self.AMP_CONFIG||{},u=("string"==typeof o.thirdPartyFrameRegex?new RegExp(o.thirdPartyFrameRegex):o.thirdPartyFrameRegex,("string"==typeof o.cdnProxyRegex?new RegExp(o.cdnProxyRegex):o.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function l(t){if(!self.document||!self.document.head)return null;if(self.location&&u.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}o.thirdPartyUrl,o.thirdPartyFrameHost,o.cdnUrl||l("runtime-host"),o.errorReportingUrl,o.betaErrorReportingUrl,o.localDev,o.geoApiUrl||l("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var c=self.__AMP_LOG;function a(t){return function(t,e){throw new Error("failed to call initLogConstructor")}()}function h(t,e,n,r,i,s,o,u,l,c,a){return t}function f(t,e,n,r,i,s,o,u,l,h,f){return(c.user||(c.user=a()),void c.user.win?c.userForEmbed||(c.userForEmbed=a()):c.user).assert(t,e,n,r,i,s,o,u,l,h,f)}function m(t,e){return b(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),e)}function p(t,e){const n=v(g(t));return w(n,e)?b(n,e):null}function d(t,e){return function(t,e){const n=A(t,e);if(n)return n;const r=P(t);return r[e]=function(){const t=new class{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}},{promise:e,reject:n,resolve:r}=t;return e.catch((()=>{})),{obj:null,promise:e,resolve:r,reject:n,context:null,ctor:null}}(),r[e].promise}(v(t),e)}function _(t,e){return A(v(t),e)}function g(t){return t.nodeType?(e=t,n=(e.ownerDocument||e).defaultView,m(n,"ampdoc")).getAmpDoc(t):t;var e,n}function v(t){const e=g(t);return e.isSingleDoc()?e.win:e}function b(t,e){h(w(t,e));const n=P(t)[e];return n.obj||(h(n.ctor),h(n.context),n.obj=new n.ctor(n.context),h(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function A(t,e){const n=P(t)[e];return n?n.promise?n.promise:(b(t,e),n.promise=Promise.resolve(n.obj)):null}function P(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}function w(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}var I,E,M=t=>function(t,e,n,r){const i=_(t,e);if(i)return i;const s=g(t);return s.whenExtensionsKnown().then((()=>{const t=s.getExtensionVersion(n);return t?m(s.win,"extensions").waitForExtension(n,t):null})).then((n=>n?r?_(t,e):d(t,e):null))}(t,"subscriptions","amp-subscriptions");function R(t,e,n,r){return function(t,e,n,r){let i=t,s=n,o=t=>{try{return s(t)}catch(t){var e,n;throw null===(e=(n=self).__AMP_REPORT_ERROR)||void 0===e||e.call(n,t),t}};const u=function(){if(void 0!==I)return I;I=!1;try{const t={get capture(){return I=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return I}(),l=!(null==r||!r.capture);return i.addEventListener(e,o,u?r:l),()=>{null==i||i.removeEventListener(e,o,u?r:l),s=null,i=null,o=null}}(t,e,n,r)}new Set(["c","v","a","ad"]);var x="onetap_google",y=class extends t.BaseElement{constructor(t){super(t),this.Mv=null,this.N9=!0,this.T_=null}isLayoutSupported(t){return"nodisplay"==t}buildCallback(){this.getAmpDoc().whenFirstVisible().then((()=>{this.Z9(function(t,e,n="source"){var r;return f(null!=t,"%s %s must be available",e,n),f("https:"==(r=(t=>"string"==typeof t?function(t,e){return E||(E=self.document.createElement("a")),function(t,e,n){return t.href="",new URL(e,t.href)}(E,t)}(t):t)(r=t)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||function(t,e){const n=t.length-e.length;return n>=0&&t.indexOf(e,n)==n}(r.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',e,n,t),t}(this.element.dataset.src,this.element))}))}hM(t,e,n){t.postMessage(e,n)}F9(t,e){if(!this.Mv)return;if(e.source!=this.Mv.contentWindow||e.origin!==t)return;const o=function(t){return t.data}(e);var u;if(u=o,"[object Object]"===n.call(u)&&o.sentinel==x)switch(o.command){case"intermediate_iframe_ready":const t=o.nonce;if(!t)return;this.hM(e.source,{"sentinel":x,"command":"parent_frame_ready","nonce":t},e.origin);break;case"intermediate_iframe_resize":const n=o.height;"number"==typeof n&&!isNaN(n)&&n>0&&this.mutateElement((()=>{s(this.element,n>0),function(t,e,n,s,o){const u=function(t,e,n){if(e.startsWith("--"))return e;r||(r=Object.create(null));let s=r[e];if(!s||n){if(s=e,void 0===t[e]){const n=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(e),r=function(t,e){for(let n=0;n<i.length;n++){const r=i[n]+e;if(void 0!==t[r])return r}return""}(t,n);void 0!==t[r]&&(s=r)}n||(r[e]=s)}return s}(t.style,"height",void 0);if(!u)return;const l=n;t.style.setProperty(function(t){const e=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return i.some((t=>e.startsWith(t+"-")))?`-${e}`:e}(u),l)}(this.Mv,0,function(t){return`${t}px`}(o.height))}));break;case"intermediate_iframe_close":this.mutateElement((()=>{this.rM()}));break;case"intermediate_iframe_done":this.mutateElement((()=>{this.rM(),this.W9()}));break;case"set_ui_mode":const u=o.mode;if(!u)return;this.q9(u);break;case"set_tap_outside_mode":this.N9=!!o.cancel}}q9(t){this.mutateElement((()=>{this.Mv.classList.add(`i-amphtml-onetap-google-ui-${t}`)}))}W9(){Promise.all([this.B9(),this.G9()]).then((t=>{t.reduce(((t,e)=>t||e))}))}B9(){const t=this.getAmpDoc().getElementById("amp-access");return!!t&&((e=this.element,p(e,"action")).execute(t,"refresh",null,null,null,null,2),!0);var e}G9(){return M(this.element).then((t=>!!t&&(t.resetPlatforms(),!0)))}Z9(t){var e;this.Mv||(this.Mv=this.getAmpDoc().win.document.createElement("iframe"),(e=this.element,p(e,"url-replace")).expandUrlAsync(t).then((t=>{this.win&&this.nk(t)})))}nk(t){h(this.Mv),s(this.element,!1);const{origin:e}=(n=this.element,p(n,"url")).parse(t);var n;this.T_=[R(this.win,"message",(t=>{this.F9(e,t)})),R(this.getAmpDoc().getRootNode(),"click",(()=>{this.N9&&!this.element.hasAttribute("hidden")&&this.rM()}))],this.Mv.classList.add("i-amphtml-onetap-google-iframe"),this.Mv.src=t,this.element.appendChild(this.Mv),this.getViewport().addToFixedLayer(this.Mv)}rM(){var t,e;if(this.Mv&&(s(this.element,!1),null===(e=(t=this.Mv).parentElement)||void 0===e||e.removeChild(t),this.Mv=null,this.T_))for(;this.T_.length>0;)this.T_.pop()()}};t.registerElement("amp-onetap-google",y,".i-amphtml-onetap-google-iframe{z-index:2147483647;border:none;position:fixed}.i-amphtml-onetap-google-ui-card{width:391px;right:20px;top:20px}.i-amphtml-onetap-google-ui-bottom_sheet{right:auto;left:0;top:auto;bottom:0;width:100%}\n/*# sourceURL=/extensions/amp-onetap-google/0.1/amp-onetap-google.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-onetap-google-0.1.mjs.map
;
import{PreactBaseElement as t}from"../bento.mjs";function e(t,e){if(null==t)return{};var n,o,r={},a=Object.keys(t);for(o=0;o<a.length;o++)n=a[o],e.indexOf(n)>=0||(r[n]=t[n]);return r}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){var e=function(t,e){if("object"!==n(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!==n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===n(e)?e:String(e)}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0;return function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=class{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}},{hasOwnProperty:c,toString:f}=Object.prototype;function p(t){const e=Object.getOwnPropertyDescriptor(t,"message");if(null!=e&&e.writable)return t;const{message:n,stack:o}=t,r=new Error(n);for(const e in t)r[e]=t[e];return r.stack=o,r}function m(t){let e=null,n="";for(var o,r=s(arguments,!0);!(o=r()).done;){const t=o.value;t instanceof Error&&!e?e=p(t):(n&&(n+=" "),n+=t)}return e?n&&(e.message=n+": "+e.message):e=new Error(n),e}function d(t){const e=m.apply(null,arguments);return e.expected=!0,e}function y(t,...e){var n,o,r;n=d.apply(null,e),null===(o=(r=self).__AMP_REPORT_ERROR)||void 0===o||o.call(r,n)}import{Fragment as b,createElement as v}from"../bento.mjs";import{useCallback as g,useEffect as h,useImperativeHandle as w,useLayoutEffect as j,useMemo as k,useRef as O,useState as x}from"../bento.mjs";import{forwardRef as S}from"../bento.mjs";import{ContainWrapper as q,useValueRef as P}from"../bento.mjs";import{useAmpContext as C,useLoading as E}from"../bento.mjs";import{useCallback as I,useLayoutEffect as M}from"../bento.mjs";import{useAmpContext as R}from"../bento.mjs";var A=self.AMP_CONFIG||{},N=("string"==typeof A.thirdPartyFrameRegex?new RegExp(A.thirdPartyFrameRegex):A.thirdPartyFrameRegex,("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function L(t){if(!self.document||!self.document.head)return null;if(self.location&&N.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}A.thirdPartyUrl,A.thirdPartyFrameHost,A.cdnUrl||L("runtime-host"),A.errorReportingUrl,A.betaErrorReportingUrl,A.localDev,A.geoApiUrl||L("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var F={"title":"","artist":"","album":"","artwork":[{"src":""}]};function T(t){const e=t.querySelector('script[type="application/ld+json"]');if(!e)return;const n=function(t,e){try{return function(t){return JSON.parse(t)}(t)}catch(t){return null}}(e.textContent);return n&&n.image?"string"==typeof n.image?n.image:n.image["@list"]&&"string"==typeof n.image["@list"][0]?n.image["@list"][0]:"string"==typeof n.image.url?n.image.url:"string"==typeof n.image[0]?n.image[0]:void 0:void 0}function V(t){const e=t.querySelector('meta[property="og:image"]');return e?e.getAttribute("content"):void 0}function z(t){const e=t.querySelector('link[rel="shortcut icon"]')||t.querySelector('link[rel="icon"]');return e?e.getAttribute("href"):void 0}function $({displayIcon:t,displayOverlay:e,metadata:n,onOverlayClick:o,pause:r,play:a,playing:l,wrapperRef:i}){const{playable:s}=C();return h((()=>{if(!s)return void r();const t=new IntersectionObserver((t=>{t[t.length-1].isIntersecting?a().catch((()=>{})):r()}),{threshold:.5});return t.observe(i.current),()=>{t.disconnect()}}),[i,a,r,s]),v(b,null,t&&v("div",{class:"eq-9e7199f"+(l?" eq-playing-9e7199f":"")},v(U,null)),e&&v("button",{"aria-label":n&&n.title||"Unmute video",tabindex:"0",class:"autoplay-mask-button-9e7199f fill-content-overlay-fc551a7",onClick:o}))}var U=function(t){let e=!1,n=null,o=()=>[1,2,3,4].map((t=>v("div",{class:"eq-col-9e7199f",key:t})));return(...t)=>(e||(n=o.apply(self,t),e=!0,o=null),n)}(),Y=S((function(t,n){let r="class",{autoplay:a=!1,component:i="video",controls:s=!1,loading:c,loop:f=!1,mediasession:p=!0,noaudio:m=!1,onPlayingState:d,onReadyState:b,poster:S,sources:I,src:A,style:N,[r]:L}=t,U=e(t,["autoplay","component","controls","loading","loop","mediasession","noaudio","onPlayingState","onReadyState","poster","sources","src","style",r].map(o));!function(){const{notify:t}=R();M((()=>{t&&t()}))}();const{playable:Y}=C(),H=E(c),J="unload"!==H,[W,Z]=x(a),[_,B]=x(!1),[D,G]=x(null),[K,Q]=x(!a),X=O(null),tt=O(null),et=k((()=>new u),[]),nt=O("loading"),ot=P(b),rt=g(((t,e)=>{if(t!==nt.current){nt.current=t;const n=ot.current;n&&n(t,e)}}),[ot]),at=P(d),lt=g((t=>{B(t);const e=at.current;e&&e(t)}),[at]);j((()=>{J||lt(!1)}),[J,lt]);const it=g((()=>et.promise.then((()=>function(t,e){const n=(o=()=>t.play(!1),new Promise((t=>{t(o())})));var o;return n.catch((t=>{y(0,t)})),n}(tt.current)))),[et]),st=g((()=>{et.promise.then((()=>{var t;return null===(t=tt.current)||void 0===t?void 0:t.pause()}))}),[et]),ut=g((()=>et.promise.then((()=>tt.current.requestFullscreen()))),[et]),ct=g((()=>{Z(!1),Q(!0)}),[]);return j((()=>{var t;const e=null===(t=tt.current)||void 0===t?void 0:t.readyState;null!=e&&rt(e>0?"complete":"loading")}),[rt]),j((()=>(p&&_&&D&&function(t,e,n,o){const{navigator:r}=t;"mediaSession"in r&&t.MediaMetadata&&(r.mediaSession.metadata=new t.MediaMetadata(F),r.mediaSession.metadata=new t.MediaMetadata(e),r.mediaSession.setActionHandler("play",n),r.mediaSession.setActionHandler("pause",o))}(window,D,it,st),()=>{})),[p,_,D,it,st]),h((()=>{Y||st()}),[Y,st]),w(n,(()=>({get readyState(){return nt.current},play:it,pause:st,requestFullscreen:ut,get currentTime(){return tt.current?tt.current.currentTime:0},get duration(){return tt.current?tt.current.duration:NaN},get autoplay(){return a},get controls(){return s},get loop(){return f},userInteracted:ct,mute:()=>Z(!0),unmute:()=>{K&&Z(!1)}})),[it,st,ut,ct,K,a,s,f]),v(q,{contentRef:X,class:L,style:N,size:!0,layout:!0,paint:!0},J&&v(i,l(l({},U),{},{ref:tt,loading:H,muted:W,loop:f,controls:s&&(!a||K),onCanPlay:()=>{et.resolve(),rt("complete")},onLoadedMetadata:()=>{p&&et.promise.then((()=>{var t,e;G((t=tt.current,l({"title":(e=U).title||e["aria-label"]||document.title,"artist":e.artist||"","album":e.album||"","artwork":[{"src":e.artwork||e.poster||T(document)||V(document)||z(document)||""}]},t&&t.getMetadata?t.getMetadata():Object.create(null))))})),rt("complete")},onPlaying:()=>lt(!0),onPause:()=>lt(!1),onEnded:()=>lt(!1),onError:t=>{rt("error",t),et.reject(t)},class:"fill-stretch-fc551a7",src:A,poster:S}),I),a&&!K&&v($,{metadata:D,playing:_,displayIcon:!m&&W,wrapperRef:X,play:it,pause:st,displayOverlay:s,onOverlayClick:ct}))}));Y.displayName="VideoWrapper";var H=class extends t{};H.Component=Y,H.loadable=!0,H.layoutSizeDefined=!0,H.staticProps,H.props={"album":{attr:"album"},"alt":{attr:"alt"},"artist":{attr:"artist"},"artwork":{attr:"artwork"},"attribution":{attr:"attribution"},"autoplay":{attr:"autoplay",type:"boolean"},"controls":{attr:"controls",type:"boolean"},"controlslist":{attr:"controlslist"},"crossorigin":{attr:"crossorigin"},"disableremoteplayback":{attr:"disableremoteplayback"},"loop":{attr:"loop",type:"boolean"},"noaudio":{attr:"noaudio",type:"boolean"},"poster":{attr:"poster"},"sources":{selector:"source",single:!1,clone:!0},"src":{attr:"src"},"title":{attr:"title"},"dock":{attr:"dock",media:!0},"rotate-to-fullscreen":{attr:"rotate-to-fullscreen",type:"boolean",media:!0}},H.shadowCss='.fill-stretch-fc551a7{width:100%;height:100%;position:relative}.fill-content-overlay-fc551a7{top:0;left:0;right:0;bottom:0;position:absolute}.autoplay-mask-button-9e7199f{width:100%;border:none;display:block;-webkit-appearance:none;appearance:none;background:transparent}.eq-9e7199f{right:7px;width:20px;bottom:7px;height:12px;display:-ms-flexbox;display:flex;opacity:0.8;z-index:1;overflow:hidden;position:absolute;-ms-flex-align:end;align-items:flex-end;pointer-events:none!important}.eq-playing-9e7199f>div:after,.eq-playing-9e7199f>div:before{animation-play-state:running}.eq-col-9e7199f{-ms-flex:1;flex:1;height:100%;position:relative;margin-right:1px}.eq-col-9e7199f:after,.eq-col-9e7199f:before{width:100%;height:100%;content:"";position:absolute;animation:keyframes-eq-animation-9e7199f 0s linear infinite alternate;will-change:transform;background-color:#fafafa;animation-play-state:paused}.eq-col-9e7199f:nth-child(4):before{animation-duration:0.4s}.eq-col-9e7199f:nth-child(4):after{animation-duration:0.25s}.eq-col-9e7199f:nth-child(3):before{animation-duration:0.3s}.eq-col-9e7199f:nth-child(3):after{animation-duration:0.35s}.eq-col-9e7199f:nth-child(2):before{animation-duration:0.5s}.eq-col-9e7199f:nth-child(2):after{animation-duration:0.4s}.eq-col-9e7199f:first-child:before{animation-duration:0.3s}.eq-col-9e7199f:first-child:after{animation-duration:0.45s}@keyframes keyframes-eq-animation-9e7199f{0%{transform:translateY(100%)}to{transform:translateY(0)}}',H.usesShadowDom=!0;import{createElement as J}from"../bento.mjs";import{useCallback as W,useImperativeHandle as Z,useLayoutEffect as _,useMemo as B,useRef as D}from"../bento.mjs";import{forwardRef as G}from"../bento.mjs";var K=["loading","unloadOnPause","sandbox","muted","controls","origin","onCanPlay","onMessage","playerStateRef","makeMethodMessage","makeFullscreenMessage","onIframeLoad"],Q=["allow-scripts","allow-same-origin","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation-by-user-activation"].join(" ");function X(t,e,n){t&&t.contentWindow&&e.then((()=>{t.contentWindow.postMessage(n(),"*")}))}var tt=G((function(t,n){let{loading:o,unloadOnPause:r=!1,sandbox:a=Q,muted:i=!1,controls:s=!1,origin:c,onCanPlay:f,onMessage:p,playerStateRef:m,makeMethodMessage:d,makeFullscreenMessage:y,onIframeLoad:b}=t,v=e(t,K);const g=D(null),h=B((()=>new u),[]),w=D(d),j=W((t=>{X(null==g?void 0:g.current,h.promise,(()=>w.current(t)))}),[h.promise]),k=D(y),O=W((()=>X(null==g?void 0:g.current,h.promise,k.current)),[h.promise]);Z(n,(()=>({get currentTime(){var t,e;return null!==(t=null==m||null===(e=m.current)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:NaN},get duration(){var t,e;return null!==(t=null==m||null===(e=m.current)||void 0===e?void 0:e.duration)&&void 0!==t?t:NaN},requestFullscreen:()=>{if(!k.current)return h.promise.then((()=>{g.current.requestFullscreen()}));O()},play:()=>j("play"),pause:()=>{if(r){const t=g.current;t&&(t.src=t.src)}else j("pause")}})),[m,j,O,h.promise,r]);const x=function(t){const e=D(null);return e.current=t,e}(p);return _((()=>{if(!g.current)return;function t(t){x.current&&(c&&!c.test(t.origin)||t.source!=g.current.contentWindow||x.current({currentTarget:g.current,target:g.current,data:t.data}))}const{defaultView:e}=g.current.ownerDocument;return e.addEventListener("message",t),()=>e.removeEventListener("message",t)}),[c,x]),_((()=>{j(i?"mute":"unmute")}),[i,j]),_((()=>{j(s?"showControls":"hideControls")}),[s,j]),J("iframe",l(l({},v),{},{ref:g,allowfullscreen:!0,frameborder:"0",sandbox:a,loading:o,onCanPlay:()=>{f&&h.promise.then(f),h.resolve()},onLoad:t=>{null==b||b(t)}}))}));tt.displayName="VideoIframeInternal";var et=G((function(t,e){return J(Y,l(l({ref:e},t),{},{component:tt}))}));et.displayName="VideoIframe";var nt=class extends H{};nt.Component=et,nt.props={"autoplay":{attr:"autoplay",type:"boolean"},"referrerpolicy":{attr:"referrerpolicy"},"implements-media-session":{attr:"mediasession",type:"boolean"},"poster":{attr:"poster"},"src":{attr:"src"},"controls":{attr:"controls",type:"boolean"},"loading":{attr:"data-loading"},"dock":{attr:"dock"},"rotate-to-fullscreen":{attr:"rotate-to-fullscreen",type:"boolean"}},nt.usesShadowDom=!0,nt.loadable=!0;import{defineBentoElement as ot}from"../bento.mjs";ot("bento-video-iframe",nt,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-video-iframe-1.0.mjs.map
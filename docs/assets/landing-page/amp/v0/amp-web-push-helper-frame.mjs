;
(()=>{function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var{hasOwnProperty:r,toString:n}=Object.prototype;function i(t){const e=Object.create(null);return t&&Object.assign(e,t),e}var s=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function o(t,e=""){try{return decodeURIComponent(t)}catch(t){return e}}function c(t){const e=i();if(!t)return e;let r;for(;r=s.exec(t);){const t=o(r[1],r[1]),n=r[2]?o(r[2].replace(/\+/g," "),r[2]):"";e[t]=n}return e}function u(t){const{location:e}=t||self;return c(e.originalHash||e.hash)}var{isArray:l}=Array;function a(t,e){const r=[];let n=0;for(let i=0;i<t.length;i++){const s=t[i];e(s,i,t)?r.push(s):(n<i&&(t[n]=s),n++)}return n<t.length&&(t.length=n),r}function h(t){return"string"==typeof t}function f(t){return 1==(null==t?void 0:t.nodeType)}var d="​​​";function p(t){return f(t)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t}function m(t){return t.indexOf(d)>=0}function g(t,e,r="Assertion failed",n){var i,s;if(e)return e;t&&-1==r.indexOf(t)&&(r+=t);let o=3;const c=r.split("%s");let u=c.shift();const l=[u];for(;c.length;){const t=arguments[o++],e=c.shift();u+=p(t)+e,l.push(t,e.trim())}const h=new Error(u);throw h.messageArray=a(l,(t=>""!==t)),null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,h),h}function v(t,e,r,n,i){return l(i)?t(r,i.concat([e])):t(r,`${i||n}: %s`,e),e}function w(t){const e=Object.getOwnPropertyDescriptor(t,"message");if(null!=e&&e.writable)return t;const{message:r,stack:n}=t,i=new Error(r);for(const e in t)i[e]=t[e];return i.stack=n,i}function A(t){let r=null,n="";for(var i,s=e(arguments,!0);!(i=s()).done;){const t=i.value;t instanceof Error&&!r?r=w(t):(n&&(n+=" "),n+=t)}return r?n&&(r.message=n+": "+r.message):r=new Error(n),r}function _(t){const e=A.apply(null,arguments);return e.expected=!0,e}var E=self.AMP_CONFIG||{},P=("string"==typeof E.thirdPartyFrameRegex?new RegExp(E.thirdPartyFrameRegex):E.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,R=("string"==typeof E.cdnProxyRegex?new RegExp(E.cdnProxyRegex):E.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function y(t){if(!self.document||!self.document.head)return null;if(self.location&&R.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}var M={thirdParty:E.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:E.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:P,cdn:E.cdnUrl||y("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:R,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:E.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:E.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:E.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:E.geoApiUrl||y("amp-geo-api")},I="";function T(t){var e;return I||(I=(null===(e=t.AMP_CONFIG)||void 0===e?void 0:e.v)||"012203281422000"),I}function S(t,e){const r=e||u(t);return["1","actions","amp","amp4ads","amp4email"].includes(r.development)||!!t.AMP_DEV_MODE}var b=()=>{},O=(t,e)=>e.reduce(((t,e)=>`${t}&s[]=${V(e)}`),`https://log.amp.dev/?v=012203281422000&id=${encodeURIComponent(t)}`),V=t=>encodeURIComponent(String(p(t))),x=t=>parseInt(u(t).log,10);self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var C,k=self.__AMP_LOG,$=null;function N(t,e){if(!$)throw new Error("failed to call initLogConstructor");return new $(self,t,e)}function W(t){return N(((t,e)=>e||t>=1?4:2),t)}function j(t,e,r,n,i,s,o,c,u,l,a){return t}function U(t){return t.data}function F(t,e){return C||(C=self.document.createElement("a")),function(t,e,r){return t.href="",new URL(e,t.href)}(C,t)}new Set(["c","v","a","ad"]);var L,z=class{constructor(t){t||(t={debug:!1,windowContext:window}),this.vt={},this.Wf={},this.Uf=t.debug,this.Gf=!1,this.Hf=!1,this.js=!1,this.Df=null,this.Kf=null,this.qf=null,this.Jf=null,this.Bf=null,this.Qf=t.windowContext||window}listen(t){return new Promise(((e,r)=>{this.js?r(new Error("Already connected.")):this.Gf?r(new Error("Already listening for connections.")):Array.isArray(t)?(this.qf=this.Zf.bind(this,t,e,r),this.Qf.addEventListener("message",this.qf),this.Uf):r(new Error("allowedOrigins should be a string array of allowed origins to accept messages from. Got:",t))})).then((()=>{this.send(z.Topics.CONNECT_HANDSHAKE,null),this.js=!0}))}Wl(t,e){const r=F(t).origin;for(let t=0;t<e.length;t++)if(F(e[t]).origin===r)return!0;return!1}Zf(t,e,r,n){const i=U(n),{origin:s,ports:o}=n;this.Uf,this.Wl(s,t)&&i&&i.topic===z.Topics.CONNECT_HANDSHAKE&&(this.Qf.removeEventListener("message",this.qf),this.Kf=o[0],this.Bf=this.Xf.bind(this),this.Kf.addEventListener("message",this.Bf,!1),this.Kf.start(),e())}connect(t,e){return new Promise(((r,n)=>{t||n(new Error("Provide a valid Window context to connect to.")),e||n(new Error("Provide an expected origin for the remote Window or provide the wildcard *.")),this.js?n(new Error("Already connected.")):this.Hf?n(new Error("Already connecting.")):(this.Df=new MessageChannel,this.Kf=this.Df.port1,this.Jf=this.Yf.bind(this,this.Kf,e,r),this.Kf.addEventListener("message",this.Jf),this.Kf.start(),t.postMessage({topic:z.Topics.CONNECT_HANDSHAKE},"*"===e?"*":F(e).origin,[this.Df.port2]))}))}Yf(t,e,r){this.js=!0,this.Uf,t.removeEventListener("message",this.Jf),this.Bf=this.Xf.bind(this),t.addEventListener("message",this.Bf,!1),r()}static get Topics(){return{CONNECT_HANDSHAKE:"topic-connect-handshake",NOTIFICATION_PERMISSION_STATE:"topic-notification-permission-state",SERVICE_WORKER_STATE:"topic-service-worker-state",SERVICE_WORKER_REGISTRATION:"topic-service-worker-registration",SERVICE_WORKER_QUERY:"topic-service-worker-query",STORAGE_GET:"topic-storage-get"}}Xf(t){const e=U(t);if(this.vt[e.id]&&e.isReply){const t=this.vt[e.id];delete this.vt[e.id];const{promiseResolver:r}=t;t.message=e.data,this.Uf,r([e.data,this.td.bind(this,e.id,t.topic)])}else{const t=this.Wf[e.topic];if(!t)return;this.Uf;for(let r=0;r<t.length;r++)(0,t[r])(e.data,this.td.bind(this,e.id,e.topic))}}on(t,e){this.Wf[t]?this.Wf[t].push(e):this.Wf[t]=[e]}off(t,e){if(e){const r=this.Wf[t].indexOf(e);-1!==r&&this.Wf[t].splice(r,1)}else this.Wf[t]&&delete this.Wf[t]}td(t,e,r){const n={id:t,topic:e,data:r,isReply:!0};return this.Kf.postMessage(n),new Promise((t=>{this.vt[n.id]={message:r,topic:e,promiseResolver:t}}))}send(t,e){const r={id:crypto.getRandomValues(new Uint8Array(10)).join(""),topic:t,data:e};return this.Uf,this.Kf.postMessage(r),new Promise((n=>{this.vt[r.id]={message:e,topic:t,promiseResolver:n}}))}};function G(t,e){return K(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),e)}function H(t,e){return K(function(t){const e=D(t);return e.isSingleDoc()?e.win:e}(D(t)),e)}function D(t){return t.nodeType?(e=t,r=(e.ownerDocument||e).defaultView,G(r,"ampdoc")).getAmpDoc(t):t;var e,r}function K(t,e){j(function(t,e){const r=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!r||!r.ctor)}(t,e));const r=function(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}(t)[e];return r.obj||(j(r.ctor),j(r.context),r.obj=new r.ctor(r.context),j(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}var q,J=t=>G(t,"ampdoc"),B=["Webkit","webkit","Moz","moz","ms","O","o"];function Q(t,e,r,n,s){const o=function(t,e,r){if(e.startsWith("--"))return e;q||(q=i());let n=q[e];if(!n||r){if(n=e,void 0===t[e]){const r=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(e),i=function(t,e){for(let r=0;r<B.length;r++){const n=B[r]+e;if(void 0!==t[n])return n}return""}(t,r);void 0!==t[i]&&(n=i)}r||(q[e]=n)}return n}(t.style,e,s);if(!o)return;const c=n?r+n:r;t.style.setProperty(function(t){const e=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return B.some((t=>e.startsWith(t+"-")))?`-${e}`:e}(o),c)}var Z=!1,X=self.__AMP_ERRORS||[];self.__AMP_ERRORS=X;var Y,tt,et=function(t){return(et=function(t){const e=function(t){let e=0;return()=>{let t=Math.pow(1.5,e++);return t+=function(t,e){let r=t*(e=e||.3)*Math.random();return Math.random()>.5&&(r*=-1),r}(t),1e3*t}}();return t=>setTimeout(t,e())}())(t)};function rt(t,e,r,n,i){var s;!this||!this.document||i&&i.expected||(j((s=this.document).defaultView),Z||(Z=!0,function(t){!function(t,e){for(const r in e)Q(t,r,e[r])}(t.body,{opacity:1,visibility:"visible","animation":"none"})}(s)));let o=!1;try{o=function(t){if(!t.document)return!1;const e=t.document.querySelectorAll("script[src]");for(let t=0;t<e.length;t++)if(r=e[t].src.toLowerCase(),!M.cdnProxyRegex.test((t=>"string"==typeof t?F(t):t)(r).origin))return!0;var r;return!1}(self)}catch(t){}if(o&&Math.random()>.01)return;const c=function(t,e,r,n,i,s){t=function(t,e){return e&&(t=e.message?e.message:String(e)),t||(t="Unknown error"),t}(t,i);let o=!(!i||!i.expected);if(/_reported_/.test(t))return;if("CANCELLED"==t)return;const c=!(self&&self.window),l=Math.random();if((function(t){return-1!=t.indexOf("Failed to load:")}(t)||"Script error."==t||c)&&(o=!0,l>.001))return;const a=m(t);if(a&&l>.1)return;const h=Object.create(null);h.v=function(t){const e=t||self;return e.__AMP_MODE?e.__AMP_MODE:e.__AMP_MODE=function(t){return{localDev:!1,development:S(t,u(t)),esm:!0,test:!1,rtvVersion:T(t)}}(e)}().rtvVersion,h.noAmp=s?"1":"0",h.m=t.replace(d,""),h.a=a?"1":"0",h.ex=o?"1":"0",h.dw=c?"1":"0";let f="1p";var p,g;if(f="esm",h.esm="1",h.rt="esm",h.ca=null!==(g=self.AMP_CONFIG)&&void 0!==g&&g.canary?"1":"0",h.bt=(null===(p=self.AMP_CONFIG)||void 0===p?void 0:p.type)||"unknown",self.location.ancestorOrigins&&self.location.ancestorOrigins[0]&&(h.or=self.location.ancestorOrigins[0]),self.viewerState&&(h.vs=self.viewerState),self.parent&&self.parent!=self&&(h.iem="1"),self.AMP&&self.AMP.viewer){const t=self.AMP.viewer.getResolvedViewerUrl(),e=self.AMP.viewer.maybeGetMessagingOrigin();t&&(h.rvu=t),e&&(h.mso=e)}const v=[],w=self.__AMP__EXPERIMENT_TOGGLES||null;var A,_,E;for(const t in w){const e=w[t];v.push(`${t}=${e?"1":"0"}`)}return h.exps=v.join(","),i?(h.el=(null===(A=i.associatedElement)||void 0===A?void 0:A.tagName)||"u",i.args&&(h.args=JSON.stringify(i.args)),a||i.ignoreStack||!i.stack||(h.s=i.stack),i.message&&(i.message+=" _reported_")):(h.f=e||"",h.l=r||"",h.c=n||""),h.r=self.document?self.document.referrer:"",h.ae=X.join(","),h.fr=self.location.originalHash||self.location.hash,"production"===h.bt&&(h.pt="1"),E=t,(_=X).length>=25&&_.splice(0,_.length-25+1),_.push(E),h}(t,e,r,n,i,o);c&&et((()=>{try{return function(t,e){return e.pt&&Math.random()<.9?L||(L=Promise.resolve(void 0)):function(t,e){const r=J(t);if(!r.isSingleDoc())return Promise.resolve(!1);const n=r.getSingleDoc();if(!n.getRootNode().documentElement.hasAttribute("report-errors-to-viewer"))return Promise.resolve(!1);const i=H(n,"viewer");return i.hasCapability("errorReporter")?i.isTrustedViewer().then((t=>{return!!t&&(i.sendMessage("error",{"m":(r=e).m,"a":r.a,"s":r.s,"el":r.el,"ex":r.ex,"v":r.v,"pt":r.pt}),!0);var r})):Promise.resolve(!1)}(t,e).then((t=>{if(!t){const t=new XMLHttpRequest;t.open("POST",Math.random()<.1?M.betaErrorReporting:M.errorReporting,!0),t.send(JSON.stringify(e))}}))}(this,c).catch((()=>{}))}catch(t){}}))}$=class{constructor(t,e,r=""){this.win=t,this.ht=e,this.ft=this.dt(),this.bt=r,this.vt=null,this.gt=function(t){let e=!1,r=null,n=t;return(...t)=>(e||(r=n.apply(self,t),e=!0,n=null),r)}((()=>{t.fetch(`${M.cdn}/rtv/012203281422000/log-messages.simple.json`).then((t=>t.json()),b).then((t=>{t&&(this.vt=t)}))})),this.wt=this.assert.bind(this)}dt(){var t;const{win:e}=this;return null!==(t=e.console)&&void 0!==t&&t.log&&0!=x(e)?this.yt():0}yt(t){return this.ht(x(t),!1)}jt(t,e,r){var n;if(e>this.ft)return!1;const i=this.win.console,s=null!==(n={1:i.error,3:i.info,2:i.warn}[e])&&void 0!==n?n:i.log,o=this.At(r),c=`[${t}]`;return h(o[0])?o[0]=c+" "+o[0]:o.unshift(c),s.apply(i,o),!0}fine(t,...e){this.jt(t,4,e)}info(t,...e){this.jt(t,3,e)}warn(t,...e){this.jt(t,2,e)}error(t,...e){if(!this.jt(t,1,e)){var r,n;const i=this.createError.apply(this,e);i.name=t||i.name,null===(r=(n=self).__AMP_REPORT_ERROR)||void 0===r||r.call(n,i)}}expectedError(t,...e){var r,n;this.jt(t,1,e)||null===(r=(n=self).__AMP_REPORT_ERROR)||void 0===r||r.call(n,this.createExpectedError.apply(this,e))}createError(t){return this.xt(A.apply(null,arguments))}createExpectedError(t){return this.xt(_.apply(null,arguments))}xt(t){return t=w(t),this.bt?t.message?-1==t.message.indexOf(this.bt)&&(t.message+=this.bt):t.message=this.bt:m(t.message)&&(t.message=t.message.replace(d,"")),t}At(t){return l(t[0])?this.Pt(t[0]):t}Pt(t){var e;const r=t.shift();return null!==(e=this.vt)&&void 0!==e&&e[r]?[this.vt[r]].concat(t):[`More info at ${O(r,t)}`]}assert(t,e,r){return l(e)?this.assert.apply(this,[t].concat(this.Pt(e))):g.apply(null,[this.bt].concat(Array.prototype.slice.call(arguments)))}assertElement(t,e){return function(t,e,r){return v(t,e,f(e),"Element expected",r)}(this.wt,t,e)}assertString(t,e){return function(t,e,r){return v(t,e,h(e),"String expected",r)}(this.wt,t,e)}assertNumber(t,e){return function(t,e,r){return v(t,e,"number"==typeof e,"Number expected",r)}(this.wt,t,e)}assertArray(t,e){return function(t,e,r){return v(t,e,l(e),"Array expected",r)}(this.wt,t,e)}assertBoolean(t,e){return function(t,e,r){return v(t,e,!!e===e,"Boolean expected",r)}(this.wt,t,e)}},k.dev||(k.dev=N((t=>t>=3?4:t>=2?3:0))),k.user||(k.user=W(d)),function(t,e){return e&&e.ownerDocument.defaultView!=t}(k.user.win,tt)?k.userForEmbed||(k.userForEmbed=W("​​​​")):k.user,Y=function(t,e){try{let r;if(t)if(void 0!==t.message)t=w(t),r=!0;else{const e=t;(t=new Error(function(t){try{return JSON.stringify(t)}catch(e){return String(t)}}(e))).origError=e}else t=new Error("Unknown error");if(t.reported)return t;if(t.reported=!0,t.messageArray){const e=function(t,e){for(let e=0;e<t.length;e++)if(null==(r=t[e])?void 0:r.tagName)return e;var r;return-1}(t.messageArray);e>-1&&(t.associatedElement=t.messageArray[e])}const n=e||t.associatedElement;if(n&&n.classList&&n.classList.add("i-amphtml-error"),self.console&&(m(t.message)||!t.expected)){const e=console.error||console.log;t.messageArray?e.apply(console,t.messageArray):n?e.call(console,t.message,n):e.call(console,t.message)}n&&n.dispatchCustomEventForTesting&&n.dispatchCustomEventForTesting("amp:error",t.message),rt.call(self,void 0,void 0,void 0,void 0,t)}catch(t){setTimeout((function(){throw t}))}return t},self.__AMP_REPORT_ERROR=Y,window._ampWebPushHelperFrame=new class{constructor(t){this.Uf=t&&t.debug,this.Qf=t.windowContext||window,this.ed=new z({debug:this.Uf,windowContext:this.Qf}),this.rd={}}nd(t,e,r,n){t({success:e,error:e?void 0:r,result:e?n:void 0})}sd(t,e){if(t&&t.isQueryTopicSupported){let r=!1;for(const e in z.Topics)t.isQueryTopicSupported===z.Topics[e]&&(r=!0);this.nd(e,!0,null,r)}else this.nd(e,!0,null,Notification.permission)}od(t,e){let r=null;try{t&&t.key&&this.Qf.localStorage&&(r=this.Qf.localStorage.getItem(t.key))}catch(t){}this.nd(e,!0,null,r)}ud(t,e){const r={isControllingFrame:!!this.Qf.navigator.serviceWorker.controller,url:this.Qf.navigator.serviceWorker.controller?this.Qf.navigator.serviceWorker.controller.scriptURL:null,state:this.Qf.navigator.serviceWorker.controller?this.Qf.navigator.serviceWorker.controller.state:null};this.nd(e,!0,null,r)}ld(t,e){if(!t||!t.workerUrl||!t.registrationOptions)throw new Error("Expected arguments workerUrl and registrationOptions in message, got:",t);this.Qf.navigator.serviceWorker.register(t.workerUrl,t.registrationOptions).then((()=>{this.nd(e,!0,null,null)})).catch((t=>{this.nd(e,!0,null,t?t.message||t.toString():null)}))}messageServiceWorker(t){this.Qf.navigator.serviceWorker.controller.postMessage({command:t.topic,payload:t.payload})}ad(t,e){if(!t||!t.topic)throw new Error("Expected argument topic in message, got:",t);new Promise((e=>{this.rd[t.topic]=e,this.waitUntilWorkerControlsPage().then((()=>{this.messageServiceWorker(t)}))})).then((r=>(delete this.rd[t.topic],this.nd(e,!0,null,r))))}hd(){const t=c(this.Qf.location.search);if(!t.parentOrigin)throw new Error("Expecting parentOrigin URL query parameter.");return t.parentOrigin}fd(t){const{command:e,payload:r}=t.data,n=this.rd[e];"function"==typeof n&&n(r)}dd(){return this.Qf.navigator.serviceWorker&&this.Qf.navigator.serviceWorker.controller&&"activated"===this.Qf.navigator.serviceWorker.controller.state}waitUntilWorkerControlsPage(){return new Promise((t=>{this.dd()?t():this.Qf.navigator.serviceWorker.addEventListener("controllerchange",(()=>{this.dd()?t():this.Qf.navigator.serviceWorker.controller.addEventListener("statechange",(()=>{this.dd()&&t()}))}))}))}run(t){this.ed.on(z.Topics.NOTIFICATION_PERMISSION_STATE,this.sd.bind(this)),this.ed.on(z.Topics.SERVICE_WORKER_STATE,this.ud.bind(this)),this.ed.on(z.Topics.SERVICE_WORKER_REGISTRATION,this.ld.bind(this)),this.ed.on(z.Topics.SERVICE_WORKER_QUERY,this.ad.bind(this)),this.ed.on(z.Topics.STORAGE_GET,this.od.bind(this)),this.waitUntilWorkerControlsPage().then((()=>{this.Qf.navigator.serviceWorker.addEventListener("message",this.fd.bind(this))})),this.ed.listen([t||this.hd()])}}({debug:!1}),window._ampWebPushHelperFrame.run()})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=amp-web-push-helper-frame.mjs.map
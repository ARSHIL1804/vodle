;
import{PreactBaseElement as e}from"../bento.mjs";function t(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?n(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}import{createElement as l}from"../bento.mjs";import{useCallback as a,useEffect as s,useRef as c}from"../bento.mjs";import{useValueRef as i}from"../bento.mjs";import{createElement as u}from"../bento.mjs";import{useCallback as d,useEffect as m,useImperativeHandle as f,useLayoutEffect as p,useRef as b}from"../bento.mjs";import{forwardRef as g}from"../bento.mjs";import{ContainWrapper as j,useValueRef as y}from"../bento.mjs";import{useAmpContext as v,useLoading as O}from"../bento.mjs";var h=["allow","allowFullScreen","iframeStyle","name","title","matchesMessagingOrigin","messageHandler","ready","loading","onReadyState","sandbox","src"],w=()=>!1,k=g((function(e,t){let{allow:n,allowFullScreen:l,iframeStyle:a,name:s,title:c,matchesMessagingOrigin:i=w,messageHandler:g,ready:k=!0,loading:S,onReadyState:I,sandbox:R,src:E}=e,x=r(e,h);const{playable:C}=v(),F=O(S),H="unload"!==F,L=b(!1),M=y(I),N=d((e=>{if(e!==L.current){L.current=e;const t=M.current;null==t||t(e?"complete":"loading")}}),[M]),T=b(null);return f(t,(()=>({get readyState(){return L.current?"complete":"loading"},get node(){return T.current}})),[]),p((()=>{H||N(!1)}),[H,N]),m((()=>{const e=T.current;if(!C&&e){const{src:t}=e;(e=>!(!e||"about:blank"==e||e.includes("#")))(t)?e.src=e.src:e.parentNode.insertBefore(e,e.nextSibling)}}),[C]),p((()=>{const e=T.current;if(!e||!H)return;const t=e=>{const t=T.current;t&&e.source==t.contentWindow&&i(e.origin)&&g(e)},{defaultView:n}=e.ownerDocument;return n.addEventListener("message",t),()=>n.removeEventListener("message",t)}),[i,g,H,k]),u(j,o(o({},x),{},{layout:!0,size:!0,paint:!0}),H&&k&&u("iframe",{allow:n,allowFullScreen:l,frameBorder:"0",loading:F,name:s,onLoad:()=>N(!0),part:"iframe",ref:T,sandbox:R,scrolling:"no",src:E,style:o(o({},a),{},{width:"100%",height:"100%",contentVisibility:"auto"}),title:c}))}));k.displayName="IframeEmbed";var{hasOwnProperty:S,toString:I}=Object.prototype,R=self.AMP_CONFIG||{},E=("string"==typeof R.thirdPartyFrameRegex?new RegExp(R.thirdPartyFrameRegex):R.thirdPartyFrameRegex,("string"==typeof R.cdnProxyRegex?new RegExp(R.cdnProxyRegex):R.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function x(e){if(!self.document||!self.document.head)return null;if(self.location&&E.test(self.location.origin))return null;const t=self.document.head.querySelector(`meta[name="${e}"]`);return t&&t.getAttribute("content")||null}R.thirdPartyUrl,R.thirdPartyFrameHost,R.cdnUrl||x("runtime-host"),R.errorReportingUrl,R.betaErrorReportingUrl,R.localDev,R.geoApiUrl||x("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG;var C=["color","onLoad","playlistId","secretToken","trackId","visual"],F=e=>"https://w.soundcloud.com"===e,H=class extends e{static getPreconnects(){return["https://api.soundcloud.com/"]}};H.Component=function(e){let{color:t,onLoad:n,playlistId:u,secretToken:d,trackId:m,visual:f=!1}=e,p=r(e,C);const b=c(null),g=i(n);s((()=>()=>{var e,t;null===(e=b.current)||void 0===e||null===(t=e.contentWindow)||void 0===t||t.postMessage(JSON.stringify({"method":"pause"}),"https://w.soundcloud.com"),b.current=null}),[]);const j=a((e=>{const t=(n=function(e){return e.data}(e),JSON.parse(n));var n,o;"ready"===t.method&&(null===(o=g.current)||void 0===o||o.call(g))}),[g]);if(!function(e,t){return null!=t||void 0!==e||(console.warn("data-trackid or data-playlistid is required for <amp-soundcloud>"),!1)}(m,u))return null;const y=null!=m?m:u;let v="https://w.soundcloud.com/player/?url="+encodeURIComponent("https://api.soundcloud.com/"+(null!=m?"tracks":"playlists")+"/"+y);return d&&(v+=encodeURIComponent("?secret_token="+d)),f?v+="&visual=true":t&&(v+="&color="+encodeURIComponent(t)),l(k,o({allow:"autoplay",frameborder:"no",ref:b,scrolling:"no",src:v,title:"Soundcloud Widget - "+y,messageHandler:j,matchesMessagingOrigin:F},p))},H.props={"children":{passthroughNonEmpty:!0},"color":{attr:"data-color"},"playlistId":{attr:"data-playlistid"},"secretToken":{attr:"data-secret-token"},"trackId":{attr:"data-trackid"},"visual":{attr:"data-visual",type:"boolean",default:!1}},H.layoutSizeDefined=!0,H.usesShadowDom=!0,H.loadable=!0;import{defineBentoElement as L}from"../bento.mjs";L("bento-soundcloud",H,void 0);
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=bento-soundcloud-1.0.mjs.map
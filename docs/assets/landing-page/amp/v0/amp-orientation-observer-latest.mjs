;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-orientation-observer",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function e(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function i(t){for(var i=1;i<arguments.length;i++){var r=null!=arguments[i]?arguments[i]:{};i%2?e(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}var{hasOwnProperty:r,toString:s}=Object.prototype;var o=self.AMP_CONFIG||{},a=("string"==typeof o.thirdPartyFrameRegex?new RegExp(o.thirdPartyFrameRegex):o.thirdPartyFrameRegex,("string"==typeof o.cdnProxyRegex?new RegExp(o.cdnProxyRegex):o.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function u(t){if(!self.document||!self.document.head)return null;if(self.location&&a.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}o.thirdPartyUrl,o.thirdPartyFrameHost,o.cdnUrl||u("runtime-host"),o.errorReportingUrl,o.betaErrorReportingUrl,o.localDev,o.geoApiUrl||u("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var c=self.__AMP_LOG;function h(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function l(t,n,e,i,r,s,o,a,u,c,h){return t}function f(t,n){const e=function(t){const n=b(t);return n.isSingleDoc()?n.win:n}(b(t));return p(e,n)?m(e,n):null}function b(t){return t.nodeType?(n=t,e=(n.ownerDocument||n).defaultView,function(t,n){return m(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}(e,"ampdoc")).getAmpDoc(t):t;var n,e}function m(t,n){l(p(t,n));const e=function(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}(t)[n];return e.obj||(l(e.ctor),l(e.context),e.obj=new e.ctor(e.context),l(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function p(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}var v=t=>b(t),g="amp-orientation-observer",O=["alpha","beta","gamma"],d={"alpha":180,"beta":0,"gamma":0},_={"alpha":[0,360],"beta":[-180,180],"gamma":[-90,90]},j=class extends t.BaseElement{constructor(t){super(t),this.Ci=v(this.element),this.fc=null,this.tO=i({},_),this.nO=i({},d),this.eO=i({},d),this.iO={beta:[],alpha:[],gamma:[]},this.rO=null}buildCallback(){this.fc=f(this.element,"action"),this.Ci.whenFirstVisible().then(this.Cu.bind(this))}Cu(){var t,n,e,i,r,s,o,a,u,l,f;t=this.win.DeviceOrientationEvent,n="The current browser doesn't support the `window.DeviceOrientationEvent`",(c.user||(c.user=h()),void c.user.win?c.userForEmbed||(c.userForEmbed=h()):c.user).assert(t,n,e,i,r,s,o,a,u,l,f),O.forEach((t=>{this.tO[t]=this.dw(`${t}-range`,this.tO[t])})),this.rO=this.element.hasAttribute("smoothing")?Number(this.element.getAttribute("smoothing"))||4:null,this.win.addEventListener("deviceorientation",(t=>{this.sO(t)}),!0)}dw(t,n){const e=this.element.getAttribute(t);if(e){const t=e.trim().split(" ");return[parseInt(t[0],10),parseInt(t[1],10)]}return n}sO(t){if(t instanceof DeviceOrientationEvent){const{screen:n}=this.win,{alpha:e}=t;let{beta:i,gamma:r}=t;const s="orientation"in n?n.orientation.angle:n.orientation;if(90==this.win.orientation||-90==this.win.orientation){const t=r;r=i,i=t}s<0&&(r=-r,i=-i);const o={alpha:e,beta:i,gamma:r};O.forEach((t=>{Math.abs(o[t]-this.nO[t])>.1&&(this.rO?this.nO[t]=this.oO(t,o[t]):this.nO[t]=o[t],this.aO(t,this.nO[t],this.tO[t]))}))}}oO(t,n){this.iO[t].length>this.rO&&this.iO[t].shift(),this.iO[t].push(n);const e=this.iO[t].reduce((function(t,n){return t+n}))/this.rO;return this.iO[t].length>this.rO&&this.eO[t]==d[t]&&(this.eO[t]=e),e-this.eO[t]}aO(t,n,e){const i=e[0]<0?n.toFixed()-e[0]:n.toFixed(),r=function(t,n,e,i){const r={detail:e};return Object.assign(r,void 0),new t.CustomEvent(n,r)}(this.win,`${g}.${t}`,{"angle":(s=n,o=e[0],a=e[1],Math.min(Math.max(s,o),a)).toFixed(),"percent":i/(e[1]-e[0])});var s,o,a;this.fc.trigger(this.element,t,r,1)}};t.registerElement(g,j)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-orientation-observer-0.1.mjs.map
;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-image-lightbox",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,h=new Array(i);s<i;s++)h[s]=t[s];return h}function s(t,s){var h="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(h)return(h=h.call(t)).next.bind(h);if(Array.isArray(t)||(h=function(t,s){if(t){if("string"==typeof t)return i(t,s);var h=Object.prototype.toString.call(t).slice(8,-1);return"Object"===h&&t.constructor&&(h=t.constructor.name),"Map"===h||"Set"===h?Array.from(t):"Arguments"===h||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(h)?i(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){h&&(t=h);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var h;function n(){return h||(h=Promise.resolve(void 0))}var e=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:r}=Array;function o(t,i){const s=[];let h=0;for(let n=0;n<t.length;n++){const e=t[n];i(e,n,t)?s.push(e):(h<n&&(t[h]=e),h++)}return h<t.length&&(t.length=h),s}function a(t){return"string"==typeof t}var{hasOwnProperty:c,toString:u}=Object.prototype;function l(t,i,s,h){return n=>f.solveYValueFromXValue(n,0,0,t,i,s,h,1,1)}var f=class{static solveYValueFromXValue(t,i,s,h,n,e,r,o,a){return f.yr(f.Ir(t,i,h,e,o),s,n,r,a)}static Ir(t,i,s,h,n){const e=1e-6;let r=(t-i)/(n-i);if(r<=0)return 0;if(r>=1)return 1;let o=0,a=1,c=0;for(let u=0;u<8;u++){c=f.Mr(r,i,s,h,n);const u=(f.Mr(r+e,i,s,h,n)-c)/e;if(Math.abs(c-t)<e)return r;if(Math.abs(u)<e)break;c<t?o=r:a=r,r-=(c-t)/u}for(let u=0;Math.abs(c-t)>e&&u<8;u++)c<t?(o=r,r=(r+a)/2):(a=r,r=(r+o)/2),c=f.Mr(r,i,s,h,n);return r}static Mr(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=f.Rr(i,s,t),r=f.Rr(s,h,t);const o=f.Rr(h,n,t);return e=f.Rr(e,r,t),r=f.Rr(r,o,t),f.Rr(e,r,t)}static yr(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=f.Rr(i,s,t),r=f.Rr(s,h,t);const o=f.Rr(h,n,t);return e=f.Rr(e,r,t),r=f.Rr(r,o,t),f.Rr(e,r,t)}static Rr(t,i,s){return t+s*(i-t)}},m={LINEAR:t=>t,EASE:t=>f.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1),EASE_IN:t=>f.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1),EASE_OUT:t=>f.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1),EASE_IN_OUT:t=>f.solveYValueFromXValue(t,0,0,.42,0,.58,1,1,1)},p={"linear":m.LINEAR,"ease":m.EASE,"ease-in":m.EASE_IN,"ease-out":m.EASE_OUT,"ease-in-out":m.EASE_IN_OUT};function _(t){if(!t)return null;if(a(t)){if(-1!=(t=t).indexOf("cubic-bezier")){const i=t.match(/cubic-bezier\((.+)\)/);if(i){const t=i[1].split(",").map(parseFloat);if(4==t.length){for(let i=0;i<4;i++)if(isNaN(t[i]))return null;return l(t[0],t[1],t[2],t[3])}}return null}return p[t]}return t}function d(t){return 1==(null==(i=t)?void 0:i.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function g(t,i,s,h,n,e,r,o,a,c,u){return t}function A(t,i,s,h,n,e,r,a,c,u,l){return function(t,i,s="Assertion failed",h){var n,e;if(i)return i;t&&-1==s.indexOf(t)&&(s+=t);let r=3;const a=s.split("%s");let c=a.shift();const u=[c];for(;a.length;){const t=arguments[r++],i=a.shift();c+=d(t)+i,u.push(t,i.trim())}const l=new Error(c);throw l.messageArray=o(u,(t=>""!==t)),null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,l),l}("​​​",t,i,s,h,n,e,r,a,c,u,l)}function M(t){return(t.ownerDocument||t).defaultView}function P(t){g(/^[\w-]+$/.test(t))}function v(t,i,s,h){return{left:t,top:i,width:s,height:h,bottom:i+h,right:t+s,x:t,y:i}}function b(t){return v(Number(t.left),Number(t.top),Number(t.width),Number(t.height))}function E(t,i,h,n){for(var e,o,a=s(r(e=t)?e:[e],!0);!(o=a()).done;){const t=o.value,s=i.getAttribute(t);null!==s?h.setAttribute(t,s):n&&h.removeAttribute(t)}}var T,I=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g,y=class{constructor(t){A(t.length>0,"Srcset must have at least one source"),this.kw=t;let i=!1,s=!1;for(let h=0;h<t.length;h++){const n=t[h];i=i||!!n.width,s=s||!!n.dpr}A(!(i===s),"Srcset must have width or dpr sources, but not both"),t.sort(i?R:w),this.jw=i}select(t,i){g(t),g(i);let s=0;return s=this.jw?this.Ow(t*i):this.Tw(i),this.kw[s].url}Ow(t){const i=this.kw;let s=0,h=1/0,n=1/0;for(let r=0;r<i.length;r++){var e;const o=null!==(e=i[r].width)&&void 0!==e?e:0,a=Math.abs(o-t);if(!(a<=1.1*h||t/n>1.2))break;s=r,h=a,n=o}return s}Tw(t){const i=this.kw;let s=0,h=1/0;for(let n=0;n<i.length;n++){const e=Math.abs(i[n].dpr-t);if(!(e<=h))break;s=n,h=e}return s}getUrls(){return this.kw.map((t=>t.url))}stringify(t){const i=[],s=this.kw;for(let h=0;h<s.length;h++){const n=s[h];let e=n.url;t&&(e=t(e)),this.jw?e+=` ${n.width}w`:e+=` ${n.dpr}x`,i.push(e)}return i.join(", ")}};function R(t,i){return A(t.width!=i.width,"Duplicate width: %s",t.width),t.width-i.width}function w(t,i){return A(t.dpr!=i.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-i.dpr}function V(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:h}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=h,n}function x(t){let i=null,h="";for(var n,e=s(arguments,!0);!(n=e()).done;){const t=n.value;t instanceof Error&&!i?i=V(t):(h&&(h+=" "),h+=t)}return i?h&&(i.message=h+": "+i.message):i=new Error(h),i}function S(t,...i){const s=x.apply(null,i);s.name=t||s.name,function(t){var i,s;null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t)}(s)}var D=["Webkit","webkit","Moz","moz","ms","O","o"];function C(t,i,s,h,n){const e=function(t,i,s){if(i.startsWith("--"))return i;T||(T=Object.create(null));let h=T[i];if(!h||s){if(h=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<D.length;s++){const h=D[s]+i;if(void 0!==t[h])return h}return""}(t,s);void 0!==t[n]&&(h=n)}s||(T[i]=h)}return h}(t.style,i,n);if(!e)return;const r=h?s+h:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return D.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(e),r)}function k(t,i){for(const s in i)C(t,s,i[s])}function O(t){return`${t}px`}function X(t,i){return"number"==typeof t?i(t):t}function Y(t,i){return null==i?`translate(${X(t,O)})`:`translate(${X(t,O)}, ${X(i,O)})`}function $(t){return`scale(${t})`}function z(t,i=" "){return(s,h)=>t.map((t=>t(s,h))).filter(a).join(i)}function Z(t,i){return(s,h)=>{for(const e in i)C(t,("display"===(n=e)&&S("STYLE","`display` style detected. You must use toggle instead."),n),i[e](s,h));var n}}function L(t,i){return s=>t+(i-t)*s}function N(t,i){return s=>Y(t(s),null==i?void 0:i(s))}function U(t){return i=>$(t(i))}function j(t,i,s){return g(i<=s),Math.min(Math.max(t,i),s)}function B(t,i,s,h){return g(i<=s),j(t,i-h,s+h)}function G(t,i){return Math.sqrt(t*t+i*i)}var F=self.AMP_CONFIG||{},H=("string"==typeof F.thirdPartyFrameRegex?new RegExp(F.thirdPartyFrameRegex):F.thirdPartyFrameRegex,("string"==typeof F.cdnProxyRegex?new RegExp(F.cdnProxyRegex):F.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function W(t){if(!self.document||!self.document.head)return null;if(self.location&&H.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}F.thirdPartyUrl,F.thirdPartyFrameHost,F.cdnUrl||W("runtime-host"),F.errorReportingUrl,F.betaErrorReportingUrl,F.localDev,F.geoApiUrl||W("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var q=self.__AMP_LOG;function J(t,i){throw new Error("failed to call initLogConstructor")}function K(t){return J()}function Q(){return q.dev||(q.dev=J())}function tt(t,i,s,h,n,e,r,o,a,c,u){return t}function it(t,i){return nt(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function st(t){return t.nodeType?(i=M(t),it(i,"ampdoc")).getAmpDoc(t):t;var i}function ht(t){const i=st(t);return i.isSingleDoc()?i.win:i}function nt(t,i){tt(et(t,i));const s=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return s.obj||(tt(s.ctor),tt(s.context),s.obj=new s.ctor(s.context),tt(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function et(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var rt,ot=t=>function(t,i){const s=ht(st(t));return et(s,i)?nt(s,i):null}(t,"action"),at=t=>function(t,i){return nt(ht(st(t)),i)}(t,"history"),ct=t=>nt(t,"timer"),ut=t=>it(t,"vsync"),lt="Animation",ft=function(){},mt=class{static animate(t,i,s,h){return new mt(t).setCurve(h).add(0,i,1).start(s)}constructor(t,i){this.wr=t,this.br=i||ut(self),this.Vr=null,this.Sr=[]}setCurve(t){return t&&(this.Vr=_(t)),this}add(t,i,s,h){return this.Sr.push({delay:t,func:i,duration:s,curve:_(h)}),this}start(t){return new pt(this.br,this.wr,this.Sr,this.Vr,t)}},pt=class{constructor(t,i,s,h,n){this.br=t,this.wr=i,this.Sr=[];for(let t=0;t<s.length;t++){const i=s[t];this.Sr.push({delay:i.delay,func:i.func,duration:i.duration,curve:i.curve||h,started:!1,completed:!1})}this.Or=n,this.hr=Date.now(),this.Re=!0,this.mi={};const r=new e;this.Cr=r.promise,this.Xs=r.resolve,this.kr=r.reject,this.Nr=this.br.createAnimTask(this.wr,{mutate:this.Dr.bind(this)}),this.br.canAnimate(this.wr)?this.Nr(this.mi):this.Lr(!1,0)}then(t,i){return t||i?this.Cr.then(t,i):this.Cr}thenAlways(t){const i=t||ft;return this.then(i,i)}halt(t){this.Lr(!1,t||0)}Lr(t,i){if(this.Re){if(this.Re=!1,0!=i){this.Sr.length>1&&this.Sr.sort(((t,i)=>t.delay+t.duration-(i.delay+i.duration)));try{if(i>0)for(let t=0;t<this.Sr.length;t++)this.Sr[t].func(1,!0);else for(let t=this.Sr.length-1;t>=0;t--)this.Sr[t].func(0,!1)}catch(i){Q().error(lt,"completion failed: "+i,i),t=!1}}t?this.Xs():this.kr()}}Dr(t){if(!this.Re)return;const i=Date.now(),s=Math.min((i-this.hr)/this.Or,1);for(let t=0;t<this.Sr.length;t++){const i=this.Sr[t];!i.started&&s>=i.delay&&(i.started=!0)}for(let t=0;t<this.Sr.length;t++){const i=this.Sr[t];i.started&&!i.completed&&this.Ur(i,s)}1==s?this.Lr(!0,0):this.br.canAnimate(this.wr)?this.Nr(this.mi):this.Lr(!1,0)}Ur(t,i){let s,h;if(t.duration>0){if(s=Math.min((i-t.delay)/t.duration,1),h=s,t.curve&&1!=h)try{h=t.curve(s)}catch(t){return Q().error(lt,"step curve failed: "+t,t),void this.Lr(!1,0)}}else s=1,h=1;1==s&&(t.completed=!0);try{t.func(h,t.completed)}catch(t){return Q().error(lt,"step mutate failed: "+t,t),void this.Lr(!1,0)}}};function _t(t){return!!(t.complete||"complete"==t.readyState||function(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}var dt=class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var i,h=s(this.Tt.slice(),!0);!(i=h()).done;)(0,i.value)(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Tt)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},gt="__AMP_Gestures",At=class{static get(t,i=!1,s=!1){let h=t[gt];return h||(h=new At(t,i,s),t[gt]=h),h}constructor(t,i,s){this.yf=t,this.EI=[],this.h_=[],this.ui=[],this.TI=[],this.RI=null,this.VI=i,this.xI=s,this.kI=!1,this.be=new class{constructor(t,i,s){this.Ee=ct(t),this.Te=i,this.ye=s||0,this.Ie=-1,this.Me=0,this.Re=!1,this.we=()=>{this.be()}}isPending(){return-1!=this.Ie}schedule(t){let i=t||this.ye;this.Re&&i<10&&(i=10);const s=Date.now()+i;return(!this.isPending()||s-this.Me<-10)&&(this.cancel(),this.Me=s,this.Ie=this.Ee.delay(this.we,i),!0)}be(){this.Ie=-1,this.Me=0,this.Re=!0,this.Te(),this.Re=!1}cancel(){this.isPending()&&(this.Ee.cancel(this.Ie),this.Ie=-1)}}(M(t),this.Ip.bind(this)),this.SI=new dt,this.DI=Object.create(null),this.CI=this.py.bind(this),this.zI=this.yy.bind(this),this.GI=this.my.bind(this),this.jI=this.d_.bind(this);const h=function(t){if(void 0!==rt)return rt;rt=!1;try{const i={get passive(){return rt=!0,!1}};t.addEventListener("test-options",null,i),t.removeEventListener("test-options",null,i)}catch(t){}return rt}(t.ownerDocument.defaultView);this.yf.addEventListener("touchstart",this.CI,!!h&&{passive:!0}),this.yf.addEventListener("touchend",this.zI),this.yf.addEventListener("touchmove",this.GI,!!h&&{passive:!0}),this.yf.addEventListener("touchcancel",this.jI),this.OI=!1}cleanup(){this.yf.removeEventListener("touchstart",this.CI),this.yf.removeEventListener("touchend",this.zI),this.yf.removeEventListener("touchmove",this.GI),this.yf.removeEventListener("touchcancel",this.jI),delete this.yf[gt],this.be.cancel()}onGesture(t,i){const s=new t(this),h=s.getType();let n=this.DI[h];return n||(this.EI.push(s),n=new dt,this.DI[h]=n),n.add(i)}removeGesture(t){const i=new t(this).getType(),s=this.DI[i];if(s){s.removeAll();const t=function(t,s){for(let s=0;s<t.length;s++)if(t[s].getType()==i)return s;return-1}(this.EI);return!(t<0||(this.EI.splice(t,1),this.ui.splice(t,1),this.TI.splice(t,1),this.h_.splice(t,1),delete this.DI[i],0))}return!1}onPointerDown(t){return this.SI.add(t)}py(t){const i=Date.now();this.kI=!1,this.SI.fire(t);for(let s=0;s<this.EI.length;s++)this.ui[s]||(this.TI[s]&&this.TI[s]<i&&this.f_(s),this.EI[s].onTouchStart(t)&&this.p_(s));this.XI(t)}my(t){const i=Date.now();for(let s=0;s<this.EI.length;s++)this.h_[s]&&(this.TI[s]&&this.TI[s]<i?this.f_(s):this.EI[s].onTouchMove(t)||this.f_(s));this.XI(t)}yy(t){const i=Date.now();for(let s=0;s<this.EI.length;s++){if(!this.h_[s])continue;if(this.TI[s]&&this.TI[s]<i){this.f_(s);continue}this.EI[s].onTouchEnd(t);const h=!this.TI[s],n=this.TI[s]<i;this.RI==this.EI[s]||!h&&!n||this.f_(s)}this.XI(t)}d_(t){for(let t=0;t<this.EI.length;t++)this.$I(t);this.XI(t)}ny(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.EI.length;h++)this.EI[h]==t&&(this.ui[h]=s+i,this.TI[h]=0);this.OI=!0}HI(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.EI.length;h++)this.EI[h]==t&&(this.TI[h]=s+i)}LI(t){this.RI==t&&(this.RI=null,this.kI=!0)}UI(t,i,s){tt(this.RI==t);const h=this.DI[t.getType()];h&&h.fire(new class{constructor(t,i,s,h){this.type=t,this.data=i,this.time=s,this.event=h}}(t.getType(),i,Date.now(),s))}XI(t){let i=!!this.RI||this.kI;if(this.kI=!1,!i){const t=Date.now();for(let s=0;s<this.EI.length;s++)if(this.ui[s]||this.TI[s]&&this.TI[s]>=t){i=!0;break}}i?(t.stopPropagation(),this.VI||t.preventDefault()):this.xI&&t.stopPropagation(),this.OI&&(this.OI=!1,this.Ip())}Ip(){const t=Date.now();let i=-1;for(let s=0;s<this.EI.length;s++)this.ui[s]?(-1==i||this.ui[s]>this.ui[i])&&(i=s):this.TI[s]&&this.TI[s]<t&&this.f_(s);if(-1==i)return;let s=0;for(let i=0;i<this.EI.length;i++)!this.ui[i]&&this.h_[i]&&(s=Math.max(s,this.TI[i]-t));s<2?this.YI(i):this.be.schedule(s)}YI(t){const i=this.EI[t];for(let i=0;i<this.EI.length;i++)i!=t&&this.$I(i);this.ui[t]=0,this.TI[t]=0,this.RI=i,i.acceptStart()}p_(t){this.h_[t]=!0,this.TI[t]=0}f_(t){this.h_[t]=!1,this.TI[t]=0,this.ui[t]||this.EI[t].acceptCancel()}$I(t){this.ui[t]=0,this.f_(t)}},Mt=class{constructor(t,i){this.TT=t,this.E_=i}getType(){return this.TT}signalReady(t){this.E_.ny(this,t)}signalPending(t){this.E_.HI(this,t)}signalEnd(){this.E_.LI(this)}signalEmit(t,i){this.E_.UI(this,t,i)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}},Pt=function(){},vt=.02,bt=Math.round(-16.67/Math.log(.95));function Et(t,i,s){i<1&&(i=1);const h=t/i,n=.5+Math.min(i/33.34,.5);return h*n+s*(1-n)}function Tt(t,i,s,h,n,e,r){return new It(t,i,s,h,n,e,r).start()}var It=class{constructor(t,i,s,h,n,r,o){this.br=o||ut(self),this.wr=t,this.st=r,this.wV=i,this.EV=s,this.MC=h,this.dC=n,this.yV=0,this.xV=0;const a=new e;this.Cr=a.promise,this.Xs=a.resolve,this.kr=a.reject,this.mC=!1}start(){return this.mC=!0,Math.abs(this.MC)<=vt&&Math.abs(this.dC)<=vt?(this.EC(),this.vC(!0)):this.TC(),this}halt(){this.mC&&this.vC(!1)}then(t,i){return t||i?this.Cr.then(t,i):this.Cr}thenAlways(t){const i=t||Pt;return this.then(i,i)}TC(){this.yV=this.MC,this.xV=this.dC;const t=this.gC.bind(this),i=this.vC.bind(this,!0);return this.br.runAnimMutateSeries(this.wr,t,5e3).then(i,i)}gC(t,i){if(!this.mC)return!1;if(this.wV+=i*this.yV,this.EV+=i*this.xV,!this.EC())return!1;const s=Math.exp(-t/bt);return this.yV=this.MC*s,this.xV=this.dC*s,Math.abs(this.yV)>vt||Math.abs(this.xV)>vt}vC(t){this.mC&&(this.mC=!1,this.EC(),t?this.Xs():this.kr())}EC(){return this.st(this.wV,this.EV)}},yt=class extends Mt{constructor(t){super("tap",t),this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.o=null}onTouchStart(t){const{touches:i}=t;return this.o=t.target,!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,0))}onTouchMove(t){const i=t.changedTouches||t.touches;if(i&&1==i.length){this.wV=i[0].clientX,this.EV=i[0].clientY;const t=Math.abs(this.wV-this.MV)>=8,s=Math.abs(this.EV-this.bV)>=8;if(t||s)return!1}return!0}onTouchEnd(t){this.signalReady(0)}acceptStart(){this.signalEmit({clientX:this.wV,clientY:this.EV,target:this.o},null),this.signalEnd()}},Rt=class extends Mt{constructor(t){super("doubletap",t),this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.tz=0,this.sz=null}onTouchStart(t){if(this.tz>1)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,this.wV=i[0].clientX,this.EV=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){this.wV=i[0].clientX,this.EV=i[0].clientY;const t=Math.abs(this.wV-this.MV)>=8,s=Math.abs(this.EV-this.bV)>=8;return!t&&!s||(this.acceptCancel(),!1)}return!1}onTouchEnd(t){this.tz++,this.tz<2?this.signalPending(200):(this.sz=t,this.signalReady(0))}acceptStart(){this.tz=0,this.signalEmit({clientX:this.wV,clientY:this.EV},this.sz),this.signalEnd()}acceptCancel(){this.tz=0}},wt=class extends Mt{constructor(t,i,s,h){super(t,i),this.AV=s,this.PV=h,this.RI=!1,this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.TV=0,this.IV=0,this.hr=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){const{touches:i}=t;return!!(this.RI&&i&&i.length>1)||!(!i||1!=i.length)&&(this.hr=Date.now(),this.MV=i[0].clientX,this.bV=i[0].clientY,!0)}onTouchMove(t){const{touches:i}=t;if(i&&i.length>=1){const{clientX:s,clientY:h}=i[0];if(this.wV=s,this.EV=h,this.RI)this.kV(!1,!1,t);else{const t=Math.abs(s-this.MV),i=Math.abs(h-this.bV);if(this.AV&&this.PV)(t>=8||i>=8)&&this.signalReady(-10);else if(this.AV){if(t>=8&&t>i)this.signalReady(-10);else if(i>=8)return!1}else{if(!this.PV)return!1;if(i>=8&&i>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:i}=t;i&&0==i.length&&this.SV(t)}acceptStart(){this.RI=!0,this.TV=this.MV,this.IV=this.bV,this.VV=this.hr,this.MV=this.wV,this.bV=this.EV,this.kV(!0,!1,null)}acceptCancel(){this.RI=!1}kV(t,i,s){this.RV=Date.now();const h=this.RV-this.VV;if(!i&&h>4||i&&h>16){const t=Et(this.wV-this.TV,h,this.yV),s=Et(this.EV-this.IV,h,this.xV);(!i||h>32||0!=t||0!=s)&&(this.yV=Math.abs(t)>1e-4?t:0,this.xV=Math.abs(s)>1e-4?s:0),this.TV=this.wV,this.IV=this.EV,this.VV=this.RV}this.signalEmit({first:t,last:i,time:this.RV,deltaX:this.wV-this.MV,deltaY:this.EV-this.bV,startX:this.MV,startY:this.bV,lastX:this.wV,lastY:this.EV,velocityX:this.yV,velocityY:this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}},Vt=class extends wt{constructor(t){super("swipe-xy",t,!0,!0)}},xt=class extends Mt{constructor(t){super("tapzoom",t),this.RI=!1,this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.tz=0,this.TV=0,this.IV=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){if(this.RI)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.MV=i[0].clientX,this.bV=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){if(this.wV=i[0].clientX,this.EV=i[0].clientY,this.RI)this.kV(!1,!1,t);else{const t=Math.abs(this.wV-this.MV)>=8,i=Math.abs(this.EV-this.bV)>=8;if(t||i){if(0==this.tz)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1}onTouchEnd(t){this.RI?this.SV(t):(this.tz++,1!=this.tz?this.acceptCancel():this.signalPending(400))}acceptStart(){this.tz=0,this.RI=!0,this.kV(!0,!1,null)}acceptCancel(){this.tz=0,this.RI=!1}kV(t,i,s){this.RV=Date.now(),t?this.yV=this.xV=0:this.RV-this.VV>2&&(this.yV=Et(this.wV-this.TV,this.RV-this.VV,this.yV),this.xV=Et(this.EV-this.IV,this.RV-this.VV,this.xV)),this.TV=this.wV,this.IV=this.EV,this.VV=this.RV,this.signalEmit({first:t,last:i,centerClientX:this.MV,centerClientY:this.bV,deltaX:this.wV-this.MV,deltaY:this.EV-this.bV,velocityX:this.yV,velocityY:this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}},St=new Set(["amp-img","amp-anim","img"]),Dt=["aria-label","aria-describedby","aria-labelledby"],Ct=l(.4,0,.2,1),kt=l(.4,0,.2,1),Ot=l(.4,0,.2,1.4),Xt=class extends t.BaseElement{constructor(t){super(t),this.ID=-1,this.iD=!1,this.nX=!1,this.eX=null,this.WD=null,this.rX=null,this.cf=null,this.oX=null,this.aX=null,this.wD=this.RD.bind(this),this.registerDefaultAction((t=>this.s$(t)),"open")}buildCallback(){ot(this.element).addToAllowlist("AMP-IMAGE-LIGHTBOX","open",["email"])}cX(){if(this.cf)return;this.cf=this.element.ownerDocument.createElement("div"),this.cf.classList.add("i-amphtml-image-lightbox-container"),this.element.appendChild(this.cf),this.oX=new class{constructor(t,i,s){this.uX=t,this.win=i,this.wi=s,this.Ue=t.element.ownerDocument.createElement("div"),this.Ue.classList.add("i-amphtml-image-lightbox-viewer"),this.ZD=t.element.ownerDocument.createElement("img"),this.ZD.classList.add("i-amphtml-image-lightbox-viewer-image"),this.Ue.appendChild(this.ZD),this.ND=null,this.Ez=0,this.vz=0,this.lX=v(0,0,0,0),this.GD=v(0,0,0,0),this.Iz=1,this.Vz=1,this.LD=1,this.bz=1,this.wz=2,this.MV=0,this.bV=0,this.Sz=0,this.kz=0,this.Cz=0,this.Dz=0,this.Xz=0,this.Yz=0,this.Oz=null,this.eC()}getElement(){return this.Ue}getImage(){return this.ZD}getViewerBox(){return this.lX}getImageBox(){return this.GD}getImageBoxWithOffset(){return 0==this.Sz&&0==this.kz?this.GD:(t=this.GD,i=this.Sz,s=this.kz,0==i&&0==s||0==t.width&&0==t.height?t:v(t.left+i,t.top+s,t.width,t.height));var t,i,s}reset(){this.ZD.setAttribute("src",""),Dt.forEach((t=>{this.ZD.removeAttribute(t)})),this.ZD.removeAttribute("aria-describedby"),this.ND=null,this.GD=v(0,0,0,0),this.Ez=0,this.vz=0,this.LD=1,this.Iz=1,this.Vz=1,this.wz=2,this.MV=0,this.bV=0,this.Sz=0,this.kz=0,this.Cz=0,this.Dz=0,this.Xz=0,this.Yz=0,this.Oz&&this.Oz.halt(),this.Oz=null}JD(t,i){i?(this.Ez=i.naturalWidth||t.offsetWidth,this.vz=i.naturalHeight||t.offsetHeight):(this.Ez=t.offsetWidth,this.vz=t.offsetHeight)}init(t,i){this.JD(t,i),this.ND=function(t){const i=t.getAttribute("srcset");if(i)return function(t){const i=[];let s;for(;s=I.exec(t);){const t=s[1];let h,n;if(s[2]){const t=s[3].toLowerCase();if("w"==t)h=parseInt(s[2],10);else{if("x"!=t)continue;n=parseFloat(s[2])}}else n=1;i.push({url:t,width:h,dpr:n})}return new y(i)}(i);const s=t.getAttribute("src");return A(s,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new y([{url:s,width:void 0,dpr:1}])}(t),"img"===t.tagName.toLowerCase()?E(Dt,t,this.ZD):t.getImpl().then((t=>E(Dt,t.element,this.ZD))),i&&_t(i)&&i.src&&this.ZD.setAttribute("src",i.src)}measure(){this.lX=b(this.Ue.getBoundingClientRect());const t=this.Ez/this.vz;let i=Math.min(this.lX.width/t,this.lX.height),s=Math.min(this.lX.height*t,this.lX.width);Math.abs(s-this.Ez)<=16&&Math.abs(i-this.vz)<=16&&(s=this.Ez,i=this.vz),this.GD=v(Math.round((this.lX.width-s)/2),Math.round((this.lX.height-i)/2),Math.round(s),Math.round(i)),k(this.ZD,{top:O(this.GD.top),left:O(this.GD.left),width:O(this.GD.width),height:O(this.GD.height)});const h=this.lX.width/this.lX.height,n=Math.max(h/t,t/h);return this.wz=Math.max(2,n),this.Vz=this.Iz=1,this.MV=this.Sz=0,this.bV=this.kz=0,this.Lz(this.Iz),this.iC(),this.oM()}oM(){if(!this.ND)return n();this.LD=Math.max(this.LD,this.Iz);const t=this.GD.width*this.LD,i=this.ND.select(t,class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}}.getDevicePixelRatio());return i==this.ZD.getAttribute("src")?n():ct(this.win).promise(1).then((()=>(this.ZD.setAttribute("src",i),this.wi(this.ZD))))}eC(){const t=At.get(this.ZD);t.onGesture(yt,(()=>{this.uX.toggleViewMode()})),t.onGesture(Vt,(t=>{this.oC(t.data.deltaX,t.data.deltaY,!1),t.data.last&&this.fC(t.data.velocityX,t.data.velocityY)})),t.onPointerDown((()=>{this.Oz&&this.Oz.halt()})),t.onGesture(Rt,(t=>{let i;i=1==this.Iz?this.wz:this.bz;const s=this.lX.width/2-t.data.clientX,h=this.lX.height/2-t.data.clientY;this.RC(i,s,h,!0).then((()=>this.qz(0,0,0,0,0,0)))})),t.onGesture(xt,(t=>{this.fX(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY),t.data.last&&this.qz(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY,t.data.velocityY,t.data.velocityY)}))}AC(t,i){return B(t,this.bz,this.wz,i?.25:0)}Uz(t,i){return B(t,this.Cz,this.Xz,i&&this.Iz>1?.25*this.lX.width:0)}Wz(t,i){return B(t,this.Dz,this.Yz,i?.25*this.lX.height:0)}Lz(t){let i=0,s=0;const h=this.lX.height-this.GD.height*t;h>=0?s=i=0:(s=h/2,i=-s);let n=0,e=0;const r=this.lX.width-this.GD.width*t;r>=0?e=n=0:(e=r/2,n=-e),this.Cz=e,this.Dz=s,this.Xz=n,this.Yz=i}iC(){k(this.ZD,{transform:Y(this.Sz,this.kz)+" "+$(this.Iz)}),1!=this.Iz&&this.uX.toggleViewMode(!0)}oC(t,i,s){const h=this.Uz(this.MV+t,!0),n=this.Wz(this.bV+i,!0);this.Fz(this.Iz,h,n,s)}fC(t,i){const s=this.kz-this.bV;1==this.Iz&&Math.abs(s)>10?this.uX.close():(this.Oz=Tt(this.ZD,this.Sz,this.kz,t,i,((t,i)=>{const s=this.Uz(t,!0),h=this.Wz(i,!0);return!(Math.abs(s-this.Sz)<1&&Math.abs(h-this.kz)<1||(this.Fz(this.Iz,s,h,!1),0))})),this.Oz.thenAlways((()=>(this.Oz=null,this.uC()))))}fX(t,i,s,h){const n=G(s,h),e=Math.abs(h)>Math.abs(s)?Math.sign(h):Math.sign(-s);if(0==e)return;const r=this.Vz*(1+e*n/100),o=this.lX.width/2-t,a=this.lX.height/2-i;s=Math.min(o,o*(n/100)),h=Math.min(a,a*(n/100)),this.RC(r,s,h,!1)}RC(t,i,s,h){const n=this.AC(t,!0);if(n==this.Iz)return;this.Lz(n);const e=this.Uz(this.MV+i*n,!1),r=this.Wz(this.bV+s*n,!1);return this.Fz(n,e,r,h)}qz(t,i,s,h,e,r){let o;o=0==e&&0==r?n():Tt(this.ZD,s,h,e,r,((s,h)=>(this.fX(t,i,s,h),!0))).thenAlways();const a=this.Iz>this.Vz;return o.then((()=>this.uC())).then((()=>{a&&this.oM()}))}Fz(t,i,s,h){const e=t-this.Iz,r=(o=this.Sz,a=this.kz,G(i-o,s-a));var o,a;let c,u=0;if(h){const t=250;u=Math.min(t,Math.max(t*r*.01,t*Math.abs(e)))}if(u>16&&h){const h=L(this.Iz,t),n=L(this.Sz,i),e=L(this.kz,s);c=mt.animate(this.ZD,(t=>{this.Iz=h(t),this.Sz=n(t),this.kz=e(t),this.iC()}),u,Ot).thenAlways((()=>{this.Iz=t,this.Sz=i,this.kz=s,this.iC()}))}else this.Iz=t,this.Sz=i,this.kz=s,this.iC(),c=h?n():void 0;return c}uC(){const t=this.AC(this.Iz,!1);t!=this.Iz&&this.Lz(t);const i=this.Uz(this.Sz/this.Iz*t,!1),s=this.Wz(this.kz/this.Iz*t,!1);return this.Fz(t,i,s,!0).then((()=>{this.Vz=this.Iz,this.MV=this.Sz,this.bV=this.kz}))}}(this,this.win,this.loadPromise.bind(this)),this.cf.appendChild(this.oX.getElement()),this.aX=this.element.ownerDocument.createElement("div"),this.aX.setAttribute("id",this.element.getAttribute("id")+"-caption"),this.aX.classList.add("amp-image-lightbox-caption"),this.aX.classList.add("i-amphtml-image-lightbox-caption"),this.cf.appendChild(this.aX);const t=this.element.ownerDocument.createElement("button"),i=this.element.getAttribute("data-close-button-aria-label")||"Close the lightbox";t.textContent=i,t.classList.add("i-amphtml-screen-reader"),t.tabIndex=-1,t.addEventListener("click",(()=>{this.close()})),this.element.appendChild(t);const s=At.get(this.element);this.element.addEventListener("click",(t=>{this.nX||this.oX.getImage().contains(t.target)||this.close()})),s.onGesture(yt,(()=>{this.nX||this.close()})),s.onGesture(Vt,(()=>{}))}s$(t){if(this.iD)return;this.cX();const i=t.caller,s=i.tagName.toLowerCase();var h,n,e,r,o,a,c,u,l,f,m;h=i&&St.has(s),n="Unsupported element: %s",e=i.tagName,(q.user||(q.user=K()),void q.user.win?q.userForEmbed||(q.userForEmbed=K()):q.user).assert(h,n,e,r,o,a,c,u,l,f,m),this.iD=!0,this.Gs(),this.Cu(i),this.win.document.documentElement.addEventListener("keydown",this.wD),this.getViewport().enterLightboxMode(),this.Y_(),this.rX=this.getViewport().onChanged((()=>{var t;this.iD&&((t=this.win,it(t,"platform")).getIosVersionString().startsWith("10.3")?ct(this.win).delay((()=>{this.oX.measure()}),500):this.oX.measure())})),this.mX().push(this.close.bind(this)).then((t=>{this.ID=t}))}RD(t){"Escape"==t.key&&(t.preventDefault(),this.close())}close(){this.iD&&(this.iD=!1,this.nX=!1,this.U_(),this.rX&&(this.rX(),this.rX=null),this.getViewport().leaveLightboxMode(),-1!=this.ID&&this.mX().pop(this.ID),this.win.document.documentElement.removeEventListener("keydown",this.wD),this.eX&&function(t){try{t.focus()}catch(t){}}(this.eX))}toggleViewMode(t){void 0!==t?this.cf.classList.toggle("i-amphtml-image-lightbox-view-mode",t):this.cf.classList.toggle("i-amphtml-image-lightbox-view-mode")}Cu(t){var i;this.eX=t,this.WD=(i=t,P("img"),i.querySelector(function(t,i){return t.replace(/^|,/g,"$&:scope ")}("> img"))),this.oX.init(this.eX,this.WD);let s=null;const h=("figure",(n=t).closest?n.closest("figure"):function(t,i,s){let h;for(h=t;h&&void 0!==h;h=h.parentElement)if(i(h))return h;return null}(n,(t=>function(t,i){const s=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!s&&s.call(t,"figure")}(t))));var n;if(h&&(s=function(t,i){return P(i),t.querySelector(i)}(h,"figcaption")),!s){const i=t.getAttribute("aria-describedby");s=this.element.ownerDocument.getElementById(i)}s&&(function(t,i){const s=i.ownerDocument.createDocumentFragment();for(let i=t.firstChild;i;i=i.nextSibling)s.appendChild(i.cloneNode(!0));i.appendChild(s)}(s,this.aX),this.oX.getImage().setAttribute("aria-describedby",this.aX.getAttribute("id"))),this.aX.classList.toggle("i-amphtml-empty",!s)}Gs(){this.oX.reset(),function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.aX),this.eX=null,this.WD=null,this.toggleViewMode(!1)}Y_(){var t,i;this.nX=!0,t=this.element,void 0===(i=!0)&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden",""),k(this.element,{opacity:0}),this.oX.measure();const s=new mt(this.element);s.add(0,Z(this.element,{opacity:L(0,1)}),.6,Ct);let h=null;if(this.WD&&_t(this.WD)&&this.WD.src){h=this.element.ownerDocument.createElement("div"),h.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(h);const t=b(this.WD.getBoundingClientRect()),i=this.oX.getImageBox(),n=this.WD.cloneNode(!0);n.className="",k(n,{position:"absolute",top:O(t.top),left:O(t.left),width:O(t.width),height:O(t.height),transformOrigin:"top left",willChange:"transform"}),h.appendChild(n),this.WD.classList.add("i-amphtml-ghost");const e=i.left-t.left,r=i.top-t.top,o=0!=t.width?i.width/t.width:1,a=j(Math.abs(r)/250*.8,.2,.8);s.add(0,Z(n,{transform:z([N(L(0,e),L(0,r)),U(L(1,o))])}),a,Ct),k(this.cf,{opacity:0}),s.add(.8,Z(this.cf,{opacity:L(0,1)}),.1,Ct),s.add(.9,Z(h,{opacity:L(1,.01)}),.1,kt)}return s.start(500).thenAlways((()=>{this.nX=!1,k(this.element,{opacity:""}),k(this.cf,{opacity:""}),h&&this.getAmpDoc().getBody().removeChild(h)}))}U_(){const t=this.oX.getImage(),i=this.oX.getImageBoxWithOffset(),s=new mt(this.element);let h=500;s.add(0,Z(this.element,{opacity:L(1,0)}),.9,kt);let n=null;if(_t(t)&&t.src&&this.WD){n=this.element.ownerDocument.createElement("div"),n.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(n);const e=b(this.WD.getBoundingClientRect()),r=t.cloneNode(!0);k(r,{position:"absolute",top:O(i.top),left:O(i.left),width:O(i.width),height:O(i.height),transform:"",transformOrigin:"top left",willChange:"transform"}),n.appendChild(r),s.add(0,Z(this.cf,{opacity:L(1,0)}),.1,kt);const o=e.left-i.left,a=e.top-i.top,c=0!=i.width?e.width/i.width:1,u=Z(r,{transform:z([N(L(0,o),L(0,a)),U(L(1,c))])}),l=j(Math.abs(a)/250*.8,.2,.8);s.add(Math.min(.8-l,.2),((t,i)=>{u(t),i&&this.WD.classList.remove("i-amphtml-ghost")}),l,kt),s.add(.8,Z(n,{opacity:L(1,.01)}),.2,kt),h=j(Math.abs(a)/250*h,300,h)}return s.start(h).thenAlways((()=>{this.WD&&this.WD.classList.remove("i-amphtml-ghost"),this.collapse(),k(this.element,{opacity:""}),k(this.cf,{opacity:""}),n&&this.getAmpDoc().getBody().removeChild(n),this.Gs()}))}mX(){return at(this.getAmpDoc())}};t.registerElement("amp-image-lightbox",Xt,"amp-image-lightbox{position:fixed!important;top:0!important;left:0!important;bottom:0!important;right:0!important;margin:0!important;padding:0!important;overflow:hidden!important;transform:translateZ(0)!important;-ms-touch-action:none!important;touch-action:none!important;z-index:1000;background:rgba(0,0,0,0.95);color:#f2f2f2}.i-amphtml-image-lightbox-container{position:absolute;z-index:0;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-trans{pointer-events:none!important;position:fixed;z-index:1001;top:0;left:0;bottom:0;right:0}.i-amphtml-image-lightbox-caption{position:absolute!important;z-index:2;bottom:0!important;left:0!important;right:0!important}.i-amphtml-image-lightbox-caption.i-amphtml-empty,.i-amphtml-image-lightbox-view-mode .i-amphtml-image-lightbox-caption{visibility:hidden}.amp-image-lightbox-caption{background:rgba(0,0,0,0.5);max-height:25%;padding:8px}.i-amphtml-image-lightbox-viewer{position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-viewer-image{position:absolute;z-index:1;display:block;transform-origin:50% 50%}\n/*# sourceURL=/extensions/amp-image-lightbox/0.1/amp-image-lightbox.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-lightbox-0.1.mjs.map
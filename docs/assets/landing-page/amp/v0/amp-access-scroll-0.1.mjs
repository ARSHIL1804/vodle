;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-access-scroll",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function e(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var s=0;return function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var{hasOwnProperty:r,toString:s}=Object.prototype;function i(t){const n=Object.create(null);return t&&Object.assign(n,t),n}function o(t,n){return r.call(t,n)}function c(t,n,e){return function(t,n){for(const e in n)t.setAttribute(e,n[e]);return t}(t.createElement(n),e)}var l=self.AMP_CONFIG||{},a=("string"==typeof l.thirdPartyFrameRegex?new RegExp(l.thirdPartyFrameRegex):l.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,u=("string"==typeof l.cdnProxyRegex?new RegExp(l.cdnProxyRegex):l.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function h(t){if(!self.document||!self.document.head)return null;if(self.location&&u.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}var p={thirdParty:l.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:l.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:a,cdn:l.cdnUrl||h("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:u,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:l.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:l.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:l.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:l.geoApiUrl||h("amp-geo-api")},f=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function d(t,n=""){try{return decodeURIComponent(t)}catch(t){return n}}function m(t){const n=Object.getOwnPropertyDescriptor(t,"message");if(null!=n&&n.writable)return t;const{message:e,stack:r}=t,s=new Error(e);for(const n in t)s[n]=t[n];return s.stack=r,s}function g(t){let n=null,r="";for(var s,i=e(arguments,!0);!(s=i()).done;){const t=s.value;t instanceof Error&&!n?n=m(t):(r&&(r+=" "),r+=t)}return n?r&&(n.message=r+": "+n.message):n=new Error(r),n}function A(t,...n){const e=g.apply(null,n);e.name=t||e.name,function(t){var n,e;null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t)}(e)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var b=self.__AMP_LOG;function v(t){return function(t,n){throw new Error("failed to call initLogConstructor")}()}function R(t,n,e,r,s,i,o,c,l,a,u){return t}function _(t,n,e,r,s,i,o,c,l,a,u){return(b.user||(b.user=v()),void b.user.win?b.userForEmbed||(b.userForEmbed=v()):b.user).assert(t,n,e,r,s,i,o,c,l,a,u)}function w(t,n){return T(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function E(t,n){return T(P(I(t)),n)}function x(t,n){return function(t,n){const e=C(t,n);if(e)return e;const r=U(t);return r[n]=function(){const t=new class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}},{promise:n,reject:e,resolve:r}=t;return n.catch((()=>{})),{obj:null,promise:n,resolve:r,reject:e,context:null,ctor:null}}(),r[n].promise}(P(t),n)}function y(t,n){return C(P(t),n)}function I(t){return t.nodeType?(n=t,e=(n.ownerDocument||n).defaultView,w(e,"ampdoc")).getAmpDoc(t):t;var n,e}function P(t){const n=I(t);return n.isSingleDoc()?n.win:n}function T(t,n){R(function(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}(t,n));const e=U(t)[n];return e.obj||(R(e.ctor),R(e.context),e.obj=new e.ctor(e.context),R(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function C(t,n){const e=U(t)[n];return e?e.promise?e.promise:(T(t,n),e.promise=Promise.resolve(e.obj)):null}function U(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function L(t,n,e,r){return function(t,n,e,r){const s=y(t,n);if(s)return s;const i=I(t);return i.whenExtensionsKnown().then((()=>{const t=i.getExtensionVersion(e);return t?w(i.win,"extensions").waitForExtension(e,t):null})).then((e=>e?r?y(t,n):x(t,n):null))}(t,n,e,r).then((t=>function(t,n,e){return _(t,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",n,e,e,e)}(t,n,e)))}var k,D=t=>w(t,"extensions"),M=t=>E(t,"viewport"),O=t=>w(t,"xhr"),$=["Webkit","webkit","Moz","moz","ms","O","o"];function z(t,n,e,r,s){const o=function(t,n,e){if(n.startsWith("--"))return n;k||(k=i());let r=k[n];if(!r||e){if(r=n,void 0===t[n]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),s=function(t,n){for(let e=0;e<$.length;e++){const r=$[e]+n;if(void 0!==t[r])return r}return""}(t,e);void 0!==t[s]&&(r=s)}e||(k[n]=r)}return r}(t.style,n,s);if(!o)return;const c=r?e+r:e;t.style.setProperty(function(t){const n=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return $.some((t=>n.startsWith(t+"-")))?`-${n}`:n}(o),c)}var S=class{constructor(t){this.am=t,this.Adt=null,this.Su=null,this.Rdt=null,this.Ms={"width":null,"left":null,"right":null},this.window=new Promise((t=>{this.Adt=t}))}el(t,n,e){const r=c(this.am.win.document,t,n);return Array.isArray(e)&&e.forEach((t=>r.appendChild(t))),r}mount(){const t=R(this.Su);this.am.getBody().appendChild(t),M(this.am).addToFixedLayer(t)}mutate(t){var n;(n=this.am.win,w(n,"vsync")).mutate(t)}toggleClass(t,n){const e=R(this.Su).classList;n?e.add(t):e.remove(t)}toggleChecked(t){R(this.Su).checked=!!t}updateHorizontalLayout(t){let n=!1;return Object.keys(this.Ms).forEach((e=>{if(!o(t,e))return;const r=this.cssSize(t[e]);this.Ms[e]!==r&&(this.Ms[e]=r,n=!0)})),n}renderHorizontalLayout(){var t;!function(t,n){for(const e in n)z(t,e,n[e])}(R(this.Su),(t=this.Ms,"display"in t&&A("STYLE","`display` style detected. You must use toggle instead."),t))}cssSize(t){return"number"==typeof t?`${t}px`:t}};function j(t,n){return t.buildUrl(`${n}?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&p=1.2&x=QUERY_PARAM(scrollx)`,!1)}var N,V=class extends S{constructor(t,n){super(t),this.tR=n,this.Co()}Co(){this.mutate((()=>{this.Rdt||(this._dt(),this.Adt(this.Rdt.contentWindow)),this.renderHorizontalLayout()}))}_dt(){this.Rdt=this.el("iframe",{"scrolling":"no","frameborder":"0","allowtransparency":"true","title":"Twitter Blue bar","width":"100%","height":"100%","sandbox":"allow-scripts allow-same-origin allow-top-navigation allow-popups allow-popups-to-escape-sandbox"}),this.Su=this.el("div",{"class":"amp-access-scroll-bar"},[this.Rdt]),this.mount(),j(this.tR,(this.tR.getAdapterConfig(),"https://connect.scroll.com/html/amp/scrolltab")).then((t=>{this.Rdt.setAttribute("src",t)}))}update(t){this.updateHorizontalLayout(t)&&this.Co()}},H=class{constructor(t){this.wdt=[],this.Wf=[],this.h=t,this.N=this.N.bind(this),function(t,n,e,r){let s=t,i=e;const o=function(){if(void 0!==N)return N;N=!1;try{const t={get capture(){return N=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return N}();s.addEventListener("message",(t=>{try{return i(t)}catch(t){var n,e;throw null===(n=(e=self).__AMP_REPORT_ERROR)||void 0===n||n.call(e,t),t}}),!!o&&r)}(window,0,this.N,void 0)}N(t){const n=t.data,e=t.origin===this.h,r="object"==typeof n&&"_scramp"in n,s=this.wdt.indexOf(t.source)>-1;e&&s&&r&&(this.Wf.forEach((t=>t(n))),this.wdt.filter((n=>n!==t.source)).forEach((t=>{t.postMessage(n,this.h)})))}register(t,n){n&&this.Wf.push(n),Promise.resolve(t).then((t=>{-1===this.wdt.indexOf(t)&&this.wdt.push(t)}))}},F=class extends S{constructor(t){super(t),this.Edt="Scroll Feature",this.mi={url:"",open:!1,title:this.Edt}}update(t){let n=!1;switch(t._scramp){case"au":n=this.updateHorizontalLayout(t),["open","url","title"].forEach((e=>{o(t,e)&&t[e]!==this.mi[e]&&(this.mi[e]=t[e],n=!0)}));break;case"st":["revealed"].forEach((e=>{o(t,e)&&t[e]!==this.mi[e]&&(this.mi[e]=t[e],n=!0)}))}n&&this.Co(this.mi)}Co(t){this.mutate((()=>{var n,e;this.Rdt||(this._dt(),this.Adt(this.Rdt.contentWindow)),this.Rdt.src!==t.url&&this.Rdt.setAttribute("src",t.url),this.renderHorizontalLayout(),this.Rdt.setAttribute("title",t.title),n=this.Rdt,void 0===(e=t.open)&&(e=n.hasAttribute("hidden")),e?n.removeAttribute("hidden"):n.setAttribute("hidden","")}))}_dt(){this.Rdt=this.el("iframe",{"class":"amp-access-scroll-sheet","scrolling":"no","frameborder":"0","allowtransparency":"true","title":this.Edt,"sandbox":"allow-scripts allow-same-origin allow-top-navigation allow-popups allow-popups-to-escape-sandbox"}),this.Su=this.Rdt,this.mount()}};function Y(t,n,e){if(n[e])return n[e];const r=t.querySelector(`style[${e}], link[${e}]`);return r?(n[e]=r,r):null}function Q(t,n){const e=t.styleSheets;for(let t=0;t<e.length;t++)if(e[t].ownerNode==n)return!0;return!1}new Set(["c","v","a","ad"]);var q,B=t=>"string"==typeof t?function(t,n){return q||(q=self.document.createElement("a")),function(t,n,e){return t.href="",new URL(n,t.href)}(q,t)}(t):t;function J(t,n,e="source"){var r;return _(null!=t,"%s %s must be available",n,e),_("https:"==(r=B(r=t)).protocol||"localhost"==r.hostname||"127.0.0.1"==r.hostname||function(t,n){const e=t.length-n.length;return e>=0&&t.indexOf(n,e)==e}(r.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,e,t),t}var Z=class{static shouldCheck(t){return!function(t){const n=i();if(!t)return n;let e;for(;e=f.exec(t);){const t=d(e[1],e[1]),r=e[2]?d(e[2].replace(/\+/g," "),e[2]):"";n[t]=r}return n}(t.win.location.search).scrollnoblockerrefresh}constructor(t,n,e){this.Ci=t,this.tR=n,this.Idt=e}check(){O(this.Ci.win).fetchJson("https://block.scroll.com/check.json").then((t=>t.json().then((t=>!0===t.dns))),(t=>this.Pdt(t.message))).then((t=>{!0===t&&this.Tdt()}))}Tdt(){if(this.Idt&&(t=this.Ci.win.location,!p.cdnProxyRegex.test(B(t).origin)))j(this.tR,"https://scroll.com/loginwithapp").then((t=>{var n;(n=this.Ci,E(n,"navigation")).navigateTo(this.Ci.win,function(t,n,e,r){return function(t,n,e){if(!n)return t;const r=t.split("#",2),s=r[0].split("?",2);let i=s[0]+(s[1]?`?${s[1]}&${n}`:`?${n}`);return i+=r[1]?`#${r[1]}`:"",i}(t,`${encodeURIComponent("feature")}=${encodeURIComponent("r")}`)}(t))}));else{const t=(this.tR.getAdapterConfig(),"https://connect.scroll.com"),n=new V(this.Ci,this.tR);new H(t).register(n.window,(t=>{"st"===t._scramp&&n.update(t)}))}var t}Pdt(t){return 0===t.indexOf("XHR Failed fetching (https://block.scroll.com/...): Resource blocked by content blocker")}};t.registerServiceForDoc("scroll",(function(t){return(t=>L(t,"access","amp-access"))(t.getHeadNode()).then((n=>{const e=n.getVendorSource("scroll"),r=new class extends class{constructor(t,n,e){this.ampdoc=t,this.Xa=e,this.Cdt=_(n.authorization,'"authorization" URL must be specified'),J(this.Cdt,'"authorization"'),this.Udt=!n.noPingback,this.Ldt=n.pingback,this.Udt&&(_(this.Ldt,'"pingback" URL must be specified'),J(this.Ldt,'"pingback"')),this.kdt=this.Ddt(n),this.eR=O(t.win),this.Ee=T(t.win,"timer")}Ddt(t){if(!t.authorizationTimeout)return 3e3;let n=t.authorizationTimeout;return _("number"==typeof n,'"authorizationTimeout" must be a number'),n=Math.min(n,3e3),n}getConfig(){return{"authorizationUrl":this.Cdt,"pingbackEnabled":this.Udt,"pingbackUrl":this.Ldt,"authorizationTimeout":this.kdt}}getAuthorizationUrl(){return this.Cdt}isAuthorizationEnabled(){return!0}getAuthorizationTimeout(){return this.kdt}authorize(){return this.Xa.buildUrl(this.Cdt,!1).then((t=>this.Ee.timeoutPromise(this.kdt,this.eR.fetchJson(t,{credentials:"include"})).then((t=>t.json()))))}isPingbackEnabled(){return this.Udt}pingback(){return this.Xa.buildUrl(R(this.Ldt),!0).then((t=>this.eR.sendSignal(t,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:""})))}postAction(){}}{constructor(t,n){n.getAdapterConfig();const e="https://connect.scroll.com";super(t,(t=>({"authorization":`${t}/amp/access?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&x=QUERY_PARAM(scrollx)&p=1.2`,"pingback":`${t}/amp/pingback?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll)&v=AUTHDATA(visitId)&p=1.2`,"namespace":"scroll"}))(e),{buildUrl:n.buildUrl.bind(n),collectUrlVars:n.collectUrlVars.bind(n)}),function(t,n,e,r,s){const o=t.getHeadNode(),c=function(t,n,e,r){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=i());const o=`amp-extension=${r}`;if(o){const e=Y(t,s,o);if(e)return"STYLE"==e.tagName&&e.textContent!==n&&(e.textContent=n),e}const c=(t.ownerDocument||t).createElement("style");c.textContent=n;let l=null;return c.setAttribute("amp-extension",r),l=Y(t,s,"amp-runtime"),function(t,n,e=null){if(!e)return void function(t,n){t.insertBefore(n,t.firstChild)}(t,n);const r=e.nextSibling;t.insertBefore(n,r)}(t,c,l),o&&(s[o]=c),c}(o,function(t,n){const e=t.__AMP_CSS_TR;return e?e(n):n}(o,".amp-access-scroll-bar{bottom:0;height:60px;left:auto;right:0px;width:48px;margin:0;padding:0}.amp-access-scroll-bar,.amp-access-scroll-sheet{position:fixed;background:transparent;z-index:2147483647}@media (max-width:599px){.amp-access-scroll-sheet{bottom:60px;height:100px;left:0!important;right:0!important;width:100%!important}}@media (min-width:600px){.amp-access-scroll-sheet{bottom:76px;height:56px;left:auto;right:16px;width:475px}}\n/*# sourceURL=/extensions/amp-access-scroll/0.1/amp-access-scroll.css*/"),0,"amp-access-scroll-elt");if(e){const n=t.getRootNode();if(Q(n,c))return c;const e=setInterval((()=>{Q(n,c)&&clearInterval(e)}),4)}}(t,0,(()=>{})),this.tR=n,this.iP=e}authorize(){return super.authorize().then((t=>{const n=this.ampdoc.getRootNode().querySelector("amp-story[standalone]");if(t&&t.scroll){if(!n){const n=new V(this.ampdoc,this.tR),e=new F(this.ampdoc),r=new H(this.iP);r.register(e.window,(t=>{"au"!==t._scramp&&"st"!==t._scramp||e.update(t)})),r.register(n.window,(t=>{"st"===t._scramp&&(e.update(t),n.update(t))}));const s=this.tR.getAdapterConfig();!function(t,n){if(n.disableAnalytics)return;const e=t.win.document,r={"trigger":"immediate"};n.dataConsentId&&(r["data-block-on-consent"]="");const s=c(e,"amp-analytics",r),i=c(e,"script",{"type":"application/json"}),o={"requests":{"scroll":"https://connect.scroll.com/amp/analytics?rid=ACCESS_READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&r=DOCUMENT_REFERRER&x=QUERY_PARAM(scrollx)&d=AUTHDATA(scroll.scroll)&v=AUTHDATA(scroll.visitId)&h=SOURCE_HOSTNAME&s=${totalEngagedTime}&p=1.2"},"triggers":{"trackInterval":{"on":"timer","timerSpec":{"interval":15,"maxTimerLength":7200},"request":"scroll"}}};i.textContent=JSON.stringify(o),s.appendChild(i),s.CONFIG=o,D(t.win).installExtensionForDoc(t,"amp-analytics"),t.getBody().appendChild(s)}(this.ampdoc,s),t.features&&t.features.d&&new class{constructor(t,n,e){this.Ci=t,this.Mdt=null,this.tR=n,this.Odt=e;const r=function(t,n,e){let r=0,s=0,i=null;function o(){r=0;const e=1e3-(t.Date.now()-s);var c;e>0?r=t.setTimeout(o,e):(c=i,i=null,n.apply(null,c))}return function(...n){s=t.Date.now(),i=n,r||(r=t.setTimeout(o,1e3))}}(t.win,this.$dt.bind(this));this.bn=M(t),this.zdt=[],t.whenReady().then((()=>{this.bn.onChanged(r),this.zdt=t.getBody().getElementsByTagName("p")}))}$dt(){return Promise.all([].slice.call(this.zdt).map((t=>this.bn.getClientRectAsync(t)))).then((t=>{let n=null,e=null;for(let r=t.length-1;r>=0;r--){const s=t[r].bottom;s<=0&&(null===e||e<s)&&(n=r,e=s)}null!==n&&this.Sdt(n)}))}Sdt(t){this.Mdt!==t&&(this.Mdt=t,this.jdt(this.zdt[t].innerText.substring(0,50)))}jdt(t){this.tR.buildUrl(`${this.Odt}/amp/updatedepth?rid=READER_ID&cid=CLIENT_ID(scroll1)&c=CANONICAL_URL&o=AMPDOC_URL&rd=`+encodeURIComponent(t),!1).then((t=>{O(this.Ci.win).fetch(t)}))}}(this.ampdoc,this.tR,"https://connect.scroll.com")}}else t&&t.blocker&&Z.shouldCheck(this.ampdoc)&&new Z(this.ampdoc,this.tR,t.features&&t.features.r).check();return t}))}}(t,e);return e.getAdapter().registerVendor(r),r}))}))})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-access-scroll-0.1.mjs.map
;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-analytics",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,s=new Array(i);e<i;e++)s[e]=t[e];return s}function e(t,e){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return(s=s.call(t)).next.bind(s);if(Array.isArray(t)||(s=function(t,e){if(t){if("string"==typeof t)return i(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){s&&(t=s);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s;function n(){return s||(s=Promise.resolve(void 0))}var r=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:o}=Array;function h(t,i){for(let e=0;e<t.length;e++)if(i(t[e],e,t))return e;return-1}function u(t,i){const e=t.length-i.length;return e>=0&&t.indexOf(i,e)==e}function c(t,i,e){const s=e||1;for(let e=0;e<s;e++){let e=0;if(t=t.replace(/\${([^}]*)}/g,((t,s)=>(e++,i(s)))),!e)break}return t}var{hasOwnProperty:a,toString:l}=Object.prototype;function f(t){return"[object Object]"===l.call(t)}function d(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function _(t,i){return a.call(t,i)}function m(t,i,e=10){const s=[],n=[];for(n.push({t:t,s:i,d:0});n.length>0;){const{d:t,s:i,t:h}=n.shift();if(s.includes(i))throw new Error("Source object has a circular reference.");if(s.push(i),h!==i)if(t>e)Object.assign(h,i);else for(var r=0,o=Object.keys(i);r<o.length;r++){const e=o[r],s=i[e];if(_(h,e)){const i=h[e];if(f(s)&&f(i)){n.push({t:i,s:s,d:t+1});continue}}h[e]=s}}return t}function A(t){return"number"==typeof t&&isFinite(t)}function p(t,i,e,s,n,r,o,h,u,c,a){return t}function P(t){return JSON.parse(t)}function E(t,i){try{return P(t)}catch(t){return null==i||i(t),null}}function T(t){return(t.ownerDocument||t).defaultView}function g(t,i){return t.replace(/^|,/g,`$&${i} `)}function v(t,i){const e=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!e&&e.call(t,i)}function I(t,i){return t.closest?t.closest(i):function(t,i,e){let s;for(s=t;s&&void 0!==s;s=s.parentElement)if(i(s))return s;return null}(t,(t=>v(t,i)))}function R(t,i,e){return function(t,i){for(const e in i)t.setAttribute(e,i[e]);return t}(t.createElement(i),e)}function M(t,i,e){const s=i||(t=>t),{dataset:n}=t,r={},o=e||/^param(.+)/;for(const t in n){const i=t.match(o);i&&(r[s(i[1][0].toLowerCase()+i[1].substr(1))]=n[t])}return r}function b(t){return t.parent&&t.parent!=t}function y(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:e,stack:s}=t,n=new Error(e);for(const i in t)n[i]=t[i];return n.stack=s,n}function S(t){let i=null,s="";for(var n,r=e(arguments,!0);!(n=r()).done;){const t=n.value;t instanceof Error&&!i?i=y(t):(s&&(s+=" "),s+=t)}return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function w(t){var i,e;null===(i=(e=self).__AMP_REPORT_ERROR)||void 0===i||i.call(e,t)}function V(t){const i=S.apply(null,arguments);setTimeout((()=>{throw w(i),i}))}var O=self.AMP_CONFIG||{},N=("string"==typeof O.thirdPartyFrameRegex?new RegExp(O.thirdPartyFrameRegex):O.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,C=("string"==typeof O.cdnProxyRegex?new RegExp(O.cdnProxyRegex):O.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function k(t){if(!self.document||!self.document.head)return null;if(self.location&&C.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}var D={thirdParty:O.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:O.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:N,cdn:O.cdnUrl||k("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:C,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:O.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:O.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:O.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:O.geoApiUrl||k("amp-geo-api")},L=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function x(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function U(t){const i=d();if(!t)return i;let e;for(;e=L.exec(t);){const t=x(e[1],e[1]),s=e[2]?x(e[2].replace(/\+/g," "),e[2]):"";i[t]=s}return i}function H(t){const{location:i}=t||self;return U(i.originalHash||i.hash)}var j="";function F(t){const i=t||self;return i.__AMP_MODE?i.__AMP_MODE:i.__AMP_MODE=function(t){return{localDev:!1,development:q(t,H(t)),esm:!0,test:!1,rtvVersion:$(t)}}(i)}function $(t){var i;return j||(j=(null===(i=t.AMP_CONFIG)||void 0===i?void 0:i.v)||"012203281422000"),j}function q(t,i){const e=i||H(t);return["1","actions","amp","amp4ads","amp4email"].includes(e.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var B=self.__AMP_LOG;function W(t,i){throw new Error("failed to call initLogConstructor")}function G(t){return B.user||(B.user=z()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(B.user.win,t)?B.userForEmbed||(B.userForEmbed=z()):B.user}function z(t){return W()}function Y(){return B.dev||(B.dev=W())}function K(t,i,e,s,n,r,o,h,u,c,a){return t}function J(t,i,e,s,n,r,o,h,u,c,a){return G().assert(t,i,e,s,n,r,o,h,u,c,a)}function X(t,i){return ot(t=et(t),i)}function Z(t,i){return ot(rt(nt(t)),i)}function Q(t,i){const e=rt(nt(t));return at(e,i)?ot(e,i):null}function tt(t,i){return function(t,i){const e=ut(t,i);if(e)return e;const s=ct(t);return s[i]=function(){const t=new r,{promise:i,reject:e,resolve:s}=t;return i.catch((()=>{})),{obj:null,promise:i,resolve:s,reject:e,context:null,ctor:null}}(),s[i].promise}(rt(t),i)}function it(t,i){return ut(rt(t),i)}function et(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}function st(t,i){const e=(t.ownerDocument||t).defaultView,s=i||et(e);if(e&&e!=s&&et(e)==s)try{return e.frameElement}catch(t){}return null}function nt(t){return t.nodeType?(i=T(t),X(i,"ampdoc")).getAmpDoc(t):t;var i}function rt(t){const i=nt(t);return i.isSingleDoc()?i.win:i}function ot(t,i){K(at(t,i));const e=ct(t)[i];return e.obj||(K(e.ctor),K(e.context),e.obj=new e.ctor(e.context),K(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function ht(t,i,e,s,n,r){const o=ct(t);let h=o[e];h||(h=o[e]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:r||!1}),!n&&h.ctor||(h.ctor=s,h.context=i,h.sharedInstance=r||!1,h.resolve&&ot(t,e))}function ut(t,i){const e=ct(t)[i];return e?e.promise?e.promise:(ot(t,i),e.promise=Promise.resolve(e.obj)):null}function ct(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function at(t,i){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!e||!e.ctor)}function lt(t,i,e,s){const n=it(t,i);if(n)return n;const r=nt(t);return r.whenExtensionsKnown().then((()=>{const t=r.getExtensionVersion(e);return t?X(r.win,"extensions").waitForExtension(e,t):null})).then((e=>e?s?it(t,i):tt(t,i):null))}var ft,dt=t=>nt(t),_t=t=>function(t,i,e){const s=Q(t,i);return s?Promise.resolve(s):lt(t,i,e)}(t,"amp-script","amp-script"),mt=t=>X(t,"crypto"),At=t=>X(t,"performance"),pt=t=>X(t,"preconnect"),Pt=t=>ot(t,"timer"),Et=t=>Q(t,"url-replace"),Tt=t=>function(t,i,e,s){return lt(t,i,e,s).then((t=>function(t,i,e){return J(t,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",i,e,e,e)}(t,i,e)))}(t,"userNotificationManager","amp-user-notification"),gt=t=>lt(t,"consentPolicyManager","amp-consent"),vt=t=>Q(t,"url"),It=t=>Z(t,"viewport"),Rt=t=>X(t,"xhr");function Mt(t,i,e,s){let n=t,r=e,o=t=>{try{return r(t)}catch(t){var i,e;throw null===(i=(e=self).__AMP_REPORT_ERROR)||void 0===i||i.call(e,t),t}};const h=function(){if(void 0!==ft)return ft;ft=!1;try{const t={get capture(){return ft=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return ft}(),u=!(null==s||!s.capture);return n.addEventListener(i,o,h?s:u),()=>{null==n||n.removeEventListener(i,o,h?s:u),r=null,n=null,o=null}}function bt(t,i,e,s){return Mt(t,i,e,s)}function yt(t){return t.data}function St(t,i,e,s){let n=e;const r=Mt(t,i,(t=>{try{n(t)}finally{n=null,r()}}),s);return r}function wt(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}var Vt="active";function Ot(t,i){let e=0;return t.type===Vt&&(e=5),Math.min(i-t.time,e)}var Nt=["mousedown","mouseup","mousemove","keydown","keyup"],Ct=["mouseleave"];function kt(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function Dt(t,i){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);i&&(s=s.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),e.push.apply(e,s)}return e}function Lt(t){for(var i=1;i<arguments.length;i++){var e=null!=arguments[i]?arguments[i]:{};i%2?Dt(Object(e),!0).forEach((function(i){kt(t,i,e[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):Dt(Object(e)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(e,i))}))}return t}var xt="__AMP__EXPERIMENT_TOGGLES",Ut=JSON.parse('{"transport":{"beacon":true,"xhrpost":true,"image":true},"vars":{"accessReaderId":"ACCESS_READER_ID","ampGeo":"AMP_GEO","ampState":"AMP_STATE","ampVersion":"AMP_VERSION","ampdocHost":"AMPDOC_HOST","ampdocHostname":"AMPDOC_HOSTNAME","ampdocMeta":"AMPDOC_META","ampdocUrl":"AMPDOC_URL","authdata":"AUTHDATA","availableScreenHeight":"AVAILABLE_SCREEN_HEIGHT","availableScreenWidth":"AVAILABLE_SCREEN_WIDTH","backgroundState":"BACKGROUND_STATE","browserLanguage":"BROWSER_LANGUAGE","canonicalHost":"CANONICAL_HOST","canonicalHostname":"CANONICAL_HOSTNAME","canonicalPath":"CANONICAL_PATH","canonicalUrl":"CANONICAL_URL","clientId":"CLIENT_ID","consentState":"CONSENT_STATE","consentString":"CONSENT_STRING","contentLoadTime":"CONTENT_LOAD_TIME","cookie":"COOKIE","counter":"COUNTER","cumulativeLayoutShift":"CUMULATIVE_LAYOUT_SHIFT","documentCharset":"DOCUMENT_CHARSET","documentReferrer":"DOCUMENT_REFERRER","domInteractiveTime":"DOM_INTERACTIVE_TIME","domainLookupTime":"DOMAIN_LOOKUP_TIME","experimentBranches":"EXPERIMENT_BRANCHES","externalReferrer":"EXTERNAL_REFERRER","firstContentfulPaint":"FIRST_CONTENTFUL_PAINT","firstInputDelay":"FIRST_INPUT_DELAY","firstViewportReady":"FIRST_VIEWPORT_READY","fragmentParam":"FRAGMENT_PARAM","htmlAttr":"HTML_ATTR","incrementalEngagedTime":"INCREMENTAL_ENGAGED_TIME","largestContentfulPaint":"LARGEST_CONTENTFUL_PAINT","makeBodyVisible":"MAKE_BODY_VISIBLE","navRedirectCount":"NAV_REDIRECT_COUNT","navTiming":"NAV_TIMING","navType":"NAV_TYPE","pageDownloadTime":"PAGE_DOWNLOAD_TIME","pageLoadTime":"PAGE_LOAD_TIME","pageViewId":"PAGE_VIEW_ID","pageViewId64":"PAGE_VIEW_ID_64","queryParam":"QUERY_PARAM","random":"RANDOM","redirectTime":"REDIRECT_TIME","resourceTiming":"RESOURCE_TIMING","screenColorDepth":"SCREEN_COLOR_DEPTH","screenHeight":"SCREEN_HEIGHT","screenWidth":"SCREEN_WIDTH","scrollHeight":"SCROLL_HEIGHT","scrollLeft":"SCROLL_LEFT","scrollTop":"SCROLL_TOP","scrollWidth":"SCROLL_WIDTH","sessionId":"SESSION_ID","sessionCount":"SESSION_COUNT","sessionEngaged":"SESSION_ENGAGED","sessionEventTimestamp":"SESSION_EVENT_TIMESTAMP","sessionTimestamp":"SESSION_TIMESTAMP","serverResponseTime":"SERVER_RESPONSE_TIME","sourceHost":"SOURCE_HOST","sourceHostname":"SOURCE_HOSTNAME","sourcePath":"SOURCE_PATH","sourceUrl":"SOURCE_URL","tcpConnectTime":"TCP_CONNECT_TIME","timestamp":"TIMESTAMP","timezone":"TIMEZONE","timezoneCode":"TIMEZONE_CODE","title":"TITLE","totalEngagedTime":"TOTAL_ENGAGED_TIME","uach":"UACH","userAgent":"USER_AGENT","viewer":"VIEWER","viewportHeight":"VIEWPORT_HEIGHT","viewportWidth":"VIEWPORT_WIDTH"}}');function Ht(t){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(t):jt(unescape(encodeURIComponent(t)))}function jt(t){const i=new Uint8Array(t.length);for(let e=0;e<t.length;e++){const s=t.charCodeAt(e);p(s<=255),i[e]=s}return i}function Ft(t){const i=new Array(t.length);for(let e=0;e<t.length;e++)i[e]=String.fromCharCode(t[e]);return i.join("")}var $t={"-":"+","_":"/",".":"="},qt={"+":"-","/":"_","=":"."};function Bt(t){return function(t){const i=Ft(t);return btoa(i).replace(/[+/=]/g,(t=>qt[t]))}(Ht(t))}var Wt,Gt=new Set(["c","v","a","ad"]),zt=t=>"string"==typeof t?Yt(t):t;function Yt(t,i){return Wt||(Wt=self.document.createElement("a")),function(t,i,e){return t.href="",new URL(i,t.href)}(Wt,t)}function Kt(t,i,e){if(!i)return t;const s=t.split("#",2),n=s[0].split("?",2);let r=n[0]+(n[1]?e?`?${i}&${n[1]}`:`?${n[1]}&${i}`:`?${i}`);return r+=s[1]?`#${s[1]}`:"",r}function Jt(t,i){return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`}function Xt(t){const i=[];for(const s in t){let n=t[s];if(null!=n){n=o(e=n)?e:[e];for(let t=0;t<n.length;t++)i.push(Jt(s,n[t]))}}var e;return i.join("&")}function Zt(t,i,e="source"){var s;return J(null!=t,"%s %s must be available",i,e),J("https:"==(s=zt(s=t)).protocol||"localhost"==s.hostname||"127.0.0.1"==s.hostname||u(s.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',i,e,t),t}function Qt(t){return D.cdnProxyRegex.test(zt(t).origin)}function ti(t,i){if(!t||"?"==t)return"";const e=new RegExp(`[?&]${i}\\b[^&]*`,"g"),s=t.replace(e,"").replace(/^[?&]/,"");return s?"?"+s:""}var ii,ei="-test-amp-cookie-tmp",si="None";function ni(t,i){const e=function(t){try{return t.document.cookie}catch(t){return""}}(t);if(!e)return null;const s=e.split(";");for(let t=0;t<s.length;t++){const e=s[t].trim(),n=e.indexOf("=");if(-1!=n&&x(e.substring(0,n).trim())==i){const t=e.substring(n+1).trim();return x(t,t)}}return null}function ri(t){const i=t.document.head&&t.document.head.querySelector("meta[name='amp-cookie-scope']");if(i){const e=i.getAttribute("content")||"",s=Yt(function(t){if(!Qt(t=zt(t)))return t.href;const i=t.pathname.split("/"),e=i[1];J(Gt.has(e),"Unknown path prefix in url %s",t.href);const s=i[2],n="s"==s?"https://"+decodeURIComponent(i[3]):"http://"+decodeURIComponent(s);return J(n.indexOf(".")>0,"Expected a . in origin %s",n),i.splice(1,"s"==s?3:2),n+i.join("/")+ti(t.search,"(amp_(js[^&=]*|gsa|r|kit)|usqp)")+(t.hash||"")}(t.location.href)).origin;return u(s,"."+e)?e:s.split("://")[1]}if(!Qt(t.location.href)){const i=t.location.hostname.split(".");let e=i[i.length-1];const s=function(t){let i=ei;for(;ni(t,i);)i=ei+0;return i}(t);for(let n=i.length-2;n>=0;n--)if(e=i[n]+"."+e,oi(t,s,"delete",Date.now()+1e3,e),"delete"==ni(t,s))return oi(t,s,"delete",Date.now()-1e3,e),e}return null}function oi(t,i,e,s,n,r,o){"ampproject.org"==n&&(e="delete",s=0);const h=encodeURIComponent(i)+"="+encodeURIComponent(e)+"; path=/"+(n?"; domain="+n:"")+"; expires="+new Date(s).toUTCString()+function(t,i){return i?`; SameSite=${i}`:""}(0,r)+(o?"; Secure":"");try{t.document.cookie=h}catch(t){}}function hi(t){return"string"==typeof t&&t.startsWith("amp-")&&-1!=t.indexOf("{")}var ui=["Webkit","webkit","Moz","moz","ms","O","o"],ci={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function ai(t,i,e){if(i.startsWith("--"))return i;ii||(ii=d());let s=ii[i];if(!s||e){if(s=i,void 0===t[i]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let e=0;e<ui.length;e++){const s=ui[e]+i;if(void 0!==t[s])return s}return""}(t,e);void 0!==t[n]&&(s=n)}e||(ii[i]=s)}return s}function li(t,i,e,s,n){const r=ai(t.style,i,n);if(!r)return;const o=s?e+s:e;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return ui.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(r),o)}function fi(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}var di="unlisten";function _i(t,i,e){const s=function(t,i){let{listeningFors:e}=t;return!e&&i&&(e=t.listeningFors=Object.create(null)),e||null}(t,e);if(!s)return s;let n=s[i];return!n&&e&&(n=s[i]=[]),n||null}function mi(t,i){for(let e=i;e&&e!=e.parent;e=e.parent)if(e==t)return!0;return!1}function Ai(t){const i={"sentinel":di};for(let e=t.length-1;e>=0;e--){const s=t[e];if(!s.frame.contentWindow){t.splice(e,1);const{events:n}=s;for(const t in n)n[t].splice(0,1/0).forEach((t=>{t(i)}))}}}function pi(t,i){return i?t.getAttribute("data-amp-3p-sentinel"):"amp"}function Pi(t){return t.__AMP_EMBED__}function Ei(t){return t.classList.contains("i-amphtml-fie")||!!I(t,".i-amphtml-fie")}function Ti(t,i){return!(Ei(i)||Qt(t.location)||"inabox"==F(t).runtime)}var gi=class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}},vi=null,Ii="*",Ri=/^[a-zA-Z0-9\-_.]+$/,Mi="amp-analytics/linker";function bi(t,i){const e=(s=i)?Object.keys(s).filter((t=>{const i=Ri.test(t);return i||G().error(Mi,"Invalid linker key: "+t),i})).map((t=>{return t+Ii+(i=s[t],Bt(String(i)));var i})).join(Ii):"";var s;return""===e?"":[t,yi(e),e].join(Ii)}function yi(t,i){const e=i||0;return function(t){vi||(vi=function(){const t=new Array(256);for(let i=0;i<256;i++){let e=i;for(let t=0;t<8;t++)1&e?e=e>>>1^3988292384:e>>>=1;t[i]=e}return t}());const i=Ht(t);let e=-1>>>0;for(let t=0;t<i.length;t++){const s=255&(e^i[t]);e=e>>>8^vi[s]}return(-1^e)>>>0}([function(){const t=(new Date).getTimezoneOffset(),i=gi.getUserLanguage(window);return[gi.getUserAgent(window),t,i].join(Ii)}(),Math.floor(Date.now()/6e4)-e,t].join(Ii)).toString(36)}function Si(t){return function(t){const i=function(t){return jt(atob(t.replace(/[-_.]/g,(t=>$t[t]))))}(t);return function(t){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf-8").decode(t);const i=Ft(new Uint8Array(t.buffer||t));return decodeURIComponent(escape(i))}(i)}(String(t))}var wi="visible",Vi="amp-analytics/session-manager",Oi="sessionId",Ni="creationTimestamp",Ci="accessTimestamp",ki="engaged",Di="eventTimestamp",Li="count";function xi(t){return t.accessTimestamp+18e5<Date.now()}function Ui(t){return"amp-session:"+t}function Hi(t,i=1){return{[Oi]:Math.round(1e4*Math.random()),[Ni]:Date.now(),[Ci]:Date.now(),[Li]:i,[Di]:void 0,[ki]:t}}function ji(t){return tt(t,"amp-analytics-session")}function Fi(t,i="default"){return gt(t).then((t=>t?t.getConsentStringInfo(i):null))}var $i="amp-analytics/variables",qi=/^(?:([^\s]*)(\([^)]*\))|[^]+)$/,Bi={1:"sufficient",2:"insufficient",3:"not_required",4:"unknown"},Wi=class{constructor(t,i,e){this.vars=t,this.iterations=void 0===i?2:i,this.noEncode=!!e,this.freezeVars={}}freezeVar(t){this.freezeVars[t]=!0}getVar(t){let i=this.vars[t];return null==i&&(i=""),i}};function Gi(t,i,e){const s=Number(i);let{length:n}=t;return J(A(s),"Start index "+s+"in substr macro should be a number"),e&&(n=Number(e),J(A(n),"Length "+n+" in substr macro should be a number")),t.substr(s,n)}function zi(t,i){return t&&t.length?t:i}function Yi(t,i,e){e||(e="");const s=new RegExp(i,"g");return t.replace(s,e)}function Ki(t,i,e){let s=0;e&&(s=parseInt(e,10),(0!=s&&!s||s<0)&&(G().error($i,"Third argument in MATCH macro must be a number >= 0"),s=0));const n=new RegExp(i),r=t.match(n);return r&&r[s]?r[s]:""}function Ji(t,i,e,s){const n=Number(t),r=Number(i);J(!isNaN(n),"CALC macro - left operand must be a number"),J(!isNaN(r),"CALC macro - right operand must be a number");let o=0;switch(e){case"add":o=n+r;break;case"subtract":o=n-r;break;case"multiply":o=n*r;break;case"divide":J(r,"CALC macro - cannot divide by 0"),o=n/r;break;default:G().error($i,"CALC macro - Invalid operation")}return ee(s)?Math.round(o):o}function Xi(t){if(null==t)return"";if(o(t))return t.map(Xi).join(",");const{argList:i,name:e}=Zi(String(t));return encodeURIComponent(e)+i}function Zi(t){if(!t)return{name:"",argList:""};const i=t.match(qi);return J(i,"Variable with invalid format found: "+t),{name:i[1]||i[0],argList:i[2]||""}}function Qi(t){return Z(t,"amp-analytics-variables")}function te(t){return tt(t,"amp-analytics-variables")}function ie(t){return function(t,i="default"){return gt(t).then((t=>t?t.whenPolicyResolved(i):null))}(t).then((t=>t?Bi[t]:null))}function ee(t){return"false"!==t&&""!==t&&"0"!==t&&"null"!==t&&"NaN"!==t&&"undefined"!==t}var se="amp-analytics/config";function ne(t,i,e){null==i&&(i={}),J(e||!t||!t.optout||"_gaUserPrefs.ioo"==t.optout||"__gaOptOutExtension"==t.optoutElementId,"optout property is only available to vendor config.");for(const s in t)J(e||"iframePing"!=s,"iframePing config is only available to vendor config."),_(t,s)&&(o(t[s])?(o(i[s])||(i[s]=[]),i[s]=ne(t[s],i[s],e)):f(t[s])?(f(i[s])||(i[s]={}),i[s]=ne(t[s],i[s],e)):i[s]=t[s]);return i}function re(t){if(!t.requests)return t;for(const e in t.requests)_(t.requests,e)&&(t.requests[e]=f(i=t.requests[e])?i:{"baseUrl":i});var i;return function(t){if(_(t,"requests")&&_(t,"requestOrigin")){const i=t.requestOrigin;for(const e in t.requests)_(t.requests[e],"origin")||(t.requests[e].origin=i)}return t}(t)}var oe=31536e6,he=!1,ue=/nochunking=1/.test(self.location.hash),ce=n();function ae(t,i,e){ue?ce.then(i):function(t){return function(t,i,e,s){const n=nt(t);ht(rt(n),n,"chunk",e)}(t,0,_e),Z(t,"chunk")}(t).run(i,e)}var le="not_run",fe=class{constructor(t){this.state=le,this.Yi=t}Ji(t){if("run"!=this.state){this.state="run";try{this.Yi(t)}catch(t){throw this.Qi(t),t}}}Xi(){return this.Yi.displayName||this.Yi.name}Qi(t){}Zi(){return!1}ts(){return!1}},de=class extends fe{constructor(t,i,e){super(t),this.ss=e}Qi(t){var i;K((i=self.document).defaultView),he||(he=!0,function(t){!function(t,i){for(const e in i)li(t,e,i[e])}(t.body,{opacity:1,visibility:"visible","animation":"none"})}(i))}Zi(){return this.es()}ts(){return this.ss.ns}es(){return this.ss.ampdoc.isVisible()}},_e=class{constructor(t){var i;this.ampdoc=t,this.i=t.win,this.rs=new class{constructor(){this.qi=[]}peek(){const t=this.length;return t?this.qi[t-1].item:null}enqueue(t,i){if(isNaN(i))throw new Error("Priority must not be NaN.");const e=this.Wi(i);this.qi.splice(e,0,{item:t,priority:i})}Wi(t){let i=-1,e=0,s=this.length;for(;e<=s&&(i=Math.floor((e+s)/2),i!==this.length);)if(this.qi[i].priority<t)e=i+1;else{if(!(i>0&&this.qi[i-1].priority>=t))break;s=i-1}return i}forEach(t){let i=this.length;for(;i--;)t(this.qi[i].item)}dequeue(){const t=this.qi.pop();return t?t.item:null}get length(){return this.qi.length}},this.hs=this.os.bind(this),this.us=0,this.ls=!(!this.i.navigator.scheduling||!this.i.navigator.scheduling.isInputPending),this.cs=!1,this.Ki=this.i.document.documentElement.hasAttribute("i-amphtml-no-boilerplate"),this.i.addEventListener("message",(t=>{"amp-macro-task"==yt(t)&&this.os(null)})),this.ns=!1,(i=t,tt(i,"viewer")).then((()=>{this.ns=!0})),t.onVisibilityChanged((()=>{t.isVisible()&&this.ds()}))}run(t,i){const e=new fe(t);this.fs(e,i)}runForStartup(t){const i=new de(t,this.i,this);this.fs(i,Number.POSITIVE_INFINITY)}fs(t,i){this.rs.enqueue(t,i),this.ds()}ps(t){let i=this.rs.peek();for(;i&&i.state!==le;)this.rs.dequeue(),i=this.rs.peek();return i&&t&&this.rs.dequeue(),i}os(t){const i=this.ps(!0);if(!i)return this.cs=!1,this.us=0,!1;let e;try{e=Date.now(),i.Ji(t)}finally{ce.then().then().then().then().then().then().then().then().then((()=>{this.cs=!1,this.us+=Date.now()-e,this.ds()}))}return!0}_s(t){if(this.Ki&&(this.ls?this.i.navigator.scheduling.isInputPending():this.us>5))return this.us=0,void this.As();ce.then((()=>{this.hs(t)}))}ds(){if(this.cs)return;const t=this.ps();return t?t.Zi()?(this.cs=!0,void this._s(null)):void(t.ts()&&this.i.requestIdleCallback?function(t,i,e,s){const n=Date.now();t.requestIdleCallback((function i(e){if(e.timeRemaining()<15){const r=2e3-(Date.now()-n);r<=0||e.didTimeout?s(e):t.requestIdleCallback(i,{timeout:r})}else s(e)}),{timeout:2e3})}(this.i,0,0,this.hs):this.As()):void 0}As(){this.i.postMessage("amp-macro-task","*")}},me="amp-analytics/cookie-writer",Ae={"referrerDomains":!0,"enabled":!0,"cookiePath":!0,"cookieMaxAge":!0,"cookieSecure":!0,"cookieDomain":!0,"sameSite":!0,"SameSite":!0,"secure":!0},pe=class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,i){const e=t.indexOf(i);-1!=e&&t.splice(e,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var i,s=e(this.Tt.slice(),!0);!(i=s()).done;)(0,i.value)(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Tt)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},Pe="video-session-visible",Ee="video-seconds-played",Te=["video-ended","video-pause","video-play","video-session","video-session-visible","video-seconds-played","video-hosted-custom","video-percentage-played","video-ad-start","video-ad-end"],ge=/^vars(.+)/,ve=function(){},Ie="amp-analytics/events",Re="click",Me="browser-event",be="custom",ye="hidden",Se="ini-load",we="render-start",Ve="scroll",Oe="story",Ne="timer",Ce="video",ke="visible",De=["ampdoc","embed"],Le=Object.freeze({[Re]:{name:Re,allowedFor:De.concat(["timer"]),klass:function(t){return new We(t)}},[Me]:{name:Me,allowedFor:De.concat(["timer"]),klass:function(t){return new $e(t)}},[be]:{name:be,allowedFor:De.concat(["timer"]),klass:function(t){return new qe(t)}},[ye]:{name:ke,allowedFor:De.concat(["timer"]),klass:function(t){return new Xe(t)}},[Se]:{name:Se,allowedFor:De.concat(["timer","visible"]),klass:function(t){return new Ye(t)}},[we]:{name:we,allowedFor:De.concat(["timer","visible"]),klass:function(t){return new ze(t)}},[Ve]:{name:Ve,allowedFor:De.concat(["timer"]),klass:function(t){return new Ge(t)}},[Oe]:{name:Oe,allowedFor:De,klass:function(t){return new Be(t)}},[Ne]:{name:Ne,allowedFor:De,klass:function(t){return new Ke(t)}},[Ce]:{name:Ce,allowedFor:De.concat(["timer"]),klass:function(t){return new Je(t)}},[ke]:{name:ke,allowedFor:De.concat(["timer"]),klass:function(t){return new Xe(t)}}});function xe(t){J(!o(t)||new Set(t).size===t.length,"Cannot have duplicate selectors in selectors list: %s",t)}function Ue(t){return t.startsWith("video")?Ce:"blur"===(i=t)||"change"===i?Me:t.startsWith("story")?Oe:function(t){return"click"===(i=t)||"browser-event"===i||"custom"===i||"hidden"===i||"ini-load"===i||"render-start"===i||"scroll"===i||"story"===i||"timer"===i||"video"===i||"visible"===i;var i}(t)?_(Le,t)?Le[t].name:t:be;var i}function He(t){const i={};return Object.keys(Le).forEach((e=>{_(Le,e)&&-1!=Le[e].allowedFor.indexOf(t)&&(i[e]=Le[e].klass)})),i}var je=class{constructor(t,i,e={},s=!0){this.target=t,this.type=i,this.vars=s?function(t,i){const e=M(t,void 0,ge);return m(e,i,0),e}(t,e):e}},Fe=class{constructor(t){this.root=t}dispose(){}add(t,i,e,s){}},$e=class extends Fe{constructor(t){super(t),this.ZAt=new pe,this.QAt={},this.tEt=this.ZAt.fire.bind(this.ZAt),this.iEt=function(t,i,e){let s=0,n=0,r=null;function o(){s=0;const e=500-(t.Date.now()-n);var h;e>0?s=t.setTimeout(o,e):(h=r,r=null,i.apply(null,h))}return function(...i){n=t.Date.now(),r=i,s||(s=t.setTimeout(o,500))}}(this.root.ampdoc.win,this.tEt)}dispose(){const t=this.root.getRoot();Object.keys(this.QAt).forEach((i=>{t.removeEventListener(i,this.iEt)})),this.tEt=null,this.ZAt=null}add(t,i,s,n){J(function(t,i){const s=function(t){var i,s,n,r,h;if(t[xt])return t[xt];t[xt]=d();const u=t[xt];p(u);const c=Lt(Lt({},null!==(i=t.AMP_CONFIG)&&void 0!==i?i:{}),null!==(s=t.AMP_EXP)&&void 0!==s?s:P((null===(n=t.__AMP_EXP)||void 0===n?void 0:n.textContent)||"{}"));for(const t in c){const i=c[t];"number"==typeof i&&i>=0&&i<=1&&(u[t]=Math.random()<i)}const a=null===(r=t.AMP_CONFIG)||void 0===r?void 0:r["allow-doc-opt-in"];if(o(a)&&a.length){const i=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(i)for(var l,f,_=e((null===(l=i.getAttribute("content"))||void 0===l?void 0:l.split(","))||[],!0);!(f=_()).done;){const t=f.value;a.includes(t)&&(u[t]=!0)}}Object.assign(u,function(t){var i;let s="";try{var n;"localStorage"in t&&(s=null!==(n=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==n?n:"")}catch(t){}const r=(null===(i=s)||void 0===i?void 0:i.split(/\s*,\s*/g))||[],o=d();for(var h,u=e(r,!0);!(h=u()).done;){const t=h.value;t&&("-"==t[0]?o[t.substr(1)]=!1:o[t]=!0)}return o}(t));const m=null===(h=t.AMP_CONFIG)||void 0===h?void 0:h["allow-url-opt-in"];if(o(m)&&m.length){const i=U(t.location.originalHash||t.location.hash);for(var A,E=e(m,!0);!(A=E()).done;){const t=A.value,e=i[`e-${t}`];"1"==e&&(u[t]=!0),"0"==e&&(u[t]=!1)}}return u}(t);return!!s["analytics-browser-events"]}(this.root.ampdoc.win),'expected global "analytics-browser-events" experiment to be enabled');const{"on":r,"selectionMethod":h=null,"selector":u}=s;J(null==u?void 0:u.length,"Missing required selector on browser event trigger"),xe(u);const c=this.root.getElements(t,u,h,!1);return this.QAt[r]||(this.root.getRootElement().addEventListener(r,this.iEt,!0),this.QAt[r]=!0),this.ZAt.add((t=>{t.type===r&&c.then((i=>{i.forEach((i=>{const e=t.target;i.contains(e)&&n(new je(i,r,{}))}))}))}))}},qe=class extends Fe{constructor(t){super(t),this.ZAt={},this.eEt={},this.sEt={},setTimeout((()=>{this.eEt=void 0}),1e4)}dispose(){this.eEt=void 0,this.sEt=void 0;for(const t in this.ZAt)this.ZAt[t].removeAll()}add(t,i,e,s){let n=e.selector;n||(n=":root");const r=e.selectionMethod||null,o=this.root.getElement(t,n,r),h=i.startsWith("sandbox-"),u=h?this.sEt&&this.sEt[i]:this.eEt&&this.eEt[i];if(u){const t=u.length;o.then((e=>{setTimeout((()=>{for(let i=0;i<t;i++){const t=u[i];e.contains(t.target)&&s(t)}h&&(this.sEt[i]=void 0)}),1)}))}let c=this.ZAt[i];return c||(c=new pe,this.ZAt[i]=c),this.ZAt[i].add((t=>{o.then((i=>{i.contains(t.target)&&s(t)}))}))}trigger(t){const i=t.type,e=i.startsWith("sandbox-"),s=this.ZAt[i];s&&(s.fire(t),e)||(e?(this.sEt[i]=this.sEt[i]||[],this.sEt[i].push(t)):this.eEt&&(this.eEt[i]=this.eEt[i]||[],this.eEt[i].push(t)))}},Be=class extends qe{constructor(t){super(t)}add(t,i,e,s){const n=this.root.getRootElement(),r=this.eEt&&this.eEt[i];if(r){const t=r.length;for(let i=0;i<t;i++){const t=r[i];this.nEt(t,n,e,s)}}let o=this.ZAt[i];return o||(o=new pe,this.ZAt[i]=o),this.ZAt[i].add((t=>{this.nEt(t,n,e,s)}))}nEt(t,i,e,s){const n=t.type,r=t.vars,o=e.storySpec||{},h=void 0===o.repeat||o.repeat,u=r.eventDetails,c=e.tagName;c&&u.tagName&&c.toLowerCase()!==u.tagName||!1===h&&u.repeated||s(new je(i,n,r))}trigger(t){const i=t.type,e=this.ZAt[i];e&&e.fire(t),this.eEt&&(this.eEt[i]=this.eEt[i]||[],this.eEt[i].push(t))}},We=class extends Fe{constructor(t){super(t),this.rEt=new pe,this.oEt=this.rEt.fire.bind(this.rEt),this.root.getRoot().addEventListener("click",this.oEt)}dispose(){this.root.getRoot().removeEventListener("click",this.oEt),this.rEt.removeAll()}add(t,i,e,s){const n=J(e.selector,"Missing required selector on click trigger"),r=e.selectionMethod||null;return this.rEt.add(this.root.createSelectiveListener(this.Nc.bind(this,s),t.parentElement||t,n,r))}Nc(t,i,e){t(new je(i,"click"))}},Ge=class extends Fe{constructor(t){super(t),this.Su=t,this.hEt=null}dispose(){null!==this.hEt&&(this.Su.getScrollManager().removeScrollHandler(this.hEt),this.hEt=null)}add(t,i,e,s){if(!e.scrollSpec)return G().error(Ie,"Missing scrollSpec on scroll trigger."),ve;if(!Array.isArray(e.scrollSpec.verticalBoundaries)&&!Array.isArray(e.scrollSpec.horizontalBoundaries))return G().error(Ie,"Boundaries are required for the scroll trigger to work."),ve;const n=this.uEt(e.scrollSpec.verticalBoundaries),r=this.uEt(e.scrollSpec.horizontalBoundaries),o=!!e.scrollSpec.useInitialPageSize;return this.hEt=this.vm.bind(this,r,n,o,s),this.Su.getScrollManager().addScrollHandler(this.hEt)}vm(t,i,e,s,n){const{scrollHeight:r,scrollWidth:o}=e?n.initialSize:n;this.cEt(i,100*(n.top+n.height)/r,"verticalScrollBoundary",s),this.cEt(t,100*(n.left+n.width)/o,"horizontalScrollBoundary",s)}uEt(t){const i={};if(!t||!Array.isArray(t))return i;for(let e=0;e<t.length;e++){let s=t[e];if("number"!=typeof s||!isFinite(s))return G().error(Ie,"Scroll trigger boundaries must be finite."),i;s=Math.min(5*Math.round(s/5),100),i[s]=!1}return i}cEt(t,i,e,s){if(i)for(const n in t){if(!_(t,n))continue;const r=parseInt(n,10);if(r>i||t[r])continue;t[r]=!0;const o={};o[e]=n,s(new je(this.Su.getRootElement(),Ve,o,!1))}}},ze=class extends Fe{constructor(t){super(t)}dispose(){}add(t,i,e,s){let n,r;const o=e.selector||":root";if(":root"==o||":host"==o)n=this.root.getRootElement(),r=this.getRootSignal(i);else{const s=e.selectionMethod;r=this.root.getAmpElement(t.parentElement||t,o,s).then((t=>(n=t,this.getElementSignal(i,n))))}return r.then((()=>{s(new je(n,i))})),ve}getRootSignal(t){return this.root.signals().whenSignal(t)}getElementSignal(t,i){return"function"!=typeof i.signals?n():i.signals().whenSignal(t)}},Ye=class extends Fe{constructor(t){super(t)}dispose(){}add(t,i,e,s){let n,r;const o=e.selector||":root";if(":root"==o||":host"==o)n=this.root.getRootElement(),r=this.getRootSignal();else{const i=e.selectionMethod;r=this.root.getAmpElement(t.parentElement||t,o,i).then((t=>(n=t,this.getElementSignal("ini-load",n))))}return r.then((()=>{s(new je(n,i))})),ve}getRootSignal(){return this.root.whenIniLoaded()}getElementSignal(t,i){if("function"!=typeof i.signals)return n();const e=i.signals();return Promise.race([e.whenSignal("ini-load"),e.whenSignal("load-end")])}},Ke=class extends Fe{constructor(t){super(t),this.aEt={},this.lEt=1}getTrackedTimerKeys(){return Object.keys(this.aEt)}dispose(){this.getTrackedTimerKeys().forEach((t=>{this.fEt(t)}))}add(t,i,e,s){const n=e.timerSpec;J(n&&"object"==typeof n,"Bad timer specification");const r="startSpec"in n?n.startSpec:null;J(!r||"object"==typeof r,"Bad timer start specification");const o="stopSpec"in n?n.stopSpec:null;J(!r&&!o||"object"==typeof o,"Bad timer stop specification");const h=this.dEt();let u,c;if(r){const e=this._Et(r);J(e,"Cannot track timer start"),u=e.add.bind(e,t,r.on,r,this.mEt.bind(this,h,i,s))}if(o){const e=this._Et(o);J(e,"Cannot track timer stop"),c=e.add.bind(e,t,o.on,o,this.mEt.bind(this,h,i,s))}const a=new class{constructor(t,i,e){this.AEt=void 0,J("interval"in t,"Timer interval specification required"),this.pEt=Number(t.interval)||0,J(this.pEt>=.5,"Bad timer interval specification"),this.PEt="maxTimerLength"in t?Number(t.maxTimerLength):7200,J(this.PEt>0,"Bad maxTimerLength specification"),this.EEt="maxTimerLength"in t,this.TEt=!("immediate"in t)||Boolean(t.immediate),this.gEt=null,this.vEt=null,this.IEt=null,this.REt=i||null,this.MEt=e||null,this.hr=void 0,this.bEt=void 0}init(t){this.REt?this.yEt():t()}dispose(){this.SEt(),this.wEt()}yEt(){this.REt&&(this.vEt=this.REt())}wEt(){this.vEt&&(this.vEt(),this.vEt=null)}VEt(){if(this.MEt)try{this.IEt=this.MEt()}catch(t){throw this.dispose(),t}}SEt(){this.IEt&&(this.IEt(),this.IEt=null)}isRunning(){return!!this.AEt}startIntervalInWindow(t,i,e){this.isRunning()||(this.hr=Date.now(),this.bEt=void 0,this.gEt=i,this.AEt=t.setInterval((()=>{i()}),1e3*this.pEt),(!this.MEt||this.MEt&&this.EEt)&&t.setTimeout((()=>{e()}),1e3*this.PEt),this.wEt(),this.TEt&&i(),this.VEt())}OEt(t){this.isRunning()&&(this.gEt(),this.gEt=null,t.clearInterval(this.AEt),this.AEt=void 0,this.bEt=void 0,this.SEt(),this.yEt())}NEt(){return this.hr?Date.now()-(this.bEt||this.hr):0}getTimerVars(){let t=0;return this.isRunning()&&(t=this.NEt(),this.bEt=Date.now()),{"timerDuration":t,"timerStart":this.hr||0}}}(n,u,c);return this.aEt[h]=a,a.init(this.CEt.bind(this,h,i,s)),()=>{this.fEt(h)}}dEt(){return++this.lEt}_Et(t){const i=Ue(G().assertString(t.on));return this.root.getTrackerForAllowlist(i,He("timer"))}mEt(t,i,e){const s=this.aEt[t];s&&(s.isRunning()?this.OEt(t):this.CEt(t,i,e))}CEt(t,i,e){this.aEt[t].startIntervalInWindow(this.root.ampdoc.win,(()=>{e(this.kEt(t,i))}),this.fEt.bind(this,t))}OEt(t){this.aEt[t].OEt(this.root.ampdoc.win)}kEt(t,i){return new je(this.root.getRootElement(),i,this.aEt[t].getTimerVars(),!1)}fEt(t){this.aEt[t]&&(this.OEt(t),this.aEt[t].dispose(),delete this.aEt[t])}},Je=class extends Fe{constructor(t){super(t),this.DEt=new pe,this.tEt=this.DEt.fire.bind(this.DEt),Te.forEach((t=>{this.root.getRoot().addEventListener(t,this.tEt)}))}dispose(){const t=this.root.getRoot();Te.forEach((i=>{t.removeEventListener(i,this.tEt)})),this.tEt=null,this.DEt=null}add(t,i,e,s){const n=e.videoSpec||{},r=J(e.selector||n.selector,"Missing required selector on video trigger");J(r.length,"Missing required selector on video trigger"),xe(r);const o=e.selectionMethod||null,h=this.root.getElements(t,r,o,!1),u=n["end-session-when-invisible"],c=n["exclude-autoplay"],a=n.interval,l=n.percentages,f=e.on;let d=0,_=0;return this.DEt.add((t=>{const{type:i}=t,e=yt(t),n=function(t,i){return t==Pe?"video-session":"video-hosted-custom"==t?i["__amp:eventType"]:t}(i,e);if(n!==f)return;if(n===Ee&&!a)return void G().error(Ie,"video-seconds-played requires interval spec with non-zero value");if(n===Ee&&(d++,d%a!=0))return;if("video-percentage-played"===n){if(!l)return void G().error(Ie,"video-percentage-played requires percentages spec.");for(let t=0;t<l.length;t++){const i=l[t];if(i<=0||i%5!=0)return void G().error(Ie,"Percentages must be set in increments of %s with non-zero values",5)}const t=e.normalizedPercentage,i=parseInt(t,10);if(K(A(i)),K(i%5==0),_==i&&l.length>1)return;if(l.indexOf(i)<0)return;_=i}if(i===Pe&&!u)return;if(c&&"playing_auto"===e.state)return;const r=t.target;h.then((t=>{t.forEach((t=>{if(!t.contains(r))return;const i=function(t){if(!t)return{};const i=Lt({},t);return delete i["__amp:eventType"],i}(e);s(new je(t,n,i))}))}))}))}},Xe=class extends Fe{constructor(t){super(t),this.LEt={}}dispose(){}add(t,i,e,s){const n=e.visibilitySpec||{},r=e.selector||n.selector,o=n.waitFor;let h=n.reportWhen,u=null;h&&J(!n.repeat,"reportWhen and repeat are mutually exclusive."),i===ye&&(h&&G().error(Ie,'ReportWhen should not be defined when eventType is "hidden"'),h="documentHidden");const c=this.root.getVisibilityManager();if("documentHidden"==h?u=this.xEt.bind(this):"documentExit"==h?u=this.UEt.bind(this):J(!h,'reportWhen value "%s" not supported.',h),!r||":root"==r||":host"==r){const t=o||(r?"ini-load":"none");return c.listenRoot(n,this.getReadyPromise(t),u,this.HEt.bind(this,i,s,this.root.getRootElement()))}const a=e.selectionMethod||n.selectionMethod;xe(r);const l=this.root.getElements(t.parentElement||t,r,a).then((t=>{const e=[];for(let r=0;r<t.length;r++)e.push(c.listenElement(t[r],n,this.getReadyPromise(o,t[r]),u,this.HEt.bind(this,i,s,t[r])));return e}));return function(){l.then((t=>{for(let i=0;i<t.length;i++)t[i]()}))}}xEt(){const{ampdoc:t}=this.root;return t.isVisible()?new Promise((i=>{t.onVisibilityChanged((()=>{t.isVisible()||i()}))})):n()}UEt(){const t=new r,{win:i}=this.root.ampdoc;let e,s;return this.jEt()||i.addEventListener("unload",e=()=>{i.removeEventListener("unload",e),t.resolve()}),i.addEventListener("pagehide",s=()=>{i.removeEventListener("pagehide",s),t.resolve()}),t.promise}jEt(){return"onpagehide"in this.root.ampdoc.win}getReadyPromise(t,i){if(i&&(function(t){const i=t.tagName;return i.startsWith("AMP-")&&!("AMP-STICKY-AD-TOP-PADDING"==i||"AMP-BODY"==i)}(i)?t=t||"ini-load":J(!t||"none"==t,"waitFor for non-AMP elements must be none or null. Found %s",t)),!t||"none"==t)return null;const e=He("visible");J(void 0!==e[t],"waitFor value %s not supported",t);const s=this.LEt[t]||this.root.getTrackerForAllowlist(t,e);return s?(this.LEt[t]=s,i?s.getElementSignal(t,i):s.getRootSignal(t)):null}HEt(t,i,e,s){const n=M(e,void 0,ge);for(const t in n)s[t]=n[t];i(new je(e,t,s,!1))}},Ze="inside";function Qe(t,i,e,s){return{left:t,top:i,width:e,height:s,bottom:i+s,right:t+e,x:t,y:i}}function ts(t,i,e){const s=(n={top:e,bottom:e+i.getHeight(),left:0,right:i.getWidth()},Qe(Number(n.left),Number(n.top),Number(n.width),Number(n.height)));var n,r,o;return o=s,(r=t).top<=o.bottom&&o.top<=r.bottom&&r.left<=o.right&&o.left<=r.right?Ze:function(t,i){return t.top<i.top?"top":t.bottom>i.bottom?"bottom":Ze}(t,s)}function is(t){const i=function(t){const i=[];if(!t)return i;let e,s=t;i.push(s);for(let t=0;t<50;t++)if(e=s.parentNode||s.parentElement,e&&1==e.nodeType)s=e,i.push(s);else{if(!e||9!=e.nodeType)break;if(e=s.ownerDocument.defaultView.frameElement,!e||1!=e.nodeType)break;s=e,i.push(s)}return i}(t.parentElement);i.push(t);let e,s=1;for(let t=0;t<i.length;t++)if(e=es(i[t]),e<s&&(s=e),0===s)return s;return s}function es(t){const i=window;if(!t)return 1;const{opacity:e,visibility:s}=function(t,i){return t.getComputedStyle(i)||ci}(i,t);if("hidden"===s)return 0;const n=""===e?1:parseFloat(e);return isNaN(n)?1:n}var ss=class{constructor(t,i){this.FEt=i,this.$Et={"visiblePercentageMin":Number(t.visiblePercentageMin)/100||0,"visiblePercentageMax":Number(t.visiblePercentageMax)/100||1,"totalTimeMin":Number(t.totalTimeMin)||0,"totalTimeMax":Number(t.totalTimeMax)||1/0,"continuousTimeMin":Number(t.continuousTimeMin)||0,"continuousTimeMax":Number(t.continuousTimeMax)||1/0},"0"===String(t.visiblePercentageMax).trim()&&(this.$Et.visiblePercentageMax=0),this.qEt=void 0!==t.reportWhen,this.BEt=!0===t.repeat,this.WEt=new pe;const e=new r;this.GEt=e.promise,this.zEt=e.resolve,this.GEt.then((()=>{this.WEt.fire()})),this.YEt=[],this.KEt=Date.now(),this.ui=!0,this.JEt=!0,this.XEt=null,this.ZEt=null,this.QEt=!1,this.tTt=!1,this.iTt=0,this.eTt=0,this.sTt=0,this.nTt=0,this.rTt=0,this.Hu=0,this.Zt=0,this.oTt=0,this.hTt=0,this.uTt=0,this.cTt=0,this.aTt=0,this.lTt=!1,this.fTt=!1,this.dTt=null}Gs(){K(!this.zEt);const t=new r;this.GEt=t.promise,this.zEt=t.resolve,this.GEt.then((()=>{this.WEt.fire()})),this.dTt=null,this.tTt=!1,this.QEt=!1,this.iTt=0,this.eTt=0,this.sTt=0,this.Hu=0,this.nTt=0,this.rTt=0,this.Zt=0,this.hTt=0,this.uTt=0,this.cTt=0,this.fTt=!1}maybeDispose(){this.BEt||this.dispose()}dispose(){this.ZEt&&(clearTimeout(this.ZEt),this.ZEt=null),this.dTt&&(clearTimeout(this.dTt),this.dTt=null),this.YEt.forEach((t=>{t()})),this.YEt.length=0,this.zEt=null,this.WEt&&(this.WEt.removeAll(),this.WEt=null)}unsubscribe(t){this.YEt.push(t)}onTriggerEvent(t){this.WEt&&this.WEt.add(t),this.GEt&&!this.zEt&&t()}setReady(t){this.ui=t,this.update()}setReportReady(t){this.JEt=!1,this.XEt=t}_Tt(){return this.ui?this.FEt():0}update(){this.Ha(this._Tt())}getState(t){return{"firstSeenTime":ns(this.nTt,t),"lastSeenTime":ns(this.rTt,t),"lastVisibleTime":ns(this.Zt,t),"firstVisibleTime":ns(this.Hu,t),"maxContinuousVisibleTime":this.eTt,"totalVisibleTime":this.sTt,"loadTimeVisibility":100*this.oTt||0,"minVisiblePercentage":100*this.hTt,"maxVisiblePercentage":100*this.uTt}}Ha(t){if(this.fTt)this.mTt(t)||this.Gs();else if(this.zEt)if(this.ATt(t)||this.qEt){if(this.ZEt&&(clearTimeout(this.ZEt),this.ZEt=null),this.JEt)this.zEt(),this.zEt=null,this.BEt&&(this.fTt=!0,this.iTt=0);else if(this.XEt){const t=this.XEt();this.XEt=null,t.then((()=>{this.JEt=!0,this.update()}))}}else if(this.QEt&&!this.ZEt){const t=this.pTt();t>0&&(this.ZEt=setTimeout((()=>{this.ZEt=null,this.update()}),t))}else!this.QEt&&this.ZEt&&(clearTimeout(this.ZEt),this.ZEt=null)}mTt(t){return K(t>=0&&t<=1),1==this.$Et.visiblePercentageMin?1==t:0==this.$Et.visiblePercentageMax?0==t:t>this.$Et.visiblePercentageMin&&t<=this.$Et.visiblePercentageMax}ATt(t){K(t>=0&&t<=1);const i=Date.now();t>0&&(this.nTt=this.nTt||i,this.rTt=i,!this.oTt&&i-this.KEt<300&&(this.oTt=t));const e=this.QEt,s=this.cTt?i-this.cTt:0;return this.QEt=this.mTt(t),this.QEt?(this.tTt=!0,e?(this.sTt+=s,this.iTt+=s,this.eTt=Math.max(this.eTt,this.iTt)):(K(!this.cTt),this.Hu=this.Hu||i),this.cTt=i,this.hTt=this.hTt>0?Math.min(this.hTt,t):t,this.uTt=Math.max(this.uTt,t),this.Zt=i):e&&(K(this.cTt>0),this.eTt=Math.max(this.eTt,this.iTt+s),this.cTt=0,this.sTt+=s,this.iTt=0,this.Zt=i),this.tTt&&this.sTt>=this.$Et.totalTimeMin&&this.sTt<=this.$Et.totalTimeMax&&this.eTt>=this.$Et.continuousTimeMin&&this.eTt<=this.$Et.continuousTimeMax}maybeSetInitialScrollDepth(t){this.lTt||(this.aTt=t,this.lTt=!0)}getInitialScrollDepth(){return this.aTt}pTt(){const t=Math.max(this.$Et.continuousTimeMin-this.iTt,0),i=Math.max(this.$Et.totalTimeMin-this.sTt,0),e=Math.max(t,i);return Math.min(e,t||1/0,i||1/0)}};function ns(t,i){return t>=i?t-i:0}var rs="amp-analytics/visibility-manager",os="__AMP_VIS",hs=[0,.05,.1,.15,.2,.25,.3,.35,.4,.45,.5,.55,.6,.65,.7,.75,.8,.85,.9,.95,1],us=1;function cs(t){let i=t.__AMP_VIS_ID;return i||(i=++us,t.__AMP_VIS_ID=i),i}function as(t){return t[os]||(t[os]=function(t){const i=dt(t),e=st(t),s=e&&Pi(e),n=e&&function(t){if(Node.prototype.getRootNode)return t.getRootNode();let i;for(i=t;i.parentNode&&(!(e=i)||"I-AMPHTML-SHADOW-ROOT"!=e.tagName&&(11!=e.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(e)));i=i.parentNode);var e;return i}(e);return s&&n?new ds(as(n),s):new fs(i)}(t)),t[os]}var ls=class{constructor(t,i){this.parent=t,this.ampdoc=i,this.PTt=0,this.ETt=[],this.xL=null,this.YEt=[],this.TTt=0,this.parent&&this.parent.gTt(this);const e=It(this.ampdoc);e.onChanged((()=>{this.maybeUpdateMaxScrollDepth(e.getScrollTop())}))}gTt(t){this.xL||(this.xL=[]),this.xL.push(t)}vTt(t){if(this.xL){const i=this.xL.indexOf(t);-1!=i&&this.xL.splice(i,1)}}dispose(){this.setRootVisibility(0);for(let t=this.ETt.length-1;t>=0;t--)this.ETt[t].dispose();if(this.YEt.forEach((t=>{t()})),this.YEt.length=0,this.parent&&this.parent.vTt(this),this.xL)for(let t=0;t<this.xL.length;t++)this.xL[t].dispose()}unsubscribe(t){this.YEt.push(t)}getStartTime(){}isBackgrounded(){}isBackgroundedAtStart(){}getRootMinOpacity(){}getRootLayoutBox(){}getRootVisibility(){return this.parent?this.parent.getRootVisibility()>0?this.PTt:0:this.PTt}setRootVisibility(t){if(this.PTt=t,this.ITt(),this.xL)for(let t=0;t<this.xL.length;t++)this.xL[t].ITt()}maybeUpdateMaxScrollDepth(t){t>this.TTt&&(this.TTt=t)}getMaxScrollDepth(){return this.TTt}ITt(){for(let t=0;t<this.ETt.length;t++)this.ETt[t].update()}listenRoot(t,i,e,s){const n=this.getRootVisibility.bind(this);return this.RTt(n,t,i,e,s)}listenElement(t,i,e,s,n){const r=this.getElementVisibility.bind(this,t);return this.RTt(r,i,e,s,n,t)}RTt(t,i,e,s,n,r){if(i.visiblePercentageThresholds&&null==i.visiblePercentageMin&&null==i.visiblePercentageMax){const h=[],u=i.visiblePercentageThresholds;if(!u||!o(u))return G().error(rs,"invalid visiblePercentageThresholds"),()=>{};for(let c=0;c<u.length;c++){const a=u[c];if(!o(a)||2!=a.length){G().error(rs,"visiblePercentageThresholds entry length is not 2");continue}if(!A(a[0])||!A(a[1])){G().error(rs,"visiblePercentageThresholds entry is not valid number");continue}const l=Number(a[0]),f=Number(a[1]);if(l<0||f>100||l>f||l==f&&100!=l&&0!=f){G().error(rs,"visiblePercentageThresholds entry invalid min/max value");continue}const d=i;d.visiblePercentageMin=l,d.visiblePercentageMax=f;const _=new ss(d,t,It(this.ampdoc));h.push(this.FH(_,i,e,s,n,r))}return()=>{h.forEach((t=>t()))}}const h=new ss(i,t,It(this.ampdoc));return this.FH(h,i,e,s,n,r)}FH(t,i,e,s,n,r){s&&t.setReportReady(s);const o=It(this.ampdoc),h=o.getScrollTop();return this.maybeUpdateMaxScrollDepth(h),e?(t.setReady(!1),e.then((()=>{t.setReady(!0),t.maybeSetInitialScrollDepth(h)}))):t.maybeSetInitialScrollDepth(h),t.onTriggerEvent((()=>{const i=this.getStartTime(),e=t.getState(i);let s;if(e.backgrounded=this.isBackgrounded()?1:0,e.backgroundedAtStart=this.isBackgroundedAtStart()?1:0,e.totalTime=Date.now()-i,r){e.elementId=r.id,e.opacity=is(r),s=o.getLayoutRect(r);const t=this.getElementVisibility(r),i=this.getElementIntersectionRect(r);Object.assign(e,{"intersectionRatio":t,"intersectionRect":JSON.stringify(i)})}else e.opacity=this.getRootMinOpacity(),e.intersectionRatio=this.getRootVisibility(),s=this.getRootLayoutBox();t.maybeDispose(),s&&(Object.assign(e,{"elementX":s.left,"elementY":s.top,"elementWidth":s.width,"elementHeight":s.height}),e.initialScrollDepth=ts(s,o,t.getInitialScrollDepth()),e.maxScrollDepth=ts(s,o,this.getMaxScrollDepth())),n(e)})),this.ETt.push(t),t.unsubscribe((()=>{const i=this.ETt.indexOf(t);-1!=i&&this.ETt.splice(i,1)})),r&&t.unsubscribe(this.observe(r,(()=>t.update()))),t.update(),function(){t.dispose()}}observe(t,i){}getElementVisibility(t){}getElementIntersectionRect(t){}},fs=class extends ls{constructor(t){if(super(null,t),this.bn=It(t),this.MTt=!t.isVisible(),this.bTt=this.isBackgrounded(),this.yTt=d(),this.Gv=null,"inabox"==F(this.ampdoc.win).runtime){const t=this.ampdoc.getRootNode(),i=t.documentElement||t.body||t;this.unsubscribe(this.observe(i,this.setRootVisibility.bind(this)));const e=()=>{const t=cs(i),e=this.yTt[t];e&&(this.ampdoc.win.innerHeight<1||this.ampdoc.win.innerWidth<1?e.isVisible=!1:e.isVisible=!0,this.setRootVisibility(e.isVisible?e.intersectionRatio:0))};this.ampdoc.win.addEventListener("resize",e),this.unsubscribe((()=>{this.ampdoc.win.removeEventListener("resize",e)}))}else this.setRootVisibility(this.ampdoc.isVisible()?1:0),this.unsubscribe(this.ampdoc.onVisibilityChanged((()=>{const t=this.ampdoc.isVisible();t||(this.MTt=!0),this.setRootVisibility(t?1:0)})))}dispose(){super.dispose(),this.Gv&&(this.Gv.disconnect(),this.Gv=null)}getStartTime(){return this.ampdoc.getFirstVisibleTime()}isBackgrounded(){return this.MTt}isBackgroundedAtStart(){return this.bTt}getRootMinOpacity(){const t=this.ampdoc.getRootNode();return is(t.documentElement||t.body||t)}getRootLayoutBox(){const t=this.ampdoc.getRootNode(),i=t.documentElement||t.body||t;return this.bn.getLayoutRect(i)}observe(t,i){const e=cs(t);let s=this.yTt[e];return s?s.intersectionRatio>0&&s.isVisible&&i(s.intersectionRatio):(s={element:t,intersectionRatio:0,intersectionRect:null,isVisible:!1,boundingClientRect:null,listeners:[]},this.yTt[e]=s),s.listeners.push(i),this.STt().observe(t),()=>{const s=this.yTt[e];if(s){const n=s.listeners.indexOf(i);-1!=n&&s.listeners.splice(n,1),0==s.listeners.length&&(this.Gv.unobserve(t),delete this.yTt[e])}}}getElementVisibility(t){if(0==this.getRootVisibility())return 0;const i=cs(t),e=this.yTt[i];return e&&e.isVisible&&e.intersectionRatio||0}getElementIntersectionRect(t){if(this.getElementVisibility(t)<=0)return null;const i=cs(t),e=this.yTt[i];return e?e.intersectionRect:null}STt(){if(!this.Gv){const{win:t}=this.ampdoc;this.Gv=new t.IntersectionObserver(this.wTt.bind(this),{threshold:hs})}return this.Gv}wTt(t){t.forEach((t=>{let i=t.intersectionRect;i=Qe(Number(i.left),Number(i.top),Number(i.width),Number(i.height));let{boundingClientRect:e}=t;e=e&&Qe(Number(e.left),Number(e.top),Number(e.width),Number(e.height)),this.VTt(t.target,t.intersectionRatio,i,e)}))}VTt(t,i,e,s){i=Math.min(Math.max(i,0),1);const n=cs(t),r=this.yTt[n];let o=!0;if((s.width<1||s.height<1)&&(o=!1),r){r.isVisible=o,r.intersectionRatio=i,r.intersectionRect=e,r.boundingClientRect=s;for(let t=0;t<r.listeners.length;t++)r.listeners[t](r.isVisible?i:0)}}},ds=class extends ls{constructor(t,i){super(t,t.ampdoc),this.embed=i,this.bTt=this.parent.isBackgrounded(),this.unsubscribe(this.parent.observe(i.host,this.setRootVisibility.bind(this)))}getStartTime(){return this.embed.getStartTime()}isBackgrounded(){return this.parent.isBackgrounded()}isBackgroundedAtStart(){return this.bTt}getRootMinOpacity(){return is(this.embed.iframe)}getRootLayoutBox(){const t=this.embed.iframe;return It(this.ampdoc).getLayoutRect(t)}observe(t,i){return this.parent.observe(t,i)}getElementVisibility(t){return 0==this.getRootVisibility()?0:this.parent.getElementVisibility(t)}getElementIntersectionRect(t){return 0==this.getRootVisibility()?null:this.parent.getElementIntersectionRect(t)}},_s=["AMP-AD","AMP-ANALYTICS","AMP-PIXEL","AMP-AD-EXIT"],ms=/^vars(.+)/,As=class{constructor(t){this.ampdoc=t,this.aEt=d(),this.OTt=null,this.NTt=null}dispose(){for(const t in this.aEt)this.aEt[t].dispose(),delete this.aEt[t];this.OTt&&this.OTt.dispose(),this.NTt&&this.NTt.dispose()}getType(){}getRoot(){}getRootElement(){const t=this.getRoot();return t.host||t.documentElement||t.body||t}getHostElement(){}signals(){}contains(t){return this.getRoot().contains(t)}getElementById(t){}getTrackerForAllowlist(t,i){const e=i[t];return e?this.getTracker(t,e):null}getTracker(t,i){let e=this.aEt[t];return e||(e=new i(this),this.aEt[t]=e),e}getTrackerOptional(t){return this.aEt[t]||null}getElement(t,i,e=null){return":root"==i?(s=()=>this.getRootElement(),new Promise((t=>{t(s())}))):":host"==i?new Promise((t=>{t(G().assertElement(this.getHostElement(),`Element "${i}" not found`))})):this.ampdoc.whenReady().then((()=>{let s,n=null;try{s="scope"==e?function(t,i){return t.querySelector(g(i,":scope"))}(t,i):"closest"==e?I(t,i):this.getRoot().querySelector(i)}catch(t){J(!1,`Invalid query selector ${i}`)}return s&&this.contains(s)&&(n=s),G().assertElement(n,`Element "${i}" not found`)}));var s}CTt(t,i=!0){return this.ampdoc.whenReady().then((()=>{let e=[];for(let s=0;s<t.length;s++){let n,r=[];const o=t[s];try{n=this.getRoot().querySelectorAll(o)}catch(t){J(!1,`Invalid query selector ${o}`)}for(let t=0;t<n.length;t++)this.contains(n[t])&&r.push(n[t]);r=i?this.kTt(r,o):r,J(r.length,`Element "${o}" not found`),e=e.concat(r)}return e.filter(((t,i)=>e.indexOf(t)===i))}))}kTt(t,i){const e=[];for(let i=0;i<t.length;i++)Object.keys(M(t[i],void 0,ms)).length&&e.push(t[i]);return e}getAmpElement(t,i,e){return this.getElement(t,i,e).then((t=>(this.DTt([t],i),t)))}getElements(t,i,e,s=!0){return o(i)?(J(!e,"Cannot have selectionMethod %s defined with an array selector.",e),this.CTt(i,s)):this.getElement(t,i,e).then((t=>[t]))}DTt(t,i){for(let e=0;e<t.length;e++)J(t[e].classList.contains("i-amphtml-element"),'Element "%s" is required to be an AMP element',i)}createSelectiveListener(t,i,e,s=null){return n=>{if(":host"==e)return;const r=this.getRootElement(),o="*"==e,h=":root"==e;let{target:u}=n;for(;u&&this.contains(u)&&("scope"!=s||h||i.contains(u));)if("closest"!=s||u.contains(i)){if(o||h&&u==r||Es(u,e)){t(u,n);break}u=u.parentElement}else u=u.parentElement}}whenIniLoaded(){}getVisibilityManager(){return this.OTt||(this.OTt=as(this.getRoot())),this.OTt}getScrollManager(){return this.NTt||(this.NTt=new class{constructor(t){this.bn=It(t.ampdoc),this.wn=Z(t.ampdoc,"mutator"),this.LTt=null,this.Fr=new pe,this.Su=t.getRootElement(),this.xTt=null}dispose(){this.Fr.removeAll(),this.UTt()}removeScrollHandler(t){this.Fr.remove(t),this.Fr.getHandlerCount()<=0&&this.UTt()}addScrollHandler(t){const i=this.bn.getSize();return this.HTt().then((e=>{const{height:s,left:n,top:r,width:o}=e,h={top:this.bn.getScrollTop()-r,left:this.bn.getScrollLeft()-n,width:i.width,height:i.height,scrollHeight:s,scrollWidth:o,initialSize:{scrollHeight:s,scrollWidth:o}};t(h)})),0===this.Fr.getHandlerCount()&&this.jTt(),this.Fr.add(t)}$x(t){return Promise.all([this.HTt(),this.FTt()]).then((i=>{const{height:e,width:s}=i[0],{height:n,left:r,top:o,width:h}=i[1],u={top:t.top-o,left:t.left-r,width:t.width,height:t.height,scrollWidth:h,scrollHeight:n,initialSize:{scrollHeight:e,scrollWidth:s}};this.Fr.fire(u)}))}UTt(){this.LTt&&(this.LTt(),this.LTt=null)}jTt(){this.LTt=this.bn.onChanged(this.$x.bind(this))}HTt(){return K(this.xTt||this.FTt())}FTt(){const t=this.wn.measureElement((()=>this.bn.getLayoutRect(this.Su)));return this.xTt=this.xTt||t,t}}(this)),this.NTt}},ps=class extends As{constructor(t){super(t)}getType(){return"ampdoc"}getRoot(){return this.ampdoc.getRootNode()}getHostElement(){return null}signals(){return this.ampdoc.signals()}getElementById(t){return this.ampdoc.getElementById(t)}whenIniLoaded(){const t=It(this.ampdoc);let i;if("inabox"==F(this.ampdoc.win).runtime)i=t.getLayoutRect(this.getRootElement());else{const e=t.getSize();i=Qe(0,0,e.width,e.height)}return e=this.ampdoc,this.ampdoc.win,function(t,i){const e=dt(t);return e.signals().whenSignal("ready-scan").then((()=>{const t=(t=>Z(t,"resources"))(e).get().filter((t=>!_s.includes(t.element.tagName))).map((t=>t.element));return 0===t.length?Promise.resolve([]):new Promise((i=>{const{win:s}=e,n=new s.IntersectionObserver((t=>{n.disconnect();const e=[];for(let i=0;i<t.length;i++){const{isIntersecting:s,target:n}=t[i];s&&e.push(n)}i(e)}),{root:b(s)?s.document:null,threshold:.01});for(let i=0;i<Math.min(t.length,100);i++)n.observe(t[i])})).then((t=>Promise.all(t.map((t=>t.whenLoaded())))))}))}(e);var e}},Ps=class extends As{constructor(t,i){super(t),this.embed=i}getType(){return"embed"}getRoot(){return this.embed.win.document}getHostElement(){return this.embed.iframe}signals(){return this.embed.signals()}getElementById(t){return this.embed.win.document.getElementById(t)}whenIniLoaded(){return this.embed.whenIniLoaded()}};function Es(t,i){try{return v(t,i)}catch(t){return G().error("amp-analytics/analytics-root","Bad query selector.",i,t),!1}}var Ts="__AMP_AN_ROOT";function gs(t,i){return vs(t)===vs(i)}function vs(t){return t.replace(/^(?:www\.|m\.|amp\.)+/,"")}function Is(t,i){const e=i.replace(/[-\/\\^$+?.()|[\]{}]/g,"\\$&").replace(/\*/g,".*");return new RegExp("^"+e+"$").test(t)}var Rs={"AMPDOC_HOST":!0,"AMPDOC_HOSTNAME":!0,"AMPDOC_URL":!0,"AMP_VERSION":!0,"AVAILABLE_SCREEN_HEIGHT":!0,"AVAILABLE_SCREEN_WIDTH":!0,"BACKGROUND_STATE":!0,"BROWSER_LANGUAGE":!0,"CANONICAL_HOST":!0,"CANONICAL_HOSTNAME":!0,"CANONICAL_PATH":!0,"CANONICAL_URL":!0,"DOCUMENT_CHARSET":!0,"FIRST_CONTENTFUL_PAINT":!0,"FIRST_VIEWPORT_READY":!0,"MAKE_BODY_VISIBLE":!0,"RANDOM":!0,"SCREEN_COLOR_DEPTH":!0,"SCREEN_HEIGHT":!0,"SCREEN_WIDTH":!0,"SOURCE_HOST":!0,"SOURCE_HOSTNAME":!0,"SOURCE_PATH":!0,"SOURCE_URL":!0,"TIMESTAMP":!0,"TIMEZONE":!0,"TIMEZONE_CODE":!0,"USER_AGENT":!0,"VIEWPORT_HEIGHT":!0,"VIEWPORT_WIDTH":!0},Ms="${extraUrlParams}",bs={"default":new class{generateRequest(t,i,e=!1){return e?{url:t.replace(Ms,""),payload:JSON.stringify(i.extraUrlParams)}:{url:ys(t,[i])}}generateBatchRequest(t,i,e=!1){return e?{url:t.replace(Ms,""),payload:JSON.stringify(i.map((t=>t.extraUrlParams)))}:{url:ys(t,i)}}}};function ys(t,i){const e=i.map((t=>Xt(t.extraUrlParams))).filter(Boolean).join("&");let s;return s=t.indexOf(Ms)>=0?t.replace(Ms,e):Kt(t,e),s}var Ss=class{constructor(t,i,e,s,n){this.yf=t,this.Ci=t.getAmpDoc(),this.win=this.Ci.win,this.$Tt=i.origin,this.baseUrl=K(i.baseUrl),this.qTt=i.batchInterval,this.BTt=Number(i.reportWindow)||null,this.WTt=null,this.Vtt=Qi(t),this._O=Et(t),this.lk=vt(t),this.GTt=null,this.zTt=null,this.YTt=[],this.KTt=e,this.lI=s,this.dr=n?Rs:void 0,this.JTt=null,this.XTt=null,this.ZTt=!0,this.QTt=null,this.JK=0,this.hr=Date.now(),this.tIt(),this.iIt()}send(t,i,e){const s=!0===i.important;if(!this.ZTt&&!s)return;this.JK++,this.QTt=i;const n=this.Vtt.getMacros(this.yf);var r,o,u;if(n.RESOURCE_TIMING=(r=this.yf,o=i.resourceTimingSpec,u=this.hr,o&&Date.now()<u+6e4?function(t,i){const{win:e}=t.getAmpDoc();if(i.done||!e.performance||!e.performance.now||!e.performance.getEntriesByType||!f((s=i).resources)||!(s.encoding&&s.encoding.entry&&s.encoding.delim)||s.encoding.base<2||s.encoding.base>36||null!=s.responseAfter&&"number"!=typeof s.responseAfter)return i.done=!0,Promise.resolve("");var s;let n=function(t){return t.performance.getEntriesByType("resource")}(e);n.length>=150&&(i.done=!0);const r=i.responseAfter||0;return i.responseAfter=Math.max(r,e.performance.now()),n=n.filter((t=>t.startTime+t.duration>=r)),n.length?(o=()=>function(t,i,e){const s=i.resources,n=i.encoding,r=Qi(e),o=(t,i=0)=>Math.round(t-i).toString(n.base||10),u=function(t,i){const e=function(t){const i={};for(const e in t){const s=t[e].host||"",n=t[e].path||"",r=t[e].query||"",o={name:e,pathPattern:new RegExp(n),queryPattern:new RegExp(r)};i[s]?i[s].resources.push(o):i[s]={hostPattern:new RegExp(s),resources:[o]}}const e=[];for(const t in i)e.push(i[t]);return e}(i),s=[];return t.forEach((t=>{const i=function(t,i){const e=t.name;for(let t=0;t<i.length;++t){const{hostPattern:s,resources:n}=i[t];if(!s.test(e.host))continue;const r=h(n,(t=>t.pathPattern.test(e.pathname)&&t.queryPattern.test(e.search)));if(-1!=r)return n[r].name}return null}(t,e);i&&s.push({entry:t,name:i})})),s}(t,s).map((t=>{const{entry:i,name:e}=t;return function(t,i,e){const s={"key":i,"startTime":e(t.startTime),"redirectTime":e(t.redirectEnd,t.redirectStart),"domainLookupTime":e(t.domainLookupEnd,t.domainLookupStart),"tcpConnectTime":e(t.connectEnd,t.connectStart),"serverResponseTime":e(t.responseStart,t.requestStart),"networkTransferTime":e(t.responseEnd,t.responseStart),"transferSize":e(t.transferSize||0),"encodedBodySize":e(t.encodedBodySize||0),"decodedBodySize":e(t.decodedBodySize||0),"duration":e(t.duration),"initiatorType":t.initiatorType};return new Wi(s,1)}(i,e,o)})).map((t=>r.expandTemplate(n.entry,t,e)));return Promise.all(u).then((t=>t.join(n.delim)))}(n,i,t),new Promise((t=>{setTimeout((()=>t(o())))}))):Promise.resolve("");var o}(r,o):Promise.resolve("")),this.GTt||(e.freezeVar("extraUrlParams"),this.GTt=this.eIt(this.baseUrl,e,n)),!this.zTt&&this.$Tt){const t=new Wi(e.vars,e.iterations,!0);this.zTt=this.eIt(this.$Tt,t,n)}const c=Lt(Lt({},t),i.extraUrlParams),a=this.win.Date.now(),l=ws(this.Vtt,this._O,c,e,n,this.yf,this.dr).then((t=>({"trigger":i.on,"timestamp":a,"extraUrlParams":t})));this.YTt.push(l),this.Pe(s||!this.qTt)}dispose(){this.Gs(),this.JTt&&(this.win.clearTimeout(this.JTt),this.JTt=null),this.XTt&&(this.win.clearTimeout(this.XTt),this.XTt=null)}eIt(t,i,e){return this.Vtt.expandTemplate(t,i,this.yf,e,this.dr).then((t=>this._O.expandUrlAsync(t,e,this.dr).catch((i=>J(!1,`Could not expand URL "${t}": ${i.message}`)))))}Pe(t){0!=this.JK&&t&&this.sIt()}sIt(){const{GTt:t,YTt:i,zTt:e}=this,s=this.QTt;this.Gs(),(e||t).then((t=>{this.KTt.url(this.Ci,t,!0)})),Promise.all([t,Promise.all(i),e]).then((t=>{const i=this.nIt(t[0],t[2]),e=t[1];0!==e.length&&(s.iframePing?(J(s.on==ke,"iframePing is only available on page view requests."),this.lI.sendRequestUsingIframe(i,e[0])):this.lI.sendRequest(i,e,!!this.qTt))}))}Gs(){this.JK=0,this.GTt=null,this.YTt=[],this.QTt=null}iIt(){if(this.qTt){this.qTt=o(this.qTt)?this.qTt:[this.qTt];for(let t=0;t<this.qTt.length;t++){let i=this.qTt[t];J(A(i),"Invalid batchInterval value: %s",this.qTt),i=1e3*Number(i),J(i>=200,"Invalid batchInterval value: %s, interval value must be greater than %s ms.",this.qTt,200),this.qTt[t]=i}this.WTt=0,this.rIt()}}tIt(){this.BTt&&(this.XTt=this.win.setTimeout((()=>{this.Pe(!0),this.ZTt=!1,this.JTt&&(this.win.clearTimeout(this.JTt),this.JTt=null)}),1e3*this.BTt))}rIt(){K(null!=this.WTt);const t=this.WTt<this.qTt.length?this.qTt[this.WTt++]:this.qTt[this.qTt.length-1];this.JTt=this.win.setTimeout((()=>{this.Pe(!0),this.rIt()}),t)}nIt(t,i){return i?this.lk.parse(i).origin+t:t}};function ws(t,i,e,s,n,r,h){const u={},c=[],a=new Wi(s.vars,s.iterations,!0),l=(e,s,u)=>{const d=e[s];if("string"==typeof d){u[s]=void 0;const e=t.expandTemplate(d,a,r).then((t=>i.expandStringAsync(t,n,h))).then((t=>{u[s]=t}));c.push(e)}else if(o(d)){u[s]=[];for(let t=0;t<d.length;t++)l(d,t,u[s])}else if(f(d)&&null!==d){u[s]={};const t=Object.keys(d);for(let i=0;i<t.length;i++)l(d,t[i],u[s])}else u[s]=d},d=Object.keys(e);for(let t=0;t<d.length;t++)l(e,d[t],u);return Promise.all(c).then((()=>u))}var Vs=class{constructor(t,i){this.Rdt=i,this.EG=!1,this.oIt=[],this.vgt=new class{constructor(t,i,e,s){this.Mv=t,this.Dv=e,this.Fv=[],this.Wv=function(t,i,e,s,n,r){K(t.src),K(!t.parentNode),K(e);const o=t.ownerDocument.defaultView;!function(t){t.listeningFors||t.addEventListener("message",(function(i){if(!yt(i))return;const e=function(t){return"string"==typeof t&&(t="{"==t.charAt(0)?E(t,(t=>{}))||null:hi(t)?function(t){if(!hi(t))return null;const i=t.indexOf("{");return p(-1!=i),E(t.substr(i),(i=>{V(new Error(`MESSAGING: Failed to parse message: ${t}\n${i.message}`))}))}(t):null),t}(yt(i));if(!e||!e.sentinel)return;const s=function(t,i,e,s){const n=_i(t,i);if(!n)return n;let r;for(let t=0;t<n.length;t++){const i=n[t],{contentWindow:e}=i.frame;if(e){if(s==e||mi(e,s)){r=i;break}}else setTimeout(Ai,0,n)}return r?r.events:null}(t,e.sentinel,i.origin,i.source);if(!s)return;let n=s[e.type];if(n){n=n.slice();for(let t=0;t<n.length;t++)(0,n[t])(e,i.source,i.origin,i)}}))}(o);const h=function(t,i,e){const s=_i(t,pi(i,e),!0);let n;for(let t=0;t<s.length;t++){const e=s[t];if(e.frame===i){n=e;break}}return n||(n={frame:i,events:Object.create(null)},s.push(n)),n.events}(o,t,s),u=Yt(t.src).origin;let c,a=h[i]||(h[i]=[]),l=function(i,s,o,h){if("amp"==i.sentinel){if(s!=t.contentWindow)return;const i="null"==o&&r;if(u!=o&&!i)return}(n||s==t.contentWindow)&&(i.sentinel!=di?e(i,s,o,h):c())};return a.push(l),c=function(){if(l){const t=a.indexOf(l);t>-1&&a.splice(t,1),l=null,a=null,e=null}}}(this.Mv,i,((t,i,e)=>{this.Fv.some((t=>t.win==i))||this.Fv.push({win:i,origin:e}),s(t,i,e)}),this.Dv,this.Dv)}send(t,i){(function(t,i){const e=[];let s=0;for(let i=0;i<t.length;i++){const n=t[i];n.win.parent?(s<i&&(t[s]=n),s++):e.push(n)}s<t.length&&(t.length=s)})(this.Fv),function(t,i,e,s,n){if(!t.contentWindow)return;s.type=e,s.sentinel=pi(t,n);let r=s;n&&(r="amp-"+JSON.stringify(s));for(let t=0;t<i.length;t++){const e=i[t];e.win.postMessage(r,e.origin)}}(this.Mv,this.Fv,t,i,this.Dv)}destroy(){this.Wv(),this.Fv.length=0}}(this.Rdt,"send-iframe-transport-events",!0,(()=>{this.setIsReady()}))}isReady(){return this.EG}setIsReady(){this.EG=!0,this.hIt()}queueSize(){return this.oIt.length}enqueue(t){K(t&&t.creativeId&&t.message),this.oIt.push(t),this.queueSize()>=100&&this.oIt.shift(),this.hIt()}hIt(){this.isReady()&&this.queueSize()&&(this.vgt.send("iframe-transport-events",{events:this.oIt}),this.oIt=[])}},Os=class{constructor(t,i,e,s){this.uIt=t,this.TT=i,this.cIt=s,K(e&&e.iframe),this.aIt=e.iframe,this.lIt=0,this.processCrossDomainIframe()}detach(){Os.markCrossDomainIframeAsDone(this.uIt.document,this.TT)}processCrossDomainIframe(){let t;Os.hasCrossDomainIframe(this.TT)?(t=Os.getFrameData(this.TT),++t.usageCount):(t=this.createCrossDomainIframe(),this.uIt.document.body.appendChild(t.frame),this.Zp()),K(t)}createCrossDomainIframe(){const t=Os.fIt(),i=JSON.stringify({scriptSrc:(this.uIt,D.thirdParty+"/2203281422000/iframe-transport-client-v0.js"),sentinel:t,type:this.TT}),e=R(this.uIt.document,"iframe",{sandbox:"allow-scripts allow-same-origin",name:i,"data-amp-3p-sentinel":t});e.sentinel=t,fi(e,!1),e.src=this.aIt;const s={frame:e,usageCount:1,queue:new Vs(this.uIt,e)};return Os.dIt[this.TT]=s,s}Zp(){var t;(t=this.uIt).PerformanceObserver&&t.TaskAttributionTiming&&"containerName"in t.TaskAttributionTiming.prototype&&(Os._It[this.TT]=new this.uIt.PerformanceObserver((t=>{t&&t.getEntries().forEach((t=>{t&&"longtask"==t.entryType&&"cross-origin-descendant"==t.name&&t.attribution&&t.attribution.forEach((t=>{this.aIt==t.containerSrc&&++this.lIt%5==0&&G().error("amp-analytics/iframe-transport",`Long Task: Vendor: "${this.TT}"`)}))}))})),Os._It[this.TT].observe({entryTypes:["longtask"]}))}static markCrossDomainIframeAsDone(t,i){const e=Os.getFrameData(i);K(e&&e.frame&&e.usageCount),--e.usageCount||(t.body.removeChild(e.frame),delete Os.dIt[i],Os._It[i]&&(Os._It[i].disconnect(),Os._It[i]=null))}static hasCrossDomainIframe(t){return _(Os.dIt,t)}static fIt(){return String(++Os.mIt)}sendRequest(t){const i=Os.getFrameData(this.TT);K(i),K(i.queue),i.queue.enqueue({creativeId:this.cIt,message:t})}static getFrameData(t){return Os.dIt[t]}static resetCrossDomainIframes(){Os.dIt={}}getCreativeId(){return this.cIt}getType(){return this.TT}};function Ns(t,i,e=!1){const s=new(gi.getImage(t));return e&&(s.referrerPolicy="no-referrer"),s.src=i,s}Os.dIt={},Os.mIt=0,Os._It={};var Cs,ks="amp-analytics/transport",Ds=class{constructor(t,i={}){this.Ci=t,this.i=t.win,this.it=i,this.ge=this.it.referrerPolicy,"no-referrer"===this.ge&&(this.it.beacon=!1,this.it.xhrpost=!1),this.AIt=!!this.it.useBody,this.pIt=null,this.PIt="inabox"==F(this.i).runtime}sendRequest(t,i,e){if(!t||0===i.length)return;const s=this.EIt(),n=function(n){const r={};return n=>{const o=String(n);return void 0===r[o]&&(r[o]=function(n){const r=e?s.generateBatchRequest(t,i,n):s.generateRequest(t,i[0],n);return r.url.startsWith("amp-script:")||(Zt(r.url,"amp-analytics request"),function(t){J(!("__amp_source_origin"in U(Yt(t).search)),"Source origin is not allowed in %s",t)}(r.url)),r}(n)),r[o]}}();if(this.it.iframe)return this.pIt?void this.pIt.sendRequest(n(!1).url):void Y().error(ks,"iframe transport was inadvertently deleted");if(this.it["amp-script"])return void Ds.forwardRequestToAmpScript(this.Ci,{url:t,payload:n(!0).payload});if(this.it.beacon&&Ds.sendRequestUsingBeacon(this.i,n(this.AIt)))return;if(this.it.xhrpost&&Ds.sendRequestUsingXhr(this.i,n(this.AIt)))return;const r=this.it.image;if(r){const t="object"==typeof r&&r.suppressWarnings;Ds.sendRequestUsingImage(this.i,n(!1),t,this.ge)}}maybeInitIframeTransport(t){if(!this.it.iframe||this.pIt)return;const i=et(T(t)),e=t.getAttribute("type"),s=this.PIt?"1":G().assertString(function(t,i){try{const e=st(t,i).parentElement;if("AMP-AD"==e.nodeName)return String(e.getResourceId())}catch(t){}return null}(t,i),"No friendly amp-ad ancestor element was found for amp-analytics tag with iframe transport.");this.pIt=new Os(i,e,this.it,s)}deleteIframeTransport(){this.pIt&&(this.pIt.detach(),this.pIt=null)}sendRequestUsingIframe(t,i){const e=ys(t,[i]);if(!e)return void G().error(ks,"Request not sent. Contents empty.");Zt(e,"amp-analytics request"),J(Yt(e).origin!=Yt(this.i.location.href).origin,"Origin of iframe request must not be equal to the document origin. See https://github.com/ampproject/amphtml/blob/main/docs/spec/amp-iframe-origin-policy.md for details.");const s=this.i.document.createElement("iframe");fi(s,!1),s.onload=s.onerror=()=>{Pt(this.i).delay((()=>{var t,i;null===(i=(t=s).parentElement)||void 0===i||i.removeChild(t)}),5e3)},s.setAttribute("amp-analytics",""),s.setAttribute("sandbox","allow-scripts allow-same-origin"),s.src=e,this.i.document.body.appendChild(s)}EIt(){return bs.default}static sendRequestUsingImage(t,i,e,s){t&&function(t){let i,e;if(function(t){return!!(t.complete||"complete"==t.readyState||wt(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}(t))return Promise.resolve(t);const s=wt(t);return s&&t.__AMP_MEDIA_LOAD_FAILURE_SRC===t.currentSrc?Promise.reject(t):new Promise(((n,r)=>{if(i=s?St(t,"loadedmetadata",n,{capture:!0}):St(t,"load",n),!t.tagName)return;let o=t;if(s&&!t.hasAttribute("src")&&(o=function(t,i){for(let e=t.lastElementChild;e;e=e.previousElementSibling)if(i(e))return e;return null}(t,(t=>"SOURCE"===t.tagName)),!o))return r(new Error("Media has no source."));e=St(o,"error",r)})).then((()=>(e&&e(),t)),(()=>{i&&i(),function(t){wt(t)&&(t.__AMP_MEDIA_LOAD_FAILURE_SRC=t.currentSrc||!0);let i=t;throw i&&i.src&&(i=i.src),G().createError("Failed to load:",i)}(t)}))}(function(t,i,e){return e&&"no-referrer"!==e&&G().error("pixel","Unsupported referrerPolicy: %s",e),"no-referrer"===e?function(t,i){if("referrerPolicy"in Image.prototype)return Ns(t,i,!0);{const e=R(t.document,"iframe",{"src":"about:blank","style":"display:none"});return e.onload=()=>{Ns(e.contentWindow,i)},t.document.body.appendChild(e),e}}(t,i):Ns(t,i)}(t,i.url,s)).then((()=>{})).catch((()=>{}))}static sendRequestUsingBeacon(t,i){const e=gi.getSendBeacon(t);return!!e&&e(i.url,i.payload||"")}static sendRequestUsingXhr(t,i){const e=gi.getXMLHttpRequest(t);if(!e)return!1;const s=new e;return"withCredentials"in s&&(s.open("POST",i.url,!0),s.withCredentials=!0,s.setRequestHeader("Content-Type","text/plain"),s.onreadystatechange=()=>{s.readyState},s.send(i.payload||""),!0)}static forwardRequestToAmpScript(t,i){return _t(t).then((t=>{J(t,"AMP-SCRIPT is not installed"),t.fetch(i.url,JSON.parse(i.payload))}))}},Ls="amp-analytics",xs=[ke,ye,Se,we],Us=class extends t.BaseElement{constructor(t){super(t),this.TIt=n(),this.gIt=null,this.vIt=!1,this.VT={},this.lU={},this.IIt=null,this.RIt=null,this.Vtt=null,this.MIt=mt(this.win),this.bIt=null,this.lI=null,this.TT=this.element.getAttribute("type"),this.PIt="inabox"==F(this.win).runtime,this.yIt=null,this.SIt=null,this.wIt=null}getLayoutPriority(){return this.PIt?0:1}isAlwaysFixed(){return!Ei(this.element)}isLayoutSupported(t){return!0}buildCallback(){this.vIt=this.element.hasAttribute("sandbox"),this.element.setAttribute("aria-hidden","true"),this.gIt=this.element.getAttribute("data-consent-notification-id"),null!=this.gIt&&(this.TIt=Tt(this.element).then((t=>t.get(this.gIt)))),"immediate"==this.element.getAttribute("trigger")&&this.VIt()}layoutCallback(){return this.VIt()}detachedCallback(){this.RIt&&(this.RIt.dispose(),this.RIt=null),this.yIt&&(this.yIt.dispose(),this.yIt=null);for(const t in this.VT)this.VT[t].dispose(),delete this.VT[t]}resumeCallback(){this.bIt&&this.bIt.then((()=>{this.lI.maybeInitIframeTransport(this.element)}))}unlayoutCallback(){return!this.getAmpDoc().isVisible()&&(this.bIt&&this.bIt.then((()=>{this.lI.deleteIframeTransport()})),super.unlayoutCallback())}VIt(){if(this.bIt)return this.bIt;const t=this.getAmpDoc();return this.bIt=t.whenFirstVisible().then((()=>Pt(this.win).promise(1))).then((()=>this.TIt)).then((()=>{return Promise.all([(i=t,tt(i,"amp-analytics-instrumentation")),te(t)]);var i})).then((t=>{this.IIt=t[0],this.Vtt=t[1];const i=new r,e=()=>{const t=new class{constructor(t){this.yf=t,this.i=null,this.OIt=Ut||{},this.mAt={},this.lU={},this.NIt={},this.vIt=!1,this.Vtt=Qi(t)}loadConfig(){return this.i=this.yf.ownerDocument.defaultView,this.vIt=this.yf.hasAttribute("sandbox"),Promise.all([this.CIt(),this.kIt()]).then(this.DIt.bind(this)).then(this.LIt.bind(this)).then((()=>this.lU))}xIt(t){const i=(this.i.location,D.cdn),e="bg"===t&&null!==(s=self.AMP_CONFIG)&&void 0!==s&&s.canary?".canary":"";var s;return`${i}/rtv/${F().rtvVersion}/v0/analytics-vendors/${t}${e}.json`}kIt(){const t=this.yf.getAttribute("type");if(!t)return n();const i=this.xIt(t),e=this.Xi();return Rt(this.i).fetchJson(i,{ampCors:!1}).then((t=>t.json())).then((t=>{this.mAt=t||{}}),(t=>{G().error(e,"Error loading vendor config: ",i,t)}))}CIt(){let t=this.yf.getAttribute("config");if(!t||this.vIt)return n();Zt(t,this.yf);const i=this.Xi(),e={};return this.yf.hasAttribute("data-credentials")&&(e.credentials=this.yf.getAttribute("data-credentials")),Et(this.yf).expandUrlAsync(t,this.Vtt.getMacros(this.yf)).then((i=>(t=i,Rt(this.i).fetchJson(t,e)))).then((t=>t.json())).then((t=>{this.NIt=t}),(e=>{G().error(i,"Error loading remote config: ",t,e)}))}DIt(){const t=this.UIt().url,i={},e=this.EU();return this.HIt(e),ne(e,i),ne(this.NIt,i),!t||this.vIt?(this.lU=this.jIt(i),n()):this.FIt(i,t)}FIt(t,i){Zt(i,this.yf);const e=this.Xi();return this.$It(t).then((()=>{const s={method:"POST",body:t};return this.yf.hasAttribute("data-credentials")&&(s.credentials=this.yf.getAttribute("data-credentials")),Et(this.yf).expandUrlAsync(i).then((t=>Rt(this.i).fetchJson(t,s))).then((t=>t.json())).then((t=>{this.lU=this.jIt(t)}),(t=>{G().error(e,"Error rewriting configuration: ",i,t)}))}))}LIt(){this.lU.warningMessage&&(this.Xi(),this.yf.getAttribute("type"),this.yf.getAttribute("config"),delete this.lU.warningMessage)}$It(t){const i=t.configRewriter,e=i&&i.varGroups,s=this.UIt().varGroups;if(!e&&!s)return n();if(e&&!s)return this.Xi(),n();t.configRewriter=t.configRewriter||{};const r=t.configRewriter;r.vars={};const o=[],h=e||{};return m(h,s),Object.keys(h).forEach((t=>{const i=h[t];if(!i.enabled)return;const e=this.shallowExpandObject(this.yf,i).then((t=>{delete t.enabled,Object.assign(r.vars,t)}));o.push(e)})),Promise.all(o).then((()=>{if(!Object.keys(r.vars).length)return delete t.configRewriter;e&&delete r.varGroups}))}jIt(t){const i={"vars":{"requestCount":0}};return ne(re(this.OIt),i),ne(re(this.mAt),i,!0),ne(re(t),i,!0),i}UIt(){return this.mAt.configRewriter||{}}EU(){if(this.yf.CONFIG)return this.yf.CONFIG;let t={};const i=this.Xi();try{const{children:e}=this.yf;1==e.length?t=function(t){const i=(s=t,p(/^[\w-]+$/.test("script")),"> script",s.querySelectorAll(g("> script",":scope"))),{length:e}=i;var s;if(1!==e)throw new Error(`Found ${e} <script> children. Expected 1.`);const n=i[0];if(!function(t){var i;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(i=t.getAttribute("type"))||void 0===i?void 0:i.toUpperCase())}(n))throw new Error('<script> child must have type="application/json"');try{var r;return P(null!==(r=n.textContent)&&void 0!==r?r:"")}catch(t){throw new Error("Failed to parse <script> contents. Is it valid JSON?")}}(this.yf):e.length>1&&G().error(i,"The tag should contain only one <script> child.")}catch(t){G().error(i,t.message)}return t}HIt(t){if(this.yf.getAttribute("type")&&(t.transport||this.NIt.transport)){const t=this.Xi();G().error(t,"Inline or remote config should not overwrite vendor transport settings")}t.transport&&t.transport.iframe&&(G().error(se,"Inline configs are not allowed to specify transport iframe"),t.transport.iframe=void 0),this.NIt.transport&&this.NIt.transport.iframe&&(G().error(se,"Remote configs are not allowed to specify transport iframe"),this.NIt.transport.iframe=void 0)}Xi(){return"AmpAnalytics "+(this.yf.getAttribute("id")||"<unknown id>")}shallowExpandObject(t,i){const e={},s=[],n=[],r=Et(t),o=Qi(t).getMacros(t);return Object.keys(i).forEach((t=>{s.push(t);const e=r.expandStringAsync(i[t],o);n.push(e)})),Promise.all(n).then((t=>(s.forEach(((i,s)=>e[i]=t[s])),e)))}}(this.element).loadConfig();i.resolve(t)};return this.PIt?e():ae(this.element,e,20),i.promise})).then((t=>(this.lU=t,new class{constructor(t,i,e){this.i=t,this.yf=i,this._O=Et(i),this.qIt=null,this.lU=e,this.lr=Qi(i).getMacros(i)}write(){if(!this.qIt){this.qIt=new r;const t=()=>{this.qIt.resolve(this.Cu())};ae(this.yf,t,10)}return this.qIt.promise}Cu(){if(!Ti(this.i,this.yf))return n();if(!_(this.lU,"cookies"))return n();if(!f(this.lU.cookies))return G().error(me,"cookies config must be an object"),n();const t=this.lU.cookies;if(!1===t.enabled)return n();const i=this.iK(t),e=Object.keys(t),s=[];for(let n=0;n<e.length;n++){const r=e[n],o=t[r],h=this.BIt(o.sameSite||o.SameSite||t.sameSite||t.SameSite);this.oK(r,o)&&s.push(this.hK(r,o.value,i,h))}return Promise.all(s)}iK(t){if(!_(t,"cookieMaxAge"))return oe;const i=Number(t.cookieMaxAge);return i||0===i?1e3*i:(G().error(me,"invalid cookieMaxAge %s, falling back to default value (1 year)",t.cookieMaxAge),oe)}oK(t,i){return!(Ae[t]||(f(i)?!_(i,"value")&&(G().error(me,"value is required in the cookieValue object"),1):(G().error(me,"cookieValue must be configured in an object"),1)))}hK(t,i,e,s){return this._O.expandStringAsync(i,this.lr).then((i=>{if(i){const n=Date.now()+e,r=s===si;!function(t,i,e,s,n={}){let r;!function(t,i,e){if(i.allowOnProxyOrigin)return void J(!i.highestAvailableDomain,"Could not support highestAvailable Domain on proxy origin, specify domain explicitly");J(!Qt(t.location.href),`Should never attempt to set cookie on proxy origin: ${e}`);const s=Yt(t.location.href).hostname.toLowerCase(),n=Yt(D.cdn).hostname.toLowerCase();J(!(s==n||u(s,"."+n)),"Should never attempt to set cookie on proxy origin. (in depth check): "+e)}(t,n,i),n.domain?r=n.domain:n.highestAvailableDomain&&(r=ri(t)),oi(t,i,e,s,r,n.sameSite,n.secure)}(this.i,t,i,n,{highestAvailableDomain:!0,sameSite:s,secure:r})}})).catch((t=>{G().error(me,"Error expanding cookie string",t)}))}BIt(t){switch(t){case"Strict":return"Strict";case"Lax":return"Lax";case"None":return si;default:return}}}(this.win,this.element,this.lU).write()))).then((()=>{this.lI=new Ds(this.getAmpDoc(),this.lU.transport||{})})).then(this.WIt.bind(this)).then(this.GIt.bind(this)).then(this.zIt.bind(this)),this.bIt.then((()=>{this.collapse()})),this.bIt}YIt(){return!!this.PIt||(null==this.wIt&&(this.wIt=Ei(this.element)),this.wIt)}WIt(){return this.lU.triggers&&Object.values(this.lU.triggers).some((t=>{var i;return null==t||null===(i=t.session)||void 0===i?void 0:i.persistEvent}))&&this.TT?ji(this.getAmpDoc()).then((t=>{this.SIt=t})):n()}GIt(){if(this.KIt())return this.Xi(),n();if(this.JIt(),!this.lU.triggers){const t=this.Xi();return this.user().warn(t,"No triggers were found in the config. No analytics data will be sent."),n()}this.XIt(this.lU.extraUrlParams,this.lU.extraUrlParamsReplaceMap),this.RIt=this.IIt.createAnalyticsGroup(this.element),this.lI.maybeInitIframeTransport(this.element);const t=[];for(const e in this.lU.triggers)if(_(this.lU.triggers,e)){const s=this.lU.triggers[e],n=this.ZIt({},s,void 0,!0),r=this.Xi();if(!s){this.user().error(r,"Trigger should be an object: ",e);continue}const h=s.request||s.parentPostMessage&&this.YIt();if(!s.on||!h){const t=this.YIt()?'/"parentPostMessage"':"";this.user().error(r,'"on" and "request"'+t+" attributes are required for data to be collected.");continue}if(this.vIt){const t=s.on;if(!("click"!==(i=t)&&"browser-event"!==i&&"custom"!==i&&"hidden"!==i&&"ini-load"!==i&&"render-start"!==i&&"scroll"!==i&&"story"!==i&&"timer"!==i&&"video"!==i&&"visible"!==i||xs.includes(t))){this.user().error(r,t+" is not supported for amp-analytics in scope");continue}}this.XIt(s.extraUrlParams,this.lU.extraUrlParamsReplaceMap),t.push(this.QIt(s).then((t=>{if(t){if(this.vIt){if(!this.element.parentElement)return;return s.selector=this.element.parentElement.tagName,s.selectionMethod="closest",this.tRt(s)}return s.selector&&!o(s.selector)?this.Vtt.expandTemplate(s.selector,n,this.element).then((t=>(s.selector=t,this.tRt(s)))):this.tRt(s)}})))}var i;return Promise.all(t)}preload(t,i){pt(this.win).preload(this.getAmpDoc(),t,i)}tRt(t){if(!this.RIt)return n();try{return this.RIt.addTrigger(t,this.yw.bind(this,t))}catch(i){return V(this.Xi(),'Failed to process trigger "'+t.on+'"',i),n()}}XIt(t,i){if(t&&i){let e=0;for(const s in i){if(++e>16){const t=this.Xi();this.user().error(t,"More than 16 extraUrlParamsReplaceMap rules aren't allowed; Skipping the rest");break}for(const e in t){const n=e.replace(s,i[s]);if(e!=n){const i=t[e];delete t[e],t[n]=i}}}}}KIt(){const t=this.lU.optoutElementId;if(t&&this.win.document.getElementById(t))return!0;if(!this.lU.optout)return!1;const i=this.lU.optout.split(".");let e=this.win;for(let t=0;t<i.length;t++){if(!e)return!1;e=e[i[t]]}return e()}JIt(){if(this.lU.requests){if(this.lU.requests){for(const t in this.lU.requests)_(this.lU.requests,t)&&(this.lU.requests[t].baseUrl||(this.user().error(Ls,"request must have a baseUrl"),delete this.lU.requests[t]));for(const t in this.lU.requests)this.lU.requests[t].baseUrl=c(this.lU.requests[t].baseUrl,(t=>{const i=this.lU.requests[t];return i&&i.baseUrl||"${"+t+"}"}),5);const t={};for(const i in this.lU.requests)if(_(this.lU.requests,i)){const e=this.lU.requests[i];t[i]=new Ss(this.element,e,pt(this.win),this.lI,this.vIt)}this.VT=t}}else if(!this.YIt()){const t=this.Xi();this.user().warn(t,"No request strings defined. Analytics data will not be sent from this page.")}}zIt(){this.yIt=new class{constructor(t,i,e,s){this.Ci=t,this.lU=i.linkers,this.qT=i.vars||{},this.TT=e,this.yf=s,this.iRt={},this.lk=vt(this.yf),this.bF=tt(t,"form-submit-service"),this.eRt=null,this.Vtt=Qi(this.Ci),this.sRt=null}init(){if(!f(this.lU))return n();this.sRt=ri(this.Ci.win),this.lU=this.nRt(this.lU);const t=Object.keys(this.lU).map((t=>{const i=this.lU[t].ids,e=Object.keys(i),s=e.map((t=>{const e=new Wi(this.qT,void 0,!0);return this.rRt(i[t],e)}));return Promise.all(s).then((i=>{const s={};return i.forEach(((t,i)=>{t&&(s[e[i]]=t)})),this.iRt[t]=s,s}))}));if(t.length){const t=Z(this.Ci,"navigation");t.registerAnchorMutator(((t,i)=>{t.href&&"click"===i.type&&(t.href=this.oRt(t.href))}),2),t.registerNavigateToMutator((t=>this.oRt(t)),2)}return this.hRt(),Promise.all(t)}dispose(){this.eRt&&this.eRt()}nRt(t){const i={},e={enabled:this.uRt()&&this.cRt()},s=Object.keys(t).filter((i=>{const s=t[i],n=f(s);return n||(e[i]=s),n})),n=gi.getLocation(this.Ci.win),r=this.lk.isProxyOrigin(n);return s.forEach((s=>{const n=Lt(Lt({},e),t[s]);!0===n.enabled&&(r||!1===n.proxyOnly)&&(n.ids?i[s]=n:G().error("amp-analytics/linker-manager",'"ids" is a required field for use of "linkers".'))})),i}rRt(t,i){const e=this.Vtt.getMacros(this.yf);return this.Vtt.expandTemplate(t,i,this.yf).then((t=>Et(this.yf).expandUrlAsync(t,e)))}uRt(){return"googleanalytics"===this.TT&&"googleanalytics"===this.Ci.getMetaByName("amp-google-client-id-api")&&this.Ci.registerSingleton(2)}cRt(){const t=X(this.Ci.win,"platform");return t.isSafari()&&t.getMajorVersion()>=12}oRt(t){const i=this.lU;for(const e in i)this.iRt[e]&&(t=this.aRt(t,e,i[e]));return t}aRt(t,i,e){const s=this.lk.parse(t);if(this.lRt(s,i,e)&&this.fRt(s)){const e=bi("1",this.iRt[i]);if(e){const s={};return s[i]=e,function(t,i){const e=U(Yt(t).search),s={},n=Object.keys(i);for(let t=0;t<n.length;t++)_(e,n[t])||(s[n[t]]=i[n[t]]);return function(t,i){return Kt(t,Xt(i))}(t,s)}(t,s)}}return t}lRt(t,i,e){const s=e.destinationDomains,{hostname:n}=t,r=gi.getHostname(this.Ci.win),o=e.sameDomainEnabled;if(!Boolean(o)&&r===n)return!1;if(s&&!Array.isArray(s))return!1;if(s)return this.dRt(s,n);const{canonicalUrl:h,sourceUrl:u}=Z(this.Ci,"documentInfo").get(),c=gs(this.lk.parse(h).hostname,n);if(this.sRt){const t=[this.sRt,"*"+this.sRt];return this.dRt(t,n)||c}return gs(this.lk.parse(u).hostname,n)||c}fRt(t){return"https:"===t.protocol||"http:"===t.protocol}dRt(t,i){for(let e=0;e<t.length;e++){const s=t[e];if(s===i)return!0;if(-1!==s.indexOf("*")&&Is(i,s))return!0}return!1}hRt(){this.eRt||this.bF.then((t=>{this.eRt=t.beforeSubmit(this._Rt.bind(this))}))}_Rt(t){const{actionXhrMutator:i,form:e}=t;for(const t in this.lU){const s=this.lU[t],n=e.getAttribute("action-xhr")||e.getAttribute("action"),r=this.lk.parse(n);this.lRt(r,t,s)&&this.mRt(e,i,t)}}mRt(t,i,e){const s=this.iRt[e];if(!s)return;const n=bi("1",s),r=t.getAttribute("action-xhr");if(r)return i(Kt(r,Jt(e,n),void 0));this.ARt(t,e,n)}ARt(t,i,e){const s={"type":"hidden","name":i,"value":e},n=R(t.ownerDocument,"input",s);t.appendChild(n)}}(this.getAmpDoc(),this.lU,this.TT,this.element);const t=()=>{this.yIt.init()};this.PIt?t():ae(this.element,t,10)}yw(t,i){var e,s;null===(e=t.session)||void 0===e||!e.persistEvent||null===(s=this.SIt)||void 0===s||s.updateEvent(this.TT);const n=o(t.request)?t.request:[t.request];for(let e=0;e<n.length;e++){const s=n[e];this.pRt(s,t,i)}}pRt(t,i,e){this.element.ownerDocument.defaultView||this.Xi();const s=this.VT[t],n=this.YIt()&&i.parentPostMessage;if(null!=t&&!s){const t=this.Xi();if(this.user().error(t,"Ignoring request for event. Request string not found: ",i.request),!n)return}this.PRt(i,e).then((t=>{const n=this.element.ownerDocument&&this.element.ownerDocument.defaultView;t&&n&&(this.ERt(s,i,e),i.parentPostMessage&&this.YIt()&&b(this.win)&&this.TRt(i,e))}))}ERt(t,i,e){if(!t)return;this.lU.vars.requestCount++;const s=this.ZIt(e,i);t.send(this.lU.extraUrlParams,i,s)}TRt(t,i){const e=t.parentPostMessage,s=this.ZIt(i,t);(function(t,i,e,s,n,r){const o=Qi(t),h=Et(r),u=o.getMacros(r);n.freezeVar("extraUrlParams");const c=o.expandTemplate(i,n,r).then((t=>h.expandStringAsync(t,u)));return i.indexOf("${extraUrlParams}")<0?c:c.then((t=>{const i=Lt(Lt({},e),s.extraUrlParams);return ws(o,h,i,n,u,r).then((i=>ys(t,[{"extraUrlParams":i}])))}))})(this.getAmpDoc(),e,this.lU.extraUrlParams,t,s,this.element).then((t=>{this.win.parent.postMessage(t,"*")}))}QIt(t){const i=t.sampleSpec,e=this.Xi();if(!i)return Promise.resolve(!0);const s=i.sampleOn;if(!s)return this.user().error(e,"Invalid sampleOn value."),Promise.resolve(!0);const n=parseFloat(i.threshold);if(n>=0&&n<=100){const i=new r,e=()=>{const e=this.ZIt({},t),r=this.rRt(s,e).then((t=>this.MIt.uniform(t))).then((t=>100*t<n));i.resolve(r)};return this.PIt?e():ae(this.element,e,10),i.promise}return G().error(e,"Invalid threshold for sampling."),Promise.resolve(!0)}PRt(t,i){const e=this.ZIt(i,t),s=this.gRt(this.lU.enabled,e),n=this.gRt(t.enabled,e);return Promise.all([s,n]).then((t=>(K(2===t.length),t[0]&&t[1])))}gRt(t,i){return void 0===t?Promise.resolve(!0):"boolean"==typeof t?Promise.resolve(t):this.rRt(t,i).then((t=>ee(t)))}rRt(t,i){return this.Vtt.expandTemplate(t,i,this.element).then((t=>Et(this.element).expandUrlAsync(t,this.Vtt.getMacros(this.element))))}Xi(){return"AmpAnalytics "+(this.element.getAttribute("id")||"<unknown id>")}ZIt(t,i,e,s){const n={};return ne(this.lU.vars,n),ne(i.vars,n),ne(t.vars,n),new Wi(n,e,s)}};t.registerServiceForDoc("amp-analytics-instrumentation",class{constructor(t){this.ampdoc=t,this.Su=this.vRt(t.getRootNode())}dispose(){this.Su.dispose()}getAnalyticsRoot(t){return this.vRt(t)}createAnalyticsGroup(t){const i=this.vRt(t);return new class{constructor(t,i){this.Su=t,this.IRt=i,this.Wf=[],this.RRt=0,this.i=T(i)}dispose(){this.Wf.forEach((t=>{t()}))}addTrigger(t,i){const e=t.on,s=Ue(e),n=He(this.Su.getType()),o=this.Su.getTrackerForAllowlist(s,n);let h;J(!!o,'Trigger type "%s" is not allowed in the %s',e,this.Su.getType());const u=new r,c=()=>{h=o.add(this.IRt,e,t,i),this.Wf.push(h),u.resolve()};if(this.RRt<1||"inabox"==F(this.i).runtime)c();else{const t=this.RRt<3?20:10;ae(this.IRt,c,t)}return this.RRt++,u.promise}}(i,t)}MRt(t){return t===Oe?Be:qe}triggerEventForTarget(t,i,e={},s=!0){const n=new je(t,i,e,s),r=this.vRt(t),o=Ue(i);r.getTracker(o,this.MRt(o)).trigger(n)}vRt(t){const i=dt(t),e=st(t),s=e&&Pi(e);return i==this.ampdoc&&!s&&this.Su?this.Su:this.bRt(s||i,(()=>s?new Ps(i,s):new ps(i)))}bRt(t,i){let e=t[Ts];return e||(e=i(),t[Ts]=e),e}}),t.registerServiceForDoc("activity",class{constructor(t){this.ampdoc=t,this.yRt=this.SRt.bind(this),this.wRt=this.VRt.bind(this),this.ORt=this.NRt.bind(this),this.CRt=this.kRt.bind(this),this.DRt={},this.LRt=[],this.xRt=!1,this.URt=!1,this.HRt=new class{constructor(){this.jRt=0,this.FRt=void 0}push(t){this.FRt&&this.FRt.time<t.time&&(this.jRt+=Ot(this.FRt,t.time)),this.FRt=t}getTotalEngagedTime(t){let i=0;return void 0!==this.FRt&&(i=this.jRt+Ot(this.FRt,t)),i}},this.bn=It(this.ampdoc),this.ampdoc.whenFirstVisible().then(this.Kn.bind(this))}Kn(){this.hr=Date.now(),this.VRt(),this.$Rt()}qRt(){const t=Date.now()-this.hr;return t>0?t:0}SRt(){this.xRt=!1,this.URt=!1}$Rt(){this.BRt(this.ampdoc.getRootNode(),Nt,this.wRt),this.BRt(this.ampdoc.getRootNode(),Ct,this.ORt),this.LRt.push(this.ampdoc.onVisibilityChanged(this.CRt)),this.bn.onScroll(this.wRt)}BRt(t,i,e){for(let s=0;s<i.length;s++)this.LRt.push(bt(t,i[s],e))}VRt(){this.xRt||(this.xRt=!0,this.URt=!1,this.WRt(Vt))}NRt(){this.URt||(this.URt=!0,this.xRt=!1,this.WRt("inactive"))}WRt(t){const i=this.qRt(),e=Math.floor(i/1e3),s=1e3-i%1e3;setTimeout(this.yRt,s),this.HRt.push({type:t,time:e})}kRt(){this.ampdoc.isVisible()?this.VRt():this.NRt()}Wv(){for(let t=0;t<this.LRt.length;t++){const i=this.LRt[t];"function"==typeof i&&i()}this.LRt=[]}yn(){this.Wv()}getTotalEngagedTime(){const t=Math.floor(this.qRt()/1e3);return this.HRt.getTotalEngagedTime(t)}getIncrementalEngagedTime(t,i=!0){if(!_(this.DRt,t))return i&&(this.DRt[t]=this.getTotalEngagedTime()),this.getTotalEngagedTime();const e=this.DRt[t];return!1===i?this.getTotalEngagedTime()-e:(this.DRt[t]=this.getTotalEngagedTime(),this.DRt[t]-e)}}),ht(Cs=et(Cs=t.win),Cs,"amp-analytics-linker-reader",class{constructor(t){this.i=t,this.YJ={}}get(t,i){return t&&i?(_(this.YJ,t)||(this.YJ[t]=this.GRt(t)),this.YJ[t]&&this.YJ[t][i]?this.YJ[t][i]:null):(G().error("amp-analytics/linker-reader","LINKER_PARAM requires two params, name and id"),null)}GRt(t){const i=U(this.i.location.search);if(!_(i,t))return null;const e=i[t];return this.zRt(this.i.location,t),function(t){const i=function(t){const i=t.split(Ii),e=i.length%2==0;if(i.length<4||!e)return G().error(Mi,`Invalid linker_param value ${t}`),null;const s=Number(i.shift());return 1!==s?(G().error(Mi,`Invalid version number ${s}`),null):{checksum:i.shift(),serializedIds:i.join(Ii)}}(t);if(!i)return null;const{checksum:e,serializedIds:s}=i;return function(t,i){for(let e=0;e<=1;e++)if(yi(t,e)==i)return!0;return!1}(s,e)?function(t){const i={},e=t.split(Ii);for(let t=0;t<e.length;t+=2){const s=e[t];if(!Ri.test(s)){G().error(Mi,`Invalid linker key ${s}, value ignored`);continue}const n=Si(e[t+1]);i[s]=n}return i}(s):(G().error(Mi,"LINKER_PARAM value checksum not valid"),null)}(e)}zRt(t,i){if(!this.i.history.replaceState)return;const e=ti(t.search,i),s=t.origin+t.pathname+e+(t.hash||"");this.i.history.replaceState(null,"",s)}}),t.registerServiceForDoc("amp-analytics-session",class{constructor(t){this.oZ=tt(t,"storage"),this.YRt=d(),this.Ci=t,this.i=t.win,this.T_=[],this.KRt=null,this.es=null,this.JRt=!0,this.Cu()}Cu(){this.XRt(),this.T_.push(bt(this.i,"focus",(()=>{this.KRt=!0,this.ZRt()})),bt(this.i,"blur",(()=>{this.KRt=!1,this.ZRt()})),bt(this.i,"pageshow",(()=>{this.JRt=!0,this.ZRt()})),bt(this.i,"pagehide",(()=>{this.JRt=!1,this.ZRt()})),this.Ci.onVisibilityChanged((()=>{this.es=this.Ci.isVisible(),this.ZRt()})))}XRt(){this.KRt=this.i.document.hasFocus(),this.es=!(function(t){const i=t[ai(t,"visibilityState",!0)];if(i)return i;const e=ai(t,"hidden",!0);return e in t&&t[e]?"hidden":wi}(this.i.document)!=wi)}ZRt(){Object.keys(this.YRt).forEach((t=>{const i=this.YRt[t];i.engaged=this.QRt(),this.tMt(t,i)}))}dispose(){this.T_.forEach((t=>{t()})),this.T_.length=0}getSessionValue(t,i){return this.get(t).then((t=>null==t?void 0:t[i]))}updateEvent(t){return this.get(t,(t=>{t.eventTimestamp=Date.now()}))}get(t,i){return t?_(this.YRt,t)&&!xi(this.YRt[t])?(this.YRt[t]=this.iMt(this.YRt[t]),null==i||i(this.YRt[t]),this.tMt(t,this.YRt[t]),Promise.resolve(this.YRt[t])):this.eMt(t,i):(G().error(Vi,"Sessions can only be accessed with a vendor type."),Promise.resolve(null))}eMt(t,i){return this.oZ.then((i=>{const e=Ui(t);return i.get(e)})).then((t=>{return t?this.iMt(f(i=t)?{[Oi]:i.sessionId,[Ni]:i.creationTimestamp,[Li]:i.count,[Ci]:i.accessTimestamp,[Di]:i.eventTimestamp,[ki]:null===(e=i.engaged)||void 0===e||e}:(Y().error(Vi,"Invalid stored session value"),Hi()),!0):Hi(this.QRt());var i,e})).then((e=>(t in this.YRt&&!xi(this.YRt[t])||(null==i||i(e),this.tMt(t,e),this.YRt[t]=e),this.YRt[t])))}iMt(t,i){const e=t.count,s=Date.now();if(xi(t)){const i=(null!=e?e:0)+1;t=Hi(this.QRt(),i)}else{const e=i&&t.engaged;t.engaged=e||this.QRt(),e&&(this.KRt=!0,this.JRt=!0,this.es=!0)}return t.accessTimestamp=s,t}QRt(){return this.JRt&&this.es&&this.KRt}tMt(t,i){return this.oZ.then((e=>{const s=Ui(t);e.setNonBoolean(s,i)}))}}),t.registerServiceForDoc("amp-analytics-variables",class{constructor(t){this.Ci=t,this.tN={},this.QJ=X(this.Ci.win,"amp-analytics-linker-reader"),this.sMt=ji(this.Ci),this._x("$DEFAULT",zi),this._x("$SUBSTR",Gi),this._x("$TRIM",(t=>t.trim())),this._x("$TOLOWERCASE",(t=>t.toLowerCase())),this._x("$TOUPPERCASE",(t=>t.toUpperCase())),this._x("$NOT",(t=>String(!t))),this._x("$BASE64",(t=>Bt(t))),this._x("$HASH",this.nMt.bind(this)),this._x("$IF",((t,i,e)=>ee(t)?i:e)),this._x("$REPLACE",Yi),this._x("$MATCH",Ki),this._x("$CALC",Ji),this._x("$EQUALS",((t,i)=>t===i)),this._x("LINKER_PARAM",((t,i)=>this.QJ.get(t,i))),this._x("TIMEZONE_CODE",(()=>{let t="";return"Intl"in this.Ci.win&&"DateTimeFormat"in this.Ci.win.Intl&&(t=(new this.Ci.win.Intl.DateTimeFormat).resolvedOptions().timeZone),t})),this._x("SCROLL_TOP",(()=>Math.round(It(this.Ci).getScrollTop()))),this._x("SCROLL_LEFT",(()=>Math.round(It(this.Ci).getScrollLeft()))),this._x("EXPERIMENT_BRANCHES",(t=>function(t,i){if(i)return function(t,i){return t.__AMP_EXPERIMENT_BRANCHES?t.__AMP_EXPERIMENT_BRANCHES[i]:null}(t,i)||"";const e=function(t){const i=et(t);return i.__AMP_EXPERIMENT_BRANCHES||(i.__AMP_EXPERIMENT_BRANCHES={}),Lt({},i.__AMP_EXPERIMENT_BRANCHES)}(t);return Object.keys(e).map((t=>`${t}:${e[t]}`)).join(",")}(this.Ci.win,t))),this._x("AMPDOC_META",((t,i="")=>{var e;return null!==(e=this.Ci.getMetaByName(t))&&void 0!==e?e:i}))}getMacros(t){const i=t.getAttribute("type"),e={"COOKIE":i=>function(t,i,e){return Ti(t,i)?ni(t,e):null}(this.Ci.win,t,i),"CONSENT_STATE":ie(t),"CONSENT_STRING":Fi(t),"CONSENT_METADATA":i=>function(t,i){return function(t,i="default"){return gt(t).then((t=>t?t.getConsentMetadataInfo(i):null))}(t).then((t=>t?t[i]:null))}(t,J(i,"CONSENT_METADATA macro must contain a key")),"SESSION_ID":()=>this.rMt(i,Oi),"SESSION_TIMESTAMP":()=>this.rMt(i,Ni),"SESSION_COUNT":()=>this.rMt(i,Li),"SESSION_EVENT_TIMESTAMP":()=>this.rMt(i,Di),"SESSION_ENGAGED":()=>this.rMt(i,ki)},s=Ei(t)?{}:{"FIRST_CONTENTFUL_PAINT":()=>At(this.Ci.win).getMetric("fcpv"),"FIRST_VIEWPORT_READY":()=>At(this.Ci.win).getMetric("pc"),"MAKE_BODY_VISIBLE":()=>At(this.Ci.win).getMetric("mbv"),"LARGEST_CONTENTFUL_PAINT":()=>At(this.Ci.win).getMetric("lcpv"),"FIRST_INPUT_DELAY":()=>At(this.Ci.win).getMetric("fid"),"CUMULATIVE_LAYOUT_SHIFT":()=>At(this.Ci.win).getMetric("cls")};return Lt(Lt(Lt({},this.tN),e),s)}rMt(t,i){return this.sMt.then((e=>e.getSessionValue(t,i)))}_x(t,i){K(!this.tN[t]),this.tN[t]=i}expandTemplate(t,i,e,s,n){return function(t,i,e){const s=[];let n=0;return t.replace(i,(function(i){const r=arguments[arguments.length-2];s.push(t.slice(n,r)),n=r+i.length;const o=e.apply(null,arguments);return s.push(o),""})),s.push(t.slice(n)),Promise.all(s).then((t=>t.join("")))}(t,/\${([^}]*)}/g,((t,r)=>{if(i.iterations<0)return G().error($i,"Maximum depth reached while expanding variables. Please ensure that the variables are not recursive."),t;if(!r)return"";const{argList:h,name:u}=Zi(r);if(i.freezeVars[u])return t;let c=i.getVar(u);const a=Et(e);if("string"==typeof c)c=this.oMt(c,i,e,a,s,n,h);else if(o(c)){for(let t=0;t<c.length;t++)c[t]="string"==typeof c[t]?this.oMt(c[t],i,e,a,s,n):c[t];c=Promise.all(c)}return Promise.resolve(c).then((t=>i.noEncode?t:Xi(t)))}))}oMt(t,i,e,s,n,r,o){return this.expandTemplate(t,new Wi(i.vars,i.iterations-1,!0),e,n,r).then((t=>s.expandStringAsync(o?t+o:t,n||this.getMacros(e),r)))}nMt(t){return mt(this.Ci.win).sha384Base64(t)}}),t.registerElement(Ls,Us)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-analytics-0.1.mjs.map
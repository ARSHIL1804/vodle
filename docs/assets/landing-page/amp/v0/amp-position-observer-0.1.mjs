;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-position-observer",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){const s=[];let n=0;for(let e=0;e<t.length;e++){const h=t[e];i(h,e,t)?s.push(h):(n<e&&(t[n]=h),n++)}return n<t.length&&(t.length=n),s}var{hasOwnProperty:s,toString:n}=Object.prototype;function e(t){return 1==(null==(i=t)?void 0:i.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function h(t,s,n,h,r,o,l,u,c,a,f){return function(t,s,n="Assertion failed",h){var r,o;if(s)return s;t&&-1==n.indexOf(t)&&(n+=t);let l=3;const u=n.split("%s");let c=u.shift();const a=[c];for(;u.length;){const t=arguments[l++],i=u.shift();c+=e(t)+i,a.push(t,i.trim())}const f=new Error(c);throw f.messageArray=i(a,(t=>""!==t)),null===(r=(o=self).__AMP_REPORT_ERROR)||void 0===r||r.call(o,f),f}("​​​",t,s,n,h,r,o,l,u,c,a,f)}function r(t){return h(/^\d+(\.\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)$/.test(null!=t?t:""),"Invalid length value: %s",t),t}var o="inside",l="bottom";function u(t,i,s,n){return{left:t,top:i,width:s,height:n,bottom:i+n,right:t+s,x:t,y:i}}function c(t,i){return t.top<i.top?"top":t.bottom>i.bottom?l:o}function a(t,i){return!(!t||!i)&&t.left==i.left&&t.top==i.top&&t.width==i.width&&t.height==i.height}var f=self.AMP_CONFIG||{},_=("string"==typeof f.thirdPartyFrameRegex?new RegExp(f.thirdPartyFrameRegex):f.thirdPartyFrameRegex,("string"==typeof f.cdnProxyRegex?new RegExp(f.cdnProxyRegex):f.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function v(t){if(!self.document||!self.document.head)return null;if(self.location&&_.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}f.thirdPartyUrl,f.thirdPartyFrameHost,f.cdnUrl||v("runtime-host"),f.errorReportingUrl,f.betaErrorReportingUrl,f.localDev,f.geoApiUrl||v("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var p=self.__AMP_LOG;function P(t,i){throw new Error("failed to call initLogConstructor")}function A(t){return p.user||(p.user=d()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(p.user.win,t)?p.userForEmbed||(p.userForEmbed=d()):p.user}function d(t){return P()}function m(t,i,s,n,e,h,r,o,l,u,c){return t}function R(t,i,s,n,e,h,r,o,l,u,c){return A().assert(t,i,s,n,e,h,r,o,l,u,c)}function E(t,i){return g(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function M(t,i){return g(I(b(t)),i)}function b(t){return t.nodeType?(i=t,s=(i.ownerDocument||i).defaultView,E(s,"ampdoc")).getAmpDoc(t):t;var i,s}function I(t){const i=b(t);return i.isSingleDoc()?i.win:i}function g(t,i){m(T(t,i));const s=V(t)[i];return s.obj||(m(s.ctor),m(s.context),s.obj=new s.ctor(s.context),m(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function V(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}function T(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var w=t=>function(t,i){const s=I(b(t));return T(s,i)?g(s,i):null}(t,"action"),x=t=>M(t,"viewport");function y(t){!function(t,i,s,n){const e=b(t),h=I(e);!function(t,i,s,n,e,h){const r=V(t);let o=r[s];o||(o=r[s]={obj:null,promise:null,resolve:null,reject:null,context:null,ctor:null,sharedInstance:!1}),o.ctor||(o.ctor=n,o.context=i,o.sharedInstance=!1,o.resolve&&g(t,s))}(h,e,i,class{constructor(t){this.Ci=t,this.i=t.win,this.tx=[],this.br=E(this.i,"vsync"),this.bn=x(t),this.T_=[],this.nx=!1,this.sx=!1,this.ix=!1,this.ox=function(t,i,s){let n=0,e=0,h=null;function r(){n=0;const o=s-(t.Date.now()-e);var l;o>0?n=t.setTimeout(r,o):(l=h,h=null,i.apply(null,l))}return function(...i){e=t.Date.now(),h=i,n||(n=t.setTimeout(r,s))}}(this.i,(()=>{this.nx=!1}),500)}observe(t,i,s){const n=new class{constructor(t,i,s,n){this.element=i,this.Te=n,this.fidelity=s,this.turn=0==s?Math.floor(4*Math.random()):0,this.ux=null,this.bn=x(t)}Pe(t){const i=this.ux;if(i&&a(i.positionRect,t.positionRect)&&a(i.viewportRect,t.viewportRect))return;m(t.positionRect);const s=t.positionRect;var n,e;t.relativePos=c(s,t.viewportRect),n=s,e=t.viewportRect,n.top<=e.bottom&&e.top<=n.bottom&&n.left<=e.right&&e.left<=n.right?(this.ux=t,this.Te(t)):this.ux&&(this.ux=null,t.positionRect=null,this.Te(t))}update(t){if(!t){if(0!=this.turn)return void this.turn--;0==this.fidelity&&(this.turn=4)}const i=this.bn.getSize(),s=u(0,0,i.width,i.height);this.bn.getClientRectAsync(this.element).then((t=>{this.Pe({positionRect:t,viewportRect:s,relativePos:null})}))}}(this.Ci,t,i,s);return this.tx.push(n),this.ix||this.lx(),n.update(),()=>{for(let t=0;t<this.tx.length;t++)if(this.tx[t]==n)return void this.hx(t)}}unobserve(t){for(let i=0;i<this.tx.length;i++)if(this.tx[i].element==t)return void this.hx(i);(p.dev||(p.dev=P())).error("POSITION_OBSERVER","cannot unobserve unobserved element")}hx(t){this.tx.splice(t,1),0==this.tx.length&&this.vx()}lx(){this.ix=!0,this.T_.push(this.bn.onScroll((()=>{this.mx()}))),this.T_.push(this.bn.onResize((()=>{this.bx()})))}vx(){for(this.ix=!1;this.T_.length;)this.T_.pop()()}updateAllEntries(t){for(let i=0;i<this.tx.length;i++)this.tx[i].update(t)}mx(){this.ox(),this.nx=!0,this.sx||this.gx()}bx(){this.updateAllEntries(!0)}gx(){this.updateAllEntries(),this.sx=!0,this.nx?this.br.measure((()=>{this.gx()})):this.sx=!1}})}(t,"position-observer")}function O(t,i,s,n){const e={detail:s};return Object.assign(e,n),new t.CustomEvent(i,e)}var $="amp-position-observer",S=class extends t.BaseElement{constructor(t){super(t),this.fc=null,this.Mf=null,this.bn=null,this.es=!1,this._R=0,this.PR=0,this.AR="0",this.RR="0",this.ER=0,this.MR=0,this.If=null,this.bR=null,this.IR=null,this.gR=0,this.VR=0,this.TR=!1,this.wR=!1}buildCallback(){this.getAmpDoc().whenFirstVisible().then(this.Cu.bind(this)),this.TR=this.element.hasAttribute("once")}Cu(){this.dw(),this.fc=w(this.element),this.bn=x(this.element),this.xR(),this.getAmpDoc().whenReady().then((()=>{const t=this.yR();this.Mf.observe(t,1,this.OR.bind(this))}))}$R(){const t=O(this.win,`${$}.enter`,{});this.fc.trigger(this.element,"enter",t,1)}SR(){const t=O(this.win,`${$}.exit`,{});this.fc.trigger(this.element,"exit",t,1)}jR(){const t=this.bn.getScrollTop(),i={"start-scroll-offset":t,"end-scroll-offset":t+this.VR,"initial-inview-percent":this.gR},s=O(this.win,`${$}.scroll`,{"percent":this.gR,"positionObserverData":i});this.fc.trigger(this.element,"scroll",s,1)}OR(t){if(this.TR&&this.wR)return;const i=this.es,s=this.If&&this.If.height;this.FR(t),this.If=t.viewportRect,s!=t.viewportRect.height&&this.CR();const n=this.kR(t.viewportRect),{positionRect:e}=t;let h;e?(h=c(e,n),this.gh(e,n,h)):(this.es=!1,h=t.relativePos),i&&!this.es&&(this.gR=h==l?0:1,this.jR(),this.SR(),this.wR=!0),!i&&this.es&&this.$R(),this.es&&(this.zR(e,n),this.jR())}gh(t,i,s){if(s==o)return void(this.es=!0);const n="top"==s?this._R:this.PR,e=t.height*n;this.es=s==l?t.top<=i.bottom-e:t.bottom>=i.top+e}zR(t,i){if(!t)return;const s=t.height*this.PR+t.height*this._R,n=i.height+t.height-s,e=Math.abs(t.top-this.ER-(i.height-t.height*this.PR));this.gR=e/n,this.VR=n-e}dw(){const t=this.element.getAttribute("intersection-ratios");if(t){const i=t.trim().split(" ");this._R=this.qR(i[0]),this.PR=this._R,i[1]&&(this.PR=this.qR(i[1]))}const i=this.element.getAttribute("viewport-margins");if(i){const t=i.trim().split(" ");this.AR=t[0],this.RR=this.AR,t[1]&&(this.RR=t[1])}this.bR=this.element.getAttribute("target")}yR(){let t;return t=this.bR?A().assertElement(this.win.document.getElementById(this.bR),"No element found with id:"+this.bR):this.element.parentNode,this.win.document.body===t&&(t=this.win.document.documentElement),t}HR(t){var i;const s=function(t){r(t);const i=/[a-z]+/i.exec(null!=t?t:"");return h(i,"Failed to read units from %s",t),i[0]}(t=r("number"==typeof(i=t)?i+"px":i&&/^\d+(\.\d+)?(px|em|rem|vh|vw|vmin|vmax|cm|mm|q|in|pc|pt)?$/.test(i)?/^\d+(\.\d+)?$/.test(i)?i+"px":i:void 0));let n=function(t){const i=parseFloat(t);return"number"==typeof(s=i)&&isFinite(s)?i:void 0;var s}(t);return n?(R("px"==s||"vh"==s,"Only pixel or vh are valid as units for exclusion margins: "+t),"vh"==s&&(n=n/100*this.If.height),n):0}qR(t){const i=parseFloat(t);return R(i>=0&&i<=1,"Ratios must be a decimal between 0 and 1: "+t),i}CR(){m(this.If),m(this.RR),m(this.AR),this.ER=this.HR(this.AR),this.MR=this.HR(this.RR)}kR(t){return m(t),u(t.left,t.top+this.ER,t.width,t.height-this.MR-this.ER)}FR(t){this.IR||(this.IR=t.viewportRect.height);const i=this.IR-t.viewportRect.height;let s=0;Math.abs(i)<150?s=i:this.IR=null,t.viewportRect=u(t.viewportRect.left,t.viewportRect.top,t.viewportRect.width,t.viewportRect.height+s)}xR(){this.Mf||(y(this.getAmpDoc()),this.Mf=M(this.element,"position-observer"))}NR(){if(this.Mf){const t=this.yR();this.Mf.unobserve(t),this.Mf=null}}};t.registerElement($,S)})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-position-observer-0.1.mjs.map
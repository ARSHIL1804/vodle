;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-sidebar",ev:"0.2",l:!1,f:function(t,i){(()=>{function i(t){return t?Array.prototype.slice.call(t):[]}var{isArray:s}=Array;function e(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,e=new Array(i);s<i;s++)e[s]=t[s];return e}function n(t,i){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return(s=s.call(t)).next.bind(s);if(Array.isArray(t)||(s=function(t,i){if(t){if("string"==typeof t)return e(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?e(t,i):void 0}}(t))||i&&t&&"number"==typeof t.length){s&&(t=s);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,{hasOwnProperty:h,toString:o}=Object.prototype;function a(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function l(t){return 1==(null==t?void 0:t.nodeType)}function c(t,i,s,e,n,r,h,o,a,l,c){return t}function u(t){return(t.ownerDocument||t).defaultView}function f(t,i){return t.closest?t.closest(i):function(t,i,s){let e;for(e=t;e&&void 0!==e;e=e.parentElement)if(i(e))return e;return null}(t,(t=>function(t,i){const s=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!s&&s.call(t,i)}(t,i)))}function d(t){return function(t,i){const s=[];for(let i=t.firstElementChild;i;i=i.nextElementSibling)!(function(t){let i;return"string"==typeof t?i=t:l(t)&&(i=t.tagName),!!i&&i.toLowerCase().startsWith("i-")}(e=i)||e.nodeType===Node.ELEMENT_NODE&&(e.hasAttribute("placeholder")||e.hasAttribute("fallback")||e.hasAttribute("overflow")))&&s.push(i);var e;return s}(t)}function m(t){const i=t.isConnected;if(void 0!==i)return i;let s=t;for(;s=p(s),s.host;)s=s.host;return s.nodeType===Node.DOCUMENT_NODE}function p(t){if(Node.prototype.getRootNode)return t.getRootNode();let i;for(i=t;i.parentNode&&(!(s=i)||"I-AMPHTML-SHADOW-ROOT"!=s.tagName&&(11!=s.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(s)));i=i.parentNode);var s;return i}function _(t){try{t.focus()}catch(t){}}function b(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:e}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=e,n}function v(t){let i=null,s="";for(var e,r=n(arguments,!0);!(e=r()).done;){const t=e.value;t instanceof Error&&!i?i=b(t):(s&&(s+=" "),s+=t)}return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function A(t){var i,s;null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t)}function P(t,...i){try{return t.apply(null,i)}catch(t){!function(t){const i=v.apply(null,arguments);setTimeout((()=>{throw A(i),i}))}(t)}}var g=["Webkit","webkit","Moz","moz","ms","O","o"],E={"getPropertyPriority":()=>"","getPropertyValue":()=>""};function M(t,i,s,e,n){const h=function(t,i,s){if(i.startsWith("--"))return i;r||(r=a());let e=r[i];if(!e||s){if(e=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<g.length;s++){const e=g[s]+i;if(void 0!==t[e])return e}return""}(t,s);void 0!==t[n]&&(e=n)}s||(r[i]=e)}return e}(t.style,i,n);if(!h)return;const o=e?s+e:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return g.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(h),o)}function w(t,i){for(const s in i)M(t,s,i[s])}function T(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}function y(t,i){return t.getComputedStyle(i)||E}var I=/vertical/,R=new WeakMap,V=new WeakMap,k=new WeakMap;function x(t){let i=R.get(t);return i||(i=new t.ResizeObserver(S),R.set(t,i)),i}function S(t){const i=new Set;for(let s=t.length-1;s>=0;s--){const e=t[s],{target:n}=e;if(i.has(n))continue;i.add(n);const r=V.get(n);if(r){k.set(n,e);for(let t=0;t<r.length;t++){const{callback:i,type:s}=r[t];O(s,i,e)}}}}function O(t,i,s){if(0==t){const{contentRect:t}=s,{height:e,width:n}=t;P(i,{width:n,height:e})}else if(1==t){const{borderBoxSize:t}=s;let e;if(t)e=t.length>0?t[0]:{inlineSize:0,blockSize:0};else{const{target:t}=s,i=u(t),n=I.test(y(i,t).writingMode),{offsetHeight:r,offsetWidth:h}=t;let o,a;n?(a=h,o=r):(o=h,a=r),e={inlineSize:o,blockSize:a}}P(i,e)}}var j=[],$="__AMP_MODAL_SAVED_TAB_INDEX";function C(t){const i=[];for(let s=t;s;s=s.parentNode||s.host)i.push(s);return i}function D(t,i,s){null===s||null==s?t.removeAttribute(i):t.setAttribute(i,s)}var X="i-amphtml-element",z=t=>t.unmount();function F(t,i,s,e){if(i&&t.classList.contains(X)){const i=t;if(P(e,i),!s){const t=i.getPlaceholder();return void(t&&F(t,!0,!1,e))}}const n=t.getElementsByClassName(X);let r=null;for(let t=0;t<n.length;t++){const i=n[t];if(s)P(e,i);else{r=r||[];let t=!1;for(let s=0;s<r.length;s++)if(r[s].contains(i)){t=!0;break}t||(r.push(i),P(e,i))}}}function B(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function L(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function N(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?L(Object(s),!0).forEach((function(i){B(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):L(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var W=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function Y(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}var G=self.AMP_CONFIG||{},H=("string"==typeof G.thirdPartyFrameRegex?new RegExp(G.thirdPartyFrameRegex):G.thirdPartyFrameRegex,("string"==typeof G.cdnProxyRegex?new RegExp(G.cdnProxyRegex):G.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function U(t){if(!self.document||!self.document.head)return null;if(self.location&&H.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}G.thirdPartyUrl,G.thirdPartyFrameHost,G.cdnUrl||U("runtime-host"),G.errorReportingUrl,G.betaErrorReportingUrl,G.localDev,G.geoApiUrl||U("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var Z,q=self.__AMP_LOG;function J(t){return q.user||(q.user=K()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(q.user.win,t)?q.userForEmbed||(q.userForEmbed=K()):q.user}function K(t){return function(t,i){throw new Error("failed to call initLogConstructor")}()}function Q(t,i,s,e,n,r,h,o,a,l,c){return t}function tt(t,i,s,e,n,r,h,o,a,l,c){return J().assert(t,i,s,e,n,r,h,o,a,l,c)}function it(t,i){return ht(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function st(t,i){return ht(rt(nt(t)),i)}function et(t,i){const s=rt(nt(t));return ot(s,i)?ht(s,i):null}function nt(t){return t.nodeType?(i=u(t),it(i,"ampdoc")).getAmpDoc(t):t;var i}function rt(t){const i=nt(t);return i.isSingleDoc()?i.win:i}function ht(t,i){Q(ot(t,i));const s=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return s.obj||(Q(s.ctor),Q(s.context),s.obj=new s.ctor(s.context),Q(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function ot(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var at="__AMP__EXPERIMENT_TOGGLES";var lt,ct=t=>it(t,"extensions"),ut=t=>st(t,"owners"),ft=t=>ht(t,"timer");function dt(t,i){const s=(":not([toolbar]) [autoscroll]",i.querySelector(function(t,i){return t.replace(/^|,/g,"$&:scope ")}(":not([toolbar]) [autoscroll]")));if(!s)return;const e=y(t.win,i)["overflow-y"];var n;"scroll"==e||"auto"==e?(n=t,st(n,"viewport")).animateScrollWithinParent(s,i,"center",0):J().error("AMP-SIDEBAR","for 'autoscroll', 'nav [toolbar]' element must be set to overflow\n        'scroll' or 'auto' for 'autoscroll' to work.")}function mt(t,i){const s=ft(t);return s.promise(1).then((()=>s.promise(i)))}var pt=class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var i,s=n(this.Tt.slice(),!0);!(i=s()).done;)(0,i.value)(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.Tt)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},_t="__AMP_Gestures",bt=class{static get(t,i=!1,s=!1){let e=t[_t];return e||(e=new bt(t,i,s),t[_t]=e),e}constructor(t,i,s){this.yf=t,this.EI=[],this.h_=[],this.ui=[],this.TI=[],this.RI=null,this.VI=i,this.xI=s,this.kI=!1,this.be=new class{constructor(t,i,s){this.Ee=ft(t),this.Te=i,this.ye=s||0,this.Ie=-1,this.Me=0,this.Re=!1,this.we=()=>{this.be()}}isPending(){return-1!=this.Ie}schedule(t){let i=t||this.ye;this.Re&&i<10&&(i=10);const s=Date.now()+i;return(!this.isPending()||s-this.Me<-10)&&(this.cancel(),this.Me=s,this.Ie=this.Ee.delay(this.we,i),!0)}be(){this.Ie=-1,this.Me=0,this.Re=!0,this.Te(),this.Re=!1}cancel(){this.isPending()&&(this.Ee.cancel(this.Ie),this.Ie=-1)}}(u(t),this.Ip.bind(this)),this.SI=new pt,this.DI=Object.create(null),this.CI=this.py.bind(this),this.zI=this.yy.bind(this),this.GI=this.my.bind(this),this.jI=this.d_.bind(this);const e=function(t){if(void 0!==lt)return lt;lt=!1;try{const i={get passive(){return lt=!0,!1}};t.addEventListener("test-options",null,i),t.removeEventListener("test-options",null,i)}catch(t){}return lt}(t.ownerDocument.defaultView);this.yf.addEventListener("touchstart",this.CI,!!e&&{passive:!0}),this.yf.addEventListener("touchend",this.zI),this.yf.addEventListener("touchmove",this.GI,!!e&&{passive:!0}),this.yf.addEventListener("touchcancel",this.jI),this.OI=!1}cleanup(){this.yf.removeEventListener("touchstart",this.CI),this.yf.removeEventListener("touchend",this.zI),this.yf.removeEventListener("touchmove",this.GI),this.yf.removeEventListener("touchcancel",this.jI),delete this.yf[_t],this.be.cancel()}onGesture(t,i){const s=new t(this),e=s.getType();let n=this.DI[e];return n||(this.EI.push(s),n=new pt,this.DI[e]=n),n.add(i)}removeGesture(t){const i=new t(this).getType(),s=this.DI[i];if(s){s.removeAll();const t=function(t,s){for(let s=0;s<t.length;s++)if(t[s].getType()==i)return s;return-1}(this.EI);return!(t<0||(this.EI.splice(t,1),this.ui.splice(t,1),this.TI.splice(t,1),this.h_.splice(t,1),delete this.DI[i],0))}return!1}onPointerDown(t){return this.SI.add(t)}py(t){const i=Date.now();this.kI=!1,this.SI.fire(t);for(let s=0;s<this.EI.length;s++)this.ui[s]||(this.TI[s]&&this.TI[s]<i&&this.f_(s),this.EI[s].onTouchStart(t)&&this.p_(s));this.XI(t)}my(t){const i=Date.now();for(let s=0;s<this.EI.length;s++)this.h_[s]&&(this.TI[s]&&this.TI[s]<i?this.f_(s):this.EI[s].onTouchMove(t)||this.f_(s));this.XI(t)}yy(t){const i=Date.now();for(let s=0;s<this.EI.length;s++){if(!this.h_[s])continue;if(this.TI[s]&&this.TI[s]<i){this.f_(s);continue}this.EI[s].onTouchEnd(t);const e=!this.TI[s],n=this.TI[s]<i;this.RI==this.EI[s]||!e&&!n||this.f_(s)}this.XI(t)}d_(t){for(let t=0;t<this.EI.length;t++)this.$I(t);this.XI(t)}ny(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let e=0;e<this.EI.length;e++)this.EI[e]==t&&(this.ui[e]=s+i,this.TI[e]=0);this.OI=!0}HI(t,i){if(this.RI)return void t.acceptCancel();const s=Date.now();for(let e=0;e<this.EI.length;e++)this.EI[e]==t&&(this.TI[e]=s+i)}LI(t){this.RI==t&&(this.RI=null,this.kI=!0)}UI(t,i,s){Q(this.RI==t);const e=this.DI[t.getType()];e&&e.fire(new class{constructor(t,i,s,e){this.type=t,this.data=i,this.time=s,this.event=e}}(t.getType(),i,Date.now(),s))}XI(t){let i=!!this.RI||this.kI;if(this.kI=!1,!i){const t=Date.now();for(let s=0;s<this.EI.length;s++)if(this.ui[s]||this.TI[s]&&this.TI[s]>=t){i=!0;break}}i?(t.stopPropagation(),this.VI||t.preventDefault()):this.xI&&t.stopPropagation(),this.OI&&(this.OI=!1,this.Ip())}Ip(){const t=Date.now();let i=-1;for(let s=0;s<this.EI.length;s++)this.ui[s]?(-1==i||this.ui[s]>this.ui[i])&&(i=s):this.TI[s]&&this.TI[s]<t&&this.f_(s);if(-1==i)return;let s=0;for(let i=0;i<this.EI.length;i++)!this.ui[i]&&this.h_[i]&&(s=Math.max(s,this.TI[i]-t));s<2?this.YI(i):this.be.schedule(s)}YI(t){const i=this.EI[t];for(let i=0;i<this.EI.length;i++)i!=t&&this.$I(i);this.ui[t]=0,this.TI[t]=0,this.RI=i,i.acceptStart()}p_(t){this.h_[t]=!0,this.TI[t]=0}f_(t){this.h_[t]=!1,this.TI[t]=0,this.ui[t]||this.EI[t].acceptCancel()}$I(t){this.ui[t]=0,this.f_(t)}};function vt(t,i,s){i<1&&(i=1);const e=t/i,n=.5+Math.min(i/33.34,.5);return e*n+s*(1-n)}Math.round(-16.67/Math.log(.95));var At="backward",Pt="horizontal";function gt(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}new Set(["c","v","a","ad"]);var Et="amp-sidebar toolbar",Mt="left",wt="right",Tt=class extends t.BaseElement{static prerenderAllowed(){return!0}constructor(t){super(t),this.bn=null,this.fc=null,this.E$=null,this.kC=null,this.Ao=this.win.document,this.IC=this.Ao.documentElement,this.XC=null,this.M$=[];const i=it(this.win,"platform");this.mD=i.isIos(),this.tk=i.isSafari(),this.ID=-1,this.T$=!1,this.fD=null,this.hD=null,this.I$=0,this.R$=!1,this.V$=null,this.k$=new class{constructor(t,i,s){this.i=t,this.kE=i,this.S$=s,this.O$=At,this.j$=Pt,this.$$=null,this.C$=null}D$(){return this.j$==Pt?this.$$.offsetWidth:this.$$.offsetHeight}X$(t,i){const s=this.j$==Pt?t:i;return this.O$==At?-Math.min(s,0):Math.max(s,0)}z$(t,i=""){const s=this.O$==At?-t:t;return`translate(${this.j$==Pt?`${s}${i}`:0}, ${this.j$==Pt?0:`${s}${i}`})`}startSwipe(t){const{direction:i,mask:s,orientation:e,swipeElement:n}=t;this.$$=n,this.C$=s,this.O$=i,this.j$=e}swipeMove(t){this.F$(t,!1)}endSwipe(t){this.F$(t,!0)}B$(t,i){const s=.75*i;return w(this.$$,{transform:this.z$(t,"px"),transition:`${s}ms transform cubic-bezier(0.15, .55, .3, 0.95)`}),mt(this.i,s)}L$(t){const i=.8*t;return this.kE((()=>{w(this.$$,{transform:this.z$(0),transition:`${i}ms transform ease-in`}),w(this.C$,{opacity:"",transition:`${i}ms opacity ease-in`})})).then((()=>mt(this.i,i)))}N$(t){const i=.75*(this.D$()-t);return this.kE((()=>{w(this.$$,{transform:this.z$(100,"%"),transition:`${i}ms transform ease-out`}),w(this.C$,{opacity:0,transition:`${i}ms opacity ease-out`})})).then((()=>mt(this.i,i))).then((()=>this.S$()))}W$(t="",i=""){w(this.$$,{transform:t,transition:""}),w(this.C$,{opacity:i,transition:""})}Y$(t,i,s,e){const n=22.5*t+s,r=22.5*i+e,h=this.X$(n,r),o=this.X$(t,i),a=.5*this.D$();return h<a&&o<.65?this.B$(h,o).then((()=>this.L$(h))):this.N$(h)}F$(t,i){const{deltaX:s,deltaY:e,velocityX:n,velocityY:r}=t;this.kE((()=>{if(i)return void this.Y$(n,r,s,e).then((()=>{this.W$()}));const t=this.X$(s,e),h=t/this.D$(),o=Math.max(0,1-h);this.W$(this.z$(t,"px"),o)}))}}(this.win,(t=>this.mutateElement(t)),(()=>this.G$(!0,3))),this.eb=this.eb.bind(this),this.H$=null}buildCallback(){tt(function(t,i){const e=function(t){var i,e,r,h,o;if(t[at])return t[at];t[at]=a();const l=t[at];c(l);const u=N(N({},null!==(i=t.AMP_CONFIG)&&void 0!==i?i:{}),null!==(e=t.AMP_EXP)&&void 0!==e?e:(f=(null===(r=t.__AMP_EXP)||void 0===r?void 0:r.textContent)||"{}",JSON.parse(f)));var f;for(const t in u){const i=u[t];"number"==typeof i&&i>=0&&i<=1&&(l[t]=Math.random()<i)}const d=null===(h=t.AMP_CONFIG)||void 0===h?void 0:h["allow-doc-opt-in"];if(s(d)&&d.length){const i=t.document.head.querySelector('meta[name="amp-experiments-opt-in"]');if(i)for(var m,p,_=n((null===(m=i.getAttribute("content"))||void 0===m?void 0:m.split(","))||[],!0);!(p=_()).done;){const t=p.value;d.includes(t)&&(l[t]=!0)}}Object.assign(l,function(t){var i;let s="";try{var e;"localStorage"in t&&(s=null!==(e=t.localStorage.getItem("amp-experiment-toggles"))&&void 0!==e?e:"")}catch(t){}const r=(null===(i=s)||void 0===i?void 0:i.split(/\s*,\s*/g))||[],h=a();for(var o,l=n(r,!0);!(o=l()).done;){const t=o.value;t&&("-"==t[0]?h[t.substr(1)]=!1:h[t]=!0)}return h}(t));const b=null===(o=t.AMP_CONFIG)||void 0===o?void 0:o["allow-url-opt-in"];if(s(b)&&b.length){const i=function(t){const i=a();if(!t)return i;let s;for(;s=W.exec(t);){const t=Y(s[1],s[1]),e=s[2]?Y(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}(t.location.originalHash||t.location.hash);for(var v,A=n(b,!0);!(v=A()).done;){const t=v.value,s=i[`e-${t}`];"1"==s&&(l[t]=!0),"0"==s&&(l[t]=!1)}}return l}(t);return!!e["amp-sidebar-v2"]}(this.win),"Turning on the amp-sidebar-v2 experiment is necessary to use the new sidebar component.");const{element:t}=this;var e;t.classList.add("i-amphtml-overlay"),t.classList.add("i-amphtml-scrollable"),this.XC=t.getAttribute("side"),this.bn=this.getViewport(),this.fc=(t=>et(t,"action"))(t),this.element.parentNode!=this.element.ownerDocument.body&&this.element.parentNode!=this.getAmpDoc().getBody()&&this.user().warn(Et,`${Et} is recommended to be a direct child of the <body> element to preserve a logical DOM order.`),this.XC!=Mt&&this.XC!=wt&&(this.XC=this.U$("rtl"==((e=this.Ao).body.getAttribute("dir")||e.documentElement.getAttribute("dir")||"ltr")?wt:Mt),t.setAttribute("side",this.XC)),this.getAmpDoc().whenReady().then((()=>{i(t.querySelectorAll("nav[toolbar]")).forEach((t=>{try{this.M$.push(new class{constructor(t,i){this.Xa=i,this.Z$=t,this.Ci=i.getAmpDoc(),this.q$=this.Z$.getAttribute("toolbar"),this.J$=null,this.K$=void 0,this.Q$=!1,this.Z$.classList.add("amp-sidebar-toolbar-target-hidden"),this.dX()}onLayoutChange(){this.Ci.win.matchMedia(this.q$).matches?this.pX():this._X()}dX(){this.J$=this.Z$.cloneNode(!0);const t=tt(this.Z$.getAttribute("toolbar-target"),'"toolbar-target" is required',this.Z$),i=this.Ci.getElementById(t);if(!i)throw J().createError(`Could not find the toolbar-target element with an id: ${t}`);this.K$=i,this.J$.classList.add("i-amphtml-toolbar"),T(this.K$,!1)}bX(){return this.Q$}pX(){return this.bX()?Z||(Z=Promise.resolve(void 0)):this.Xa.mutateElement((()=>{this.K$&&(T(this.K$,!0),this.K$.contains(this.J$)||this.K$.appendChild(this.J$),this.Z$.classList.add("amp-sidebar-toolbar-target-shown"),this.Z$.classList.remove("amp-sidebar-toolbar-target-hidden"),this.Q$=!0,dt(this.Ci,this.J$))}))}_X(){this.bX()&&this.Xa.mutateElement((()=>{this.K$&&(T(this.K$,!1),this.Z$.classList.add("amp-sidebar-toolbar-target-hidden"),this.Z$.classList.remove("amp-sidebar-toolbar-target-shown"),this.Q$=!1)}))}}(t,this))}catch(t){this.user().error(Et,"Failed to instantiate toolbar",t)}})),this.eb()})),this.vX(),t.addEventListener("amp:dom-update",(()=>{this.vX()})),this.mD&&this.AX(),t.hasAttribute("role")||t.setAttribute("role","dialog"),t.setAttribute("aria-modal","false"),t.tabIndex=-1,this.IC.addEventListener("keydown",(t=>{"Escape"==t.key&&this.u$(3)&&t.preventDefault()})),this.fD=this.BD(),this.fD||(this.fD=this.createScreenReaderCloseButton(),t.insertBefore(this.fD,this.element.firstChild)),t.appendChild(this.createScreenReaderCloseButton()),this.registerDefaultAction((t=>{const{caller:i,trust:s}=t;this.s$(s,i)}),"open"),this.registerAction("close",(t=>{this.u$(t.trust)})),this.registerAction("toggle",(t=>{const{caller:i,trust:s}=t;this.R$?this.u$(s):this.s$(s,i)})),t.addEventListener("click",(i=>{const s=f(i.target,"A");if(s&&s.href){const i=(t=>et(t,"url"))(t).parse(s.href),e=this.getAmpDoc().getUrl();if(gt(s.href)!=gt(e))return;i.hash&&this.u$(3)}}),!0),this.eC(this.element)}attachedCallback(){this.H$=this.bn.onResize(function(t,i,s){let e=0,n=0,r=null;function h(){e=0;const s=100-(t.Date.now()-n);var o;s>0?e=t.setTimeout(h,s):(o=r,r=null,i.apply(null,o))}return function(...i){n=t.Date.now(),r=i,e||(e=t.setTimeout(h,100))}}(this.win,this.eb)),this.eb()}detachedCallback(){this.H$&&(this.H$(),this.H$=null)}vX(){if(this.V$)return;const t=this.element.querySelector("amp-nested-menu");t&&(ct(this.win).installExtensionForDoc(this.getAmpDoc(),"amp-nested-menu"),this.V$=t)}BD(){const t=this.element.querySelectorAll("[on]");for(let i=0;i<t.length;i++){const s=t[i],e=this.fc.hasResolvableActionForTarget(s,"tap",this.element,Q(s.parentElement)),n=f(s,"[toolbar]");if(e&&!n)return s}return null}createScreenReaderCloseButton(){const t=this.element.getAttribute("data-close-button-aria-label")||"Close the sidebar",i=this.Ao.createElement("button");return i.textContent=t,i.classList.add("i-amphtml-screen-reader"),i.tabIndex=-1,i.addEventListener("click",(()=>{this.u$(3)})),i}eb(){this.getAmpDoc().whenReady().then((()=>{this.M$.forEach((t=>{t.onLayoutChange()}))}))}PX(t,i){this.E$=t;const s=()=>{this.E$===t&&this.mutateElement(t)};i?ft(this.win).delay(s,i):s()}gX(t){T(this.element,!0),T(this.EX(),!0),this.bn.addToFixedLayer(this.element,!0),this.mutateElement((()=>{(function(t){c(j.every((i=>i.element!==t))),c(m(t));const s=function(t){const s=[],e=C(t);for(let t=0;t<e.length;t++){const n=e[t];n.parentNode&&i(n.parentNode.children).filter((t=>t!=n)).forEach((t=>s.push(t)))}return s}(t),e=C(t).filter(l),n=function(t){const i=[];let s=t;for(;s;){const t=p(s),e=t.querySelectorAll(["a[href]","area[href]","button","details summary","iframe","input","select","textarea","[contenteditable]","[draggable]","[tabindex]"].join(","));Array.prototype.push.apply(i,e),s=t.host}return i}(t),r=n.filter((i=>t.contains(i)&&void 0!==i[$])),h=n.filter((i=>!t.contains(i)&&void 0===i[$])),o=s.concat(e).map((t=>({element:t,prevValue:t.getAttribute("aria-hidden")})));e.forEach((t=>t.removeAttribute("aria-hidden"))),s.forEach((t=>t.setAttribute("aria-hidden","true"))),h.forEach((t=>{t[$]=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")})),r.forEach((t=>{c(void 0!==t[$]),D(t,"tabindex",t[$])})),j.push({element:t,hiddenElementInfos:o,focusableExternalElements:h,focusableInternalElements:r})})(this.element),this.element.setAttribute("aria-modal","true")})),this.mD&&this.tk&&this.MX(),this.element.scrollTop=1,this.element.setAttribute("open",""),this.EX().setAttribute("open",""),this.PX((()=>this.wX(t)),350),dt(this.getAmpDoc(),this.element)}wX(t){const i=d(this.element),s=ut(this.element);s.scheduleLayout(this.element,i),s.scheduleResume(this.element,i),this.TX()||_(Q(this.fD)),this.aO("sidebarOpen",t),this.element.setAttribute("i-amphtml-sidebar-opened",""),this.EX().setAttribute("i-amphtml-sidebar-opened",""),this.setAsContainer()}yX(t,i){this.EX().removeAttribute("open"),this.EX().removeAttribute("i-amphtml-sidebar-opened"),this.mutateElement((()=>{!function(t){const i=j.pop();c(i);const{element:s,focusableExternalElements:e,focusableInternalElements:n,hiddenElementInfos:r}=i;c(m(t)),c(s===t),r.forEach((({element:t,prevValue:i})=>D(t,"aria-hidden",i))),n.forEach((t=>t.setAttribute("tabindex","-1"))),e.forEach((t=>{c(void 0!==t[$]),D(t,"tabindex",t[$]),t[$]=void 0}))}(this.element),this.element.setAttribute("aria-modal","false")})),this.element.removeAttribute("open"),this.element.removeAttribute("i-amphtml-sidebar-opened"),this.PX((()=>this.IX(i)),t?0:350)}IX(t){T(this.element,!1),T(this.EX(),!1),ut(this.element).schedulePause(this.element,d(this.element)),-1!=this.ID&&(this.mX().pop(this.ID),this.ID=-1),this.aO("sidebarClose",t),this.removeAsContainer(),function(t,i=!0){!function(t,i,e,n){const r=s(h=t)?h:[h];var h;for(let t=0;t<r.length;t++)F(r[t],i,!0,n)}(t,i,0,z)}(this.element,!1)}s$(t,i){this.R$||(this.R$=!0,this.bn.enterOverlayMode(),this.PX((()=>this.gX(t))),this.mX().push((()=>this.u$(t))).then((t=>{this.ID=t})),i&&(this.hD=i,this.I$=this.bn.getScrollTop()),function(t,i,s){const e=t.ownerDocument.defaultView;if(!e)return;let n=V.get(t);if(n||(n=[],V.set(t,n),x(e).observe(t)),!n.some((t=>t.callback===s&&0===t.type))){n.push({type:0,callback:s});const i=k.get(t);i&&setTimeout((()=>O(0,s,i)))}}(this.element,0,this.eb))}u$(t){return this.G$(!1,t)}G$(t,i){if(!this.R$)return!1;this.R$=!1,this.bn.leaveOverlayMode();const s=this.I$==this.bn.getScrollTop(),e=this.element.contains(this.Ao.activeElement);return this.PX((()=>this.yX(t,i))),t&&(T(this.element,!1),T(this.EX(),!1)),this.hD&&e&&s&&(this.TX()||_(this.hD)),function(t,i,s){const e=V.get(t);if(e&&(function(t,i){const e=[];let n=0;for(let i=0;i<t.length;i++){const h=t[i];(r=h).callback===s&&0===r.type?e.push(h):(n<i&&(t[n]=h),n++)}var r;n<t.length&&(t.length=n)}(e),0==e.length)){V.delete(t),k.delete(t);const i=t.ownerDocument.defaultView;i&&x(i).unobserve(t)}}(this.element,0,this.eb),!0}eC(t){bt.get(t,!1,!0).onGesture(class extends class extends class{constructor(t,i){this.TT=t,this.E_=i}getType(){return this.TT}signalReady(t){this.E_.ny(this,t)}signalPending(t){this.E_.HI(this,t)}signalEnd(){this.E_.LI(this)}signalEmit(t,i){this.E_.UI(this,t,i)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}}{constructor(t,i,s,e){super(t,i),this.AV=s,this.PV=e,this.RI=!1,this.MV=0,this.bV=0,this.wV=0,this.EV=0,this.TV=0,this.IV=0,this.hr=0,this.RV=0,this.VV=0,this.yV=0,this.xV=0}onTouchStart(t){const{touches:i}=t;return!!(this.RI&&i&&i.length>1)||!(!i||1!=i.length)&&(this.hr=Date.now(),this.MV=i[0].clientX,this.bV=i[0].clientY,!0)}onTouchMove(t){const{touches:i}=t;if(i&&i.length>=1){const{clientX:s,clientY:e}=i[0];if(this.wV=s,this.EV=e,this.RI)this.kV(!1,!1,t);else{const t=Math.abs(s-this.MV),i=Math.abs(e-this.bV);if(this.AV&&this.PV)(t>=8||i>=8)&&this.signalReady(-10);else if(this.AV){if(t>=8&&t>i)this.signalReady(-10);else if(i>=8)return!1}else{if(!this.PV)return!1;if(i>=8&&i>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:i}=t;i&&0==i.length&&this.SV(t)}acceptStart(){this.RI=!0,this.TV=this.MV,this.IV=this.bV,this.VV=this.hr,this.MV=this.wV,this.bV=this.EV,this.kV(!0,!1,null)}acceptCancel(){this.RI=!1}kV(t,i,s){this.RV=Date.now();const e=this.RV-this.VV;if(!i&&e>4||i&&e>16){const t=vt(this.wV-this.TV,e,this.yV),s=vt(this.EV-this.IV,e,this.xV);(!i||e>32||0!=t||0!=s)&&(this.yV=Math.abs(t)>1e-4?t:0,this.xV=Math.abs(s)>1e-4?s:0),this.TV=this.wV,this.IV=this.EV,this.VV=this.RV}this.signalEmit({first:t,last:i,time:this.RV,deltaX:this.wV-this.MV,deltaY:this.EV-this.bV,startX:this.MV,startY:this.bV,lastX:this.wV,lastY:this.EV,velocityX:this.yV,velocityY:this.xV},s)}SV(t){this.RI&&(this.RI=!1,this.kV(!1,!0,t),this.signalEnd())}}{constructor(t){super("swipe-x",t,!0,!1)}},(t=>{const{data:i}=t;this.RX(i)}))}RX(t){t.first?this.k$.startSwipe({swipeElement:this.element,mask:this.kC,direction:this.XC==Mt?At:"forward",orientation:Pt}):t.last?this.k$.endSwipe(t):this.k$.swipeMove(t)}U$(t){return f(this.element,"amp-story")?t==Mt?wt:Mt:t}EX(){if(!this.kC){const t=this.Ao.createElement("div");t.classList.add("amp-sidebar-mask","i-amphtml-sidebar-mask"),t.addEventListener("click",(()=>{this.u$(3)})),this.getAmpDoc().getBody().appendChild(t),t.addEventListener("touchmove",(t=>{t.preventDefault()})),this.eC(t),this.kC=t}return this.kC}AX(){this.element.addEventListener("scroll",(t=>{this.R$&&(this.element.scrollTop<1?(this.element.scrollTop=1,t.preventDefault()):this.element.scrollHeight==this.element.scrollTop+this.element.offsetHeight&&(this.element.scrollTop=this.element.scrollTop-1,t.preventDefault()))}))}MX(){if(!this.T$){const t=this.Ao.createElement("div");w(t,{"height":"54px","width":"100%","background-color":"transparent"}),this.element.appendChild(t),this.T$=!0}}mX(){return st(this.getAmpDoc(),"history")}aO(t,i){const s=function(t,i,s,e){const n={detail:{}};return Object.assign(n,void 0),new t.CustomEvent(i,n)}(this.win,`${Et}.${t}`);this.fc.trigger(this.element,t,s,i)}TX(){return this.mD&&(t=this.element,st(t,"viewer")).isEmbedded();var t}};t.registerElement("amp-sidebar",Tt,"amp-sidebar{--story-page-vh:1vh;position:fixed!important;top:0;max-height:100vh!important;height:100vh;max-width:80vw;background-color:#efefef;min-width:45px!important;outline:none;overflow-x:hidden!important;overflow-y:auto!important;z-index:2147483647;-webkit-overflow-scrolling:touch;will-change:transform}amp-sidebar[side=left]{left:0!important;transform:translateX(-100%);animation-name:i-amphtml-sidebar-slide-out-left}amp-sidebar[side=left][open]{animation-name:i-amphtml-sidebar-slide-in-left}amp-sidebar[side=right]{right:0!important;transform:translateX(100%);animation-name:i-amphtml-sidebar-slide-out-right}amp-sidebar[side=right][open]{animation-name:i-amphtml-sidebar-slide-in-right}amp-sidebar[side][i-amphtml-sidebar-opened]{transform:none;animation:none}.i-amphtml-sidebar-mask,amp-sidebar[side]{animation-duration:233ms;animation-timing-function:cubic-bezier(0,0,.21,1);animation-fill-mode:forwards}.i-amphtml-toolbar>ol,.i-amphtml-toolbar>ul{display:-ms-flexbox;display:flex;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-wrap:wrap;flex-wrap:wrap;overflow:auto;list-style-type:none;padding:0;margin:0}.amp-sidebar-mask,.i-amphtml-sidebar-mask{background-color:rgba(0,0,0,0.5)}.i-amphtml-sidebar-mask{position:fixed!important;top:0!important;left:0!important;width:100vw!important;height:100vh!important;background-image:none!important;animation-name:i-amphtml-sidebar-mask-fade-out;z-index:2147483646}.i-amphtml-sidebar-mask[open]{animation-name:i-amphtml-sidebar-mask-fade-in}.i-amphtml-sidebar-mask[i-amphtml-sidebar-opened]{animation:none}@keyframes i-amphtml-sidebar-slide-in-left{0%{transform:translateX(-100%)}to{transform:translateX(0)}}@keyframes i-amphtml-sidebar-slide-out-left{0%{transform:translateX(0)}to{transform:translateX(-100%)}}@keyframes i-amphtml-sidebar-slide-in-right{0%{transform:translateX(100%)}to{transform:translateX(0)}}@keyframes i-amphtml-sidebar-slide-out-right{0%{transform:translateX(0)}to{transform:translateX(100%)}}@keyframes i-amphtml-sidebar-mask-fade-in{0%{opacity:0}to{opacity:1}}@keyframes i-amphtml-sidebar-mask-fade-out{0%{opacity:1}to{opacity:0}}\n/*# sourceURL=/extensions/amp-sidebar/0.2/amp-sidebar.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-sidebar-0.2.mjs.map
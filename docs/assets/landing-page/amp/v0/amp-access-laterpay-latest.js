;
(self.AMP=self.AMP||[]).push({m:0,v:"2203281422000",n:"amp-access-laterpay",ev:"0.2",l:!0,f:function(t,n){!function(){Array.isArray;var n=Object.prototype;function r(t){var n=Object.create(null);return t&&Object.assign(n,t),n}function e(t,n){t.insertBefore(n,t.firstChild)}n.hasOwnProperty,n.toString;var i=self.AMP_CONFIG||{},a=("string"==typeof i.thirdPartyFrameRegex?new RegExp(i.thirdPartyFrameRegex):i.thirdPartyFrameRegex,("string"==typeof i.cdnProxyRegex?new RegExp(i.cdnProxyRegex):i.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function s(t){if(!self.document||!self.document.head)return null;if(self.location&&a.test(self.location.origin))return null;var n=self.document.head.querySelector('meta[name="'.concat(t,'"]'));return n&&n.getAttribute("content")||null}i.thirdPartyUrl,i.thirdPartyFrameHost,i.cdnUrl||s("runtime-host"),i.errorReportingUrl,i.betaErrorReportingUrl,i.localDev,i.geoApiUrl||s("amp-geo-api");var u=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{return decodeURIComponent(t)}catch(t){return n}}function c(t){var n=(t||self).location;return function(t){var n,e=r();if(!t)return e;for(;n=u.exec(t);){var i=o(n[1],n[1]),a=n[2]?o(n[2].replace(/\+/g," "),n[2]):"";e[i]=a}return e}(n.originalHash||n.hash)}var l="";function f(t){var n;return l||(l=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"01".concat("2203281422000")),l}function h(t,n){var r=n||c(t);return["1","actions","amp","amp4ads","amp4email"].includes(r.development)||!!t.AMP_DEV_MODE}function p(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var d,v=self.__AMP_LOG;function m(t,n){throw new Error("failed to call initLogConstructor")}function y(t){return v.user||(v.user=b()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(v.user.win,t)?v.userForEmbed||(v.userForEmbed=b()):v.user}function b(t){return m()}function g(){return v.dev||(v.dev=m())}function x(t,n,r,e,i,a,s,u,o,c,l){return t}function w(t,n,r,e,i,a,s,u,o,c,l){return y().assert(t,n,r,e,i,a,s,u,o,c,l)}function j(){return d||(d=Promise.resolve(void 0))}var O=function(){var t=this;this.promise=new Promise((function(n,r){t.resolve=n,t.reject=r}))};function R(t,n){return z(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function L(t,n){return U(N(t),n)}function _(t){return t.nodeType?(r=t,n=(r.ownerDocument||r).defaultView,R(n,"ampdoc")).getAmpDoc(t):t;var n,r}function N(t){var n=_(t);return n.isSingleDoc()?n.win:n}function z(t,n){x(function(t,n){var r=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!r||!r.ctor)}(t,n));var r=k(t)[n];return r.obj||(x(r.ctor),x(r.context),r.obj=new r.ctor(r.context),x(r.obj),r.context=null,r.resolve&&r.resolve(r.obj)),r.obj}function U(t,n){var r=k(t)[n];return r?r.promise?r.promise:(z(t,n),r.promise=Promise.resolve(r.obj)):null}function k(t){var n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function B(t,n,r,e){return function(t,n,r,e){var i=L(t,n);if(i)return i;var a=_(t);return a.whenExtensionsKnown().then((function(){var t=a.getExtensionVersion(r);return t?R(a.win,"extensions").waitForExtension(r,t):null})).then((function(r){return r?e?L(t,n):function(t,n){return function(t,n){var r=U(t,n);if(r)return r;var e,i,a,s,u=k(t);return u[n]=(i=(e=new O).promise,a=e.reject,s=e.resolve,i.catch((function(){})),{obj:null,promise:i,resolve:s,reject:a,context:null,ctor:null}),u[n].promise}(N(t),n)}(t,n):null}))}(t,n,r,e).then((function(t){return function(t,n,r){return w(t,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.",n,r,r,r)}(t,n,r)}))}var I;function P(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function E(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){p(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function A(t,n,r,e){return function(t,n,r,e){var i=t,a=r,s=function(t){try{return a(t)}catch(t){var n,r;throw null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,t),t}},u=function(){if(void 0!==I)return I;I=!1;try{var t={get capture(){return I=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return I}(),o=!(null==e||!e.capture);return i.addEventListener(n,s,u?e:o),function(){null==i||i.removeEventListener(n,s,u?e:o),a=null,i=null,s=null}}(t,n,r,e)}function C(t,n,r){if(n[r])return n[r];var e=t.querySelector("style[".concat(r,"], link[").concat(r,"]"));return e?(n[r]=e,e):null}function S(t,n){for(var r=t.styleSheets,e=0;e<r.length;e++)if(r[e].ownerNode==n)return!0;return!1}var D="amp-access-laterpay",T={live:{eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},sandbox:{eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"}},q={payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required.",laterpayBadgePrefix:"Powered by ",laterpayBadgeSuffix:""},F=function(){function t(t,n){this.ampdoc=t.ampdoc,this.oE=n,this.Tu=function(t,n){return z(N(_(t)),"viewport")}(this.ampdoc),this.Oat=this.oE.getAdapterConfig(),this.Lat=null,this.oat=null,this.Nat=null,this.mat=null,this._at=[],this.vat=!0,this.tat=null,this.zat=null,this.kat=null,this.Uat=this.Oat.locale||"en",this.aat=E(E({},q),this.Oat.localeMessages||{}),this.Bat=this.Eat()+"/api/v2/fetch/amp/?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";var i=this.Oat.articleId;i&&(this.Bat+="&article_id="+encodeURIComponent(i));var a=this.Oat.jwt;a&&(this.Bat+="&jwt="+encodeURIComponent(a)),this.js=z(this.ampdoc.win,"timer"),this.Iu=R(this.ampdoc.win,"vsync"),this.Sr=function(t){return R(t,"xhr")}(this.ampdoc.win),function(t,n,i,a,s){var u=t.getHeadNode(),o=function(t,n,i,a){var s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=r());var u="amp-extension=".concat(a);if(u){var o=C(t,s,u);if(o)return"STYLE"==o.tagName&&o.textContent!==n&&(o.textContent=n),o}var c=(t.ownerDocument||t).createElement("style");c.textContent=n;return c.setAttribute("amp-extension",a),function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(r){var i=r.nextSibling;t.insertBefore(n,i)}else e(t,n)}(t,c,C(t,s,"amp-runtime")),u&&(s[u]=c),c}(u,function(t,n){var r=t.__AMP_CSS_TR;return r?r(n):n}(u,".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"),0,"amp-access-laterpay");if(i){var c=t.getRootNode();if(S(c,o))return o;var l=setInterval((function(){S(c,o)&&clearInterval(l)}),4)}}(this.ampdoc,0,(function(){}))}var n=t.prototype;return n.Eat=function(){var t,n=this.Oat.region||"eu";return(t=self,t.__AMP_MODE?t.__AMP_MODE:t.__AMP_MODE=function(t){return{localDev:!1,development:h(t,c(t)),esm:!1,test:!1,rtvVersion:f(t)}}(t)).development&&this.Oat.configUrl?this.Oat.configUrl:this.Oat.sandbox?T.sandbox[n]:T.live[n]},n.authorize=function(){var t=this;return this.Iat().then((function(n){if(204===n.status)throw y().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");return t.Oat.scrollToTopAfterAuth&&t.Iu.mutate((function(){return t.Tu.setScrollTop(0)})),t.uat(),{access:n.access}}),(function(n){if(!n||!n.response)throw n;var r=n.response;if(402!==r.status)throw n;return r.json().catch((function(){})).then((function(n){return t.Lat=n,t.oat=t.$at(n.purchase_options),t.uat().then(t.hat.bind(t)),{access:!1}}))}))},n.Iat=function(){var t=this,n=this.Bat+"&article_title="+encodeURIComponent(this.Pat());return this.oE.buildUrl(n,!1).then((function(n){return t.oE.getLoginUrl(n)})).then((function(n){return g().info(D,"Authorization URL: ",n),t.js.timeoutPromise(3e3,t.Sr.fetchJson(n,{credentials:"include"})).then((function(t){return t.json()}))}))},n.$at=function(t){var n=this.Pat(),r={};return r.singlePurchases=t.filter((function(t){return"single_purchase"===t.sales_model})),r.singlePurchases.forEach((function(t){return t.description=n})),r.timepasses=t.filter((function(t){return"timepass"===t.sales_model})),r.subscriptions=t.filter((function(t){return"subscription"===t.sales_model})),r},n.Aat=function(t){return this.ampdoc.win.document.createElement(t)},n.Pat=function(){var t=this.ampdoc.getRootNode().querySelector(this.Oat.articleTitleSelector);return w(t,"No article title element found with selector %s",this.Oat.articleTitleSelector),t.textContent.trim()},n.bE=function(){var t=D+"-dialog",n=this.ampdoc.getElementById(t);return y().assertElement(n,"No element found with id "+t)},n.uat=function(){var t,n=this;if(this.vat)return j();for(;t=this._at.shift();)t();return this.Nat&&(this.Nat(),this.Nat=null),this.mat&&(this.mat(),this.mat=null),this.Iu.mutatePromise((function(){n.vat=!0,n.tat=null,function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(n.bE())}))},n.hat=function(){var t=this,n=this.bE();this.tat=this.Aat("div"),this.tat.className=D+"-container",this.Oat.sandbox&&this.Cat("sandbox"),this.Cat("header");var r=this.Aat("ul");this.oat.singlePurchases.forEach((function(n){r.appendChild(t.Dat(n))})),this.oat.timepasses.forEach((function(n){r.appendChild(t.Dat(n))})),this.oat.subscriptions.forEach((function(n){r.appendChild(t.Dat(n))}));var e=this.Aat("button");e.className=D+"-purchase-button",e.textContent=this.aat.defaultButton,this.kat=e,this.Nat=A(e,"click",(function(n){var r=t.zat.value,e=t.zat.dataset.purchaseType;t.Rat(n,r,e)})),this.tat.appendChild(r),this.tat.appendChild(e),this.tat.appendChild(this.Sat(this.Lat.identify_url)),this.Cat("footer"),n.appendChild(this.tat),n.appendChild(this.Tat()),this.vat=!1,this.qat(r.firstElementChild)},n.qat=function(t){var n=t.querySelector('input[type="radio"]');n.checked=!0,this.Fat(n)},n.Cat=function(t){if(this.aat[t]){var n=this.Aat("p");n.className=D+"-"+t,n.textContent=this.aat[t],this.tat.appendChild(n)}},n.Tat=function(){var t=this.Aat("a");t.href="https://blog.laterpay.net/laterpay-academy/what-is-laterpay",t.target="_blank",t.textContent="LaterPay";var n=this.Aat("p"),r=this.Aat("span");r.textContent=this.aat.laterpayBadgePrefix;var e=this.Aat("span");return e.textContent=this.aat.laterpayBadgeSuffix,n.className=D+"-badge",n.appendChild(r),n.appendChild(t),n.appendChild(e),n},n.Dat=function(t){var n=this.Aat("li"),r=this.Aat("label");r.for=t.title,r.appendChild(this.Jat(t));var e=this.Aat("div");e.className=D+"-metadata";var i=this.Aat("span");i.className=D+"-title",i.textContent=t.title,e.appendChild(i);var a=this.Aat("p");return a.className=D+"-description",a.textContent=t.description,e.appendChild(a),r.appendChild(e),n.appendChild(r),n.appendChild(this.Vat(t.price)),n},n.Jat=function(t){var n=this.Aat("input");n.name="purchaseOption",n.type="radio",n.id=t.title,n.value=t.purchase_url;var r="pay_later"===t.price.payment_model?"payLater":"payNow",e=this.aat[r+"Button"];return n.setAttribute("data-purchase-action-label",e),n.setAttribute("data-purchase-type",r),this._at.push(A(n,"change",this.Yat.bind(this))),n},n.Vat=function(t){var n=this.Zat(t.amount),r=this.Aat("span");r.className=D+"-price",r.textContent=n;var e=this.Aat("sup");e.className=D+"-currency",e.textContent=t.currency;var i=this.Aat("p");return i.className=D+"-price-container",i.appendChild(r),i.appendChild(e),i},n.Zat=function(t){return(t/100).toLocaleString(this.Uat,{style:"decimal",minimumFractionDigits:0})},n.Sat=function(t){var n=this,r=this.Aat("p");r.className=D+"-already-purchased-link-container";var e=this.Aat("a");return e.href=t,e.textContent=this.aat.alreadyPurchasedLink,this.mat=A(e,"click",(function(r){n.Rat(r,t,"alreadyPurchased")})),r.appendChild(e),r},n.Yat=function(t){t.preventDefault(),this.Fat(t.target)},n.Fat=function(t){var n=D+"-selected",r=this.zat,e=t.dataset.purchaseActionLabel;r&&r.classList.contains(n)&&r.classList.remove(n),this.zat=t,this.zat.classList.add(n),this.kat.textContent=e},n.Rat=function(t,n,r){var e=this;return t.preventDefault(),this.oE.buildUrl(n,!1).then((function(t){g().fine(D,"Authorization URL: ",t),e.oE.loginWithUrl(t,r)}))},n.pingback=function(){return j()},t}();t.registerServiceForDoc("laterpay",(function(t){return(n=t.getHeadNode(),B(n,"access","amp-access")).then((function(t){var n=t.getVendorSource("laterpay"),r=new F(t,n);return n.getAdapter().registerVendor(r),r}));var n}))}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-access-laterpay-0.2.js.map
;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-consent",ev:"0.1",l:!0,f:function(t,n){(()=>{function n(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,i=new Array(n);e<n;e++)i[e]=t[e];return i}var e;function i(){return e||(e=Promise.resolve(void 0))}var s=class{constructor(){this.promise=new Promise(((t,n)=>{this.resolve=t,this.reject=n}))}},{isArray:r}=Array;function o(t,n){const e=t.length-n.length;return e>=0&&t.indexOf(n,e)==e}var h,{hasOwnProperty:c,toString:a}=Object.prototype;function u(t){return"[object Object]"===a.call(t)}function l(t){const n=Object.create(null);return t&&Object.assign(n,t),n}function p(t,n){return c.call(t,n)}function m(t,n,e=10){const i=[],s=[];for(s.push({t:t,s:n,d:0});s.length>0;){const{d:t,s:n,t:h}=s.shift();if(i.includes(n))throw new Error("Source object has a circular reference.");if(i.push(n),h!==n)if(t>e)Object.assign(h,n);else for(var r=0,o=Object.keys(n);r<o.length;r++){const e=o[r],i=n[e];if(p(h,e)){const n=h[e];if(u(i)&&u(n)){s.push({t:n,s:i,d:t+1});continue}}h[e]=i}}return t}function d(t,n,e,i,s,r,o,h,c,a,u){return t}function f(t,n){return t.replace(/^|,/g,`$&${n} `)}function _(t){d(/^[\w-]+$/.test(t))}var g=["Webkit","webkit","Moz","moz","ms","O","o"];function P(t){const n=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return g.some((t=>n.startsWith(t+"-")))?`-${n}`:n}function v(t,n,e){if(n.startsWith("--"))return n;h||(h=l());let i=h[n];if(!i||e){if(i=n,void 0===t[n]){const e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(n),s=function(t,n){for(let e=0;e<g.length;e++){const i=g[e]+n;if(void 0!==t[i])return i}return""}(t,e);void 0!==t[s]&&(i=s)}e||(h[n]=i)}return i}function I(t,n,e,i,s){const r=v(t.style,n,s);if(!r)return;const o=i?e+i:e;t.style.setProperty(P(r),o)}function A(t,n){for(const e in n)I(t,e,n[e])}function b(t,n){void 0===n&&(n=t.hasAttribute("hidden")),n?t.removeAttribute("hidden"):t.setAttribute("hidden","")}function y(t,n,e=5){if(!isFinite(e)||e<0)throw new Error("Invalid depth: "+e);if(t===n)return!0;const i=[{a:t,b:n,depth:e}];for(;i.length>0;){const{a:t,b:n,depth:e}=i.shift();if(e>0){if(typeof t!=typeof n)return!1;if(r(t)&&r(n)){if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)i.push({a:t[s],b:n[s],depth:e-1});continue}if(t&&n&&"object"==typeof t&&"object"==typeof n){const r=Object.keys(t),h=Object.keys(n);if(r.length!==h.length)return!1;for(var s=0,o=r;s<o.length;s++){const r=o[s];i.push({a:t[r],b:n[r],depth:e-1})}continue}}if(t!==n)return!1}return!0}function R(t){var n;null===(n=t.parentElement)||void 0===n||n.removeChild(t)}function E(t,n){t.insertBefore(n,t.firstChild)}function M(t){try{t.focus()}catch(t){}}var C=self.AMP_CONFIG||{},w=("string"==typeof C.thirdPartyFrameRegex?new RegExp(C.thirdPartyFrameRegex):C.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,T=("string"==typeof C.cdnProxyRegex?new RegExp(C.cdnProxyRegex):C.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function k(t){if(!self.document||!self.document.head)return null;if(self.location&&T.test(self.location.origin))return null;const n=self.document.head.querySelector(`meta[name="${t}"]`);return n&&n.getAttribute("content")||null}var S={thirdParty:C.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:C.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:w,cdn:C.cdnUrl||k("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:T,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:C.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:C.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:C.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:C.geoApiUrl||k("amp-geo-api")},V=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function O(t,n=""){try{return decodeURIComponent(t)}catch(t){return n}}function x(t){const n=l();if(!t)return n;let e;for(;e=V.exec(t);){const t=O(e[1],e[1]),i=e[2]?O(e[2].replace(/\+/g," "),e[2]):"";n[t]=i}return n}function j(t){const{location:n}=t||self;return x(n.originalHash||n.hash)}var U="";function D(t){var n;return U||(U=(null===(n=t.AMP_CONFIG)||void 0===n?void 0:n.v)||"012203281422000"),U}function N(t,n){const e=n||j(t);return["1","actions","amp","amp4ads","amp4email"].includes(e.development)||!!t.AMP_DEV_MODE}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var L=self.__AMP_LOG;function H(t,n){throw new Error("failed to call initLogConstructor")}function F(t){return L.user||(L.user=$()),function(t,n){return n&&n.ownerDocument.defaultView!=t}(L.user.win,t)?L.userForEmbed||(L.userForEmbed=$()):L.user}function $(t){return H()}function q(){return L.dev||(L.dev=H())}function G(t,n,e,i,s,r,o,h,c,a,u){return t}function z(t,n,e,i,s,r,o,h,c,a,u){return F().assert(t,n,e,i,s,r,o,h,c,a,u)}function W(t,n){return X(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),n)}function B(t,n){return X(Y(Q(t)),n)}function J(t,n){const e=Y(Q(t));return et(e,n)?X(e,n):null}function K(t,n){return function(t,n){const e=tt(t,n);if(e)return e;const i=nt(t);return i[n]=function(){const t=new s,{promise:n,reject:e,resolve:i}=t;return n.catch((()=>{})),{obj:null,promise:n,resolve:i,reject:e,context:null,ctor:null}}(),i[n].promise}(Y(t),n)}function Z(t,n){return tt(Y(t),n)}function Q(t){return t.nodeType?(n=t,e=(n.ownerDocument||n).defaultView,W(e,"ampdoc")).getAmpDoc(t):t;var n,e}function Y(t){const n=Q(t);return n.isSingleDoc()?n.win:n}function X(t,n){G(et(t,n));const e=nt(t)[n];return e.obj||(G(e.ctor),G(e.context),e.obj=new e.ctor(e.context),G(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function tt(t,n){const e=nt(t)[n];return e?e.promise?e.promise:(X(t,n),e.promise=Promise.resolve(e.obj)):null}function nt(t){let n=t.__AMP_SERVICES;return n||(n=t.__AMP_SERVICES={}),n}function et(t,n){const e=t.__AMP_SERVICES&&t.__AMP_SERVICES[n];return!(!e||!e.ctor)}var it=t=>B(t,"owners"),st=t=>{const n=Q(t),e=W(n.win,"ampdoc"),i=e.isSingleDoc()?e.getSingleDoc():null;return K(i&&i.win==n.win?i:n,"storage")},rt=t=>J(t,"url-replace"),ot=t=>function(t,n,e,i){const s=Z(t,n);if(s)return s;const r=Q(t);return r.whenExtensionsKnown().then((()=>{const t=r.getExtensionVersion(e);return t?W(r.win,"extensions").waitForExtension(e,t):null})).then((e=>e?i?Z(t,n):K(t,n):null))}(t,"geo","amp-geo",!0),ht=t=>W(t,"xhr"),ct="notificationUIManager";function at(t){return t.data}function ut(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function lt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function pt(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?lt(Object(e),!0).forEach((function(n){ut(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):lt(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}var mt={};function dt(t){const n=new Uint8Array(t.length);for(let e=0;e<t.length;e++){const i=t.charCodeAt(e);d(i<=255),n[e]=i}return n}function ft(t){const n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=String.fromCharCode(t[e]);return n.join("")}mt.appconsent={"consentInstanceId":"appconsent","checkConsentHref":"https://collector.appconsent.io/amp/check-consent","promptUISrc":"https://cdn.appconsent.io/loader.html"},mt.ConsentManager={"consentInstanceId":"ConsentManager","checkConsentHref":"https://consentmanager.mgr.consensu.org/delivery/ampcheck.php","promptUISrc":"https://consentmanager.mgr.consensu.org/delivery/ampui.php"},mt.didomi={"consentInstanceId":"didomi","checkConsentHref":"https://api.privacy-center.org/amp/check-consent","promptUISrc":"https://sdk-amp.privacy-center.org/loader.html"},mt.iubenda={"consentInstanceId":"iubenda","checkConsentHref":"https://amp.iubenda.com/checkConsent","promptUISrc":"https://www.iubenda.com/en/help/22135-cookie-solution-amp"},mt.sirdata={"consentInstanceId":"sirdata","checkConsentHref":"https://sddan.mgr.consensu.org/api/v1/public/amp/check","promptUISrc":"https://ui.sddan.mgr.consensu.org/amp.html"},mt.Marfeel={"consentInstanceId":"Marfeel","checkConsentHref":"https://live.mrf.io/cmp/marfeel/amp/check-consent","promptUISrc":"https://live.mrf.io/cmp/marfeel/amp/index.html"},mt.Ogury={"consentInstanceId":"Ogury","checkConsentHref":"https://api.ogury.mgr.consensu.org/v1/check-for-consent","promptUISrc":"https://www.ogury.mgr.consensu.org/amp.html"},mt.onetrust={"consentInstanceId":"onetrust","checkConsentHref":"https://cdn.cookielaw.org/amp/consent/check","promptUISrc":" https://amp.onetrust.mgr.consensu.org/"},mt.opencmp={"consentInstanceId":"opencmp","checkConsentHref":"https://amp.opencmp.net/consent/check","promptUISrc":"https://cdn.opencmp.net/tcf-v2/amp/cmp.html"},mt.pubtech={"consentInstanceId":"pubtech","checkConsentHref":"https://amp.pubtech.it/cmp-amp-check-consent","promptUISrc":"https://cdn.pubtech.ai/amp/index.html"},mt.quantcast={"consentInstanceId":"quantcast","checkConsentHref":"https://apis.quantcast.mgr.consensu.org/amp/check-consent","promptUISrc":"https://quantcast.mgr.consensu.org/tcfv2/amp.html"},mt.SourcePoint={"consentInstanceId":"SourcePoint","checkConsentHref":"https://sourcepoint.mgr.consensu.org/consent/v2/amp","promptUISrc":"https://amp.pm.sourcepoint.mgr.consensu.org/"},mt.UniConsent={"consentInstanceId":"UniConsent","checkConsentHref":"https://edge.uniconsent.com/amp/check-consent","promptUISrc":"https://cmp.uniconsent.com/amp/index.html"},mt.Usercentrics={"consentInstanceId":"Usercentrics","checkConsentHref":"https://consents.usercentrics.eu/amp/checkConsent","promptUISrc":"https://amp.usercentrics.eu/amp.html"},mt.LiveRamp={"consentInstanceId":"LiveRamp","checkConsentHref":"https://api.privacymanager.io/amp/check-consent","promptUISrc":"https://amp-consent-tool.privacymanager.io/1/index.html"},mt.googlefc={"consentInstanceId":"googlefc","checkConsentHref":"https://fundingchoicesmessages.google.com/amp/consent/check?pvid=PAGE_VIEW_ID_64&anonid=CONSENT_PAGE_VIEW_ID_64&href=SOURCE_URL","promptUISrc":"https://fundingchoicesmessages.google.com/amp/consent/message?pvid=PAGE_VIEW_ID_64&anonid=CONSENT_PAGE_VIEW_ID_64&href=SOURCE_URL&clientConfig=CONSENT_INFO(clientConfig)","xssiPrefix":")]}'","uiConfig":{"overlay":!0},"clearDirtyBitOnResponse_dontUseThisItMightBeRemoved":!0};var _t,gt={"-":"+","_":"/",".":"="},Pt={"+":"-","/":"_","=":"."},vt=new Set(["c","v","a","ad"]),It=t=>"string"==typeof t?At(t):t;function At(t,n){return _t||(_t=self.document.createElement("a")),function(t,n,e){return t.href="",new URL(n,t.href)}(_t,t)}function bt(t,n,e="source"){var i;return z(null!=t,"%s %s must be available",n,e),z("https:"==(i=It(i=t)).protocol||"localhost"==i.hostname||"127.0.0.1"==i.hostname||o(i.hostname,".localhost")||/^\/\//.test(t),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',n,e,t),t}function yt(t){return S.cdnProxyRegex.test(It(t).origin)}function Rt(t){if(!yt(t=It(t)))return t.href;const n=t.pathname.split("/"),e=n[1];z(vt.has(e),"Unknown path prefix in url %s",t.href);const i=n[2],s="s"==i?"https://"+decodeURIComponent(n[3]):"http://"+decodeURIComponent(i);return z(s.indexOf(".")>0,"Expected a . in origin %s",s),n.splice(1,"s"==i?3:2),s+n.join("/")+function(t,n){if(!t||"?"==t)return"";const e=new RegExp("[?&](amp_(js[^&=]*|gsa|r|kit)|usqp)\\b[^&]*","g"),i=t.replace(e,"").replace(/^[?&]/,"");return i?"?"+i:""}(t.search)+(t.hash||"")}var Et=class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}},Mt="-test-amp-cookie-tmp";function Ct(t,n){const e=function(t){try{return t.document.cookie}catch(t){return""}}(t);if(!e)return null;const i=e.split(";");for(let t=0;t<i.length;t++){const e=i[t].trim(),s=e.indexOf("=");if(-1!=s&&O(e.substring(0,s).trim())==n){const t=e.substring(s+1).trim();return O(t,t)}}return null}function wt(t,n,e,i,s,r,o){"ampproject.org"==s&&(e="delete",i=0);const h=encodeURIComponent(n)+"="+encodeURIComponent(e)+"; path=/"+(s?"; domain="+s:"")+"; expires="+new Date(i).toUTCString()+function(t,n){return n?`; SameSite=${n}`:""}(0,r)+(o?"; Secure":"");try{t.document.cookie=h}catch(t){}}var Tt=31536e6;function kt(t){const n=function(t){const n=function(t,n){let{crypto:e}=t;const i=new Uint8Array(16);return e.getRandomValues(i),i}(t);return n||String(t.location.href+Date.now()+t.Math.random()+t.screen.width+t.screen.height)}(t);if("string"==typeof n)return(e=t,W(e,"crypto")).sha384Base64(n);var e,i;{const t=n;return i=()=>function(t){const n=ft(t);return btoa(n).replace(/[+/=]/g,(t=>Pt[t]))}(t).replace(/\.+$/,""),new Promise((t=>{t(i())}))}}var St="removeEventListener";function Vt(t){return!!t&&!(!p(t,"isDirty")||1!=t.isDirty)}function Ot(t){return 1==t||2!=t&&null}function xt(t,n,e){if(!t&&!n)return!0;if(t&&n){const i=Ot(t.consentState)===Ot(n.consentState),s=(t.consentString||"")===(n.consentString||"");let r;r=e?!!t.isDirty==!!e:!!t.isDirty==!!n.isDirty;const o=y(t.consentMetadata,n.consentMetadata),h=y(t.purposeConsents,n.purposeConsents);return i&&s&&o&&h&&r}return!1}function jt(t,n,e,i,s){return{"consentState":t,"consentString":n,"consentMetadata":e,"purposeConsents":i,"isDirty":s}}function Ut(t,n,e,i){return{"consentStringType":t,"additionalConsent":n,"gdprApplies":e,"purposeOne":i}}function Dt(t){return!0===t||1===t?1:!1===t||0===t?2:5}function Nt(t){return!!t.consentString||1===t.consentState||2===t.consentState}function Lt(t){return 1===t?"accepted":2===t?"rejected":"unknown"}var Ht="CONSENT-STATE-MANAGER";function Ft(t){return K(t,"consentStateManager")}var $t="amp-consent/consent-config",qt="amp-story-consent",Gt={"promptUI":!0,"checkConsentHref":!0,"promptIfUnknownForGeoGroup":!0,"onUpdateHref":!0},zt={"PAGE_VIEW_ID":!0,"PAGE_VIEW_ID_64":!0,"SOURCE_URL":!0};function Wt(t,n,e){const i=pt({"CLIENT_ID":Bt(t),"CONSENT_PAGE_VIEW_ID_64":()=>Ft(t).then((t=>t.consentPageViewId64()))},e);return rt(t).expandUrlAsync(n,i,pt(pt({},i),zt))}function Bt(t){return(n=t,K(n,"cid")).then((t=>t.get({scope:"AMP-CONSENT",createCookieIfNotPresent:!0},i())));var n}var Jt,Kt="consent-policy-manager",Zt={"default":!0,"_till_responded":!0,"_till_accepted":!0,"_auto_reject":!0};function Qt(t){const n=t.tagName;return n.startsWith("AMP-")&&!("AMP-STICKY-AD-TOP-PADDING"==n||"AMP-BODY"==n)}function Yt(t){return function(t,n){d(1===n.length),t.innerHTML=n[0];const e=t.firstElementChild;return d(e),d(!e.nextElementSibling),t.removeChild(e),e}(Jt,t)}var Xt=['<svg viewBox="0 0 40 40"><defs><linearGradient id=grad><stop stop-color="rgb(105, 105, 105)"></stop><stop offset=100% stop-color="rgb(105, 105, 105)" stop-opacity=0></stop></linearGradient></defs><path d="M11,4.4 A18,18, 0,1,0, 38,20" stroke=url(#grad)></path></svg>'],tn="amp-consent-ui",nn="i-amphtml-consent-ui-iframe-fullscreen",en="i-amphtml-consent-ui-iframe-active",sn="i-amphtml-consent-ui-modal",rn="i-amphtml-consent-ui-in",on="i-amphtml-consent-ui-loading",hn="i-amphtml-consent-ui-border-enabled",cn=class{constructor(t,n,e){this.tW=t,this.nW=!1,this.eW=!1,this.es=!1,this.iW=!1,this.Rb=!1,this.sW=null,this.rW=n.uiConfig&&!0===n.uiConfig.overlay,this.oW=n.captions&&n.captions.consentPromptCaption||"User Consent Prompt",this.hW=n.captions&&n.captions.buttonActionCaption||"Focus Prompt",this.cW=!1,this.aW=!0,this.kC=null,this.uW=null,this.lW=null,this.Ci=t.getAmpDoc(),this.bn=B(this.Ci,"viewport"),this.Ue=(t=>B(t,"viewer"))(this.Ci),this.qt=t.element,this.i=t.win,this.Ao=this.i.document,this.pW=null,this.rM=!1,this.mW=null,this.wv=null,this.dW="30vh",this.fW=!0,this._W=!1,this.gW=!1,this.PW=this.vW.bind(this),this.lU=n,this.Cu(n,e)}Cu(t,n){if(n){const t=this.Ci.getElementById(n);return t||F().error(tn,"postPromptUI element with id=%s not found",n),this.sW=t,void(this.eW=!0)}const e=t.promptUI,i=t.promptUISrc;if(e){const t=this.Ci.getElementById(e);t&&this.qt.contains(t)||F().error(tn,"child element of <amp-consent> with promptUI id %s not found",e),this.sW=t}else i&&(this.nW=!0,bt(i,this.qt),this.sW=this.IW(i),this.wv=this.AW(),this.mW=t.clientConfig||null)}show(t){if(!this.sW)return;if(this.eW&&!this.qt.contains(this.sW))return void b(this.sW,!0);b(this.qt,!0);const{classList:n}=this.qt;if(n.add("amp-active"),n.remove("amp-hidden"),this.tW.getViewport().addToFixedLayer(this.qt,!0),this.nW)this.gW=t,this.bW().then((()=>{this.tW.mutateElement((()=>{this.eW||(this.lW=this.Ao.activeElement),this.yW(),this.RW(),this.EW()}))}));else{const t=()=>{this.sW&&(b(this.sW,!0),this.eW||(this.lW=this.Ao.activeElement,this.yW(),this.resume(),this.sW.focus()))};Qt(this.sW)?function(t){if(d(Qt(t)),t.createdCallback)return Promise.resolve(t);if(!t.__AMP_UPG_PRM){const n=new s;t.__AMP_UPG_PRM=n.promise,t.__AMP_UPG_RES=n.resolve}const n=t.__AMP_UPG_PRM;return d(n),n}(this.sW).then((()=>this.sW.build())).then((()=>t())):t()}this.es=!0}hide(){this.sW&&(this.pause(),this.tW.mutateElement((()=>{if(this.nW&&this.MW(),!this.eW){const{classList:t}=this.qt;t.remove("amp-active"),t.add("amp-hidden")}this.wW(),this.TW(),this.kW(),this.SW(),this.tW.getViewport().removeFromFixedLayer(this.qt),b(this.sW,!1),this.es=!1,this.lW?(this.lW.focus(),this.lW=null):this.i.document.body.children.length>0&&this.i.document.body.children[0].focus()})))}pause(){this.sW&&it(this.tW.element).schedulePause(this.tW.element,this.sW)}resume(){this.sW&&(it(this.tW.element).scheduleLayout(this.tW.element,this.sW),it(this.tW.element).scheduleResume(this.tW.element,this.sW))}VW(t){if(this.dW="30vh",this.fW=!0,this._W=!1,t.initialHeight)if("string"==typeof t.initialHeight&&t.initialHeight.indexOf("vh")>=0){const n=parseInt(t.initialHeight,10);this.dW=n>=80?"80vh":this.dW,n>=10&&n<=80?(this.dW=`${n}vh`,this._W=n>60,this.rW=this._W||this.rW):F().error(tn,`Inavlid initial height: ${t.initialHeight}.Minimum: 10vh. Maximum: 80vh.`)}else F().error(tn,`Inavlid initial height: ${t.initialHeight}.Must be a string in "vh" units.`);!1!==t.border||this._W||(this.fW=!1),this.pW.resolve()}OW(){if(!this.sW||!this.es||this.Rb)return;this.SW(),this.xW("requestFullOverlay");const{classList:t}=this.qt;t.add(nn),this.jB(),this.Rb=!0}xW(t){this.Ue.sendMessage(t,{},!0)}IW(t){const n=this.qt.ownerDocument.createElement("iframe"),e=["allow-scripts","allow-popups"];this.jW(t)&&e.push("allow-same-origin"),n.setAttribute("sandbox",e.join(" "));const{classList:i}=n;return i.add("i-amphtml-consent-ui-fill"),n}jW(t){const n=J(this.qt,"url"),e=n.parse(t),i=n.parse(this.Ci.getUrl());return e.origin!=i.origin}AW(){const t=this.qt.ownerDocument.createElement("placeholder");b(t,!1),t.classList.add("i-amphtml-consent-ui-placeholder");const n=function(t){const n=t.ownerDocument||t;return Jt&&Jt.ownerDocument===n||(Jt=n.createElement("div")),Yt}(t)(Xt);return t.appendChild(n),t}UW(){return Ft(this.Ci).then((t=>t.getLastConsentInstanceInfo().then((t=>({"clientConfig":this.mW,"consentState":Lt(t.consentState),"consentStateValue":Lt(t.consentState),"consentMetadata":t.consentMetadata,"consentString":t.consentString,"promptTrigger":this.gW?"action":"load","isDirty":!!t.isDirty,"purposeConsents":t.purposeConsents})))))}bW(){this.pW=new s;const{classList:t}=this.qt;var n;n=this.qt,_("placeholder"),n.querySelector("placeholder")||E(this.qt,this.wv),t.add(on),b(this.sW,!1),this.rM=!1;const e=this.UW().then((t=>Wt(this.qt,this.lU.promptUISrc,{"CONSENT_INFO":n=>JSON.stringify(t[n])}).then((n=>{this.sW.src=n,this.sW.setAttribute("name",JSON.stringify(t)),this.i.addEventListener("message",this.PW),E(this.qt,this.sW)}))));return Promise.all([e,this.pW.promise,this.tW.mutateElement((()=>{b(this.wv,!0)}))])}EW(){const{classList:t}=this.qt;t.add(en),b(this.wv,!1),b(this.sW,!0),this._W&&(t.add(sn),M(this.sW)),this.SW(),this.tW.mutateElement((()=>{t.remove(on),this.tW.mutateElement((()=>{t.add(rn),this.iW=!0,this.DW()}))}))}MW(){const{classList:t}=this.qt;t.remove(en),t.remove(sn),t.remove(hn),this.i.removeEventListener("message",this.PW),t.remove(nn),this.Rb?this.xW("cancelFullOverlay"):this._W&&this.bn.leaveLightboxMode(),this.Rb=!1,t.remove(rn),this.iW=!1,this.sW.removeAttribute("name"),b(this.wv,!1),this.rM=!0,this.i.setTimeout((()=>{this.rM&&R(this.sW)}),1e3)}RW(){if(this.cW||this._W)return;const t=this.Ao.createElement("div"),n=this.Ao.createElement("button"),e=this.Ao.createElement("div");t.setAttribute("role","alertdialog"),e.textContent=this.oW,n.textContent=this.hW,n.onclick=()=>{M(this.sW)},t.appendChild(e),t.appendChild(n);const{classList:i}=t;i.add("i-amphtml-consent-alertdialog"),this.tW.element.appendChild(t),M(n),this.cW=!0,this.uW=t}TW(){this.uW&&(R(this.uW),delete this.uW)}SW(){A(this.qt,{transform:"",transition:""})}DW(){const{classList:t}=this.qt;this.sW&&A(this.sW,{height:this.dW}),function(t,n){const{style:e}=t;for(const t in n)e.setProperty(P(v(e,t)),String(n[t]),"important")}(this.qt,{"--i-amphtml-modal-height":`${this.dW}`}),t.add("i-amphtml-consent-ui-iframe-transform"),(this.fW||this._W)&&t.add(hn),this._W&&this.bn.enterLightboxMode()}yW(){if(this.rW){if(!this.kC){const t=this.i.document.createElement("div");t.classList.add("i-amphtml-consent-ui-mask"),this.qt.ownerDocument.body.appendChild(t),this.kC=t}b(this.kC,!0),this.jB()}}wW(){this.rW&&(this.kC&&b(this.kC,!1),this.kW())}jB(){this.aW&&(this.bn.enterOverlayMode(),this.aW=!1)}kW(){this.aW||(this.bn.leaveOverlayMode(),this.aW=!0)}vW(t){if(this.sW.contentWindow!==t.source)return;const n=at(t);if(!n||"consent-ui"!=n.type)return;const e=n.action,i=n.type;if("ready"===e&&this.VW(n),"enter-fullscreen"===e){if(!this.iW||this._W||this.Ao.activeElement!==this.sW&&!this.gW)return void this.NW(i,e,!0);this.NW(i,e),this.tW.mutateElement((()=>{this.OW()}))}}NW(t,n,e=!1){this.LW("amp-consent-response",t,n,e?"error":"success",e?"Could not enter fullscreen. Fullscreen is only supported when the iframe is visible as a bottom sheet and after user interaction.":"Entering fullscreen.")}LW(t,n,e,i,s){const r=this.sW.contentWindow;r&&r.postMessage({type:t,requestType:n,requestAction:e,state:i,info:s},"*")}},an=null,un="*",ln=/^[a-zA-Z0-9\-_.]+$/,pn="amp-analytics/linker";function mn(t,n){const e=n||0;return function(t){an||(an=function(){const t=new Array(256);for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)1&e?e=e>>>1^3988292384:e>>>=1;t[n]=e}return t}());const n=(e=t,"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):dt(unescape(encodeURIComponent(e))));var e;let i=-1>>>0;for(let t=0;t<n.length;t++){const e=255&(i^n[t]);i=i>>>8^an[e]}return(-1^i)>>>0}([function(){const t=(new Date).getTimezoneOffset(),n=Et.getUserLanguage(window);return[Et.getUserAgent(window),t,n].join(un)}(),Math.floor(Date.now()/6e4)-e,t].join(un)).toString(36)}function dn(t){return function(t){const n=function(t){return dt(atob(t.replace(/[-_.]/g,(t=>gt[t]))))}(t);return function(t){if("undefined"!=typeof TextDecoder)return new TextDecoder("utf-8").decode(t);const n=ft(new Uint8Array(t.buffer||t));return decodeURIComponent(escape(n))}(n)}(String(t))}var fn="amp-consent/cookie-writer",_n={"referrerDomains":!0,"enabled":!0,"cookiePath":!0,"cookieMaxAge":!0,"cookieSecure":!0,"cookieDomain":!0},gn={"LINKER_PARAM":!0},Pn="amp-consent",vn="loaded",In=t=>"accept"===t||"reject"===t||"dismiss"===t,An="consentStateManager",bn="consentPolicyManager",yn="amp-consent",Rn="accept",En="reject",Mn="dismiss",Cn=class extends t.BaseElement{constructor(t){super(t),this.HW=null,this.FW=null,this.$W=null,this.qW=null,this.GW=null,this.zW=null,this.WW=null,this.BW=null,this.JW=null,this.KW=!1,this.ZW=!1,this.QW=!1,this.br=this.getVsync(),this.YW=null,this.XW=null,this.NJ=null,this.LJ=null}getConsentPolicy(){return null}buildCallback(){z(this.element.getAttribute("id"),"amp-consent should have an id");const t=new class{constructor(t){this.yf=t,this.NJ=null,this.qb=null}getConsentConfigPromise(){return this.qb||(this.qb=this.HJ()),this.qb}getMatchedGeoGroup(){return this.NJ}qJ(t){const n=t.consents;if(!t.consents)return t;const e=Object.keys(n);if(z(e.length<=1,"%s: only single consent instance is supported",$t),e.length>0){t.consentInstanceId=e[0];const n=t.consents[e[0]],i=Object.keys(n);for(let e=0;e<i.length;e++){const s=i[e];!t[s]&&Gt[s]&&(t[i[e]]=n[i[e]])}}return delete t.consents,t}HJ(){const t=this.qJ(z(this.EU(),"%s: Inline config not found")),n=m(this.GJ()||{},t||{},1);if(z(n.consentInstanceId,"%s: consentInstanceId to store consent info is required",$t),n.policy){const t=Object.keys(n.policy);for(let e=0;e<t.length;e++)"default"!=t[e]&&delete n.policy[t[e]]}const e=n.promptIfUnknownForGeoGroup;return"string"==typeof e?(n.consentRequired=!1,n.geoOverride={[e]:{"consentRequired":!0}}):void 0===n.consentRequired&&n.checkConsentHref&&(n.consentRequired="remote"),this.WJ(n).then((t=>this.BJ(t))).then((t=>this.JJ(t)))}WJ(t){return t.geoOverride?ot(this.yf).then((n=>{z(n,"%s: requires <amp-geo> to use `geoOverride`",$t);const e=l(t),i=Object.keys(t.geoOverride);for(let s=0;s<i.length;s++)if(2===n.isInCountryGroup(i[s])){const n=t.geoOverride[i[s]];p(n,"consentInstanceId")&&(F().error($t,"consentInstanceId cannot be overriden in geoGroup:",i[s]),delete n.consentInstanceId),m(e,n,1),this.NJ=i[s];break}return delete e.geoOverride,e})):Promise.resolve(t)}BJ(t){const n=t.consentRequired;return z("boolean"==typeof n||"remote"===n,"`consentRequired` is required",$t),"remote"===n&&z(t.checkConsentHref,"%s: `checkConsentHref` must be specified if `consentRequired` is remote",$t),t}JJ(t){return n=this.yf,_(qt),"> amp-story-consent",n.querySelector(f("> amp-story-consent",":scope"))&&z(!t.promptUISrc,"%s: `promptUiSrc` cannot be specified while using %s.",$t,qt),t;var n}EU(){try{return function(t){const n=(i=t,_("script"),i.querySelectorAll(f("> script",":scope"))),{length:e}=n;var i;if(1!==e)throw new Error(`Found ${e} <script> children. Expected 1.`);const s=n[0];if(!function(t){var n;return"SCRIPT"==t.tagName&&"APPLICATION/JSON"==(null===(n=t.getAttribute("type"))||void 0===n?void 0:n.toUpperCase())}(s))throw new Error('<script> child must have type="application/json"');try{var r;return o=null!==(r=s.textContent)&&void 0!==r?r:"",JSON.parse(o)}catch(t){throw new Error("Failed to parse <script> contents. Is it valid JSON?")}var o}(this.yf)}catch(t){throw F(this.yf).createError($t,t)}}GJ(){const t=this.yf.getAttribute("type");if(!t)return null;z(mt[t],"%s: invalid CMP type %s",$t,t);const n=mt[t];return this.KJ(n),n}KJ(t){const n=["consentInstanceId","checkConsentHref","promptUISrc"];for(let e=0;e<n.length;e++)G(t[n[e]])}}(this.element);return t.getConsentConfigPromise().then((n=>{this.NJ=t.getMatchedGeoGroup(),this.de(n)}))}pauseCallback(){this.GW&&this.GW.pause()}resumeCallback(){this.GW&&this.GW.resume()}de(t){this.zW=t,this.XW=this.zW.consentInstanceId,this.zW.postPromptUI&&(this.BW=new cn(this,{},this.zW.postPromptUI));const n=this.zW.policy||{};this.WW=function(t,n){const e={};e[n]=void 0;const i={"waitFor":e},s=[4,1,2,3],r={"waitFor":e,"unblockOn":s},o={"waitFor":e,"timeout":{"seconds":0,"fallbackAction":"reject"},"unblockOn":s};return t._till_responded=r,t._till_accepted=i,t._auto_reject=o,t&&t.default||(t.default=i),t}(n,this.XW);const e=function(t,n){const e=[];for(let n=t.firstElementChild;n;n=n.nextElementSibling)!(function(t){let n;var e;return"string"==typeof t?n=t:1==(null==(e=t)?void 0:e.nodeType)&&(n=t.tagName),!!n&&n.toLowerCase().startsWith("i-")}(i=n)||i.nodeType===Node.ELEMENT_NODE&&(i.hasAttribute("placeholder")||i.hasAttribute("fallback")||i.hasAttribute("overflow")))&&e.push(n);var i;return e}(this.element);for(let t=0;t<e.length;t++){const n=e[t];b(n,!1),it(this.element).setOwner(n,this.element)}const s=K(this.getAmpDoc(),bn).then((t=>{this.FW=t,this.FW.setLegacyConsentInstanceId(this.XW);const n=Object.keys(this.WW);for(let t=0;t<n.length;t++)this.FW.registerConsentPolicyInstance(n[t],this.WW[n[t]])})),r=K(this.getAmpDoc(),An).then((t=>{t.registerConsentInstance(this.XW,this.zW),this.HW=t})),h=K(this.getAmpDoc(),ct).then((t=>{this.qW=t})),c=this.zW.cookies?new class{constructor(t,n,e){this.i=t,this.yf=n,this.ZJ=null,this.lU=e,this.QJ=new class{constructor(t){this.i=t,this.YJ={}}get(t,n){return t&&n?(p(this.YJ,t)||(this.YJ[t]=this.XJ(t)),this.YJ[t]&&this.YJ[t][n]?this.YJ[t][n]:null):(F().error("amp-consent/linker-reader","LINKER_PARAM requires two params, name and id"),null)}XJ(t){const n=x(this.i.location.search);return p(n,t)?function(t){const n=function(t){const n=t.split(un),e=n.length%2==0;if(n.length<4||!e)return F().error(pn,`Invalid linker_param value ${t}`),null;const i=Number(n.shift());return 1!==i?(F().error(pn,`Invalid version number ${i}`),null):{checksum:n.shift(),serializedIds:n.join(un)}}(t);if(!n)return null;const{checksum:e,serializedIds:i}=n;return function(t,n){for(let e=0;e<=1;e++)if(mn(t,e)==n)return!0;return!1}(i,e)?function(t){const n={},e=t.split(un);for(let t=0;t<e.length;t+=2){const i=e[t];if(!ln.test(i)){F().error(pn,`Invalid linker key ${i}, value ignored`);continue}const s=dn(e[t+1]);n[i]=s}return n}(i):(F().error(pn,"LINKER_PARAM value checksum not valid"),null)}(n[t]):null}}(t)}write(){return this.ZJ||(this.ZJ=this.Cu()),this.ZJ}Cu(){if(!this.nK(this.i,this.yf))return i();if(!p(this.lU,"cookies"))return i();if(!u(this.lU.cookies))return F().error(fn,"cookies config must be an object"),i();const t=this.lU.cookies;if(!1===t.enabled)return i();const n=this.iK(t),e=Object.keys(t),s=[];for(let i=0;i<e.length;i++){const r=e[i],o=t[r];this.oK(r,o)&&s.push(this.hK(r,o.value,n))}return Promise.all(s)}iK(t){if(!p(t,"cookieMaxAge"))return Tt;const n=Number(t.cookieMaxAge);return n||0===n?1e3*n:(F().error(fn,"invalid cookieMaxAge %s, falling back to default value (1 year)",t.cookieMaxAge),Tt)}oK(t,n){return!(_n[t]||(u(n)?!p(n,"value")&&(F().error(fn,"value is required in the cookieValue object"),1):(F().error(fn,"cookieValue must be configured in an object"),1)))}hK(t,n,e){return rt(this.yf).expandStringAsync(n,{"LINKER_PARAM":(t,n)=>this.QJ.get(t,n)},gn).then((n=>{if(n){const i=Date.now()+e;!function(t,n,e,i,s={}){let r;!function(t,n,e){if(n.allowOnProxyOrigin)return void z(!n.highestAvailableDomain,"Could not support highestAvailable Domain on proxy origin, specify domain explicitly");z(!yt(t.location.href),`Should never attempt to set cookie on proxy origin: ${e}`);const i=At(t.location.href).hostname.toLowerCase(),s=At(S.cdn).hostname.toLowerCase();z(!(i==s||o(i,"."+s)),"Should never attempt to set cookie on proxy origin. (in depth check): "+e)}(t,s,n),s.domain?r=s.domain:s.highestAvailableDomain&&(r=function(t){const n=t.document.head&&t.document.head.querySelector("meta[name='amp-cookie-scope']");if(n){const e=n.getAttribute("content")||"",i=At(Rt(t.location.href)).origin;return o(i,"."+e)?e:i.split("://")[1]}if(!yt(t.location.href)){const n=t.location.hostname.split(".");let e=n[n.length-1];const i=function(t){let n=Mt;for(;Ct(t,n);)n=Mt+0;return n}(t);for(let s=n.length-2;s>=0;s--)if(e=n[s]+"."+e,wt(t,i,"delete",Date.now()+1e3,e),"delete"==Ct(t,i))return wt(t,i,"delete",Date.now()-1e3,e),e}return null}(t)),wt(t,n,e,i,r,s.sameSite,s.secure)}(this.i,t,n,i,{highestAvailableDomain:!0})}})).catch((t=>{F().error(fn,"Error expanding cookie string",t)}))}nK(){return!((t=this.yf).classList.contains("i-amphtml-fie")||function(t,n){return t.closest?t.closest(".i-amphtml-fie"):function(t,n,e){let i;for(i=t;i&&void 0!==i;i=i.parentElement)if(n(i))return i;return null}(t,(t=>function(t,n){const e=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!e&&e.call(t,".i-amphtml-fie")}(t)))}(t)||yt(this.i.location)||"inabox"==function(t){const n=t||self;return n.__AMP_MODE?n.__AMP_MODE:n.__AMP_MODE=function(t){return{localDev:!1,development:N(t,j(t)),esm:!0,test:!1,rtvVersion:D(t)}}(n)}(this.i).runtime);var t}}(this.win,this.element,this.zW).write():i();Promise.all([r,h,s,c]).then((()=>{this.Cu()}))}cK(){this.registerAction("accept",(t=>{this.uK(Rn,t)})),this.registerAction("reject",(t=>{this.uK(En,t)})),this.registerAction("dismiss",(()=>{this.uK(Mn)})),this.registerAction("setPurpose",(t=>{this.lK(t)})),this.registerAction("prompt",(t=>this.pK(t))),this.mK()}uK(t,n){this.dK()&&this.fK(t,n).then((()=>{this._K(t)}))}mK(){this.win.addEventListener("message",(t=>{if(!this.KW)return;let n,e;const i=at(t);if(!i||"consent-response"!=i.type)return;if(!i.action)return void F().error(yn,"consent-response message missing required info");void 0!==i.info&&("string"!=typeof i.info&&(F().error(yn,"consent-response info only supports string, %s, treated as undefined",i.info),i.info=void 0),i.action===Mn&&(i.info&&this.user().error(yn,"Consent string value %s not applicable on user dismiss, stored value will be kept and used",i.info),i.info=void 0),n=i.info,e=this.gK(i.consentMetadata));const s=this.element.querySelectorAll("iframe");for(let r=0;r<s.length;r++)if(s[r].contentWindow===t.source){const{action:t,purposeConsents:s}=i;if(!In(t)||!this.dK())continue;s&&Object.keys(s).length&&t!==Mn&&(this.PK(s),this.HW.updateConsentInstancePurposes(s)),this._K(t,n,e)}}))}vK(t){this.qW||q().error(yn,"notification ui manager not found"),this.QW||this.GW&&(this.QW=!0,this.qW.registerUI(this.tB.bind(this,t)))}tB(t){this.KW&&q().error(yn,"Attempt to show an already displayed prompt UI"),this.br.mutate((()=>{this.GW.show(t),this.KW=!0}));const n=new s;return this.JW=n.resolve,n.promise}m$(){this.KW||q().error(yn,"%s no consent ui to hide"),this.GW.hide(),this.KW=!1,this.JW&&(this.JW(),this.JW=null),this.QW=!1}dK(){return this.HW?this.KW:(q().error(yn,"No consent state manager"),!1)}_K(t,n,e){(In(t)&&this.zW.clearDirtyBitOnResponse_dontUseThisItMightBeRemoved?this.HW.setDirtyBit(!1):i()).then((()=>{this.IK(t,n,e)}))}IK(t,n,e){this.ZW=!0,t==Rn?this.HW.updateConsentInstanceState(1,n,e):t==En?this.HW.updateConsentInstanceState(2,n,e):t==Mn&&this.HW.updateConsentInstanceState(3),this.m$()}fK(t,n){var e;return"boolean"!=typeof(null==n||null===(e=n.args)||void 0===e?void 0:e.purposeConsentDefault)?i():t===Mn?(q.warn(yn,"Dismiss cannot have a `purposeConsentDefault` parameter."),i()):this.AK().then((t=>{if(!t||!t.length)return;const e={},i=n.args.purposeConsentDefault;t.forEach((t=>{e[t]=i})),this.HW.updateConsentInstancePurposes(e,!0)}))}pK(t){const{args:n}=t;(!0===(null==n?void 0:n.expireCache)?this.HW.setDirtyBit():i()).then((()=>{this.vK(!0)}))}lK(t){if(!t||!t.args||!Object.keys(t.args).length)return void q().error(yn,"Must have arugments for `setPurpose`.");const{args:n}=t;this.dK()&&(this.PK(n),this.HW.updateConsentInstancePurposes(n))}Cu(){this.bK(),this.yK(),this.RK(),this.EK().then((t=>this.MK(t))).then((t=>{t&&this.CK(),this.FW.enableTimeout()})).catch((t=>{})),this.cK()}EK(){return this.HW.getConsentInstanceInfo().then((t=>{if(Nt(t))return Promise.resolve(!0);const n=this.zW.consentRequired;return"boolean"==typeof n?Promise.resolve(n):this.wK().then((t=>!!t&&(void 0!==t.consentRequired?!!t.consentRequired:!!t.promptIfUnknown)))}))}bK(){const t=this.wK().then((t=>t&&void 0!==t.sharedData?t.sharedData:null));this.HW.setConsentInstanceSharedData(t)}yK(){this.wK().then((t=>{t&&((t.expireCache||t.forcePromptOnNext)&&this.HW.setDirtyBit(),t.consentRequired&&!this.ZW&&this.TK(t.consentStateValue,t.consentString||void 0,t.consentMetadata,t.purposeConsents))}))}TK(t,n,e,i){const s="accepted"===(r=t)?1:"rejected"===r?2:"unknown"===r?5:null;var r;null!==s&&(i&&u(i)&&Object.keys(i).length&&(this.PK(i),this.HW.updateConsentInstancePurposes(i)),this.HW.updateConsentInstanceState(s,n,this.gK(e)))}wK(){if(this.YW)return this.YW;const{"checkConsentHref":t}=this.zW;if(t){const n=this.HW.getLastConsentInstanceInfo();this.YW=n.then((n=>{const e={credentials:"include",method:"POST",body:{"consentInstanceId":this.XW,"consentStateValue":Lt(n.consentState),"consentMetadata":n.consentMetadata,"consentString":n.consentString,"isDirty":!!n.isDirty,"matchedGeoGroup":this.NJ,"purposeConsents":n.purposeConsents,"clientConfig":this.zW.clientConfig}};bt(t,this.element);const i=this.getAmpDoc(),s=Rt(i.getUrl()),r=(h=t,c=It(c=s),new URL(h,c.href).toString()),o=ht(this.win);var h,c;return i.whenFirstVisible().then((()=>Wt(this.element,r).then((t=>o.fetchJson(t,e).then((t=>o.xssiJson(t,this.zW.xssiPrefix).catch((t=>{F().error(yn,"Could not parse the `checkConsentHref` response.",t)}))))))))}))}else this.YW=Promise.resolve(null);return this.YW}kK(t){return this.AK().then((n=>{if(null==n||!n.length)return this.HW.hasAllPurposeConsents(),!0;const e=t.purposeConsents;if(!e||Object.keys(e).length<n.length)return!1;for(let t=0;t<n.length;t++)if(!p(e,n[t]))return!1;return this.HW.hasAllPurposeConsents(),!0}))}AK(){if(this.LJ)return this.LJ;const t=this.zW.purposeConsentRequired;return r(t)?this.LJ=Promise.resolve(t):this.LJ=this.wK().then((t=>t&&r(t.purposeConsentRequired)?t.purposeConsentRequired:null)),this.LJ}SK(){return this.HW.getConsentInstanceInfo().then((t=>Nt(t)?this.kK(t):Promise.resolve(!1)))}MK(t){return this.GW=new cn(this,G(this.zW)),this.SK().then((n=>!!n||(t?(this.vK(!1),!0):(this.HW.updateConsentInstanceState(4),!1))))}CK(){this.BW&&(this.qW.onQueueEmpty((()=>{this.br.mutate((()=>{this.BW.show(!1)}))})),this.qW.onQueueNotEmpty((()=>{this.br.mutate((()=>{this.BW.hide()}))})))}getConsentStateManagerForTesting(){return this.HW}getConsentRequiredPromiseForTesting(){return this.EK()}getIsPromptUiOnForTesting(){return this.KW}PK(t){Object.keys(t).forEach((n=>{t[n]}))}gK(t){if(t){if(u(t))return function(t){const n=t.consentStringType,e=t.additionalConsent,i=t.gdprApplies,s=t.purposeOne,r=[];var o;n&&1!==(o=n)&&2!==o&&3!==o&&(delete t.consentStringType,r.push("consentStringType")),e&&"string"!=typeof e&&(delete t.additionalConsent,r.push("additionalConsent")),i&&"boolean"!=typeof i&&(delete t.gdprApplies,r.push("gdprApplies")),s&&"boolean"!=typeof s&&(delete t.purposeOne,r.push("purposeOne"));for(let t=0;t<r.length;t++)F().error("amp-consent",'Consent metadata value "%s" is invalid.',r[t])}(t),Ut(t.consentStringType,t.additionalConsent,t.gdprApplies,t.purposeOne);F().error(yn,"CMP metadata is not an object.")}}RK(){if(!this.zW.exposesTcfApi)return;if(this.win.frames.__tcfapiLocator)return;this.$W=new class{constructor(t){this.VK=t,this.xK=l(),this.jK=null,this.UK=0,t.setOnPolicyChange((()=>{this.DK()}))}handleTcfCommand(t,n){if(!this.NK(t.__tcfapiCall))return;const e=t.__tcfapiCall,{command:i}=e;switch(i){case"ping":this.LK(e,n);break;case"getTCData":this.HK(e,n);break;case"addEventListener":this.FK(e,n);break;case St:this.$K(e,n);break;default:return}}FK(t,n){this.xK[this.UK]||(this.xK[this.UK]={payload:t,win:n},this.UK++)}$K(t,n){const{callId:e,parameter:i}=t,s=!!this.xK[i];s&&delete this.xK[i],this.qK(n,void 0,e,s)}DK(){Object.keys(this.xK).length&&this.GK().then((t=>{const n=t[2];if(!n||n===this.jK)return;this.jK=n;const e=Object.keys(this.xK);for(let i=0;i<e.length;i++){const s=Number(e[i]);if(!p(this.xK,s))continue;const{payload:r,win:o}=this.xK[s],{callId:h}=r,c=this.zK(t[0],t[1],n,s);this.qK(o,c,h,!0)}}))}GK(){const t=this.VK.getConsentStringInfo("default"),n=this.VK.getConsentMetadataInfo("default"),e=this.VK.getMergedSharedData("default");return Promise.all([n,e,t])}HK(t,n){this.GK().then((e=>{const i=this.zK(e[0],e[1],e[2]),{callId:s}=t;this.qK(n,i,s,!0)}))}zK(t,n,e,i){const s=t?t.purposeOne:void 0,r=t?t.gdprApplies:void 0,o=t?t.additionalConsent:void 0,h=pt(pt({},n),{},{additionalConsent:o});return{tcfPolicyVersion:2,gdprApplies:r,tcString:e,listenerId:i,cmpStatus:vn,eventStatus:"tcloaded",purposeOneTreatment:s,additionalData:h}}LK(t,n){this.VK.getConsentMetadataInfo("default").then((e=>{const i=this.WK(e),{callId:s}=t;this.qK(n,i,s)}))}WK(t){return{gdprApplies:t?t.gdprApplies:void 0,cmpLoaded:!0,cmpStatus:vn,tcfPolicyVersion:2}}qK(t,n,e,i){if(!t)return;const s={returnValue:n,callId:e,success:i};t.postMessage({__tcfapiReturn:s},"*")}NK(t){if(!u(t))return F().error(Pn,`"tcfapiCall" is not an object: ${t}`),!1;const{command:n,parameter:e,version:i}=t;return"getTCData"!==(s=n)&&"ping"!==s&&"addEventListener"!==s&&"removeEventListener"!==s?(F().error(Pn,`Unsupported command found in "tcfapiCall": ${n}`),!1):e&&n!=St?(F().error(Pn,`Unsupported parameter found in "tcfapiCall": ${e}`),!1):2===i||(F().error(Pn,`Found incorrect version in "tcfapiCall": ${i}`),!1);var s}getMinimalPingReturnForTesting(t){return this.WK(t)}getMinimalTcDataForTesting(t,n,e,i){return this.zK(t,n,e,i)}}(this.FW),this.win.addEventListener("message",(t=>this.BK(t)));const t=this.element.ownerDocument.createElement("iframe");t.setAttribute("name","__tcfapiLocator"),t.setAttribute("aria-hidden","true"),b(t,!1),this.element.appendChild(t)}BK(t){const n=at(t);n&&n.__tcfapiCall&&this.$W.handleTcfCommand(n,t.source)}};t.registerElement("amp-consent",Cn,"amp-consent{position:fixed!important;bottom:0;left:0;overflow:hidden!important;background:hsla(0,0%,100%,0.7);width:100%;z-index:2147483645}amp-consent[i-amphtml-notbuilt]>*{display:none!important}amp-consent>*{max-height:100vh!important}amp-consent.amp-active{visibility:visible}amp-consent.amp-hidden{visibility:hidden}@keyframes amp-consent-ui-placeholder-spin{0%{transform:rotate(0deg)}to{transform:rotate(360deg)}}.i-amphtml-consent-ui-placeholder{width:100%;height:100%;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.i-amphtml-consent-ui-placeholder>svg{width:30px;height:30px;fill:none;stroke-width:1.5px;transform-origin:50% 50%;animation:amp-consent-ui-placeholder-spin 1000ms linear infinite}.i-amphtml-consent-alertdialog{overflow:hidden;position:absolute;height:1px;width:1px;top:auto;left:auto}.i-amphtml-consent-ui-fill{position:absolute;top:0;left:0;width:100%}iframe.i-amphtml-consent-ui-fill{border:none}amp-consent.i-amphtml-consent-ui-iframe-active{width:100%!important;height:100%!important;padding:0px!important;margin:0px!important;overflow:auto!important;transform:translate3d(0px,100vh,0px)!important}amp-consent.i-amphtml-consent-ui-iframe-active.i-amphtml-consent-ui-modal{box-sizing:border-box;top:0;right:0;animation:i-amphtml-modal-appear 0.5s;animation-fill-mode:forwards;height:var(--i-amphtml-modal-height)!important;width:90vw!important;margin:auto!important;max-width:760px}amp-consent.i-amphtml-consent-ui-border-enabled{border-top-left-radius:8px!important;border-top-right-radius:8px!important;box-shadow:0 0 5px 0 rgba(0,0,0,0.2)!important}amp-consent.i-amphtml-consent-ui-modal.i-amphtml-consent-ui-border-enabled{border-radius:8px!important;box-shadow:0 0 5px 0 rgba(0,0,0,0.2)!important}amp-consent.i-amphtml-consent-ui-iframe-active.i-amphtml-consent-ui-iframe-transform{transform:translate3d(0px,calc(100% - var(--i-amphtml-modal-height)),0px)!important}amp-consent.i-amphtml-consent-ui-iframe-active.i-amphtml-consent-ui-in{transition:transform 0.5s ease-out!important}amp-consent.i-amphtml-consent-ui-iframe-active.i-amphtml-consent-ui-in.i-amphtml-consent-ui-iframe-fullscreen{top:0px!important;transform:translateZ(0px)!important;border-top-left-radius:0px!important;border-top-right-radius:0px!important}amp-consent.i-amphtml-consent-ui-in.i-amphtml-consent-ui-iframe-fullscreen>.i-amphtml-consent-ui-fill{height:100%!important}@keyframes i-amphtml-consent-ui-mask{0%{opacity:0.0}to{opacity:0.2}}@keyframes i-amphtml-modal-appear{0%{transform:translateY(100vh);opacity:0}to{transform:translate(0);opacity:1}}.i-amphtml-consent-ui-mask{position:fixed!important;top:0!important;left:0!important;width:100vw!important;height:100vh!important;opacity:0.2;animation:i-amphtml-consent-ui-mask 0.25s ease-in;background-image:none!important;background-color:#000;z-index:2147483644}\n/*# sourceURL=/extensions/amp-consent/0.1/amp-consent.css*/"),t.registerServiceForDoc(ct,class{constructor(){this.JK=0,this.KK=i(),this.ZK=()=>{},this.QK=()=>{}}onQueueEmpty(t){this.ZK=t,0==this.JK&&t()}onQueueNotEmpty(t){this.QK=t,this.JK>0&&t()}registerUI(t){0==this.JK&&this.QK(),this.JK++;const n=this.KK.then((()=>t().then((()=>{this.JK--,0==this.JK&&this.ZK()}))));return this.KK=n,n}}),t.registerServiceForDoc(An,class{constructor(t){this.Ci=t,this.YK=null,this.XK=null,this.tZ=null,this.nZ=null,this.eZ=null,this.iZ=void 0;const n=new s;this.sZ=n.resolve,this.rZ=n.promise,this.consentPageViewId64=function(t){let n=!1,e=null,i=t;return(...t)=>(n||(e=i.apply(self,t),n=!0,i=null),e)}((()=>kt(this.Ci.win)))}registerConsentInstance(t,n){this.XK?q().error(Ht,"Cannot register consent instance %s, instance %s has already been registered.",t,this.YK):(this.YK=t,this.XK=new class{constructor(t,n,e){this.Ci=t,this.ci=n,this.sharedDataPromise=null,this.oZ=st(t),this.hZ=null,this.cZ=null,this.aZ="amp-consent:"+n,this.uZ=e.onUpdateHref||null,this.uZ&&bt(this.uZ,"AMP-CONSENT"),this.lZ=void 0}setDirtyBit(t=!0){return this.lZ=t,this.get().then((n=>{Vt(n)!==t&&this.update(n.consentState,n.consentString,n.purposeConsents,n.consentMetadata,t)}))}update(t,n,e,i,s){const r=(h=this.hZ&&this.hZ.consentState,1!==(c=o=t)&&2!==c&&3!==c&&4!==c&&5!==c&&(o=5),3==o?h||5:4==o&&h&&5!=h?h:o);var o,h,c,a,u,l;if(3===t)return void(this.hZ=jt(r,null===(a=this.hZ)||void 0===a?void 0:a.consentString,null===(u=this.hZ)||void 0===u?void 0:u.consentMetadata,null===(l=this.hZ)||void 0===l?void 0:l.purposeConsents));const p=this.hZ;s&&Vt(p)?this.hZ=jt(r,n,i,e,!0):this.hZ=jt(r,n,i,e);const m=jt(r,n,i,e,this.lZ);xt(m,this.cZ)||this.pZ(m)}pZ(t){this.oZ.then((n=>{if(!xt(t,this.hZ,this.lZ))return;if(5===t.consentState)return void n.remove(this.aZ);const e=function(t){const n=l(),e=t.consentState;if(1==e)n.s=1;else{if(2!=e)return null;n.s=0}return t.consentString&&(n.r=t.consentString),!0===t.isDirty&&(n.d=1),t.consentMetadata&&(n.m=function(t){const n=l();return t.consentStringType&&(n.cst=t.consentStringType),t.additionalConsent&&(n.ac=t.additionalConsent),null!=t.gdprApplies&&(n.ga=t.gdprApplies),null!=t.purposeOne&&(n.po=t.purposeOne),n}(t.consentMetadata)),t.purposeConsents&&(n.pc=t.purposeConsents),0==Object.keys(n)?null:n}(t);null!=e&&(this.cZ=t,n.setNonBoolean(this.aZ,e),this.mZ(t))}))}get(){if(this.hZ)return Promise.resolve(this.hZ);let t;return this.oZ.then((n=>(t=n,t.get(this.aZ)))).then((n=>{if(this.hZ)return this.hZ;const e=function(t){if(void 0===t)return jt(5);if("boolean"==typeof t)return function(t){return jt(Dt(t))}(t);if(!u(t))throw q().createError("Invalid stored consent value");return jt(Dt(t.s),t.r,(n=t.m)?Ut(n.cst,n.ac,n.ga,n.po):Ut(),t.pc,t.d&&1===t.d);var n}(n);return this.cZ=e,Vt(e)&&(this.mZ(jt(5)),t.remove(this.aZ),this.cZ=null),this.hZ=e,this.hZ})).catch((t=>(q().error(Ht,"Failed to read storage",t),jt(5))))}mZ(t){if(!this.uZ)return;if(Vt(t))return;const n=Ot(t.consentState);Bt(this.Ci).then((e=>{const i={"consentInstanceId":this.ci,"ampUserId":e};null!=n&&(i.consentState=n),i.consentStateValue=Lt(t.consentState),t.consentString&&(i.consentString=t.consentString),t.consentMetadata&&(i.consentMetadata=t.consentMetadata),t.purposeConsents&&(i.purposeConsents=t.purposeConsents);const s={credentials:"include",method:"POST",body:i,ampCors:!1};this.Ci.whenFirstVisible().then((()=>{Wt(this.Ci.getHeadNode(),this.uZ).then((t=>{ht(this.Ci.win).fetchJson(t,s)}))}))}))}}(this.Ci,t,n),this.eZ&&(this.eZ(),this.eZ=null))}updateConsentInstanceState(t,n,e){this.XK?(this.XK.update(t,n,this.iZ,e,!1),this.tZ&&(this.tZ(jt(t,n,e,this.iZ)),this.hasAllPurposeConsents())):q().error(Ht,"instance not registered")}updateConsentInstancePurposes(t,n=!1){this.iZ||(this.iZ={}),Object.keys(t).forEach((e=>{if(n&&p(this.iZ,e))return;const i=t[e]?1:2;this.iZ[e]=i}))}getLastConsentInstanceInfo(){return G(this.XK),this.XK.get()}getConsentInstanceInfo(){return G(this.XK),this.XK.get().then((t=>Vt(t)?jt(5):t))}onConsentStateChange(t){G(this.XK),G(!this.tZ),this.tZ=t,this.getConsentInstanceInfo().then((n=>{t(n)}))}setConsentInstanceSharedData(t){G(this.XK),this.XK.sharedDataPromise=t}hasAllPurposeConsents(){this.sZ()}whenHasAllPurposeConsents(){return this.rZ}setDirtyBit(t=!0){return this.XK.setDirtyBit(t)}getConsentInstanceSharedData(){return G(this.XK),this.XK.sharedDataPromise}whenConsentReady(){if(this.XK)return i();if(!this.nZ){const t=new s;this.nZ=t.promise,this.eZ=t.resolve}return this.nZ}getSavedInstanceForTesting(){return this.XK.cZ}}),t.registerServiceForDoc(bn,class{constructor(t){this.Ci=t,this.dZ=l(),this.fZ=l(),this._Z=K(this.Ci,"consentStateManager"),this.gZ=new s;const e=new s;this.PZ=e.promise,this.vZ=e.resolve,this.IZ=new class{constructor(){this.Tt=null}add(t){return this.Tt||(this.Tt=[]),this.Tt.push(t),()=>{this.remove(t)}}remove(t){this.Tt&&function(t,n){const e=t.indexOf(n);-1!=e&&t.splice(e,1)}(this.Tt,t)}removeAll(){this.Tt&&(this.Tt.length=0)}fire(t){if(this.Tt)for(var e,i=function(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t))||t&&"number"==typeof t.length){i&&(t=i);var s=0;return function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.Tt.slice());!(e=i()).done;)(0,e.value)(t)}getHandlerCount(){var t,n;return null!==(t=null===(n=this.Tt)||void 0===n?void 0:n.length)&&void 0!==t?t:0}},this.AZ=null,this.bP=null,this.MP=null,this.zP=null,this.iZ=null,this.bZ=null}setLegacyConsentInstanceId(t){this.AZ=t,this.Cu()}registerConsentPolicyInstance(t,n){if(this.fZ[t])return;const e=Object.keys(n.waitFor||{});if(1!==e.length||e[0]!==this.AZ)return void F().error(Kt,"invalid waitFor value, consent policy will never resolve");const i=new class{constructor(t){this.lU=t;const n=new s;this.ei=n.promise,this.li=n.resolve,this.yZ=4,this.RZ=t.unblockOn||[1,3]}startTimeout(t){const n=this.lU.timeout;let e,i=null;var s;null!=n&&(u(n)?(n.fallbackAction&&"reject"==n.fallbackAction?e=2:n.fallbackAction&&"dismiss"!=n.fallbackAction&&F().error(Kt,"unsupported fallbackAction %s",n.fallbackAction),i=n.seconds):i=n,z("number"==typeof(s=i)&&isFinite(s),"invalid timeout value %s",i)),null!=i&&t.setTimeout((()=>{e=e||5,this.evaluate(e,!0)}),1e3*i)}evaluate(t,n=!1){t&&(n&&!this.li||(this.yZ=1===t?1:2===t?2:4===t?3:4,this.li&&(this.li(),this.li=null)))}getReadyPromise(){return this.ei}getCurrentPolicyStatus(){return this.yZ}shouldUnblock(){return this.RZ.indexOf(this.yZ)>-1}}(n);this.fZ[t]=i,this.dZ[t]&&(this.dZ[t].resolve(),this.dZ[t]=null),this.PZ.then((()=>{this.bP&&i.evaluate(this.bP),this.IZ.add((t=>{i.evaluate(t)})),this.gZ.promise.then((()=>{i.startTimeout(this.Ci.win)}))}))}Cu(){this._Z.then((t=>{t.whenConsentReady().then((()=>{t.onConsentStateChange((t=>{this.EZ(t),this.vZ&&(this.vZ(),this.vZ=null)}))}))}))}enableTimeout(){this.gZ.resolve()}EZ(t){const n=t.consentState,e=t.consentString,i=t.consentMetadata,s=t.purposeConsents,{zP:r,MP:o,iZ:h}=this;this.MP=e,this.zP=i,this.iZ=s,5!==n&&(4==n?1!=this.bP&&2!=this.bP&&(this.bP=4):3==n?(null===this.bP&&(this.bP=5),this.MP=o,this.zP=r,this.iZ=h):this.bP=n,this.IZ.fire(this.bP),this.bZ&&this.bZ())}setOnPolicyChange(t){this.bZ||(this.bZ=t)}whenPolicyResolved(t){return Zt[t]?this.MZ(t).then((()=>this.fZ[t].getReadyPromise().then((()=>this.fZ[t].getCurrentPolicyStatus())))):(F().error(Kt,"can not find policy %s, only predefined policies are supported",t),Promise.resolve(4))}whenPolicyUnblock(t){return Zt[t]?this.MZ(t).then((()=>this.fZ[t].getReadyPromise().then((()=>this.fZ[t].shouldUnblock())))):(F().error(Kt,"can not find policy %s, only predefined policies are supported",t),Promise.resolve(!1))}getMergedSharedData(t){return this.whenPolicyResolved(t).then((()=>this._Z)).then((t=>t.getConsentInstanceSharedData()))}getConsentStringInfo(t){return this.whenPolicyResolved(t).then((()=>this.MP))}getConsentMetadataInfo(t){return this.whenPolicyResolved(t).then((()=>this.zP))}whenPurposesUnblock(t){return this._Z.then((t=>t.whenHasAllPurposeConsents())).then((()=>!!this.iZ&&t.every((t=>p(this.iZ,t)&&1===this.iZ[t]))))}MZ(t){return this.fZ[t]?i():(this.dZ[t]||(this.dZ[t]=new s),this.dZ[t].promise)}})})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-consent-0.1.mjs.map
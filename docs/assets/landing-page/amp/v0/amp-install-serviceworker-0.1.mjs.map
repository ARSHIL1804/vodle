{"version":3,"file":"amp-install-serviceworker-0.1.mjs","mappings":"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","names":["hasOwnProperty","hasOwn_","toString","toString_","Object","prototype","element","opt_display","undefined","hasAttribute","removeAttribute","setAttribute","env","self","AMP_CONFIG","thirdPartyFrameRegex","RegExp","cdnProxyRegex","name","document","head","location","test","origin","metaEl","querySelector","getAttribute","urls","thirdParty","thirdPartyFrameHost","cdn","getMetaUrl","localhostRegex","errorReporting","betaErrorReporting","localDev","trustedViewerHosts","geoApi","__AMP_LOG","user","dev","userForEmbed","logs","opt_element","getUserLogger","win","ownerDocument","defaultView","isFromEmbed","suffix","levelFunc","opt_suffix","Error","callLogConstructor","shouldBeTrueish","opt_message","opt_1","opt_2","opt_3","opt_4","opt_5","opt_6","opt_7","opt_8","opt_9","assert","id","getServiceInternal","__AMP_TOP","getTopWindow","nodeOrDoc","nodeType","node","getService","getAmpDoc","ampdoc","getAmpdoc","isSingleDoc","holder","devAssert","isServiceRegistered","s","services","__AMP_SERVICES","getServices","obj","ctor","context","resolve","service","optsSupported","Services","elementOrAmpDoc","getAmpdocServiceHolder","getServiceForDoc","get","getServiceForDocOrNull","url","index","indexOf","substring","Set","TAG","AmpInstallServiceWorker","AMP","BaseElement","constructor","window","super","this","iframeSrc_","urlRewriter_","isSafari_","isSafari","buildCallback","navigator","maybeInstallUrlRewrite_","urlService","getUrlService_","src","assertHttpsUrl","isProxyOrigin","href","parse","whenLoadedAndVisiblePromise_","then","options","scope","serviceWorker","register","registration","installingSw","installing","addEventListener","evt","target","state","performServiceWorkerOptimizations","active","e","error","install","iframeSrc","docInfo","sourceUrl","canonicalUrl","userAssert","insertIframe_","Promise","all","loadPromise","whenFirstVisible","mutateElement","toggle","iframe","createElement","appendChild","winUrl","urlMatch","urlMatchExpr","shellUrl","removeFragment","createError","getSourceOrigin","UrlRewriter_","isSecure","waitToPreloadShell_","preloadShell_","_element$parentElemen","parentElement","removeChild","urlMatchExpr_","shellUrl_","urlService_","shellLoc_","eventType","listener","opt_evtListenerOpts","localElement","localListener","capture","removeEventListener","err","detectEvtListenerOptsSupport","event","__AMP_REPORT_ERROR","internalListenImplementation","listen","getRootNode","handle_","bind","defaultPrevented","closest","callback","opt_stopAt","el","selector","matcher","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","call","tgtLoc","pathname","encodeURIComponent","search","hash","ampScriptsUsed","performance","getEntriesByType","filter","item","initiatorType","startsWith","map","script","activeSW","postMessage","JSON","stringify","type","payload","sendAmpScriptToSwOnFirstVisit","links","querySelectorAll","link","doc","fakeLink","relList","supports","supportsPrefetch","forEach","linkTag","prefetchOutgoingLinks","registerElement"],"sourceRoot":"https://raw.githubusercontent.com/ampproject/amphtml/2203281422000/","sources":["src/core/types/object/index.js","src/core/dom/style.js","src/config.js","src/utils/log.js","src/service-helpers.js","src/core/window/index.js","src/service/index.js","src/core/dom/event-helper-listen.js","src/url.js","extensions/amp-install-serviceworker/0.1/amp-install-serviceworker.js","src/core/dom/index.js","src/utils/event-helper.js","src/core/dom/query.js"]}

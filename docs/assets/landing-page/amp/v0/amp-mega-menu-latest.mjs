;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-mega-menu",ev:"0.1",l:!0,f:function(t,e){(()=>{var e,n="amp:dom-update",i="ArrowLeft";function a(t){return t?Array.prototype.slice.call(t):[]}var{hasOwnProperty:r,toString:o}=Object.prototype;function s(t){return 1==(null==t?void 0:t.nodeType)}function m(t,e,n,i,a,r,o,s,m,l,u){return t}function l(t,e){return t.replace(/^|,/g,`$&${e} `)}function u(t,e){return t.querySelector(l(e,":scope"))}function h(t,e,n){let i;for(i=t;i&&i!==n;i=i.parentElement)if(e(i))return i;return null}function c(t){const e=t.isConnected;if(void 0!==e)return e;let n=t;for(;n=p(n),n.host;)n=n.host;return n.nodeType===Node.DOCUMENT_NODE}function p(t){if(Node.prototype.getRootNode)return t.getRootNode();let e;for(e=t;e.parentNode&&(!(n=e)||"I-AMPHTML-SHADOW-ROOT"!=n.tagName&&(11!=n.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(n)));e=e.parentNode);var n;return e}function d(t){try{t.focus()}catch(t){}}var f=[],g="__AMP_MODAL_SAVED_TAB_INDEX";function _(t){const e=[];for(let n=t;n;n=n.parentNode||n.host)e.push(n);return e}function b(t,e,n){null===n||null==n?t.removeAttribute(e):t.setAttribute(e,n)}var v=self.AMP_CONFIG||{},A=("string"==typeof v.thirdPartyFrameRegex?new RegExp(v.thirdPartyFrameRegex):v.thirdPartyFrameRegex,("string"==typeof v.cdnProxyRegex?new RegExp(v.cdnProxyRegex):v.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/);function P(t){if(!self.document||!self.document.head)return null;if(self.location&&A.test(self.location.origin))return null;const e=self.document.head.querySelector(`meta[name="${t}"]`);return e&&e.getAttribute("content")||null}v.thirdPartyUrl,v.thirdPartyFrameHost,v.cdnUrl||P("runtime-host"),v.errorReportingUrl,v.betaErrorReportingUrl,v.localDev,v.geoApiUrl||P("amp-geo-api"),self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var y=self.__AMP_LOG;function E(t){return function(t,e){throw new Error("failed to call initLogConstructor")}()}function x(t,e,n,i,a,r,o,s,m,l,u){return t}function k(t,e){const n=function(t){const e=I(t);return e.isSingleDoc()?e.win:e}(I(t));return R(n,e)?M(n,e):null}function I(t){return t.nodeType?(e=t,n=(e.ownerDocument||e).defaultView,function(t,e){return M(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),e)}(n,"ampdoc")).getAmpDoc(t):t;var e,n}function M(t,e){x(R(t,e));const n=function(t){let e=t.__AMP_SERVICES;return e||(e=t.__AMP_SERVICES={}),e}(t)[e];return n.obj||(x(n.ctor),x(n.context),n.obj=new n.ctor(n.context),x(n.obj),n.context=null,n.resolve&&n.resolve(n.obj)),n.obj}function R(t,e){const n=t.__AMP_SERVICES&&t.__AMP_SERVICES[e];return!(!n||!n.ctor)}var w="amp-mega-menu",T=class extends t.BaseElement{static prerenderAllowed(){return!0}constructor(t){super(t),this.bC=[],this.yC=0,this.xC=null,this.kC=null,this.Ao=this.win.document,this.IC=this.Ao.documentElement,this.fc=null,this.wC=t.id||Math.floor(100*Math.random()),this.VC=this.CC.bind(this),this.DC=this.OC.bind(this),this.HC=this.LC.bind(this)}isLayoutSupported(t){return"fixed-height"===t}buildCallback(){this.fc=k(this.element,"action")}layoutCallback(){return this.CC(),this.element.addEventListener(n,this.VC),this.kC||(this.kC=this.SC()),e||(e=Promise.resolve(void 0))}unlayoutCallback(){return this.element.removeEventListener(n,this.VC),this.zC(),!0}SC(){const t=this.Ao.createElement("div");t.classList.add("i-amphtml-mega-menu-mask"),t.setAttribute("aria-hidden","true");const e=("header",((n=this.element).closest?n.closest("header"):h(n,(t=>function(t,e){const n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector;return!!n&&n.call(t,"header")}(t))))||this.element);var n;return e.classList.add("i-amphtml-mega-menu-mask-parent"),e.appendChild(t),t}CC(){this.bC=a(this.element.querySelectorAll(l("nav > * > li",":scope"))),this.bC.filter((t=>!t.classList.contains("i-amphtml-mega-menu-item"))).forEach((t=>{if(1==t.childElementCount){const e=t.firstElementChild;return void this.$C(t,e,null)}const e=u(t,"> button")||u(t,"> [role=button]"),n=u(t,"> [role=dialog]");var i,a,r,o,s,m,l,h,c,p,d;i=e,a=`${w} requires each expandable item to include a button that toggles it.`,(y.user||(y.user=E()),void y.user.win?y.userForEmbed||(y.userForEmbed=E()):y.user).assert(i,a,r,o,s,m,l,h,c,p,d),this.$C(t,e,n)}))}$C(t,e,n){if(t.classList.add("i-amphtml-mega-menu-item"),this.yC++,e.classList.add("i-amphtml-mega-menu-heading"),e.hasAttribute("tabindex")||e.setAttribute("tabindex",0),e.addEventListener("click",(t=>this.jC(t))),e.addEventListener("keydown",(t=>this.NC(t))),!n||this.fc.hasAction(e,"tap",t))return;n.classList.add("i-amphtml-mega-menu-content"),n.setAttribute("aria-modal","false");let i=n.getAttribute("id");i||(i=this.wC+"_AMP_content_"+this.yC,n.setAttribute("id",i)),n.insertBefore(this.KC(),n.firstChild),n.appendChild(this.KC()),e.setAttribute("aria-haspopup","dialog"),e.setAttribute("aria-controls",i),e.setAttribute("aria-expanded","false")}OC(t){const e=t.target;this.xC&&!this.xC.contains(e)&&c(e)&&this.zC()}LC(t){"Escape"===t.key&&this.zC()&&t.preventDefault()}jC(t){if(!this.BC(t))return;t.preventDefault(),t.stopPropagation();const e=t.currentTarget.parentElement;e!=this.zC()&&this.qC(e)}BC(t){const e=t.target,n=t.currentTarget;return!h(e,(t=>"A"==t.tagName),n)&&!this.fc.hasAction(e,"tap",n)&&n.hasAttribute("aria-haspopup")}NC(t){if(t.defaultPrevented)return;const{key:e}=t;switch(e){case i:case"ArrowRight":return void this.FC(t);case"Enter":case" ":return void(t.target==t.currentTarget&&this.jC(t))}}FC(t){const e=t.currentTarget.parentElement,n=this.bC.indexOf(e);if(-1!==n){t.preventDefault();let e=t.key==i?-1:1;"rtl"==((o=this.Ao).body.getAttribute("dir")||o.documentElement.getAttribute("dir")||"ltr")&&(e=-e);const s=(a=n+e,r=this.bC.length,a>0&&r>0?a%r:(a%r+r)%r);d(this.UC(this.bC[s]))}var a,r,o}qC(t){this.mutateElement((()=>{const e=this.WC(t);(function(t){m(f.every((e=>e.element!==t))),m(c(t));const e=function(t){const e=[],n=_(t);for(let t=0;t<n.length;t++){const i=n[t];i.parentNode&&a(i.parentNode.children).filter((t=>t!=i)).forEach((t=>e.push(t)))}return e}(t),n=_(t).filter(s),i=function(t){const e=[];let n=t;for(;n;){const t=p(n),i=t.querySelectorAll(["a[href]","area[href]","button","details summary","iframe","input","select","textarea","[contenteditable]","[draggable]","[tabindex]"].join(","));Array.prototype.push.apply(e,i),n=t.host}return e}(t),r=i.filter((e=>t.contains(e)&&void 0!==e[g])),o=i.filter((e=>!t.contains(e)&&void 0===e[g])),l=e.concat(n).map((t=>({element:t,prevValue:t.getAttribute("aria-hidden")})));n.forEach((t=>t.removeAttribute("aria-hidden"))),e.forEach((t=>t.setAttribute("aria-hidden","true"))),o.forEach((t=>{t[g]=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")})),r.forEach((t=>{m(void 0!==t[g]),b(t,"tabindex",t[g])})),f.push({element:t,hiddenElementInfos:l,focusableExternalElements:o,focusableInternalElements:r})})(e),e.setAttribute("aria-modal","true")})),t.setAttribute("open",""),this.element.setAttribute("open",""),this.kC.setAttribute("open",""),this.UC(t).setAttribute("aria-expanded","true"),d(t.querySelector(".i-amphtml-screen-reader")),this.IC.addEventListener("click",this.DC),this.IC.addEventListener("keydown",this.HC),this.xC=t}zC(){if(!this.xC)return null;const t=this.xC;this.mutateElement((()=>{const e=this.WC(t);!function(t){const e=f.pop();m(e);const{element:n,focusableExternalElements:i,focusableInternalElements:a,hiddenElementInfos:r}=e;m(c(t)),m(n===t),r.forEach((({element:t,prevValue:e})=>b(t,"aria-hidden",e))),a.forEach((t=>t.setAttribute("tabindex","-1"))),i.forEach((t=>{m(void 0!==t[g]),b(t,"tabindex",t[g]),t[g]=void 0}))}(e),e.setAttribute("aria-modal","false")})),t.removeAttribute("open"),this.element.removeAttribute("open"),this.kC.removeAttribute("open");const e=this.UC(t);return e.setAttribute("aria-expanded","false"),t.contains(this.Ao.activeElement)&&d(e),this.IC.removeEventListener("click",this.DC),this.IC.removeEventListener("keydown",this.HC),this.xC=null,t}UC(t){return u(t,"> .i-amphtml-mega-menu-heading")}WC(t){return u(t,"> .i-amphtml-mega-menu-content")}KC(){const t=this.element.getAttribute("data-close-button-aria-label")||"Close the menu",e=this.Ao.createElement("button");return e.textContent=t,e.classList.add("i-amphtml-screen-reader"),e.addEventListener("click",(()=>this.zC())),e}};t.registerElement(w,T,"amp-mega-menu{z-index:1000!important;white-space:nowrap!important}amp-mega-menu.i-amphtml-layout-size-defined[open]{overflow:visible!important}amp-mega-menu nav{background:#fff}amp-mega-menu nav>*{margin:0}amp-mega-menu .i-amphtml-mega-menu-item{display:inline-block!important}amp-mega-menu .i-amphtml-mega-menu-heading{cursor:pointer!important}amp-mega-menu .i-amphtml-mega-menu-content{position:absolute!important;left:0;width:100vw;opacity:0!important;visibility:hidden!important;background:#fff}amp-mega-menu .i-amphtml-mega-menu-item[open]>.i-amphtml-mega-menu-content{visibility:visible!important;opacity:1!important}amp-mega-menu .i-amphtml-mega-menu-item:not([open]) .i-amphtml-screen-reader{display:none!important}.i-amphtml-mega-menu-mask-parent{z-index:1000!important;position:relative}.i-amphtml-mega-menu-mask{position:fixed!important;z-index:-1!important;visibility:hidden!important;opacity:0!important;top:0!important;bottom:0!important;left:0!important;right:0!important;background:rgba(0,0,0,0.5);transition:opacity 200ms,visibility 0s 200ms}.i-amphtml-mega-menu-mask[open]{opacity:1!important;visibility:visible!important;transition:opacity 200ms}\n/*# sourceURL=/extensions/amp-mega-menu/0.1/amp-mega-menu.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-mega-menu-0.1.mjs.map
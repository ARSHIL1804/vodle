;
(self.AMP=self.AMP||[]).push({m:1,v:"2203281422000",n:"amp-story-player",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,e=new Array(i);s<i;s++)e[s]=t[s];return e}function s(t,s){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,s){if(t){if("string"==typeof t)return i(t,s);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?i(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var e;function r(){return e||(e=Promise.resolve(void 0))}var n=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:o}=Array;function a(t,i){for(let s=0;s<t.length;s++)if(i(t[s],s,t))return s;return-1}var{hasOwnProperty:h,toString:l}=Object.prototype;function c(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function p(t,i){return t}function u(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function f(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function m(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?f(Object(s),!0).forEach((function(i){u(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var d="ase art bmp blp cd5 cit cpt cr2 cut dds dib djvu egt exif gif gpl grf icns ico iff jng jpeg jpg jfif jp2 jps lbm max miff mng msp nitf ota pbm pc1 pc2 pc3 pcf pcx pdn pgm PI1 PI2 PI3 pict pct pnm pns ppm psb psd pdd psp px pxm pxr qfx raw rle sct sgi rgb int bw tga tiff tif vtf xbm xcf xpm 3dv amf ai awg cgm cdr cmx dxf e2d egt eps fs gbr odg svg stl vrml x3d sxd v2d vnd wmf emf art xar png webp jxr hdp wdp cur ecw iff lbm liff nrrd pam pcx pgf sgi rgb rgba bw int inta sid ras sun tga".split(" "),y="### #gf $on $tf 0b 8m 8u 12u 15u 64c 075 75 085 85 91 091 096 96 abf acfm acs afm afn afs all amfm apf asf aspf atm auf b30 bco bdf bepf bez bfn bmap bmf bx bzr cbtf cct cef cff cfn cga ch4 cha chm chr chx claf collection compositefont dfont dus dzk eft eot etx euf f00 f06 f08 f09 f3f f10 f11 f12 f13 f16 fd fdb ff ffil flf fli fn3 fnb fnn fnt fnta fo1 fo2 fog fon font fonts fot frf frs ftm fxr fyi gdr gf gft glf glif glyphs gsf gxf hbf ice intellifont lepf lft lwfn mcf mcf mfd mfm mft mgf mmm mrf mtf mvec nlq ntf odttf ofm okf otf pcf pcf pfa pfb pfm pft phf pk pkt prs pss qbf qfn r8? scr sfd sff sfi sfl sfn sfo sfp sfs sif snf spd spritefont sui suit svg sxs t1c t2 tb1 tb2 tdf tfm tmf tpf ttc tte ttf type ufm ufo usl usp us? vf vf1 vf3 vfb vfm vfont vlw vmf vnf w30 wfn wnf woff woff2 xfc xfn xfr xft zfi zsu _v".split(" "),g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function _(t,i){if(i=i.split(":")[0],!(t=+t))return!1;switch(i){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}var v=Object.prototype.hasOwnProperty;function b(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}var A={stringify:function(t,i){i=i||"";var s,e=[];for(r in"string"!=typeof i&&(i="?"),t)if(v.call(t,r)){(s=t[r])||null!=s&&!isNaN(s)||(s="");var r=encodeURIComponent(r);s=encodeURIComponent(s),null!==r&&null!==s&&e.push(r+"="+s)}return e.length?i+e.join("&"):""},parse:function(t){for(var i,s=/([^=?&]+)=?([^&]*)/g,e={};i=s.exec(t);){var r=b(i[1]);i=b(i[2]),null===r||null===i||r in e||(e[r]=i)}return e}},P=/^[A-Za-z][A-Za-z0-9+-.]*:[\\/]+/,w=/^([a-z][a-z0-9.+-]*:)?([\\/]{1,})?([\S\s]*)/i,x=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/;function E(t){return(t||"").toString().replace(x,"")}var M=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],T={hash:1,query:1};function R(t){var i=("undefined"!=typeof window?window:void 0!==g?g:"undefined"!=typeof self?self:{}).location||{};t=t||i,i={};var s,e=typeof t;if("blob:"===t.protocol)i=new S(unescape(t.pathname),{});else if("string"===e)for(s in i=new S(t,{}),T)delete i[s];else if("object"===e){for(s in t)s in T||(i[s]=t[s]);void 0===i.slashes&&(i.slashes=P.test(t.href))}return i}function I(t){return t=E(t),{protocol:(t=w.exec(t))[1]?t[1].toLowerCase():"",slashes:!!(t[2]&&2<=t[2].length),rest:t[2]&&1===t[2].length?"/"+t[3]:t[3]}}function S(t,i,s){if(t=E(t),!(this instanceof S))return new S(t,i,s);var e=M.slice(),r=typeof i,n=0;"object"!==r&&"string"!==r&&(s=i,i=null),s&&"function"!=typeof s&&(s=A.parse),i=R(i);var o=I(t||"");for(r=!o.protocol&&!o.slashes,this.slashes=o.slashes||r&&i.slashes,this.protocol=o.protocol||i.protocol||"",t=o.rest,o.slashes||(e[3]=[/(.*)/,"pathname"]);n<e.length;n++)if("function"==typeof(o=e[n]))t=o(t);else{var a=o[0],h=o[1];a!=a?this[h]=t:"string"==typeof a?~(a=t.indexOf(a))&&("number"==typeof o[2]?(this[h]=t.slice(0,a),t=t.slice(a+o[2])):(this[h]=t.slice(a),t=t.slice(0,a))):(a=a.exec(t))&&(this[h]=a[1],t=t.slice(0,a.index)),this[h]=this[h]||r&&o[3]&&i[h]||"",o[4]&&(this[h]=this[h].toLowerCase())}if(s&&(this.query=s(this.query)),r&&i.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==i.pathname)){if(t=this.pathname,i=i.pathname,""!==t){for(s=(i=(i||"/").split("/").slice(0,-1).concat(t.split("/")))[(t=i.length)-1],e=!1,n=0;t--;)"."===i[t]?i.splice(t,1):".."===i[t]?(i.splice(t,1),n++):n&&(0===t&&(e=!0),i.splice(t,1),n--);e&&i.unshift(""),"."!==s&&".."!==s||i.push(""),i=i.join("/")}this.pathname=i}"/"!==this.pathname.charAt(0)&&this.hostname&&(this.pathname="/"+this.pathname),_(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(o=this.auth.split(":"),this.username=o[0]||"",this.password=o[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}S.prototype={set:function(t,i,s){switch(t){case"query":"string"==typeof i&&i.length&&(i=(s||A.parse)(i)),this[t]=i;break;case"port":this[t]=i,_(i,this.protocol)?i&&(this.host=this.hostname+":"+i):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=i,this.port&&(i+=":"+this.port),this.host=i;break;case"host":this[t]=i,/:\d+$/.test(i)?(i=i.split(":"),this.port=i.pop(),this.hostname=i.join(":")):(this.hostname=i,this.port="");break;case"protocol":this.protocol=i.toLowerCase(),this.slashes=!s;break;case"pathname":case"hash":i?(s="pathname"===t?"/":"#",this[t]=i.charAt(0)!==s?s+i:i):this[t]=i;break;default:this[t]=i}for(t=0;t<M.length;t++)(i=M[t])[4]&&(this[i[1]]=this[i[1]].toLowerCase());return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=A.stringify);var i=this.protocol;return i&&":"!==i.charAt(i.length-1)&&(i+=":"),i+=this.slashes?"//":"",this.username&&(i+=this.username,this.password&&(i+=":"+this.password),i+="@"),i+=this.host+this.pathname,(t="object"==typeof this.query?t(this.query):this.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(i+=this.hash),i}},S.extractProtocol=I,S.location=R,S.trimLeft=E,S.qs=A;var V=S,k=/^xn--/,j=/[^\0-\x7E]/,z=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},F=Math.floor,$=String.fromCharCode;function q(t){throw new RangeError(O[t])}function U(t,i){var s=t.split("@");let e="";1<s.length&&(e=s[0]+"@",t=s[1]);{s=[];let e=(t=(t=t.replace(z,".")).split(".")).length;for(;e--;)s[e]=i(t[e]);i=s}return e+i.join(".")}function C(t,i){return t+22+75*(26>t)-((0!=i)<<5)}function D(t,i,s){let e=0;for(t=s?F(t/700):t>>1,t+=F(t/i);455<t;e+=36)t=F(t/35);return F(e+36*t/(t+38))}var N=function(t){return U(t,(function(t){return k.test(t)?function(t){const i=[],s=t.length;let e=0,r=128,n=72;var o=t.lastIndexOf("-");0>o&&(o=0);for(var a=0;a<o;++a)128<=t.charCodeAt(a)&&q("not-basic"),i.push(t.charCodeAt(a));for(o=0<o?o+1:0;o<s;){a=e;for(let i=1,r=36;;r+=36){o>=s&&q("invalid-input");var h=t.charCodeAt(o++);(36<=(h=10>h-48?h-22:26>h-65?h-65:26>h-97?h-97:36)||h>F((2147483647-e)/i))&&q("overflow"),e+=h*i;const a=r<=n?1:r>=n+26?26:r-n;if(h<a)break;i>F(2147483647/(h=36-a))&&q("overflow"),i*=h}n=D(e-a,h=i.length+1,0==a),F(e/h)>2147483647-r&&q("overflow"),r+=F(e/h),e%=h,i.splice(e++,0,r)}return String.fromCodePoint(...i)}(t.slice(4).toLowerCase()):t}))},L=/[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,Y=/[\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc]/;function H(t){return(t="undefined"!=typeof window?function(t){return t=new TextEncoder("utf-8").encode(t),window.crypto.subtle.digest("SHA-256",t).then((t=>{var i=[];t=new DataView(t);for(let s=0;s<t.byteLength;s+=4){let e=("00000000"+t.getUint32(s).toString(16)).slice(-8);i.push(e)}return i.join("")}))}(t):void 0).then((t=>function(t){let i=[];t.match(/.{1,2}/g).forEach(((t,s)=>{i[s]=parseInt(t,16)}));var s=i.length%5,e=Math.floor(i.length/5);if(t=[],0!=s){for(var r=0;r<5-s;r++)i+="\0";e+=1}for(r=0;r<e;r++)t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(i[5*r]>>3)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((7&i[5*r])<<2|i[5*r+1]>>6)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((63&i[5*r+1])>>1)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((1&i[5*r+1])<<4|i[5*r+2]>>4)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((15&i[5*r+2])<<1|i[5*r+3]>>7)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((127&i[5*r+3])>>2)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((3&i[5*r+3])<<3|i[5*r+4]>>5)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(31&i[5*r+4]));for(e=0,1==s?e=6:2==s?e=4:3==s?e=3:4==s&&(e=1),s=0;s<e;s++)t.pop();for(s=0;s<e;s++)t.push("=");return t.join("")}("ffffffffff"+t+"000000").substr(8,Math.ceil(4*t.length/5))))}function X(t){return"--"==t.slice(2,4)&&"xn"!=t.slice(0,2)}function B(t,i,e=null){let r=new V(i),n=function(t,i=null){return(t=>d.some((i=>!!t.endsWith(`.${i}`))))(t)?"/i":(t=>y.some((i=>!!t.endsWith(`.${i}`))))(t)?"/r":"viewer"===i?"/v":"/c"}(r.pathname,e);return n+="https:"===r.protocol?"/s/":"/",i.endsWith("/")||(r.pathname=r.pathname.replace(/\/$/,"")),function(t){if(X(t=new V(t).hostname))var i=!1;else i=N(t),i=63>=t.length&&!(L.test(i)&&Y.test(i))&&-1!=t.indexOf(".");return i?63<(i=function(t){return U(t,(function(t){return j.test(t)?"xn--"+function(t){const i=[];let e=(t=function(t){let i=[],s=0,e=t.length;for(;s<e;){let r=t.charCodeAt(s++);if(55296<=r&&56319>=r&&s<e){let e=t.charCodeAt(s++);56320==(64512&e)?i.push(((1023&r)<<10)+(1023&e)+65536):(i.push(r),s--)}else i.push(r)}return i}(t)).length,r=128,n=0,o=72;for(var a,h=s(t,!0);!(a=h()).done;){var l=a.value;128>l&&i.push($(l))}let c=l=i.length;for(l&&i.push("-");c<e;){for(var p,u=2147483647,f=s(t,!0);!(p=f()).done;){const t=p.value;t>=r&&t<u&&(u=t)}const e=c+1;u-r>F((2147483647-n)/e)&&q("overflow"),n+=(u-r)*e,r=u;for(var m,d=s(t,!0);!(m=d()).done;){const t=m.value;if(t<r&&2147483647<++n&&q("overflow"),t==r){var y=n;for(u=36;;u+=36){const t=u<=o?1:u>=o+26?26:u-o;if(y<t)break;y-=t;const s=36-t;i.push($(C(t+y%s,0))),y=F(y/s)}i.push($(C(y,0))),o=D(n,e,c==l),n=0,++c}}++n,++r}return i.join("")}(t):t}))}(i=(i=(i=N(t)).split("-").join("--")).split(".").join("-")).toLowerCase()).length?H(t):(X(i)&&(i="0-".concat(i,"-0")),Promise.resolve(i)):H(t)}(r.toString()).then((s=>{let e=new V(i);return e.protocol="https",s=s+"."+t,e.host=s,e.hostname=s,e.pathname=n+r.hostname+r.pathname,e.toString()}))}var Z="amp-viewer-messaging",G="channelOpen",J="__AMPHTML__";function W(t){if("string"!=typeof t)return t;if("{"!=t.charAt(0))return null;try{return JSON.parse(t)}catch(t){return null}}var Q,K=class{static initiateHandshakeWithDocument(t,i){return new Promise((s=>{const e=setInterval((()=>{const r=new MessageChannel,n={app:J,name:"handshake-poll"};t.postMessage(n,"*",[r.port2]);const o=r.port1,a=t=>{const r=W(t.data);if(r&&r.app===J&&r.name===G){clearInterval(e),o.removeEventListener("message",a);const t=new K(null,o,!1,i,!0);t.sendResponse_(r.requestid,G,null),s(t)}};o.addEventListener("message",a),o.start()}),1e3)}))}static waitForHandshakeFromDocument(t,i,s,e,r){return new Promise((n=>{const o=a=>{const h=W(a.data);if(h&&(a.origin==s||r&&r.test(a.origin))&&(!a.source||a.source==i)&&h.app===J&&h.name===G){t.removeEventListener("message",o);const s=new class{constructor(t,i,s){this.win_=t,this.origin_=i,this.target_=s}addEventListener(t,i){this.win_.addEventListener("message",(t=>{t.origin==this.origin_&&t.source==this.target_&&i(t)}))}postMessage(t){const i="null"===this.origin_?"*":this.origin_;this.target_.postMessage(t,i)}start(){}}(t,a.origin,i),r=new K(null,s,!1,e,!0);r.sendResponse_(h.requestid,G,null),n(r)}};t.addEventListener("message",o)}))}constructor(t,i,s,e,r){this.win_=t,this.port_=i,this.isWebview_=!!s,this.token_=e||null,this.verifyToken_=!!r,this.requestIdCounter_=0,this.waitingForResponse_={},this.messageHandlers_={},this.defaultHandler_=null,this.port_.addEventListener("message",this.handleMessage_.bind(this)),this.port_.start()}registerHandler(t,i){this.messageHandlers_[t]=i}unregisterHandler(t){delete this.messageHandlers_[t]}setDefaultHandler(t){this.defaultHandler_=t}handleMessage_(t){const i=W(t.data);i&&i.app===J&&(this.token_&&this.verifyToken_&&i.messagingToken!==this.token_?this.logError_(Z+": handleMessage_ error: ","invalid token"):"q"===i.type?this.handleRequest_(i):"s"===i.type&&this.handleResponse_(i))}sendRequest(t,i,s){const e=++this.requestIdCounter_;let r;return s&&(r=new Promise(((t,i)=>{this.waitingForResponse_[e]={resolve:t,reject:i}}))),this.sendMessage_({app:J,requestid:e,type:"q",name:t,data:i,rsvp:s}),r}sendResponse_(t,i,s){this.sendMessage_({app:J,requestid:t,type:"s",name:i,data:s})}sendResponseError_(t,i,s){const e=this.errorToString_(s);this.logError_(Z+": sendResponseError_, message name: "+i,e),this.sendMessage_({app:J,requestid:t,type:"s",name:i,data:null,error:e})}sendMessage_(t){const i=Object.assign(t,{});this.token_&&!this.verifyToken_&&(i.messagingToken=this.token_),this.port_.postMessage(this.isWebview_?JSON.stringify(i):i)}handleRequest_(t){let i=this.messageHandlers_[t.name];if(i||(i=this.defaultHandler_),!i){const i=new Error("Cannot handle request because no default handler is set!");throw i.args=t.name,i}const s=i(t.name,t.data,!!t.rsvp);if(t.rsvp){const i=t.requestid;if(!s)throw this.sendResponseError_(i,t.name,new Error("no response")),new Error("expected response but none given: "+t.name);s.then((s=>{this.sendResponse_(i,t.name,s)}),(s=>{this.sendResponseError_(i,t.name,s)}))}}handleResponse_(t){const i=t.requestid,s=this.waitingForResponse_[i];s&&(delete this.waitingForResponse_[i],t.error?(this.logError_(Z+": handleResponse_ error: ",t.error),s.reject(new Error(`Request ${t.name} failed: ${t.error}`))):s.resolve(t.data))}logError_(t,i){if(!this.win_)return;let s="amp-messaging-error-logger: "+t;s+=" data: "+this.errorToString_(i),this.win_.viewerState=s}errorToString_(t){return t?t.message?t.message:String(t):"unknown error"}},tt="visible";function it(t){try{t.focus()}catch(t){}}function st(t,i,s){const e=t.hasAttribute(i),r=void 0!==s?s:!e;return r!==e&&(r?t.setAttribute(i,""):t.removeAttribute(i)),r}var et=["Webkit","webkit","Moz","moz","ms","O","o"];function rt(t,i,s,e,r){const n=function(t,i,s){if(i.startsWith("--"))return i;Q||(Q=c());let e=Q[i];if(!e||s){if(e=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),r=function(t,i){for(let s=0;s<et.length;s++){const e=et[s]+i;if(void 0!==t[e])return e}return""}(t,s);void 0!==t[r]&&(e=r)}s||(Q[i]=e)}return e}(t.style,i,r);if(!n)return;const o=e?s+e:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return et.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(n),o)}function nt(t,i){for(const s in i)rt(t,s,i[s])}function ot(t,i){for(let s=0;s<i.length;s++)rt(t,i[s],null)}var at,ht=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function lt(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function ct(t,i,s){let e=0,r=null;function n(n){r=null,e=t.setTimeout(o,s),i.apply(null,n)}function o(){e=0,r&&n(r)}return function(...t){e?r=t:n(t)}}var pt=self.AMP_CONFIG||{},ut=("string"==typeof pt.thirdPartyFrameRegex?new RegExp(pt.thirdPartyFrameRegex):pt.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,ft=("string"==typeof pt.cdnProxyRegex?new RegExp(pt.cdnProxyRegex):pt.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function mt(t){if(!self.document||!self.document.head)return null;if(self.location&&ft.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}var dt,yt={thirdParty:pt.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:pt.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:ut,cdn:pt.cdnUrl||mt("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:ft,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:pt.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:pt.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:pt.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:pt.geoApiUrl||mt("amp-geo-api")};function gt(t,i,s,e){const r={detail:s};return Object.assign(r,e),new t.CustomEvent(i,r)}function _t(t,i){return dt||(dt=self.document.createElement("a")),vt(dt,t)}function vt(t,i,s){return t.href="",new URL(i,t.href)}function bt(t){const i=[];for(const n in t){let a=t[n];if(null!=a){a=o(r=a)?r:[r];for(let t=0;t<a.length;t++)i.push((s=n,e=a[t],`${encodeURIComponent(s)}=${encodeURIComponent(e)}`))}}var s,e,r;return i.join("&")}function At(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}function Pt(t){const i=t.indexOf("#");return-1==i?"":t.substring(i)}function wt(t){return yt.cdnProxyRegex.test((t=>"string"==typeof t?_t(t):t)(t).origin)}function xt(t){const i=t.indexOf("?");if(-1==i)return t;const s=Pt(t);return t.substring(0,i)+s}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null},self.__AMP_LOG,new Set(["c","v","a","ad"]);var Et="i-amphtml-story-player-loading",Mt="i-amphtml-story-player-loaded",Tt="i-amphtml-story-player-error",Rt=["cdn.ampproject.org","www.bing-amp.com"],It=["allow-top-navigation"],St="amp-story-player-hide-button",Vt="PAGE_ATTACHMENT_STATE",kt="UI_STATE",jt="MUTED_STATE",zt="CURRENT_PAGE_ID",Ot="i-amphtml-story-player-no-navigation-transition",Ft="amp-story-player",$t=class extends t.BaseElement{static prerenderAllowed(){return!0}constructor(t){super(t),this.tyt=new class{constructor(t,i){return this.i=t,this.yf=i,this.am=t.document,this.Em=this.am.createElement("a"),this.Mm=[],this.ym=null,this.Tm=0,this.Rm=0,this.xm=null,this.Im=null,this.Vm=null,this.Sm={startX:0,startY:0,lastX:0,isSwipeX:null},this.km=null,this.jm=new n,this.zm(),this.$m=new class{constructor(t){this.i=t,this.Sm={startY:0,lastDelta:0,touchStartTimeMs:null,touchEndTimeMs:null,touchMoveTimeMs:null},this.Om={startY:0,isRunning:!1,acceleration:1,speedLimit:.3,startTimeMs:null,maxTimeBetweenSwipesMs:250,moveTimeThresholdMs:100,durationMs:null,meetsDeltaYThreshold:!1,deltaYThresholdPx:5,deltaY:null,offsetThresholdPx:30,offsetPx:null,multiplier:1}}onTouchStart(t,i){this.Sm.startY=i,this.Sm.touchStartTimeMs=t,this.Om.startY=this.i.scrollY,this.Om.isRunning&&this.Sm.touchEndTimeMs-this.Sm.touchStartTimeMs<this.Om.maxTimeBetweenSwipesMs?this.Om.multiplier+=this.Om.acceleration:this.Om.multiplier=1,this.Om.isRunning=!1}onTouchMove(t,i){this.Om.acceleration=Math.abs(this.Om.deltaY/(t-this.Sm.touchMoveTimeMs)),this.Sm.touchMoveTimeMs=t,ct(this.i,this.Fm.bind(this,i),50)()}Fm(t){this.Om.deltaY=t-this.Sm.startY,this.Om.meetsDeltaYThreshold=Math.abs(this.Om.deltaY)>this.Om.deltaYThresholdPx,this.Om.meetsDeltaYThreshold&&this.i.scrollBy(0,-this.Om.deltaY)}onTouchEnd(t){if(this.Sm.touchEndTimeMs=t,!this.Om.meetsDeltaYThreshold)return;const i=this.Sm.touchEndTimeMs-this.Sm.touchMoveTimeMs;this.Om.offsetPx=this.qm(),i<this.Om.moveTimeThresholdMs&&Math.abs(this.Om.offsetPx)>this.Om.offsetThresholdPx&&(this.Om.durationMs=1.2*this.i.innerHeight,this.Om.isRunning=!0,requestAnimationFrame((t=>{this.Om.startTimeMs=t,this.Om.startY=this.i.scrollY,this.Cm(t)}))),this.Om.multiplier=1,this.Sm.startY=0,this.Om.deltaY=0}qm(){const t=this.i.innerHeight*this.Om.speedLimit;let i=Math.pow(this.Om.acceleration,2)*this.i.innerHeight;return i=Math.min(t,i),i*=this.Om.deltaY>0?-this.Om.multiplier:this.Om.multiplier,i}Cm(t){const i=t-this.Om.startTimeMs;if(i>this.Om.durationMs)return;const s=this.Um(i/this.Om.durationMs)*this.Om.offsetPx,e=this.Om.startY+s;this.Om.isRunning?(this.i.scroll(0,e),requestAnimationFrame(this.Cm.bind(this))):cancelAnimationFrame(requestAnimationFrame(this.Cm.bind(this)))}Um(t){return 1- --t*t*t*t}}(t),this.Dm=!0,this.Nm=null,this.Lm=null,this.Ym=null,this.yf}zm(){this.yf.buildPlayer=this.buildPlayer.bind(this),this.yf.layoutPlayer=this.layoutPlayer.bind(this),this.yf.getElement=this.getElement.bind(this),this.yf.getStories=this.getStories.bind(this),this.yf.load=this.load.bind(this),this.yf.show=this.show.bind(this),this.yf.add=this.add.bind(this),this.yf.play=this.play.bind(this),this.yf.pause=this.pause.bind(this),this.yf.go=this.go.bind(this),this.yf.mute=this.mute.bind(this),this.yf.unmute=this.unmute.bind(this),this.yf.getStoryState=this.getStoryState.bind(this),this.yf.rewind=this.rewind.bind(this)}load(){if(!this.yf.isConnected)throw new Error(`[${Ft}] element must be connected to the DOM before calling load().`);if(this.yf.fm)throw new Error(`[${Ft}] calling load() on an already loaded element.`);this.buildPlayer(),this.layoutPlayer()}Hm(t){t.idx=this.Mm.length,t.distance=t.idx-this.Tm,t.connectedDeferred=new n,this.Mm.push(t)}add(t){if(t.length<=0)return;if(!Array.isArray(t)||!t.every((t=>t&&t.href)))throw new Error('"stories" parameter has the wrong structure');const i=this.Mm.length;for(let i=0;i<t.length;i++){const s=t[i];this.Hm(s),this.Xm(s)}this.Co(i)}play(){this.yf.pm||this.layoutPlayer(),this.Bm(!1)}pause(){this.Bm(!0)}Bm(t){this.Dm=!t;const i=this.Mm[this.Tm];this.ii(i,t?"paused":tt)}getElement(){return this.yf}getStories(){return this.Mm}buildPlayer(){this.yf.fm||(this.Zm(),this._m(),this.Gm(),this.Jm(),this.Wm(),this.Qm(this.Mm.length-this.Tm-1),this.Km(),this.ty(),this.iy(),this.sy(),this.ey(),this.ny(),this.yf.fm=!0)}Zm(){var t;((t=this.yf.querySelectorAll("a"))?Array.prototype.slice.call(t):[]).forEach((t=>{const i=t.querySelector("img[data-amp-story-player-poster-img]"),s=i&&i.getAttribute("src"),e={href:t.href,title:t.textContent&&t.textContent.trim()||null,posterImage:t.getAttribute("data-poster-portrait-src")||s};this.Hm(e)}))}ny(){this.yf.dispatchEvent(gt(this.i,"ready",{})),this.yf.isReady=!0}Gm(){this.Mm.forEach((t=>{this.Xm(t)}))}_m(){this.ym=this.am.createElement("div"),this.ym.classList.add("i-amphtml-story-player-main-container");const t=this.am.createElement("div");t.classList.add("i-amphtml-fill-content","i-amphtml-story-player-shadow-root-intermediary"),this.yf.appendChild(t);const i=this.yf.attachShadow?t.attachShadow({mode:"open"}):t,s=this.am.createElement("style");s.textContent=':host{all:initial;color:initial}.story-player-iframe{height:100%;width:100%;-ms-flex:0 0 100%;flex:0 0 100%;border:0;opacity:0;transition:opacity 500ms ease;position:absolute}.i-amphtml-story-player-main-container{height:100%;position:relative;overflow:hidden;transform-style:preserve-3d}.i-amphtml-story-player-loaded .story-player-iframe{opacity:1;transition:transform 200ms cubic-bezier(0.4,0,0.2,1)}.i-amphtml-story-player-no-navigation-transition .story-player-iframe{transition-duration:0.01s}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="0"],.i-amphtml-story-player-main-container iframe:first-of-type{transform:translateZ(1px)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="1"],.i-amphtml-story-player-main-container iframe:nth-of-type(2),.i-amphtml-story-player-main-container iframe:nth-of-type(3){transform:translate3d(100%,0,0)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="-1"]{transform:translate3d(-100%,0,0)}.amp-story-player-exit-control-button{position:absolute;height:48px;width:48px;background-repeat:no-repeat;background-position:50%;margin-top:7px;background-size:28px;border:0px;background-color:transparent;outline:transparent;cursor:pointer;z-index:1}.amp-story-player-close-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\')}.amp-story-player-back-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>\')}.amp-story-player-hide-button{display:none}.i-amphtml-story-player-panel{--i-amphtml-story-player-panel-ratio:69/116;--i-amphtml-story-player-panel-responsive-margin:max(74px,calc(var(--i-amphtml-story-player-height)*0.0825));--i-amphtml-story-player-panel-height:calc(var(--i-amphtml-story-player-height) - var(--i-amphtml-story-player-panel-responsive-margin)*2);--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-panel-height)*var(--i-amphtml-story-player-panel-ratio));--i-amphtml-story-player-panel-button-margin:max(10px,calc(50vw - 145px - var(--i-amphtml-story-player-panel-width)/2))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-medium{--i-amphtml-story-player-panel-responsive-margin:0px;--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-height)*var(--i-amphtml-story-player-panel-ratio))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-small{--i-amphtml-story-player-panel-ratio:36/53}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{position:absolute;top:50%;transform:translateY(-50%);width:48px;height:48px;z-index:1;background-color:transparent;border:none;background-position:50%;background-repeat:no-repeat;cursor:pointer;transition:opacity 150ms}.i-amphtml-story-player-panel-next[disabled],.i-amphtml-story-player-panel-prev[disabled]{opacity:.1;cursor:initial}.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-next,.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-prev,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-next,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-prev{opacity:0;pointer-events:none}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><path stroke="%23fff" stroke-linecap="round" stroke-width="1.9" d="M17 29.2V18.8c0-1.2 1.4-2 2.5-1.3l7.5 5.2c1 .6 1 2 0 2.6l-7.5 5.2c-1 .7-2.5 0-2.5-1.3z"/><rect width="1.8" height="15.6" x="30.2" y="16.2" fill="%23fff" rx=".9"/></svg>\')!important}.i-amphtml-story-player-panel-prev{margin-inline-start:calc(var(--i-amphtml-story-player-panel-button-margin));transform:translateY(-50%) rotate(180deg)}.i-amphtml-story-player-panel-next{margin-inline-end:var(--i-amphtml-story-player-panel-button-margin);right:0}[dir=rtl].i-amphtml-story-player-panel-prev{right:0}[dir=rtl].i-amphtml-story-player-panel-next{left:0;transform:translateY(-50%) rotate(180deg)}\n/*# sourceURL=/css/amp-story-player-shadow.css*/',i.appendChild(s),i.insertBefore(this.ym,i.firstElementChild)}Jm(){const t=this.yf.getAttribute("exit-control");if("back-button"!==(i=t)&&"close-button"!==i)return;var i;const s=this.am.createElement("button");this.ym.appendChild(s);const e="back-button"===t;s.classList.add(e?"amp-story-player-back-button":"amp-story-player-close-button"),s.classList.add("amp-story-player-exit-control-button"),s.addEventListener("click",(()=>{this.yf.dispatchEvent(gt(this.i,e?"amp-story-player-back":"amp-story-player-close",{}))}))}Wm(){if(this.xm)return this.xm;const t=this.yf.getAttribute("amp-cache");t&&!Rt.includes(t)&&console.error(`[${Ft}]`,`Unsupported cache specified, use one of following: ${Rt}`);const i=this.yf.querySelector("script");if(!i)return null;if("SCRIPT"!=(s=i).tagName||"APPLICATION/JSON"!=(null===(e=s.getAttribute("type"))||void 0===e?void 0:e.toUpperCase()))throw new Error('<script> child must have type="application/json"');var s,e,r;try{this.xm=(r=i.textContent,JSON.parse(r))}catch(t){console.error(`[${Ft}] `,t)}return this.xm}Xm(t){const i=this.am.createElement("iframe");t.posterImage&&rt(i,"backgroundImage",t.posterImage),i.classList.add("story-player-iframe"),i.setAttribute("allow","autoplay"),function(t){if(!t.sandbox||!t.sandbox.supports)return;const i=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let s=0;s<i.length;s++){const e=i[s];if(!t.sandbox.supports(e))return}t.sandbox=i.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(i),this.oy(i),this.hy(i),t.iframe=i}oy(t){if(t.sandbox&&t.sandbox.supports&&!(t.sandbox.length<=0))for(let i=0;i<It.length;i++){const s=It[i];if(!t.sandbox.supports(s))throw new Error(`Iframe doesn't support: ${s}`);t.sandbox.add(s)}}ly(t){const{iframe:i}=t;t.messagingPromise=new Promise((s=>{this.uy(t,i).then((i=>{i.setDefaultHandler((()=>r())),i.registerHandler("touchstart",((t,i)=>{this.py(i)})),i.registerHandler("touchmove",((t,i)=>{this.my(i)})),i.registerHandler("touchend",((t,i)=>{this.yy(i)})),i.registerHandler("selectDocument",((t,i)=>{this._y(i)})),i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0})),i.sendRequest("onDocumentState",{"state":Vt},!1),i.sendRequest("onDocumentState",{"state":zt},!1),i.sendRequest("onDocumentState",{"state":jt}),i.sendRequest("onDocumentState",{"state":kt}),i.registerHandler("documentStateUpdate",((t,s)=>{this.gy(s,i)})),this.xm&&this.xm.controls&&(this.vy(t.idx),i.sendRequest("customDocumentUI",{"controls":this.xm.controls},!1)),s(i)}),(t=>{console.error(`[${Ft}]`,t)}))}))}vy(t){if(t===this.Mm.length-1){const t=a(this.xm.controls,(t=>"skip-next"===t.name||"skip-to-next"===t.name));t>=0&&(this.xm.controls[t].state="disabled")}}uy(t,i){return this.Ay(t.href).then((t=>K.waitForHandshakeFromDocument(this.i,i.contentWindow,this.Py(t).origin,null,yt.cdnProxyRegex)))}hy(t){this.ym.classList.add(Et),t.onload=()=>{this.ym.classList.remove(Et),this.ym.classList.add(Mt),this.yf.classList.add(Mt)},t.onerror=()=>{this.ym.classList.remove(Et),this.ym.classList.add(Tt),this.yf.classList.add(Tt)}}layoutPlayer(){if(!this.yf.pm){if(new class{constructor(t,i,s){this.i=t,this.yf=i,this.gm=s,this.vm=null,this.Am()}Am(){this.i.IntersectionObserver&&this.i===this.i.parent?this.Pm():this.bm()}Pm(){const t=new this.i.IntersectionObserver((i=>{i.forEach((i=>{i.isIntersecting&&(this.gm(),t.unobserve(this.yf))}))}));t.observe(this.yf)}bm(){this.vm=ct(this.i,this.wm.bind(this),500),this.i.addEventListener("scroll",this.vm),this.wm(this.yf)}wm(){const t=this.yf.getBoundingClientRect().top;this.i.innerHeight>t&&(this.gm(),this.i.removeEventListener("scroll",this.vm))}}(this.i,this.yf,(()=>this.jm.resolve())),this.i.ResizeObserver)new this.i.ResizeObserver((t=>{const{height:i,width:s}=t[0].contentRect;this.by(i,s)})).observe(this.yf);else{const{height:t,width:i}=this.yf.getBoundingClientRect();this.by(t,i)}this.Co(),this.yf.pm=!0}}ey(){this.Lm=this.am.createElement("button"),this.Lm.classList.add("i-amphtml-story-player-panel-prev"),this.Lm.addEventListener("click",(()=>this.wy())),this.Lm.setAttribute("aria-label","previous story"),this.ym.appendChild(this.Lm),this.Ym=this.am.createElement("button"),this.Ym.classList.add("i-amphtml-story-player-panel-next"),this.Ym.addEventListener("click",(()=>this.xe())),this.Ym.setAttribute("aria-label","next story"),this.ym.appendChild(this.Ym),this.Ey()}Ey(){st(this.Lm,"disabled",this.My(this.Tm-1)&&!this.Vm),st(this.Ym,"disabled",this.My(this.Tm+1)&&!this.Vm)}by(t,i){const s=i/t>.75;this.ym.classList.toggle("i-amphtml-story-player-panel",s),s&&(nt(this.ym,{"--i-amphtml-story-player-height":`${t}px`}),this.ym.classList.toggle("i-amphtml-story-player-panel-medium",t<756),this.ym.classList.toggle("i-amphtml-story-player-panel-small",t<538))}Ty(){let{endpoint:t}=this.xm.behavior;return t?(t=t.replace(/\${offset}/,this.Mm.length.toString()),fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then((t=>t.json())).catch((t=>{console.error(`[${Ft}]`,t)}))):(this.Im=!1,r())}show(t,i=null,s={}){const e=this.Ry(t);let n=r();return e.idx!==this.Tm&&(this.Tm=e.idx,n=this.Co(),!1===s.animate&&(this.ym.classList.toggle(Ot,!0),function(t,i,s,e){let r=s;const n=function(t,i,s,e){let r=t,n=s,o=t=>{try{return n(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const a=function(){if(void 0!==at)return at;at=!1;try{const t={get capture(){return at=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return at}();return r.addEventListener(i,o,!!a&&e),()=>{null==r||r.removeEventListener(i,o,!!a&&e),n=null,r=null,o=null}}(t,"transitionend",(t=>{try{r(t)}finally{r=null,n()}}),void 0)}(e.iframe,0,(()=>{this.ym.classList.remove(Ot)}))),this.xy()),null!=i?n.then((()=>this.Iy(i))):n}mute(){const t=this.Mm[this.Tm];this.Vy(t,!0)}unmute(){const t=this.Mm[this.Tm];this.Vy(t,!1)}getStoryState(t){"page-attachment"===t&&this.Sy()}ky(t){const i=gt(this.i,"navigation",t);this.yf.dispatchEvent(i)}xy(){const t=this.Tm,i=this.Mm.length-this.Tm-1,s={"index":t,"remaining":i};this.Ey(),this.jy().then((t=>this.zy(t))),this.ky(s),this.Qm(i)}jy(){const t=this.Mm[this.Tm];return new Promise((i=>{t.messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:kt},!0).then((t=>i(t.value)))}))}))}zy(t){const i=2===t||0===t;this.ym.classList.toggle("i-amphtml-story-player-full-bleed-story",i)}Qm(t){this.xm&&this.xm.behavior&&this.$y()&&t<=2&&this.Ty().then((t=>{t&&this.add(t)})).catch((t=>{console.error(`[${Ft}]`,t)}))}Oy(t){return t&&t.on&&t.action}$y(){if(null!==this.Im)return this.Im;const{behavior:t}=this.xm;var i;return this.Im=this.Oy(t)&&"end"===(i=t).on&&"fetch"===i.action&&i.endpoint,this.Im}xe(){!this.Vm&&this.My(this.Tm+1)||(this.Vm&&this.My(this.Tm+1)?this.go(1):(this.Tm++,this.Co(),this.xy()))}wy(){!this.Vm&&this.My(this.Tm-1)||(this.Vm&&this.My(this.Tm-1)?this.go(-1):(this.Tm--,this.Co(),this.xy()))}go(t,i=0,s={}){if(0===t&&0===i)return;if(!this.Vm&&this.My(this.Tm+t))throw new Error("Out of Story range.");const e=this.Tm+t,n=t>0?this.Mm[e%this.Mm.length]:this.Mm[(e%this.Mm.length+this.Mm.length)%this.Mm.length];let o=r();this.Tm!==n.idx&&(o=this.show(n.href,null,s)),o.then((()=>{this.Fy(i)}))}qy(t){const i=0===t.distance?0:t.idx>this.Tm?1:-1;requestAnimationFrame((()=>{const{iframe:s}=t;ot(s,["transform","transition"]),s.setAttribute("i-amphtml-iframe-position",i)}))}Cy(t){var i;return this.Mm[this.Tm].storyContentLoaded?r():0!==t.distance?this.km.promise:(null===(i=this.km)||void 0===i||i.reject("[amp-story-player-dev] Cancelling previous story load promise."),this.km=new n,t.messagingPromise.then((i=>i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0,this.km.resolve()})))),r())}Co(t=this.Tm){const i=[];for(let s=0;s<this.Mm.length;s++){const e=this.Mm[(s+t)%this.Mm.length],r=e.distance;e.distance=Math.abs(this.Tm-e.idx),r<=1&&e.distance>1&&this.Uy(e),e.distance<=1&&!e.iframe.isConnected&&this.Dy(e),e.distance>1||i.push(this.Cy(e).then((()=>this.Ay(e.href))).then((t=>{this.Ny(t,e.iframe.src)||this.Ly(e,t)})).then((()=>this.jm.promise)).then((()=>{0===e.distance&&this.Dm&&this.ii(e,tt),0===r&&1===e.distance&&this.ii(e,"inactive")})).then((()=>{this.qy(e),0===e.distance&&it(e.iframe)})).catch((t=>{t.includes("amp-story-player-dev")||console.error(`[${Ft}]`,t)})))}return Promise.all(i)}Dy(t){this.ym.appendChild(t.iframe),this.ly(t),t.connectedDeferred.resolve()}Uy(t){t.storyContentLoaded=!1,t.connectedDeferred=new n,t.iframe.setAttribute("src",""),t.iframe.remove()}Ly(t,i){const{iframe:s}=t,{href:e}=this.Py(i,"prerender");s.setAttribute("src",e),t.title&&s.setAttribute("title",t.title)}Ny(t,i){return!(i.length<=0)&&At(xt(i))===At(xt(t))}Ay(t){const i=this.yf.getAttribute("amp-cache");if(!i||!Rt.includes(i))return Promise.resolve(t);if(wt(t)){const i=_t(t);return i.pathname.startsWith("/c/")&&(i.pathname="/v/"+i.pathname.substr(3)),Promise.resolve(i.toString())}return B(i,t,"viewer").then((t=>t))}Py(t,i="inactive"){const s={"visibilityState":i,"origin":this.i.origin,"showStoryUrlInfo":"0","storyPlayer":"v0","cap":"swipe"};"auto"===this.Nm&&(s.attribution="auto");const e=m(m({},function(t){const i=c();if(!t)return i;let s;for(;s=ht.exec(t);){const t=lt(s[1],s[1]),e=s[2]?lt(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}(Pt(t))),s);let r=At(t);wt(t)&&(r=function(t,i,s){if(!i)return t;const e=t.split("#",2),r=e[0].split("?",2);let n=r[0]+(r[1]?`?${r[1]}&${i}`:`?${i}`);return n+=e[1]?`#${e[1]}`:"",n}(r,bt({"amp_js_v":"0.1"})));const n=r+"#"+bt(e);return vt(this.Em,n)}ii(t,i){t.messagingPromise.then((t=>t.sendRequest("visibilitychange",{state:i},!0)))}Yy(t,i,s){t.messagingPromise.then((t=>{t.sendRequest("setDocumentState",{state:i,value:s})}))}Vy(t,i){this.Yy(t,jt,i)}Sy(){this.Mm[this.Tm].messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Vt},!0).then((t=>this.Hy(t.value)))}))}Iy(t){this.Mm[this.Tm].messagingPromise.then((i=>i.sendRequest("selectPage",{"id":t})))}Ry(t){const i=t?a(this.Mm,(({href:i})=>i===t)):this.Tm;if(!this.Mm[i])throw new Error(`Story URL not found in the player: ${t}`);return this.Mm[i]}rewind(t){const i=this.Ry(t);this.Xy(i).then((()=>i.messagingPromise)).then((t=>t.sendRequest("rewind",{})))}Xy(t){return t.iframe.isConnected?r():t.connectedDeferred.promise}Fy(t){0!==t&&this.By(t)}By(t){this.Mm[this.Tm].messagingPromise.then((i=>i.sendRequest("selectPage",{delta:t})))}gy(t,i){switch(t.state){case Vt:this.Zy(t.value);break;case zt:this.Gy(t.value,i);break;case jt:this.Jy(t.value);break;case kt:this.zy(t.value);break;case"AMP_STORY_PLAYER_EVENT":this.Wy(t.value)}}Wy(t){switch(t){case"amp-story-player-skip-next":case"amp-story-player-skip-to-next":this.xe();break;default:this.yf.dispatchEvent(gt(this.i,t,{}))}}Jy(t){this.yf.dispatchEvent(gt(this.i,"amp-story-muted-state",{muted:t}))}Gy(t,i){i.sendRequest("getDocumentState",{"state":"STORY_PROGRESS"},!0).then((i=>{this.yf.dispatchEvent(gt(this.i,"storyNavigation",{"pageId":t,"progress":i.value}))}))}Zy(t){this.Qy(!t),this.Hy(t)}Qy(t){const i=this.ym.querySelector("button.amp-story-player-exit-control-button");i&&(t?i.classList.remove(St):i.classList.add(St))}Hy(t){this.yf.dispatchEvent(gt(this.i,t?"page-attachment-open":"page-attachment-close",{}))}_y(t){this.Ky(t),t.next?this.xe():t.previous&&this.wy()}Ky(t){if(this.Vm||!t.next&&!t.previous)return;let i,s;t.next?(i=this.Tm+1===this.Mm.length,s="noNextStory"):(i=0===this.Tm,s="noPreviousStory"),i&&this.yf.dispatchEvent(gt(this.i,s,{}))}py(t){const i=this.t_(t);i&&(this.Sm.startX=i.screenX,this.Sm.startY=i.screenY,this.$m&&this.$m.onTouchStart(t.timeStamp,i.clientY),this.yf.dispatchEvent(gt(this.i,"amp-story-player-touchstart",{"touches":t.touches})))}my(t){const i=this.t_(t);if(!i)return;if(this.yf.dispatchEvent(gt(this.i,"amp-story-player-touchmove",{"touches":t.touches,"isNavigationalSwipe":this.Sm.isSwipeX})),!1===this.Sm.isSwipeX)return void(this.$m&&this.$m.onTouchMove(t.timeStamp,i.clientY));const{screenX:s,screenY:e}=i;this.Sm.lastX=s,(null!==this.Sm.isSwipeX||(this.Sm.isSwipeX=Math.abs(this.Sm.startX-s)>Math.abs(this.Sm.startY-e),this.Sm.isSwipeX))&&this.i_({deltaX:s-this.Sm.startX,last:!1})}yy(t){this.yf.dispatchEvent(gt(this.i,"amp-story-player-touchend",{"touches":t.touches,"isNavigationalSwipe":this.Sm.isSwipeX})),!0===this.Sm.isSwipeX?this.i_({deltaX:this.Sm.lastX-this.Sm.startX,last:!0}):this.$m&&this.$m.onTouchEnd(t.timeStamp),this.Sm.startX=0,this.Sm.startY=0,this.Sm.lastX=0,this.Sm.isSwipeX=null,this.Rm=0}i_(t){if(this.Mm.length<=1)return;const{deltaX:i}=t;if(!0===t.last){const t=Math.abs(i);return 1===this.Rm&&(t>50&&(this.s_()||this.Vm)?this.xe():this.e_()),void(2===this.Rm&&(t>50&&(this.s_()||this.Vm)?this.wy():this.e_()))}this.r_(i)}e_(){const t=this.Mm[this.Tm].iframe;requestAnimationFrame((()=>{ot(p(t),["transform","transition"])}));const i=this.s_();i&&requestAnimationFrame((()=>{ot(p(i.iframe),["transform","transition"])}))}s_(){const t=1===this.Rm?this.Tm+1:this.Tm-1;return this.My(t)?null:this.Mm[t]}My(t){return t>=this.Mm.length||t<0}Km(){if(!this.xm)return;const{behavior:t}=this.xm;t&&"boolean"==typeof t.autoplay&&(this.Dm=t.autoplay)}ty(){if(!this.xm)return;const{display:t}=this.xm;t&&"auto"===t.attribution&&(this.Nm="auto")}iy(){if(!this.xm)return;const{behavior:t}=this.xm;t&&!1===t.pageScroll&&(this.$m=null)}sy(){if(null!==this.Vm)return this.Vm;if(!this.xm)return this.Vm=!1,!1;const{behavior:t}=this.xm;var i;return this.Vm=this.Oy(t)&&"end"===(i=t).on&&"circular-wrapping"===i.action,this.Vm}r_(t){let i;t<0?(this.Rm=1,i=`translate3d(calc(100% + ${t}px), 0, 0)`):(this.Rm=2,i=`translate3d(calc(${t}px - 100%), 0, 0)`);const s=this.Mm[this.Tm],{iframe:e}=s,r=`translate3d(${t}px, 0, 0)`;requestAnimationFrame((()=>{nt(p(e),{transform:r,transition:"none"})}));const n=this.s_();n&&requestAnimationFrame((()=>{nt(p(n.iframe),{transform:i,transition:"none"})}))}t_(t){const{touches:i}=t;if(!i||i.length<1)return null;const{clientX:s,clientY:e,screenX:r,screenY:n}=i[0];return{screenX:r,screenY:n,clientX:s,clientY:e}}}(this.win,t)}buildCallback(){this.tyt.buildPlayer()}layoutCallback(){return this.tyt.layoutPlayer(),r()}isLayoutSupported(t){return function(t){return"fixed"==t||"fixed-height"==t||"responsive"==t||"fill"==t||"flex-item"==t||"fluid"==t||"intrinsic"==t}(t)}};t.registerElement("amp-story-player",$t,'amp-story-player{position:relative;display:block}.i-amphtml-story-player-shadow-root-intermediary{width:100%;height:100%}amp-story-player a:first-of-type{width:100%;height:100%;background:var(--story-player-poster,#d3d3d3);background-size:100% 100%;display:block}amp-story-player.i-amphtml-story-player-loaded a{display:none}amp-story-player:after{content:" ";position:absolute;box-sizing:border-box;top:calc(50% - 32px);left:calc(50% - 32px);width:64px;height:64px;border-radius:50%;border-color:#fff transparent;border-style:solid;border-width:6px;filter:drop-shadow(0px 1px 3px rgba(0,0,0,0.25));animation-name:i-amphtml-story-player-spinner;animation-duration:4400ms;animation-timing-function:cubic-bezier(0.4,0,0.2,1);animation-iteration-count:infinite}@keyframes i-amphtml-story-player-spinner{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}to{transform:rotate(1080deg)}}.i-amphtml-story-player-loaded:after{visibility:hidden}\n/*# sourceURL=/css/amp-story-player.css*/')})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-story-player-0.1.mjs.map
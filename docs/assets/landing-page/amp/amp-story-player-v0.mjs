;
(()=>{var{isArray:t}=Array;function i(t,i){const s=[];let e=0;for(let n=0;n<t.length;n++){const r=t[n];i(r,n,t)?s.push(r):(e<n&&(t[e]=r),e++)}return e<t.length&&(t.length=e),s}function s(t,i){for(let s=0;s<t.length;s++)if(i(t[s],s,t))return s;return-1}function e(t){return"string"==typeof t}function n(t,i){(null==i||i>t.length)&&(i=t.length);for(var s=0,e=new Array(i);s<i;s++)e[s]=t[s];return e}function r(t,i){var s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return(s=s.call(t)).next.bind(s);if(Array.isArray(t)||(s=function(t,i){if(t){if("string"==typeof t)return n(t,i);var s=Object.prototype.toString.call(t).slice(8,-1);return"Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s?Array.from(t):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?n(t,i):void 0}}(t))||i&&t&&"number"==typeof t.length){s&&(t=s);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var{hasOwnProperty:o,toString:a}=Object.prototype;function h(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function l(t){return 1==(null==t?void 0:t.nodeType)}var c="​​​";function u(t){return l(t)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t}function f(t,s,e="Assertion failed",n){var r,o;if(s)return s;t&&-1==e.indexOf(t)&&(e+=t);let a=3;const h=e.split("%s");let l=h.shift();const c=[l];for(;h.length;){const t=arguments[a++],i=h.shift();l+=u(t)+i,c.push(t,i.trim())}const f=new Error(l);throw f.messageArray=i(c,(t=>""!==t)),null===(r=(o=self).__AMP_REPORT_ERROR)||void 0===r||r.call(o,f),f}function p(i,s,e,n,r){return t(r)?i(e,r.concat([s])):i(e,`${r||n}: %s`,s),s}function m(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:e}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=e,n}function d(t){let i=null,s="";for(var e,n=r(arguments,!0);!(e=n()).done;){const t=e.value;t instanceof Error&&!i?i=m(t):(s&&(s+=" "),s+=t)}return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function y(t){const i=d.apply(null,arguments);return i.expected=!0,i}function _(t,i,s){let e=0,n=null;function r(r){n=null,e=t.setTimeout(o,s),i.apply(null,r)}function o(){e=0,n&&r(n)}return function(...t){e?n=t:r(t)}}var g=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function v(t,i=""){try{return decodeURIComponent(t)}catch(t){return i}}function A(t){const i=h();if(!t)return i;let s;for(;s=g.exec(t);){const t=v(s[1],s[1]),e=s[2]?v(s[2].replace(/\+/g," "),s[2]):"";i[t]=e}return i}var P=self.AMP_CONFIG||{},b=("string"==typeof P.thirdPartyFrameRegex?new RegExp(P.thirdPartyFrameRegex):P.thirdPartyFrameRegex)||/^d-\d+\.ampproject\.net$/,w=("string"==typeof P.cdnProxyRegex?new RegExp(P.cdnProxyRegex):P.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function E(t){if(!self.document||!self.document.head)return null;if(self.location&&w.test(self.location.origin))return null;const i=self.document.head.querySelector(`meta[name="${t}"]`);return i&&i.getAttribute("content")||null}var M={thirdParty:P.thirdPartyUrl||"https://3p.ampproject.net",thirdPartyFrameHost:P.thirdPartyFrameHost||"ampproject.net",thirdPartyFrameRegex:b,cdn:P.cdnUrl||E("runtime-host")||"https://cdn.ampproject.org",cdnProxyRegex:w,localhostRegex:/^https?:\/\/localhost(:\d+)?$/,errorReporting:P.errorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r",betaErrorReporting:P.betaErrorReportingUrl||"https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta",localDev:P.localDev||!1,trustedViewerHosts:[/(^|\.)google\.(com?|[a-z]{2}|com?\.[a-z]{2}|cat)$/,/(^|\.)gmail\.(com|dev)$/],geoApi:P.geoApiUrl||E("amp-geo-api")},T=()=>{},R=(t,i)=>i.reduce(((t,i)=>`${t}&s[]=${x(i)}`),`https://log.amp.dev/?v=012203281422000&id=${encodeURIComponent(t)}`),x=t=>encodeURIComponent(String(u(t))),I=t=>parseInt(function(t){const{location:i}=t||self;return A(i.originalHash||i.hash)}(t).log,10);self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var V=self.__AMP_LOG,S=null;function k(){S=class{constructor(t,i,s=""){this.win=t,this.ht=i,this.ft=this.dt(),this.bt=s,this.vt=null,this.gt=function(t){let i=!1,s=null,e=t;return(...t)=>(i||(s=e.apply(self,t),i=!0,e=null),s)}((()=>{t.fetch(`${M.cdn}/rtv/012203281422000/log-messages.simple.json`).then((t=>t.json()),T).then((t=>{t&&(this.vt=t)}))})),this.wt=this.assert.bind(this)}dt(){var t;const{win:i}=this;return null!==(t=i.console)&&void 0!==t&&t.log&&0!=I(i)?this.yt():0}yt(t){return this.ht(I(t),!1)}jt(t,i,s){var n;if(i>this.ft)return!1;const r=this.win.console,o=null!==(n={1:r.error,3:r.info,2:r.warn}[i])&&void 0!==n?n:r.log,a=this.At(s),h=`[${t}]`;return e(a[0])?a[0]=h+" "+a[0]:a.unshift(h),o.apply(r,a),!0}fine(t,...i){this.jt(t,4,i)}info(t,...i){this.jt(t,3,i)}warn(t,...i){this.jt(t,2,i)}error(t,...i){if(!this.jt(t,1,i)){var s,e;const n=this.createError.apply(this,i);n.name=t||n.name,null===(s=(e=self).__AMP_REPORT_ERROR)||void 0===s||s.call(e,n)}}expectedError(t,...i){var s,e;this.jt(t,1,i)||null===(s=(e=self).__AMP_REPORT_ERROR)||void 0===s||s.call(e,this.createExpectedError.apply(this,i))}createError(t){return this.xt(d.apply(null,arguments))}createExpectedError(t){return this.xt(y.apply(null,arguments))}xt(t){return t=m(t),this.bt?t.message?-1==t.message.indexOf(this.bt)&&(t.message+=this.bt):t.message=this.bt:t.message.indexOf(c)>=0&&(t.message=t.message.replace(c,"")),t}At(i){return t(i[0])?this.Pt(i[0]):i}Pt(t){var i;const s=t.shift();return null!==(i=this.vt)&&void 0!==i&&i[s]?[this.vt[s]].concat(t):[`More info at ${R(s,t)}`]}assert(i,s,e){return t(s)?this.assert.apply(this,[i].concat(this.Pt(s))):f.apply(null,[this.bt].concat(Array.prototype.slice.call(arguments)))}assertElement(t,i){return function(t,i,s){return p(t,i,l(i),"Element expected",s)}(this.wt,t,i)}assertString(t,i){return function(t,i,s){return p(t,i,e(i),"String expected",s)}(this.wt,t,i)}assertNumber(t,i){return function(t,i,s){return p(t,i,"number"==typeof i,"Number expected",s)}(this.wt,t,i)}assertArray(i,s){return function(i,s,e){return p(i,s,t(s),"Array expected",e)}(this.wt,i,s)}assertBoolean(t,i){return function(t,i,s){return p(t,i,!!i===i,"Boolean expected",s)}(this.wt,t,i)}},V.dev||(V.dev=j((t=>t>=3?4:t>=2?3:0))),function(t){if(V.user||(V.user=z(c)),void V.user.win)return V.userForEmbed||(V.userForEmbed=z("​​​​"));V.user}()}function j(t,i){if(!S)throw new Error("failed to call initLogConstructor");return new S(self,t,i)}function z(t){return j(((t,i)=>i||t>=1?4:2),t)}var $,O=class{constructor(t,i){this.i=t,this.yf=i,this.am=this.i.document,this.fm=!1,this.pm=!1,this.ym=null}buildCallback(){this.fm||(this._m(),this.fm=!0)}layoutCallback(){this.pm||(this.pm=!0)}_m(){this.ym=this.am.createElement("main");const t=this.yf.attachShadow({mode:"open"}),i=this.am.createElement("style");i.textContent="amp-story-entry-point{position:relative;display:block}\n/*# sourceURL=/css/amp-story-entry-point.css*/",t.appendChild(i),t.appendChild(this.ym)}getElement(){return this.yf}};function F(){return $||($=Promise.resolve(void 0))}var q=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}};function C(t,i,s){return i in t?Object.defineProperty(t,i,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[i]=s,t}function U(t,i){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),s.push.apply(s,e)}return s}function D(t){for(var i=1;i<arguments.length;i++){var s=null!=arguments[i]?arguments[i]:{};i%2?U(Object(s),!0).forEach((function(i){C(t,i,s[i])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):U(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}var N="ase art bmp blp cd5 cit cpt cr2 cut dds dib djvu egt exif gif gpl grf icns ico iff jng jpeg jpg jfif jp2 jps lbm max miff mng msp nitf ota pbm pc1 pc2 pc3 pcf pcx pdn pgm PI1 PI2 PI3 pict pct pnm pns ppm psb psd pdd psp px pxm pxr qfx raw rle sct sgi rgb int bw tga tiff tif vtf xbm xcf xpm 3dv amf ai awg cgm cdr cmx dxf e2d egt eps fs gbr odg svg stl vrml x3d sxd v2d vnd wmf emf art xar png webp jxr hdp wdp cur ecw iff lbm liff nrrd pam pcx pgf sgi rgb rgba bw int inta sid ras sun tga".split(" "),L="### #gf $on $tf 0b 8m 8u 12u 15u 64c 075 75 085 85 91 091 096 96 abf acfm acs afm afn afs all amfm apf asf aspf atm auf b30 bco bdf bepf bez bfn bmap bmf bx bzr cbtf cct cef cff cfn cga ch4 cha chm chr chx claf collection compositefont dfont dus dzk eft eot etx euf f00 f06 f08 f09 f3f f10 f11 f12 f13 f16 fd fdb ff ffil flf fli fn3 fnb fnn fnt fnta fo1 fo2 fog fon font fonts fot frf frs ftm fxr fyi gdr gf gft glf glif glyphs gsf gxf hbf ice intellifont lepf lft lwfn mcf mcf mfd mfm mft mgf mmm mrf mtf mvec nlq ntf odttf ofm okf otf pcf pcf pfa pfb pfm pft phf pk pkt prs pss qbf qfn r8? scr sfd sff sfi sfl sfn sfo sfp sfs sif snf spd spritefont sui suit svg sxs t1c t2 tb1 tb2 tdf tfm tmf tpf ttc tte ttf type ufm ufo usl usp us? vf vf1 vf3 vfb vfm vfont vlw vmf vnf w30 wfn wnf woff woff2 xfc xfn xfr xft zfi zsu _v".split(" "),Y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function H(t,i){if(i=i.split(":")[0],!(t=+t))return!1;switch(i){case"http":case"ws":return 80!==t;case"https":case"wss":return 443!==t;case"ftp":return 21!==t;case"gopher":return 70!==t;case"file":return!1}return 0!==t}var X=Object.prototype.hasOwnProperty;function B(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(t){return null}}var Z={stringify:function(t,i){i=i||"";var s,e=[];for(n in"string"!=typeof i&&(i="?"),t)if(X.call(t,n)){(s=t[n])||null!=s&&!isNaN(s)||(s="");var n=encodeURIComponent(n);s=encodeURIComponent(s),null!==n&&null!==s&&e.push(n+"="+s)}return e.length?i+e.join("&"):""},parse:function(t){for(var i,s=/([^=?&]+)=?([^&]*)/g,e={};i=s.exec(t);){var n=B(i[1]);i=B(i[2]),null===n||null===i||n in e||(e[n]=i)}return e}},G=/^[A-Za-z][A-Za-z0-9+-.]*:[\\/]+/,J=/^([a-z][a-z0-9.+-]*:)?([\\/]{1,})?([\S\s]*)/i,W=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/;function Q(t){return(t||"").toString().replace(W,"")}var K=[["#","hash"],["?","query"],function(t){return t.replace("\\","/")},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],tt={hash:1,query:1};function it(t){var i=("undefined"!=typeof window?window:void 0!==Y?Y:"undefined"!=typeof self?self:{}).location||{};t=t||i,i={};var s,e=typeof t;if("blob:"===t.protocol)i=new et(unescape(t.pathname),{});else if("string"===e)for(s in i=new et(t,{}),tt)delete i[s];else if("object"===e){for(s in t)s in tt||(i[s]=t[s]);void 0===i.slashes&&(i.slashes=G.test(t.href))}return i}function st(t){return t=Q(t),{protocol:(t=J.exec(t))[1]?t[1].toLowerCase():"",slashes:!!(t[2]&&2<=t[2].length),rest:t[2]&&1===t[2].length?"/"+t[3]:t[3]}}function et(t,i,s){if(t=Q(t),!(this instanceof et))return new et(t,i,s);var e=K.slice(),n=typeof i,r=0;"object"!==n&&"string"!==n&&(s=i,i=null),s&&"function"!=typeof s&&(s=Z.parse),i=it(i);var o=st(t||"");for(n=!o.protocol&&!o.slashes,this.slashes=o.slashes||n&&i.slashes,this.protocol=o.protocol||i.protocol||"",t=o.rest,o.slashes||(e[3]=[/(.*)/,"pathname"]);r<e.length;r++)if("function"==typeof(o=e[r]))t=o(t);else{var a=o[0],h=o[1];a!=a?this[h]=t:"string"==typeof a?~(a=t.indexOf(a))&&("number"==typeof o[2]?(this[h]=t.slice(0,a),t=t.slice(a+o[2])):(this[h]=t.slice(a),t=t.slice(0,a))):(a=a.exec(t))&&(this[h]=a[1],t=t.slice(0,a.index)),this[h]=this[h]||n&&o[3]&&i[h]||"",o[4]&&(this[h]=this[h].toLowerCase())}if(s&&(this.query=s(this.query)),n&&i.slashes&&"/"!==this.pathname.charAt(0)&&(""!==this.pathname||""!==i.pathname)){if(t=this.pathname,i=i.pathname,""!==t){for(s=(i=(i||"/").split("/").slice(0,-1).concat(t.split("/")))[(t=i.length)-1],e=!1,r=0;t--;)"."===i[t]?i.splice(t,1):".."===i[t]?(i.splice(t,1),r++):r&&(0===t&&(e=!0),i.splice(t,1),r--);e&&i.unshift(""),"."!==s&&".."!==s||i.push(""),i=i.join("/")}this.pathname=i}"/"!==this.pathname.charAt(0)&&this.hostname&&(this.pathname="/"+this.pathname),H(this.port,this.protocol)||(this.host=this.hostname,this.port=""),this.username=this.password="",this.auth&&(o=this.auth.split(":"),this.username=o[0]||"",this.password=o[1]||""),this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString()}et.prototype={set:function(t,i,s){switch(t){case"query":"string"==typeof i&&i.length&&(i=(s||Z.parse)(i)),this[t]=i;break;case"port":this[t]=i,H(i,this.protocol)?i&&(this.host=this.hostname+":"+i):(this.host=this.hostname,this[t]="");break;case"hostname":this[t]=i,this.port&&(i+=":"+this.port),this.host=i;break;case"host":this[t]=i,/:\d+$/.test(i)?(i=i.split(":"),this.port=i.pop(),this.hostname=i.join(":")):(this.hostname=i,this.port="");break;case"protocol":this.protocol=i.toLowerCase(),this.slashes=!s;break;case"pathname":case"hash":i?(s="pathname"===t?"/":"#",this[t]=i.charAt(0)!==s?s+i:i):this[t]=i;break;default:this[t]=i}for(t=0;t<K.length;t++)(i=K[t])[4]&&(this[i[1]]=this[i[1]].toLowerCase());return this.origin=this.protocol&&this.host&&"file:"!==this.protocol?this.protocol+"//"+this.host:"null",this.href=this.toString(),this},toString:function(t){t&&"function"==typeof t||(t=Z.stringify);var i=this.protocol;return i&&":"!==i.charAt(i.length-1)&&(i+=":"),i+=this.slashes?"//":"",this.username&&(i+=this.username,this.password&&(i+=":"+this.password),i+="@"),i+=this.host+this.pathname,(t="object"==typeof this.query?t(this.query):this.query)&&(i+="?"!==t.charAt(0)?"?"+t:t),this.hash&&(i+=this.hash),i}},et.extractProtocol=st,et.location=it,et.trimLeft=Q,et.qs=Z;var nt=et,rt=/^xn--/,ot=/[^\0-\x7E]/,at=/[\x2E\u3002\uFF0E\uFF61]/g,ht={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},lt=Math.floor,ct=String.fromCharCode;function ut(t){throw new RangeError(ht[t])}function ft(t,i){var s=t.split("@");let e="";1<s.length&&(e=s[0]+"@",t=s[1]);{s=[];let e=(t=(t=t.replace(at,".")).split(".")).length;for(;e--;)s[e]=i(t[e]);i=s}return e+i.join(".")}function pt(t,i){return t+22+75*(26>t)-((0!=i)<<5)}function mt(t,i,s){let e=0;for(t=s?lt(t/700):t>>1,t+=lt(t/i);455<t;e+=36)t=lt(t/35);return lt(e+36*t/(t+38))}var dt=function(t){return ft(t,(function(t){return rt.test(t)?function(t){const i=[],s=t.length;let e=0,n=128,r=72;var o=t.lastIndexOf("-");0>o&&(o=0);for(var a=0;a<o;++a)128<=t.charCodeAt(a)&&ut("not-basic"),i.push(t.charCodeAt(a));for(o=0<o?o+1:0;o<s;){a=e;for(let i=1,n=36;;n+=36){o>=s&&ut("invalid-input");var h=t.charCodeAt(o++);(36<=(h=10>h-48?h-22:26>h-65?h-65:26>h-97?h-97:36)||h>lt((2147483647-e)/i))&&ut("overflow"),e+=h*i;const a=n<=r?1:n>=r+26?26:n-r;if(h<a)break;i>lt(2147483647/(h=36-a))&&ut("overflow"),i*=h}r=mt(e-a,h=i.length+1,0==a),lt(e/h)>2147483647-n&&ut("overflow"),n+=lt(e/h),e%=h,i.splice(e++,0,n)}return String.fromCodePoint(...i)}(t.slice(4).toLowerCase()):t}))},yt=/[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,_t=/[\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc]/;function gt(t){return(t="undefined"!=typeof window?function(t){return t=new TextEncoder("utf-8").encode(t),window.crypto.subtle.digest("SHA-256",t).then((t=>{var i=[];t=new DataView(t);for(let s=0;s<t.byteLength;s+=4){let e=("00000000"+t.getUint32(s).toString(16)).slice(-8);i.push(e)}return i.join("")}))}(t):void 0).then((t=>function(t){let i=[];t.match(/.{1,2}/g).forEach(((t,s)=>{i[s]=parseInt(t,16)}));var s=i.length%5,e=Math.floor(i.length/5);if(t=[],0!=s){for(var n=0;n<5-s;n++)i+="\0";e+=1}for(n=0;n<e;n++)t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(i[5*n]>>3)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((7&i[5*n])<<2|i[5*n+1]>>6)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((63&i[5*n+1])>>1)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((1&i[5*n+1])<<4|i[5*n+2]>>4)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((15&i[5*n+2])<<1|i[5*n+3]>>7)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((127&i[5*n+3])>>2)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt((3&i[5*n+3])<<3|i[5*n+4]>>5)),t.push("abcdefghijklmnopqrstuvwxyz234567".charAt(31&i[5*n+4]));for(e=0,1==s?e=6:2==s?e=4:3==s?e=3:4==s&&(e=1),s=0;s<e;s++)t.pop();for(s=0;s<e;s++)t.push("=");return t.join("")}("ffffffffff"+t+"000000").substr(8,Math.ceil(4*t.length/5))))}function vt(t){return"--"==t.slice(2,4)&&"xn"!=t.slice(0,2)}function At(t,i,s=null){let e=new nt(i),n=function(t,i=null){return(t=>N.some((i=>!!t.endsWith(`.${i}`))))(t)?"/i":(t=>L.some((i=>!!t.endsWith(`.${i}`))))(t)?"/r":"viewer"===i?"/v":"/c"}(e.pathname,s);return n+="https:"===e.protocol?"/s/":"/",i.endsWith("/")||(e.pathname=e.pathname.replace(/\/$/,"")),function(t){if(vt(t=new nt(t).hostname))var i=!1;else i=dt(t),i=63>=t.length&&!(yt.test(i)&&_t.test(i))&&-1!=t.indexOf(".");return i?63<(i=function(t){return ft(t,(function(t){return ot.test(t)?"xn--"+function(t){const i=[];let s=(t=function(t){let i=[],s=0,e=t.length;for(;s<e;){let n=t.charCodeAt(s++);if(55296<=n&&56319>=n&&s<e){let e=t.charCodeAt(s++);56320==(64512&e)?i.push(((1023&n)<<10)+(1023&e)+65536):(i.push(n),s--)}else i.push(n)}return i}(t)).length,e=128,n=0,o=72;for(var a,h=r(t,!0);!(a=h()).done;){var l=a.value;128>l&&i.push(ct(l))}let c=l=i.length;for(l&&i.push("-");c<s;){for(var u,f=2147483647,p=r(t,!0);!(u=p()).done;){const t=u.value;t>=e&&t<f&&(f=t)}const s=c+1;f-e>lt((2147483647-n)/s)&&ut("overflow"),n+=(f-e)*s,e=f;for(var m,d=r(t,!0);!(m=d()).done;){const t=m.value;if(t<e&&2147483647<++n&&ut("overflow"),t==e){var y=n;for(f=36;;f+=36){const t=f<=o?1:f>=o+26?26:f-o;if(y<t)break;y-=t;const s=36-t;i.push(ct(pt(t+y%s,0))),y=lt(y/s)}i.push(ct(pt(y,0))),o=mt(n,s,c==l),n=0,++c}}++n,++e}return i.join("")}(t):t}))}(i=(i=(i=dt(t)).split("-").join("--")).split(".").join("-")).toLowerCase()).length?gt(t):(vt(i)&&(i="0-".concat(i,"-0")),Promise.resolve(i)):gt(t)}(e.toString()).then((s=>{let r=new nt(i);return r.protocol="https",s=s+"."+t,r.host=s,r.hostname=s,r.pathname=n+e.hostname+e.pathname,r.toString()}))}var Pt="amp-viewer-messaging",bt="channelOpen",wt="__AMPHTML__";function Et(t){if("string"!=typeof t)return t;if("{"!=t.charAt(0))return null;try{return JSON.parse(t)}catch(t){return null}}var Mt=class{static initiateHandshakeWithDocument(t,i){return new Promise((s=>{const e=setInterval((()=>{const n=new MessageChannel,r={app:wt,name:"handshake-poll"};t.postMessage(r,"*",[n.port2]);const o=n.port1,a=t=>{const n=Et(t.data);if(n&&n.app===wt&&n.name===bt){clearInterval(e),o.removeEventListener("message",a);const t=new Mt(null,o,!1,i,!0);t.sendResponse_(n.requestid,bt,null),s(t)}};o.addEventListener("message",a),o.start()}),1e3)}))}static waitForHandshakeFromDocument(t,i,s,e,n){return new Promise((r=>{const o=a=>{const h=Et(a.data);if(h&&(a.origin==s||n&&n.test(a.origin))&&(!a.source||a.source==i)&&h.app===wt&&h.name===bt){t.removeEventListener("message",o);const s=new class{constructor(t,i,s){this.win_=t,this.origin_=i,this.target_=s}addEventListener(t,i){this.win_.addEventListener("message",(t=>{t.origin==this.origin_&&t.source==this.target_&&i(t)}))}postMessage(t){const i="null"===this.origin_?"*":this.origin_;this.target_.postMessage(t,i)}start(){}}(t,a.origin,i),n=new Mt(null,s,!1,e,!0);n.sendResponse_(h.requestid,bt,null),r(n)}};t.addEventListener("message",o)}))}constructor(t,i,s,e,n){this.win_=t,this.port_=i,this.isWebview_=!!s,this.token_=e||null,this.verifyToken_=!!n,this.requestIdCounter_=0,this.waitingForResponse_={},this.messageHandlers_={},this.defaultHandler_=null,this.port_.addEventListener("message",this.handleMessage_.bind(this)),this.port_.start()}registerHandler(t,i){this.messageHandlers_[t]=i}unregisterHandler(t){delete this.messageHandlers_[t]}setDefaultHandler(t){this.defaultHandler_=t}handleMessage_(t){const i=Et(t.data);i&&i.app===wt&&(this.token_&&this.verifyToken_&&i.messagingToken!==this.token_?this.logError_(Pt+": handleMessage_ error: ","invalid token"):"q"===i.type?this.handleRequest_(i):"s"===i.type&&this.handleResponse_(i))}sendRequest(t,i,s){const e=++this.requestIdCounter_;let n;return s&&(n=new Promise(((t,i)=>{this.waitingForResponse_[e]={resolve:t,reject:i}}))),this.sendMessage_({app:wt,requestid:e,type:"q",name:t,data:i,rsvp:s}),n}sendResponse_(t,i,s){this.sendMessage_({app:wt,requestid:t,type:"s",name:i,data:s})}sendResponseError_(t,i,s){const e=this.errorToString_(s);this.logError_(Pt+": sendResponseError_, message name: "+i,e),this.sendMessage_({app:wt,requestid:t,type:"s",name:i,data:null,error:e})}sendMessage_(t){const i=Object.assign(t,{});this.token_&&!this.verifyToken_&&(i.messagingToken=this.token_),this.port_.postMessage(this.isWebview_?JSON.stringify(i):i)}handleRequest_(t){let i=this.messageHandlers_[t.name];if(i||(i=this.defaultHandler_),!i){const i=new Error("Cannot handle request because no default handler is set!");throw i.args=t.name,i}const s=i(t.name,t.data,!!t.rsvp);if(t.rsvp){const i=t.requestid;if(!s)throw this.sendResponseError_(i,t.name,new Error("no response")),new Error("expected response but none given: "+t.name);s.then((s=>{this.sendResponse_(i,t.name,s)}),(s=>{this.sendResponseError_(i,t.name,s)}))}}handleResponse_(t){const i=t.requestid,s=this.waitingForResponse_[i];s&&(delete this.waitingForResponse_[i],t.error?(this.logError_(Pt+": handleResponse_ error: ",t.error),s.reject(new Error(`Request ${t.name} failed: ${t.error}`))):s.resolve(t.data))}logError_(t,i){if(!this.win_)return;let s="amp-messaging-error-logger: "+t;s+=" data: "+this.errorToString_(i),this.win_.viewerState=s}errorToString_(t){return t?t.message?t.message:String(t):"unknown error"}};function Tt(t,i){return t}var Rt,xt="visible";function It(t){try{t.focus()}catch(t){}}function Vt(t,i,s){const e=t.hasAttribute(i),n=void 0!==s?s:!e;return n!==e&&(n?t.setAttribute(i,""):t.removeAttribute(i)),n}var St,kt=["Webkit","webkit","Moz","moz","ms","O","o"];function jt(t,i,s,e,n){const r=function(t,i,s){if(i.startsWith("--"))return i;Rt||(Rt=h());let e=Rt[i];if(!e||s){if(e=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<kt.length;s++){const e=kt[s]+i;if(void 0!==t[e])return e}return""}(t,s);void 0!==t[n]&&(e=n)}s||(Rt[i]=e)}return e}(t.style,i,n);if(!r)return;const o=e?s+e:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return kt.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(r),o)}function zt(t,i){for(const s in i)jt(t,s,i[s])}function $t(t,i){for(let s=0;s<i.length;s++)jt(t,i[s],null)}function Ot(t,i,s,e){const n={detail:s};return Object.assign(n,e),new t.CustomEvent(i,n)}var Ft,qt=class{constructor(t,i,s){this.i=t,this.yf=i,this.gm=s,this.vm=null,this.Am()}Am(){this.i.IntersectionObserver&&this.i===this.i.parent?this.Pm():this.bm()}Pm(){const t=new this.i.IntersectionObserver((i=>{i.forEach((i=>{i.isIntersecting&&(this.gm(),t.unobserve(this.yf))}))}));t.observe(this.yf)}bm(){this.vm=_(this.i,this.wm.bind(this),500),this.i.addEventListener("scroll",this.vm),this.wm(this.yf)}wm(){const t=this.yf.getBoundingClientRect().top;this.i.innerHeight>t&&(this.gm(),this.i.removeEventListener("scroll",this.vm))}};function Ct(t,i){return Ft||(Ft=self.document.createElement("a")),Ut(Ft,t)}function Ut(t,i,s){return t.href="",new URL(i,t.href)}function Dt(i){const s=[];for(const o in i){let a=i[o];if(null!=a){a=t(r=a)?r:[r];for(let t=0;t<a.length;t++)s.push((e=o,n=a[t],`${encodeURIComponent(e)}=${encodeURIComponent(n)}`))}}var e,n,r;return s.join("&")}function Nt(t){const i=t.indexOf("#");return-1==i?t:t.substring(0,i)}function Lt(t){const i=t.indexOf("#");return-1==i?"":t.substring(i)}function Yt(t){return M.cdnProxyRegex.test((t=>"string"==typeof t?Ct(t):t)(t).origin)}function Ht(t){const i=t.indexOf("?");if(-1==i)return t;const s=Lt(t);return t.substring(0,i)+s}new Set(["c","v","a","ad"]);var Xt="i-amphtml-story-player-loading",Bt="i-amphtml-story-player-loaded",Zt="i-amphtml-story-player-error",Gt=["cdn.ampproject.org","www.bing-amp.com"],Jt=["allow-top-navigation"],Wt="amp-story-player-hide-button",Qt="PAGE_ATTACHMENT_STATE",Kt="UI_STATE",ti="MUTED_STATE",ii="CURRENT_PAGE_ID",si="i-amphtml-story-player-no-navigation-transition",ei="amp-story-player",ni=class{constructor(t,i){return this.i=t,this.yf=i,this.am=t.document,this.Em=this.am.createElement("a"),this.Mm=[],this.ym=null,this.Tm=0,this.Rm=0,this.xm=null,this.Im=null,this.Vm=null,this.Sm={startX:0,startY:0,lastX:0,isSwipeX:null},this.km=null,this.jm=new q,this.zm(),this.$m=new class{constructor(t){this.i=t,this.Sm={startY:0,lastDelta:0,touchStartTimeMs:null,touchEndTimeMs:null,touchMoveTimeMs:null},this.Om={startY:0,isRunning:!1,acceleration:1,speedLimit:.3,startTimeMs:null,maxTimeBetweenSwipesMs:250,moveTimeThresholdMs:100,durationMs:null,meetsDeltaYThreshold:!1,deltaYThresholdPx:5,deltaY:null,offsetThresholdPx:30,offsetPx:null,multiplier:1}}onTouchStart(t,i){this.Sm.startY=i,this.Sm.touchStartTimeMs=t,this.Om.startY=this.i.scrollY,this.Om.isRunning&&this.Sm.touchEndTimeMs-this.Sm.touchStartTimeMs<this.Om.maxTimeBetweenSwipesMs?this.Om.multiplier+=this.Om.acceleration:this.Om.multiplier=1,this.Om.isRunning=!1}onTouchMove(t,i){this.Om.acceleration=Math.abs(this.Om.deltaY/(t-this.Sm.touchMoveTimeMs)),this.Sm.touchMoveTimeMs=t,_(this.i,this.Fm.bind(this,i),50)()}Fm(t){this.Om.deltaY=t-this.Sm.startY,this.Om.meetsDeltaYThreshold=Math.abs(this.Om.deltaY)>this.Om.deltaYThresholdPx,this.Om.meetsDeltaYThreshold&&this.i.scrollBy(0,-this.Om.deltaY)}onTouchEnd(t){if(this.Sm.touchEndTimeMs=t,!this.Om.meetsDeltaYThreshold)return;const i=this.Sm.touchEndTimeMs-this.Sm.touchMoveTimeMs;this.Om.offsetPx=this.qm(),i<this.Om.moveTimeThresholdMs&&Math.abs(this.Om.offsetPx)>this.Om.offsetThresholdPx&&(this.Om.durationMs=1.2*this.i.innerHeight,this.Om.isRunning=!0,requestAnimationFrame((t=>{this.Om.startTimeMs=t,this.Om.startY=this.i.scrollY,this.Cm(t)}))),this.Om.multiplier=1,this.Sm.startY=0,this.Om.deltaY=0}qm(){const t=this.i.innerHeight*this.Om.speedLimit;let i=Math.pow(this.Om.acceleration,2)*this.i.innerHeight;return i=Math.min(t,i),i*=this.Om.deltaY>0?-this.Om.multiplier:this.Om.multiplier,i}Cm(t){const i=t-this.Om.startTimeMs;if(i>this.Om.durationMs)return;const s=this.Um(i/this.Om.durationMs)*this.Om.offsetPx,e=this.Om.startY+s;this.Om.isRunning?(this.i.scroll(0,e),requestAnimationFrame(this.Cm.bind(this))):cancelAnimationFrame(requestAnimationFrame(this.Cm.bind(this)))}Um(t){return 1- --t*t*t*t}}(t),this.Dm=!0,this.Nm=null,this.Lm=null,this.Ym=null,this.yf}zm(){this.yf.buildPlayer=this.buildPlayer.bind(this),this.yf.layoutPlayer=this.layoutPlayer.bind(this),this.yf.getElement=this.getElement.bind(this),this.yf.getStories=this.getStories.bind(this),this.yf.load=this.load.bind(this),this.yf.show=this.show.bind(this),this.yf.add=this.add.bind(this),this.yf.play=this.play.bind(this),this.yf.pause=this.pause.bind(this),this.yf.go=this.go.bind(this),this.yf.mute=this.mute.bind(this),this.yf.unmute=this.unmute.bind(this),this.yf.getStoryState=this.getStoryState.bind(this),this.yf.rewind=this.rewind.bind(this)}load(){if(!this.yf.isConnected)throw new Error(`[${ei}] element must be connected to the DOM before calling load().`);if(this.yf.fm)throw new Error(`[${ei}] calling load() on an already loaded element.`);this.buildPlayer(),this.layoutPlayer()}Hm(t){t.idx=this.Mm.length,t.distance=t.idx-this.Tm,t.connectedDeferred=new q,this.Mm.push(t)}add(t){if(t.length<=0)return;if(!Array.isArray(t)||!t.every((t=>t&&t.href)))throw new Error('"stories" parameter has the wrong structure');const i=this.Mm.length;for(let i=0;i<t.length;i++){const s=t[i];this.Hm(s),this.Xm(s)}this.Co(i)}play(){this.yf.pm||this.layoutPlayer(),this.Bm(!1)}pause(){this.Bm(!0)}Bm(t){this.Dm=!t;const i=this.Mm[this.Tm];this.ii(i,t?"paused":xt)}getElement(){return this.yf}getStories(){return this.Mm}buildPlayer(){this.yf.fm||(this.Zm(),this._m(),this.Gm(),this.Jm(),this.Wm(),this.Qm(this.Mm.length-this.Tm-1),this.Km(),this.ty(),this.iy(),this.sy(),this.ey(),this.ny(),this.yf.fm=!0)}Zm(){var t;((t=this.yf.querySelectorAll("a"))?Array.prototype.slice.call(t):[]).forEach((t=>{const i=t.querySelector("img[data-amp-story-player-poster-img]"),s=i&&i.getAttribute("src"),e={href:t.href,title:t.textContent&&t.textContent.trim()||null,posterImage:t.getAttribute("data-poster-portrait-src")||s};this.Hm(e)}))}ny(){this.yf.dispatchEvent(Ot(this.i,"ready",{})),this.yf.isReady=!0}Gm(){this.Mm.forEach((t=>{this.Xm(t)}))}_m(){this.ym=this.am.createElement("div"),this.ym.classList.add("i-amphtml-story-player-main-container");const t=this.am.createElement("div");t.classList.add("i-amphtml-fill-content","i-amphtml-story-player-shadow-root-intermediary"),this.yf.appendChild(t);const i=this.yf.attachShadow?t.attachShadow({mode:"open"}):t,s=this.am.createElement("style");s.textContent=':host{all:initial;color:initial}.story-player-iframe{height:100%;width:100%;-ms-flex:0 0 100%;flex:0 0 100%;border:0;opacity:0;transition:opacity 500ms ease;position:absolute}.i-amphtml-story-player-main-container{height:100%;position:relative;overflow:hidden;transform-style:preserve-3d}.i-amphtml-story-player-loaded .story-player-iframe{opacity:1;transition:transform 200ms cubic-bezier(0.4,0,0.2,1)}.i-amphtml-story-player-no-navigation-transition .story-player-iframe{transition-duration:0.01s}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="0"],.i-amphtml-story-player-main-container iframe:first-of-type{transform:translateZ(1px)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="1"],.i-amphtml-story-player-main-container iframe:nth-of-type(2),.i-amphtml-story-player-main-container iframe:nth-of-type(3){transform:translate3d(100%,0,0)}.i-amphtml-story-player-main-container .story-player-iframe[i-amphtml-iframe-position="-1"]{transform:translate3d(-100%,0,0)}.amp-story-player-exit-control-button{position:absolute;height:48px;width:48px;background-repeat:no-repeat;background-position:50%;margin-top:7px;background-size:28px;border:0px;background-color:transparent;outline:transparent;cursor:pointer;z-index:1}.amp-story-player-close-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>\')}.amp-story-player-back-button{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" height="24" width="24" fill="%23FFF"><path d="M0 0h24v24H0z" fill="none"/><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>\')}.amp-story-player-hide-button{display:none}.i-amphtml-story-player-panel{--i-amphtml-story-player-panel-ratio:69/116;--i-amphtml-story-player-panel-responsive-margin:max(74px,calc(var(--i-amphtml-story-player-height)*0.0825));--i-amphtml-story-player-panel-height:calc(var(--i-amphtml-story-player-height) - var(--i-amphtml-story-player-panel-responsive-margin)*2);--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-panel-height)*var(--i-amphtml-story-player-panel-ratio));--i-amphtml-story-player-panel-button-margin:max(10px,calc(50vw - 145px - var(--i-amphtml-story-player-panel-width)/2))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-medium{--i-amphtml-story-player-panel-responsive-margin:0px;--i-amphtml-story-player-panel-width:calc(var(--i-amphtml-story-player-height)*var(--i-amphtml-story-player-panel-ratio))}.i-amphtml-story-player-panel.i-amphtml-story-player-panel-small{--i-amphtml-story-player-panel-ratio:36/53}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{position:absolute;top:50%;transform:translateY(-50%);width:48px;height:48px;z-index:1;background-color:transparent;border:none;background-position:50%;background-repeat:no-repeat;cursor:pointer;transition:opacity 150ms}.i-amphtml-story-player-panel-next[disabled],.i-amphtml-story-player-panel-prev[disabled]{opacity:.1;cursor:initial}.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-next,.i-amphtml-story-player-full-bleed-story .i-amphtml-story-player-panel-prev,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-next,:not(.i-amphtml-story-player-panel) .i-amphtml-story-player-panel-prev{opacity:0;pointer-events:none}.i-amphtml-story-player-panel-next,.i-amphtml-story-player-panel-prev{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="none"><path stroke="%23fff" stroke-linecap="round" stroke-width="1.9" d="M17 29.2V18.8c0-1.2 1.4-2 2.5-1.3l7.5 5.2c1 .6 1 2 0 2.6l-7.5 5.2c-1 .7-2.5 0-2.5-1.3z"/><rect width="1.8" height="15.6" x="30.2" y="16.2" fill="%23fff" rx=".9"/></svg>\')!important}.i-amphtml-story-player-panel-prev{margin-inline-start:calc(var(--i-amphtml-story-player-panel-button-margin));transform:translateY(-50%) rotate(180deg)}.i-amphtml-story-player-panel-next{margin-inline-end:var(--i-amphtml-story-player-panel-button-margin);right:0}[dir=rtl].i-amphtml-story-player-panel-prev{right:0}[dir=rtl].i-amphtml-story-player-panel-next{left:0;transform:translateY(-50%) rotate(180deg)}\n/*# sourceURL=/css/amp-story-player-shadow.css*/',i.appendChild(s),i.insertBefore(this.ym,i.firstElementChild)}Jm(){const t=this.yf.getAttribute("exit-control");if("back-button"!==(i=t)&&"close-button"!==i)return;var i;const s=this.am.createElement("button");this.ym.appendChild(s);const e="back-button"===t;s.classList.add(e?"amp-story-player-back-button":"amp-story-player-close-button"),s.classList.add("amp-story-player-exit-control-button"),s.addEventListener("click",(()=>{this.yf.dispatchEvent(Ot(this.i,e?"amp-story-player-back":"amp-story-player-close",{}))}))}Wm(){if(this.xm)return this.xm;const t=this.yf.getAttribute("amp-cache");t&&!Gt.includes(t)&&console.error(`[${ei}]`,`Unsupported cache specified, use one of following: ${Gt}`);const i=this.yf.querySelector("script");if(!i)return null;if("SCRIPT"!=(s=i).tagName||"APPLICATION/JSON"!=(null===(e=s.getAttribute("type"))||void 0===e?void 0:e.toUpperCase()))throw new Error('<script> child must have type="application/json"');var s,e,n;try{this.xm=(n=i.textContent,JSON.parse(n))}catch(t){console.error(`[${ei}] `,t)}return this.xm}Xm(t){const i=this.am.createElement("iframe");t.posterImage&&jt(i,"backgroundImage",t.posterImage),i.classList.add("story-player-iframe"),i.setAttribute("allow","autoplay"),function(t){if(!t.sandbox||!t.sandbox.supports)return;const i=["allow-top-navigation-by-user-activation","allow-popups-to-escape-sandbox"];for(let s=0;s<i.length;s++){const e=i[s];if(!t.sandbox.supports(e))return}t.sandbox=i.join(" ")+" "+["allow-forms","allow-modals","allow-pointer-lock","allow-popups","allow-same-origin","allow-scripts"].join(" ")}(i),this.oy(i),this.hy(i),t.iframe=i}oy(t){if(t.sandbox&&t.sandbox.supports&&!(t.sandbox.length<=0))for(let i=0;i<Jt.length;i++){const s=Jt[i];if(!t.sandbox.supports(s))throw new Error(`Iframe doesn't support: ${s}`);t.sandbox.add(s)}}ly(t){const{iframe:i}=t;t.messagingPromise=new Promise((s=>{this.uy(t,i).then((i=>{i.setDefaultHandler((()=>F())),i.registerHandler("touchstart",((t,i)=>{this.py(i)})),i.registerHandler("touchmove",((t,i)=>{this.my(i)})),i.registerHandler("touchend",((t,i)=>{this.yy(i)})),i.registerHandler("selectDocument",((t,i)=>{this._y(i)})),i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0})),i.sendRequest("onDocumentState",{"state":Qt},!1),i.sendRequest("onDocumentState",{"state":ii},!1),i.sendRequest("onDocumentState",{"state":ti}),i.sendRequest("onDocumentState",{"state":Kt}),i.registerHandler("documentStateUpdate",((t,s)=>{this.gy(s,i)})),this.xm&&this.xm.controls&&(this.vy(t.idx),i.sendRequest("customDocumentUI",{"controls":this.xm.controls},!1)),s(i)}),(t=>{console.error(`[${ei}]`,t)}))}))}vy(t){if(t===this.Mm.length-1){const t=s(this.xm.controls,(t=>"skip-next"===t.name||"skip-to-next"===t.name));t>=0&&(this.xm.controls[t].state="disabled")}}uy(t,i){return this.Ay(t.href).then((t=>Mt.waitForHandshakeFromDocument(this.i,i.contentWindow,this.Py(t).origin,null,M.cdnProxyRegex)))}hy(t){this.ym.classList.add(Xt),t.onload=()=>{this.ym.classList.remove(Xt),this.ym.classList.add(Bt),this.yf.classList.add(Bt)},t.onerror=()=>{this.ym.classList.remove(Xt),this.ym.classList.add(Zt),this.yf.classList.add(Zt)}}layoutPlayer(){if(!this.yf.pm){if(new qt(this.i,this.yf,(()=>this.jm.resolve())),this.i.ResizeObserver)new this.i.ResizeObserver((t=>{const{height:i,width:s}=t[0].contentRect;this.by(i,s)})).observe(this.yf);else{const{height:t,width:i}=this.yf.getBoundingClientRect();this.by(t,i)}this.Co(),this.yf.pm=!0}}ey(){this.Lm=this.am.createElement("button"),this.Lm.classList.add("i-amphtml-story-player-panel-prev"),this.Lm.addEventListener("click",(()=>this.wy())),this.Lm.setAttribute("aria-label","previous story"),this.ym.appendChild(this.Lm),this.Ym=this.am.createElement("button"),this.Ym.classList.add("i-amphtml-story-player-panel-next"),this.Ym.addEventListener("click",(()=>this.xe())),this.Ym.setAttribute("aria-label","next story"),this.ym.appendChild(this.Ym),this.Ey()}Ey(){Vt(this.Lm,"disabled",this.My(this.Tm-1)&&!this.Vm),Vt(this.Ym,"disabled",this.My(this.Tm+1)&&!this.Vm)}by(t,i){const s=i/t>.75;this.ym.classList.toggle("i-amphtml-story-player-panel",s),s&&(zt(this.ym,{"--i-amphtml-story-player-height":`${t}px`}),this.ym.classList.toggle("i-amphtml-story-player-panel-medium",t<756),this.ym.classList.toggle("i-amphtml-story-player-panel-small",t<538))}Ty(){let{endpoint:t}=this.xm.behavior;return t?(t=t.replace(/\${offset}/,this.Mm.length.toString()),fetch(t,{method:"GET",headers:{Accept:"application/json"}}).then((t=>t.json())).catch((t=>{console.error(`[${ei}]`,t)}))):(this.Im=!1,F())}show(t,i=null,s={}){const e=this.Ry(t);let n=F();return e.idx!==this.Tm&&(this.Tm=e.idx,n=this.Co(),!1===s.animate&&(this.ym.classList.toggle(si,!0),function(t,i,s,e){let n=s;const r=function(t,i,s,e){let n=t,r=s,o=t=>{try{return r(t)}catch(t){var i,s;throw null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t),t}};const a=function(){if(void 0!==St)return St;St=!1;try{const t={get capture(){return St=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return St}();return n.addEventListener(i,o,!!a&&e),()=>{null==n||n.removeEventListener(i,o,!!a&&e),r=null,n=null,o=null}}(t,"transitionend",(t=>{try{n(t)}finally{n=null,r()}}),void 0)}(e.iframe,0,(()=>{this.ym.classList.remove(si)}))),this.xy()),null!=i?n.then((()=>this.Iy(i))):n}mute(){const t=this.Mm[this.Tm];this.Vy(t,!0)}unmute(){const t=this.Mm[this.Tm];this.Vy(t,!1)}getStoryState(t){"page-attachment"===t&&this.Sy()}ky(t){const i=Ot(this.i,"navigation",t);this.yf.dispatchEvent(i)}xy(){const t=this.Tm,i=this.Mm.length-this.Tm-1,s={"index":t,"remaining":i};this.Ey(),this.jy().then((t=>this.zy(t))),this.ky(s),this.Qm(i)}jy(){const t=this.Mm[this.Tm];return new Promise((i=>{t.messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Kt},!0).then((t=>i(t.value)))}))}))}zy(t){const i=2===t||0===t;this.ym.classList.toggle("i-amphtml-story-player-full-bleed-story",i)}Qm(t){this.xm&&this.xm.behavior&&this.$y()&&t<=2&&this.Ty().then((t=>{t&&this.add(t)})).catch((t=>{console.error(`[${ei}]`,t)}))}Oy(t){return t&&t.on&&t.action}$y(){if(null!==this.Im)return this.Im;const{behavior:t}=this.xm;var i;return this.Im=this.Oy(t)&&"end"===(i=t).on&&"fetch"===i.action&&i.endpoint,this.Im}xe(){!this.Vm&&this.My(this.Tm+1)||(this.Vm&&this.My(this.Tm+1)?this.go(1):(this.Tm++,this.Co(),this.xy()))}wy(){!this.Vm&&this.My(this.Tm-1)||(this.Vm&&this.My(this.Tm-1)?this.go(-1):(this.Tm--,this.Co(),this.xy()))}go(t,i=0,s={}){if(0===t&&0===i)return;if(!this.Vm&&this.My(this.Tm+t))throw new Error("Out of Story range.");const e=this.Tm+t,n=t>0?this.Mm[e%this.Mm.length]:this.Mm[(e%this.Mm.length+this.Mm.length)%this.Mm.length];let r=F();this.Tm!==n.idx&&(r=this.show(n.href,null,s)),r.then((()=>{this.Fy(i)}))}qy(t){const i=0===t.distance?0:t.idx>this.Tm?1:-1;requestAnimationFrame((()=>{const{iframe:s}=t;$t(s,["transform","transition"]),s.setAttribute("i-amphtml-iframe-position",i)}))}Cy(t){var i;return this.Mm[this.Tm].storyContentLoaded?F():0!==t.distance?this.km.promise:(null===(i=this.km)||void 0===i||i.reject("[amp-story-player-dev] Cancelling previous story load promise."),this.km=new q,t.messagingPromise.then((i=>i.registerHandler("storyContentLoaded",(()=>{t.storyContentLoaded=!0,this.km.resolve()})))),F())}Co(t=this.Tm){const i=[];for(let s=0;s<this.Mm.length;s++){const e=this.Mm[(s+t)%this.Mm.length],n=e.distance;e.distance=Math.abs(this.Tm-e.idx),n<=1&&e.distance>1&&this.Uy(e),e.distance<=1&&!e.iframe.isConnected&&this.Dy(e),e.distance>1||i.push(this.Cy(e).then((()=>this.Ay(e.href))).then((t=>{this.Ny(t,e.iframe.src)||this.Ly(e,t)})).then((()=>this.jm.promise)).then((()=>{0===e.distance&&this.Dm&&this.ii(e,xt),0===n&&1===e.distance&&this.ii(e,"inactive")})).then((()=>{this.qy(e),0===e.distance&&It(e.iframe)})).catch((t=>{t.includes("amp-story-player-dev")||console.error(`[${ei}]`,t)})))}return Promise.all(i)}Dy(t){this.ym.appendChild(t.iframe),this.ly(t),t.connectedDeferred.resolve()}Uy(t){t.storyContentLoaded=!1,t.connectedDeferred=new q,t.iframe.setAttribute("src",""),t.iframe.remove()}Ly(t,i){const{iframe:s}=t,{href:e}=this.Py(i,"prerender");s.setAttribute("src",e),t.title&&s.setAttribute("title",t.title)}Ny(t,i){return!(i.length<=0)&&Nt(Ht(i))===Nt(Ht(t))}Ay(t){const i=this.yf.getAttribute("amp-cache");if(!i||!Gt.includes(i))return Promise.resolve(t);if(Yt(t)){const i=Ct(t);return i.pathname.startsWith("/c/")&&(i.pathname="/v/"+i.pathname.substr(3)),Promise.resolve(i.toString())}return At(i,t,"viewer").then((t=>t))}Py(t,i="inactive"){const s={"visibilityState":i,"origin":this.i.origin,"showStoryUrlInfo":"0","storyPlayer":"v0","cap":"swipe"};"auto"===this.Nm&&(s.attribution="auto");const e=D(D({},A(Lt(t))),s);let n=Nt(t);Yt(t)&&(n=function(t,i,s){if(!i)return t;const e=t.split("#",2),n=e[0].split("?",2);let r=n[0]+(n[1]?`?${n[1]}&${i}`:`?${i}`);return r+=e[1]?`#${e[1]}`:"",r}(n,Dt({"amp_js_v":"0.1"})));const r=n+"#"+Dt(e);return Ut(this.Em,r)}ii(t,i){t.messagingPromise.then((t=>t.sendRequest("visibilitychange",{state:i},!0)))}Yy(t,i,s){t.messagingPromise.then((t=>{t.sendRequest("setDocumentState",{state:i,value:s})}))}Vy(t,i){this.Yy(t,ti,i)}Sy(){this.Mm[this.Tm].messagingPromise.then((t=>{t.sendRequest("getDocumentState",{state:Qt},!0).then((t=>this.Hy(t.value)))}))}Iy(t){this.Mm[this.Tm].messagingPromise.then((i=>i.sendRequest("selectPage",{"id":t})))}Ry(t){const i=t?s(this.Mm,(({href:i})=>i===t)):this.Tm;if(!this.Mm[i])throw new Error(`Story URL not found in the player: ${t}`);return this.Mm[i]}rewind(t){const i=this.Ry(t);this.Xy(i).then((()=>i.messagingPromise)).then((t=>t.sendRequest("rewind",{})))}Xy(t){return t.iframe.isConnected?F():t.connectedDeferred.promise}Fy(t){0!==t&&this.By(t)}By(t){this.Mm[this.Tm].messagingPromise.then((i=>i.sendRequest("selectPage",{delta:t})))}gy(t,i){switch(t.state){case Qt:this.Zy(t.value);break;case ii:this.Gy(t.value,i);break;case ti:this.Jy(t.value);break;case Kt:this.zy(t.value);break;case"AMP_STORY_PLAYER_EVENT":this.Wy(t.value)}}Wy(t){switch(t){case"amp-story-player-skip-next":case"amp-story-player-skip-to-next":this.xe();break;default:this.yf.dispatchEvent(Ot(this.i,t,{}))}}Jy(t){this.yf.dispatchEvent(Ot(this.i,"amp-story-muted-state",{muted:t}))}Gy(t,i){i.sendRequest("getDocumentState",{"state":"STORY_PROGRESS"},!0).then((i=>{this.yf.dispatchEvent(Ot(this.i,"storyNavigation",{"pageId":t,"progress":i.value}))}))}Zy(t){this.Qy(!t),this.Hy(t)}Qy(t){const i=this.ym.querySelector("button.amp-story-player-exit-control-button");i&&(t?i.classList.remove(Wt):i.classList.add(Wt))}Hy(t){this.yf.dispatchEvent(Ot(this.i,t?"page-attachment-open":"page-attachment-close",{}))}_y(t){this.Ky(t),t.next?this.xe():t.previous&&this.wy()}Ky(t){if(this.Vm||!t.next&&!t.previous)return;let i,s;t.next?(i=this.Tm+1===this.Mm.length,s="noNextStory"):(i=0===this.Tm,s="noPreviousStory"),i&&this.yf.dispatchEvent(Ot(this.i,s,{}))}py(t){const i=this.t_(t);i&&(this.Sm.startX=i.screenX,this.Sm.startY=i.screenY,this.$m&&this.$m.onTouchStart(t.timeStamp,i.clientY),this.yf.dispatchEvent(Ot(this.i,"amp-story-player-touchstart",{"touches":t.touches})))}my(t){const i=this.t_(t);if(!i)return;if(this.yf.dispatchEvent(Ot(this.i,"amp-story-player-touchmove",{"touches":t.touches,"isNavigationalSwipe":this.Sm.isSwipeX})),!1===this.Sm.isSwipeX)return void(this.$m&&this.$m.onTouchMove(t.timeStamp,i.clientY));const{screenX:s,screenY:e}=i;this.Sm.lastX=s,(null!==this.Sm.isSwipeX||(this.Sm.isSwipeX=Math.abs(this.Sm.startX-s)>Math.abs(this.Sm.startY-e),this.Sm.isSwipeX))&&this.i_({deltaX:s-this.Sm.startX,last:!1})}yy(t){this.yf.dispatchEvent(Ot(this.i,"amp-story-player-touchend",{"touches":t.touches,"isNavigationalSwipe":this.Sm.isSwipeX})),!0===this.Sm.isSwipeX?this.i_({deltaX:this.Sm.lastX-this.Sm.startX,last:!0}):this.$m&&this.$m.onTouchEnd(t.timeStamp),this.Sm.startX=0,this.Sm.startY=0,this.Sm.lastX=0,this.Sm.isSwipeX=null,this.Rm=0}i_(t){if(this.Mm.length<=1)return;const{deltaX:i}=t;if(!0===t.last){const t=Math.abs(i);return 1===this.Rm&&(t>50&&(this.s_()||this.Vm)?this.xe():this.e_()),void(2===this.Rm&&(t>50&&(this.s_()||this.Vm)?this.wy():this.e_()))}this.r_(i)}e_(){const t=this.Mm[this.Tm].iframe;requestAnimationFrame((()=>{$t(Tt(t),["transform","transition"])}));const i=this.s_();i&&requestAnimationFrame((()=>{$t(Tt(i.iframe),["transform","transition"])}))}s_(){const t=1===this.Rm?this.Tm+1:this.Tm-1;return this.My(t)?null:this.Mm[t]}My(t){return t>=this.Mm.length||t<0}Km(){if(!this.xm)return;const{behavior:t}=this.xm;t&&"boolean"==typeof t.autoplay&&(this.Dm=t.autoplay)}ty(){if(!this.xm)return;const{display:t}=this.xm;t&&"auto"===t.attribution&&(this.Nm="auto")}iy(){if(!this.xm)return;const{behavior:t}=this.xm;t&&!1===t.pageScroll&&(this.$m=null)}sy(){if(null!==this.Vm)return this.Vm;if(!this.xm)return this.Vm=!1,!1;const{behavior:t}=this.xm;var i;return this.Vm=this.Oy(t)&&"end"===(i=t).on&&"circular-wrapping"===i.action,this.Vm}r_(t){let i;t<0?(this.Rm=1,i=`translate3d(calc(100% + ${t}px), 0, 0)`):(this.Rm=2,i=`translate3d(calc(${t}px - 100%), 0, 0)`);const s=this.Mm[this.Tm],{iframe:e}=s,n=`translate3d(${t}px, 0, 0)`;requestAnimationFrame((()=>{zt(Tt(e),{transform:n,transition:"none"})}));const r=this.s_();r&&requestAnimationFrame((()=>{zt(Tt(r.iframe),{transform:i,transition:"none"})}))}t_(t){const{touches:i}=t;if(!i||i.length<1)return null;const{clientX:s,clientY:e,screenX:n,screenY:r}=i[0];return{screenX:n,screenY:r,clientX:s,clientY:e}}};(function(t,i,s){let e=i(t);if(e)s();else{const n=()=>{i(t)&&(e||(e=!0,s()),t.removeEventListener("readystatechange",n))};t.addEventListener("readystatechange",n)}})(self.document,(function(t){return"loading"!=t.readyState&&"uninitialized"!=t.readyState}),(()=>{new class{constructor(t){this.i=t}n_(t){new qt(this.i,t,(()=>t.layoutPlayer()));const i=()=>{t.layoutPlayer(),this.i.removeEventListener("scroll",i)};this.i.addEventListener("scroll",i)}loadPlayers(){const t=this.i.document.getElementsByTagName("amp-story-player");k();for(let i=0;i<t.length;i++){const s=t[i],e=new ni(this.i,s);e.buildPlayer(),this.n_(e)}}loadEntryPoints(){const t=this.i.document.getElementsByTagName("amp-story-entry-point");k();for(let i=0;i<t.length;i++){const s=t[i],e=new O(this.i,s);e.buildCallback(),this.n_(e)}}}(self).loadPlayers()})),globalThis.AmpStoryPlayer=ni})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
//# sourceMappingURL=amp-story-player-v0.mjs.map
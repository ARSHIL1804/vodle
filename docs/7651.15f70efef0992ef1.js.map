{"version":3,"mappings":"6NAwBA,MAAMA,EAAiB,CACrB,CACEC,KAAM,GACNC,UCQJ,MAAM,QAIJC,YACYC,EACDC,EACAC,EACAC,GAHCC,gBACDA,iBACAA,iBACAA,SACTA,KAAKD,EAAEE,EAAEC,MAAM,0BAGjBC,WACEH,KAAKD,EAAEE,EAAEC,MAAM,uBAGjBE,mBACEJ,KAAKD,EAAEE,EAAEC,MAAM,+BACfF,KAAKD,EAAEM,EAAEC,aAGXC,kBACEP,KAAKD,EAAEE,EAAEC,MAAM,8BAEXF,KAAKD,EAAEM,EAAEG,OACXR,KAAKS,iBAITC,cAEEV,KAAKD,EAAEE,EAAEC,MAAM,0BAGjBS,kBACEX,KAAKD,EAAEE,EAAEC,MAAM,8BAGXO,2EACiBT,KAAKH,UAAUe,OAAO,CACzCC,OAAQb,KAAKF,UAAUgB,QAAQ,yBAC/BC,QAASf,KAAKF,UAAUgB,QAAQ,wBAChCE,QAAS,CACP,CACEC,KAAMjB,KAAKF,UAAUgB,QAAQ,UAC7BI,KAAM,SACNC,QAAS,KACPnB,KAAKD,EAAEE,EAAEmB,MAAM,oCAEfpB,KAAKJ,SAASyB,SAGlB,CACEJ,KAAMjB,KAAKF,UAAUgB,QAAQ,yBAC7BI,KAAM,KACNC,QAAS,KACPnB,KAAKD,EAAEE,EAAEmB,MAAM,oCAEfpB,KAAKD,EAAEM,EAAEiB,kBAAkBC,KAAK,KAQ9BC,OAAO5B,SAAS6B,WACfC,MAAMC,IACPC,aAA4B,CAAEC,cAAe,CAAC,CAAEC,GAAI,KAChDC,MAAO/B,KAAKF,UAAUgB,QAAQ,iBAC9BkB,KAAM,SAGVhC,KAAKJ,SAASyB,eAMXY,0DA/EJC,GAAUC,yEAAVD,EAAUE,gMCXvBD,sBAAY,kBAAZA,CAAY,mBAGNA,2BACFA,QACAA,4CACAA,2BACEA,qBACFA,YAIJA,8BAPeA,oJDMFD,GAAb,KDAO,IAAMG,EAAb,MAAM,sDAAOA,4DAHF,CAACC,cAAsB9C,IACtB8C,QAECD,GAAb,GGKaE,EAAb,MAAM,sDAAOA,4DATF,CACPC,KACAC,KACAC,KACAL,EACAM,oBAISJ,GAAb","names":["routes","path","component","constructor","location","alertCtrl","translate","G","this","L","entry","ngOnInit","ionViewWillEnter","D","save_state","ionViewDidEnter","ready","confirm_dialog","onDataReady","ionViewDidLeave","create","header","instant","message","buttons","text","role","handler","trace","back","clear_all_local","then","window","reload","catch","error","LocalNotifications","notifications","id","title","body","present","LogoutPage","i0","selectors","LogoutPageRoutingModule","RouterModule","LogoutPageModule","CommonModule","FormsModule","IonicModule","TranslateModule"],"sources":["./src/app/logout/logout-routing.module.ts","./src/app/logout/logout.page.ts","./src/app/logout/logout.page.html","./src/app/logout/logout.module.ts"],"sourcesContent":["/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK) authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { LogoutPage } from './logout.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: LogoutPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class LogoutPageRoutingModule {}\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK) authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { Component, OnInit, ViewChild } from '@angular/core';\nimport { Location } from '@angular/common'\nimport { TranslateService } from '@ngx-translate/core';\nimport { AlertController } from '@ionic/angular';\n\nimport { LocalNotifications } from '@capacitor/local-notifications';\n\nimport { GlobalService } from \"../global.service\";\n\n// PAGE:\n\n@Component({\n  selector: 'app-logout',\n  templateUrl: './logout.page.html',\n  styleUrls: ['./logout.page.scss'],\n})\nexport class LogoutPage implements OnInit {\n\n  // LIFECYCLE:\n\n  constructor(      \n      private location: Location,\n      public alertCtrl: AlertController,\n      public translate: TranslateService,\n      public G: GlobalService) { \n    this.G.L.entry(\"LogoutPage.constructor\");\n  }\n\n  ngOnInit() {\n    this.G.L.entry(\"LogoutPage.ngOnInit\");\n  }\n  \n  ionViewWillEnter() {\n    this.G.L.entry(\"LogoutPage.ionViewWillEnter\");\n    this.G.D.save_state();\n  }\n\n  ionViewDidEnter() {\n    this.G.L.entry(\"LogoutPage.ionViewDidEnter\");\n    // TODO: query whether really logout:\n    if (this.G.D.ready) {\n      this.confirm_dialog();\n    }\n  }\n\n  onDataReady() {\n    // called when DataService initialization was slower than view initialization\n    this.G.L.entry(\"LogoutPage.onDataReady\");\n  }\n\n  ionViewDidLeave() {\n    this.G.L.entry(\"LogoutPage.ionViewDidLeave\");\n  }\n\n  async confirm_dialog() {\n    const dialog = await this.alertCtrl.create({ \n      header: this.translate.instant('logout.confirm-header'), \n      message: this.translate.instant('logout.confirm-intro'), \n      buttons: [\n        { \n          text: this.translate.instant('cancel'), \n          role: 'cancel',\n          handler: () => { \n            this.G.L.trace('LogoutPage.confirm_dialog cancel');\n            // TODO: navigate back\n            this.location.back();\n          } \n        },\n        { \n          text: this.translate.instant('logout.confirm-button'),\n          role: 'ok', \n          handler: () => {\n            this.G.L.trace('LogoutPage.confirm_dialog logout');\n            // clear all local storage:\n            this.G.D.clear_all_local().then(() => {\n              // now reload page, which will reinit the app and redirect us to the login page\n              // (at least in browsers – what about native apps?):\n/*              LocalNotifications.schedule({ notifications: [{ id: null,\n                title: \"Reloading...\",\n                body: null\n              }]});\n*/\n              window.location.reload();\n            }).catch(error => {\n              LocalNotifications.schedule({ notifications: [{ id: null,\n                  title: this.translate.instant(\"logout.failed\"),\n                  body: null\n              }]});\n              // go back to previous page:\n              this.location.back();\n            })\n          } \n        } \n      ] \n    }); \n    await dialog.present(); \n  }\n\n}\n","<!--\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK) authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n-->\n\n<!--\nTODO:\n- offer to show email and password\n-->\n\n<ion-header>\n  <ion-toolbar style=\"padding-right:11px;\">\n    <ion-buttons slot=\"start\">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title [innerHtml]=\"'logout.-page-title'|translate\"></ion-title>\n    <ion-thumbnail slot=\"end\">\n      <ion-img src=\"./assets/topright_icon.png\"></ion-img>\n    </ion-thumbnail>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n<!--  <ion-grid class=\"center-grid\">\n    <ion-item lines=\"none\">\n      <ion-label class=\"ion-text-center\"><h1 style=\"width:100%;\" [innerHtml]=\"'logout.bye'|translate\"></h1></ion-label>\n    </ion-item>\n  </ion-grid>\n-->\n</ion-content>\n","/*\n(C) Copyright 2015–2022 Potsdam Institute for Climate Impact Research (PIK) authors, and contributors, see AUTHORS file.\n\nThis file is part of vodle.\n\nvodle is free software: you can redistribute it and/or modify it under the \nterms of the GNU Affero General Public License as published by the Free \nSoftware Foundation, either version 3 of the License, or (at your option) \nany later version.\n\nvodle is distributed in the hope that it will be useful, but WITHOUT ANY \nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR \nA PARTICULAR PURPOSE. See the GNU Affero General Public License for more \ndetails.\n\nYou should have received a copy of the GNU Affero General Public License \nalong with vodle. If not, see <https://www.gnu.org/licenses/>. \n*/\n\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { TranslateModule } from '@ngx-translate/core';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { LogoutPageRoutingModule } from './logout-routing.module';\n\nimport { LogoutPage } from './logout.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    LogoutPageRoutingModule,\n    TranslateModule.forChild()\n  ],\n  declarations: [LogoutPage]\n})\nexport class LogoutPageModule {}\n"],"sourceRoot":"webpack:///","file":"7651.15f70efef0992ef1.js"}
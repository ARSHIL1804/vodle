"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[186],{186:(In,T,d)=>{d.r(T),d.d(T,{PollPage:()=>v,PollPageModule:()=>qn});var Z=d(6362),w=d(587),P=d(8139),s=d(3926),m=d(1951),x=d(4929),k=d(2340),C=d(2459),Q=d(8581),H=d(2122),L=d(1353),n=d(260),D=d(6301);const q=["expandWrapper"],M=["*"];let N=(()=>{class o{constructor(t){this.renderer=t}ngAfterViewInit(){this.renderer.setStyle(this.expandWrapper.nativeElement,"height",this.expandHeight+"px")}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(n.Qsj))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-expandable"]],viewQuery:function(t,e){if(1&t&&n.Gf(q,5,n.SBq),2&t){let i;n.iGM(i=n.CRH())&&(e.expandWrapper=i.first)}},inputs:{expanded:"expanded",expandHeight:"expandHeight"},ngContentSelectors:M,decls:3,vars:2,consts:[[1,"expand-wrapper"],["expandWrapper",""]],template:function(t,e){1&t&&(n.F$t(),n.TgZ(0,"div",0,1),n.Hsn(2),n.qZA()),2&t&&n.ekj("collapsed",!e.expanded)},styles:["app-expandable[_ngcontent-%COMP%]   .expand-wrapper[_ngcontent-%COMP%]{transition:height 1s ease}app-expandable[_ngcontent-%COMP%]   .collapsed[_ngcontent-%COMP%]{display:none;height:0!important}"]}),o})();function G(o,r){1&o&&(n._UZ(0,"ion-text",12),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"poll.-page-title"),n.oJD)}function I(o,r){if(1&o&&(n.TgZ(0,"ion-text")(1,"b"),n._UZ(2,"i",13),n.qZA()()),2&o){const t=n.oxw();n.xp6(2),n.Q6J("innerHtml",t.p.title,n.oJD)}}function Y(o,r){1&o&&(n.ynx(0),n._UZ(1,"ion-icon",14)(2,"ion-icon",15),n.BQk())}function E(o,r){1&o&&n._UZ(0,"ion-spinner",16)}function z(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-button",17),n.NdJ("click",function(){return n.CHM(t),n.oxw().checkmark_clicked()}),n._UZ(1,"ion-icon",18),n.qZA()}}function F(o,r){1&o&&(n._UZ(0,"span",13),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"poll.delegate-button"),n.oJD)}function R(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-button",19),n.NdJ("click",function(i){return n.CHM(t),n.oxw().delegate_dialog(i)}),n.YNc(1,F,2,3,"span",20),n.TgZ(2,"ion-button",21),n._UZ(3,"ion-icon",22),n.qZA()()}if(2&o){const t=n.oxw();n.xp6(1),n.Q6J("ngIf",t.scroll_position<70)}}function O(o,r){if(1&o&&(n.TgZ(0,"small"),n._UZ(1,"br"),n._uU(2),n.qZA()),2&o){const t=n.oxw().$implicit;n.xp6(2),n.hij(" ",t.body," ")}}function B(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-card")(1,"ion-card-content",49)(2,"ion-item",50),n._uU(3," \xa0\xa0 "),n.TgZ(4,"ion-label",49),n._uU(5),n.YNc(6,O,3,1,"small",5),n.qZA(),n.TgZ(7,"ion-button",51),n.NdJ("click",function(){const l=n.CHM(t).$implicit,a=n.oxw(2);return a.news.delete(l),a.G.N.dismiss(l.key)}),n._UZ(8,"ion-icon",52),n.qZA()()()()}if(2&o){const t=r.$implicit;n.xp6(5),n.hij(" ",t.title," "),n.xp6(1),n.Q6J("ngIf",t.body)}}const S=function(o){return{language:o}};function V(o,r){if(1&o&&(n.TgZ(0,"small"),n._UZ(1,"p",13),n.ALo(2,"translate"),n.qZA()),2&o){const t=n.oxw(2);n.xp6(1),n.Q6J("innerHtml",n.xi3(2,1,"poll.different-language",n.VKq(4,S,t.G.S.language_names[t.p.language])),n.oJD)}}function W(o,r){if(1&o&&n._UZ(0,"i",13),2&o){const t=n.oxw(3);n.Q6J("innerHtml",t.p.desc,n.oJD)}}function $(o,r){1&o&&(n.TgZ(0,"span"),n._uU(1,"\xa0"),n.qZA())}function j(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"small"),n._uU(1," ("),n.TgZ(2,"span",46),n.NdJ("click",function(){n.CHM(t);const i=n.oxw(3);return i.G.open_url_in_new_tab(i.G.D.fix_url(i.p.url)),i.details_expanded=!i.details_expanded}),n._UZ(3,"ion-text",45),n.ALo(4,"translate"),n._uU(5,"\xa0"),n._UZ(6,"ion-icon",55),n.qZA(),n._uU(7,") "),n.qZA()}2&o&&(n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,1,"read-more"),n.oJD))}function K(o,r){1&o&&(n.TgZ(0,"small"),n._uU(1," \xa0 ("),n._UZ(2,"ion-text",45),n.ALo(3,"translate"),n._uU(4,") "),n.qZA()),2&o&&(n.xp6(2),n.Q6J("innerHtml",n.lcZ(3,1,"hide"),n.oJD))}function X(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",53),n.NdJ("click",function(){n.CHM(t);const i=n.oxw(2);return i.details_expanded=!i.details_expanded}),n.TgZ(1,"ion-grid",54)(2,"ion-row",27)(3,"ion-col",27)(4,"div"),n.YNc(5,W,1,1,"i",20),n.YNc(6,$,2,0,"span",5),n.YNc(7,j,8,3,"small",5),n.YNc(8,K,5,3,"small",5),n.qZA()()()()()}if(2&o){const t=n.oxw(2);n.xp6(4),n.Akn(t.details_expanded?"white-space: normal; overflow: hidden; text-overflow: ellipsis; width: 100%!important;":"white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: 100%!important;"),n.xp6(1),n.Q6J("ngIf",""!=(t.p.desc||"")),n.xp6(1),n.Q6J("ngIf",""!=(t.p.desc||"")&&""!=(t.p.url||"")),n.xp6(1),n.Q6J("ngIf",""!=(t.p.url||"")),n.xp6(1),n.Q6J("ngIf",t.details_expanded)}}function nn(o,r){1&o&&(n._UZ(0,"ion-label",60),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"poll.assist-me-button"),n.oJD)}function tn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-button",56),n.NdJ("click",function(){return n.CHM(t),n.oxw(2).assist_dialog()}),n.YNc(1,nn,2,3,"ion-label",57),n._uU(2,"\xa0"),n.TgZ(3,"ion-button",58),n._UZ(4,"ion-icon",59),n.qZA()()}if(2&o){const t=n.oxw(2);n.xp6(1),n.Q6J("ngIf",t.details_expanded)}}function en(o,r){1&o&&(n._UZ(0,"ion-badge",61),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"badges.closing-soon"),n.oJD)}function on(o,r){1&o&&(n._UZ(0,"span",13),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"poll.closes"),n.oJD)}function ln(o,r){1&o&&(n._UZ(0,"span",13),n.ALo(1,"translate")),2&o&&n.Q6J("innerHtml",n.lcZ(1,1,"poll.closed"),n.oJD)}function an(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",64)(1,"small")(2,"p"),n._UZ(3,"span",65),n.ALo(4,"translate"),n._uU(5,"\xa0"),n._UZ(6,"wbr")(7,"span",13),n.ALo(8,"translate"),n._UZ(9,"wbr"),n.TgZ(10,"span",66),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).glossary("wap")}),n._UZ(11,"span",45),n.ALo(12,"translate"),n._UZ(13,"ion-icon",67),n.qZA(),n._UZ(14,"span",13),n.ALo(15,"translate"),n._uU(16," \xa0"),n._UZ(17,"wbr"),n.TgZ(18,"span",32),n._uU(19," ("),n.TgZ(20,"a",68),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).assist_dialog()}),n.ALo(21,"translate"),n.qZA(),n._uU(22,") "),n.qZA()()()()}2&o&&(n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,5,"poll.hint-abstaining-1"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(8,7,"poll.hint-abstaining-2-before-wap"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(12,9,"poll.hint-abstaining-2-wap"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(15,11,"poll.hint-abstaining-2-after-wap"),n.oJD),n.xp6(6),n.Q6J("innerHtml",n.lcZ(21,13,"poll.assist-me-inline"),n.oJD))}function rn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",69)(1,"small")(2,"p"),n._UZ(3,"span",65),n.ALo(4,"translate"),n._UZ(5,"wbr"),n.TgZ(6,"span",66),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).glossary("wap")}),n._UZ(7,"span",70),n.ALo(8,"translate"),n._UZ(9,"ion-icon",71),n.qZA(),n._UZ(10,"span",65),n.ALo(11,"translate"),n._uU(12,"\xa0"),n._UZ(13,"wbr")(14,"span",13),n.ALo(15,"translate"),n._uU(16," \xa0"),n._UZ(17,"wbr"),n.TgZ(18,"span",32),n._uU(19," ("),n.TgZ(20,"a",68),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).assist_dialog()}),n.ALo(21,"translate"),n.qZA(),n._uU(22,") "),n.qZA()()()()}2&o&&(n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,5,"poll.hint-only1positive-1-before-wap"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(8,7,"poll.hint-only1positive-1-wap"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(11,9,"poll.hint-only1positive-1-after-wap"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(15,11,"poll.hint-only1positive-2"),n.oJD),n.xp6(6),n.Q6J("innerHtml",n.lcZ(21,13,"poll.assist-me-inline"),n.oJD))}function sn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",72)(1,"small")(2,"p"),n._UZ(3,"span",65),n.ALo(4,"translate"),n._UZ(5,"wbr"),n.TgZ(6,"span",66),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).glossary("approve")}),n._UZ(7,"span",70),n.ALo(8,"translate"),n._UZ(9,"ion-icon",71),n.qZA(),n._UZ(10,"span",65),n.ALo(11,"translate"),n._uU(12,"\xa0"),n._UZ(13,"wbr")(14,"span",13),n.ALo(15,"translate"),n._UZ(16,"wbr"),n.TgZ(17,"span",66),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).glossary("wap")}),n._UZ(18,"span",45),n.ALo(19,"translate"),n._UZ(20,"ion-icon",67),n.qZA(),n._UZ(21,"span",13),n.ALo(22,"translate"),n._uU(23," \xa0"),n._UZ(24,"wbr"),n.TgZ(25,"span",32),n._uU(26," ("),n.TgZ(27,"a",68),n.NdJ("click",function(){return n.CHM(t),n.oxw(3).assist_dialog()}),n.ALo(28,"translate"),n.qZA(),n._uU(29,") "),n.qZA()()()()}2&o&&(n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,7,"poll.hint-only1approved-1-before-approving"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(8,9,"poll.hint-only1approved-1-approving"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(11,11,"poll.hint-only1approved-1-after-approving"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(15,13,"poll.hint-only1approved-2-before-wap"),n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(19,15,"poll.hint-only1approved-2-wap"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(22,17,"poll.hint-only1approved-2-after-wap"),n.oJD),n.xp6(6),n.Q6J("innerHtml",n.lcZ(28,19,"poll.assist-me-inline"),n.oJD))}function _n(o,r){1&o&&(n.TgZ(0,"ion-item",73)(1,"small")(2,"p"),n._UZ(3,"span",13),n.ALo(4,"translate"),n.qZA()()()),2&o&&(n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,1,"poll.hint-mostapproved-1"),n.oJD))}function cn(o,r){if(1&o&&(n.ynx(0),n.YNc(1,an,23,15,"ion-item",62),n.YNc(2,rn,23,15,"ion-item",40),n.YNc(3,sn,30,21,"ion-item",63),n.YNc(4,_n,5,3,"ion-item",39),n.BQk()),2&o){const t=n.oxw(2);n.xp6(1),n.Q6J("ngIf",t.p.am_abstaining),n.xp6(1),n.Q6J("ngIf",1==t.p.my_n_rated_positive),n.xp6(1),n.Q6J("ngIf",1!=t.p.my_n_rated_positive&&1==t.p.my_n_approved),n.xp6(1),n.Q6J("ngIf",t.p.my_n_approved>1&&!t.p.T.approvals_map.get(t.oidsorted[0]).get(t.p.myvid))}}function pn(o,r){if(1&o&&(n.ynx(0),n.TgZ(1,"ion-item",73)(2,"p"),n._uU(3," Results: "),n.qZA()(),n.TgZ(4,"ion-item",64)(5,"p")(6,"b"),n._uU(7,"The winner is "),n._UZ(8,"i",13),n.qZA()()(),n.TgZ(9,"ion-item",73)(10,"p")(11,"small"),n._UZ(12,"span",13),n.ALo(13,"translate"),n.qZA()()(),n.BQk()),2&o){const t=n.oxw(2);n.xp6(8),n.Q6J("innerHtml",t.p.options[t.oidsorted[0]].name,n.oJD),n.xp6(4),n.Q6J("innerHtml",n.lcZ(13,2,"poll.final-ratings"),n.oJD)}}const dn=function(o){return{n_others:o}};function gn(o,r){if(1&o&&(n._UZ(0,"span",13),n.ALo(1,"translate")),2&o){const t=n.oxw(3);n.Q6J("innerHtml",n.xi3(1,1,1==t.n_indirect_clients?"poll.also-for-other":"poll.also-for-others",n.VKq(4,dn,t.n_indirect_clients))+" ",n.oJD)}}function un(o,r){if(1&o&&(n._UZ(0,"span",13),n.ALo(1,"translate")),2&o){const t=n.oxw(3);n.Q6J("innerHtml",n.lcZ(1,1,0==t.n_indirect_clients?"poll.declined-all":"poll.declined-some"),n.oJD)}}function hn(o,r){if(1&o&&(n.TgZ(0,"ion-chip",79),n._UZ(1,"ion-icon",80),n.TgZ(2,"small"),n._uU(3),n.qZA()()),2&o){const t=r.$implicit;n.Q6J("routerLink",t.url),n.xp6(3),n.Oqu(t.from)}}function mn(o,r){if(1&o&&(n.TgZ(0,"ion-row")(1,"ion-col",77)(2,"small"),n._UZ(3,"span",13),n.ALo(4,"translate"),n.YNc(5,hn,4,2,"ion-chip",78),n.qZA()()()),2&o){const t=n.oxw(3);n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,2,"poll.have-accepted"),n.oJD),n.xp6(2),n.Q6J("ngForOf",t.accepted_requests)}}function xn(o,r){if(1&o&&(n.TgZ(0,"ion-chip",79),n._UZ(1,"ion-icon",80),n.TgZ(2,"small"),n._uU(3),n.qZA()()),2&o){const t=r.$implicit;n.Q6J("routerLink",t.url),n.xp6(3),n.Oqu(t.from)}}function fn(o,r){if(1&o&&(n.TgZ(0,"ion-row")(1,"ion-col",77)(2,"small"),n._UZ(3,"span",13),n.ALo(4,"translate"),n.YNc(5,xn,4,2,"ion-chip",78),n.qZA()()()),2&o){const t=n.oxw(3);n.xp6(3),n.Q6J("innerHtml",n.lcZ(4,2,"poll.have-declined"),n.oJD),n.xp6(2),n.Q6J("ngForOf",t.declined_requests)}}function Zn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",73)(1,"ion-grid",27)(2,"ion-row",74),n.NdJ("click",function(){n.CHM(t);const i=n.oxw(2);return i.incoming_delegation_expanded=!i.incoming_delegation_expanded}),n.TgZ(3,"ion-col",75)(4,"small"),n._UZ(5,"ion-icon",76),n.YNc(6,gn,2,6,"span",20),n.YNc(7,un,2,3,"span",20),n._uU(8," \xa0 "),n.qZA()()(),n.YNc(9,mn,6,4,"ion-row",5),n.YNc(10,fn,6,4,"ion-row",5),n.qZA()()}if(2&o){const t=n.oxw(2);n.xp6(5),n.Q6J("name",t.incoming_delegation_expanded?"chevron-down-outline":"chevron-forward-outline"),n.xp6(1),n.Q6J("ngIf",t.accepted_requests.length>0),n.xp6(1),n.Q6J("ngIf",t.declined_requests.length>0),n.xp6(2),n.Q6J("ngIf",t.incoming_delegation_expanded&&t.accepted_requests.length>0),n.xp6(1),n.Q6J("ngIf",t.incoming_delegation_expanded&&t.declined_requests.length>0)}}function wn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",69)(1,"ion-grid",27)(2,"ion-row",81)(3,"ion-col",75)(4,"small")(5,"p")(6,"span",82),n._uU(7),n.qZA(),n._uU(8,"\xa0 "),n._UZ(9,"span",13),n.ALo(10,"translate"),n.qZA()()(),n.TgZ(11,"ion-col",83)(12,"ion-button",84),n.NdJ("click",function(){return n.CHM(t),n.oxw(2).revoke_delegation_dialog()}),n._UZ(13,"ion-icon",85),n.qZA()()()()()}if(2&o){const t=n.oxw(2);n.xp6(7),n.Oqu(t.delegate),n.xp6(2),n.Q6J("innerHtml",n.lcZ(10,3,"poll.delegate-not-responded"),n.oJD),n.xp6(3),n.Q6J("disabled",!t.running)}}function Pn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",69)(1,"ion-grid",27)(2,"ion-row",81)(3,"ion-col",75)(4,"small")(5,"p")(6,"span",82),n._uU(7),n.qZA(),n._uU(8,"\xa0 "),n._UZ(9,"span",13),n.ALo(10,"translate"),n.qZA()()(),n.TgZ(11,"ion-col",83)(12,"ion-button",86),n.NdJ("click",function(){return n.CHM(t),n.oxw(2).revoke_delegation_dialog()}),n._UZ(13,"ion-icon",85),n.qZA(),n._uU(14,"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 "),n.qZA(),n.TgZ(15,"ion-col",87)(16,"small")(17,"p"),n._UZ(18,"span",13),n.ALo(19,"translate"),n._uU(20,"\xa0 "),n._UZ(21,"ion-icon",88),n.qZA()()()()()()}if(2&o){const t=n.oxw(2);n.xp6(7),n.Oqu(t.delegate),n.xp6(2),n.Q6J("innerHtml",n.lcZ(10,3,"poll.delegate-controls-"+(t.n_delegated==t.oidsorted.length?"all":2*t.n_delegated>t.oidsorted.length?"most":t.n_delegated>0?"some":"none")),n.oJD),n.xp6(9),n.Q6J("innerHtml",n.lcZ(19,5,"poll.choose-whose-ratings"),n.oJD)}}const yn=function(o){return{delegate:o}};function Tn(o,r){if(1&o){const t=n.EpF();n.O4$(),n.kcU(),n.TgZ(0,"ion-col",122),n._uU(1,"\xa0\xa0\xa0 "),n.TgZ(2,"ion-toggle",123),n.NdJ("ionChange",function(){n.CHM(t);const i=n.oxw().index,l=n.oxw(2);return l.on_rate_yourself_toggle_change(l.oidsorted[i])})("ngModelChange",function(i){n.CHM(t);const l=n.oxw().index,a=n.oxw(2);return a.rate_yourself_toggle[a.oidsorted[l]]=i}),n.qZA(),n.TgZ(3,"div",124),n._UZ(4,"small",13),n.ALo(5,"translate"),n.ALo(6,"translate"),n.qZA()()}if(2&o){const t=n.oxw().index,e=n.oxw(2);n.xp6(2),n.Q6J("id","rate_yourself_toggle_"+e.oidsorted[t])("disabled",!e.running)("ngModel",e.rate_yourself_toggle[e.oidsorted[t]]),n.xp6(2),n.Q6J("innerHtml",e.rate_yourself_toggle[e.oidsorted[t]]?n.lcZ(5,4,"poll.my-own"):n.xi3(6,6,"poll.delegate-s",n.VKq(9,yn,e.delegate)),n.oJD)}}const Jn=function(o){return{average:o}};function vn(o,r){if(1&o&&(n.TgZ(0,"span",125),n._uU(1,", "),n._UZ(2,"span",117),n.ALo(3,"translate"),n.qZA()),2&o){const t=n.oxw().index,e=n.oxw(2);n.xp6(2),n.Q6J("innerHtml",n.xi3(3,1,"poll.average-rating",n.VKq(4,Jn,e.Math.round(e.p.T.total_effective_ratings_map.get(e.oidsorted[t])/e.Math.max(1,e.p.T.n_not_abstaining)*10)/10)),n.oJD)}}const J=function(o){return{percentage:o}};function An(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-item",89)(1,"ion-grid",27)(2,"ion-row",27)(3,"ion-col",90),n._UZ(4,"div",91),n.O4$(),n.TgZ(5,"svg",92),n._UZ(6,"circle",93)(7,"path",94)(8,"line",95),n.qZA()(),n.kcU(),n.TgZ(9,"ion-col")(10,"ion-grid",27)(11,"ion-row",96),n.NdJ("click",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.expand(a.oidsorted[l])}),n.TgZ(12,"ion-col",27)(13,"ion-label",27),n._UZ(14,"ion-icon",97),n.TgZ(15,"b")(16,"i"),n._uU(17,"\xa0"),n._UZ(18,"span",13),n._uU(19,"\xa0"),n.qZA()()()()(),n.TgZ(20,"ion-row",27)(21,"ion-col",98),n.NdJ("click",function(i){const a=n.CHM(t).index,_=n.oxw(2);return _.onRatingColClick(_.oidsorted[a],i)})("pointerdown",function(i){const a=n.CHM(t).index,_=n.oxw(2);return _.onRatingColPointerdown(_.oidsorted[a],i)})("touchstart",function(i){const a=n.CHM(t).index,_=n.oxw(2);return _.onRatingColTouchstart(_.oidsorted[a],i)})("touchup",function(i){const a=n.CHM(t).index,_=n.oxw(2);return _.onRatingColTouchup(_.oidsorted[a],i)})("pointerup",function(i){const a=n.CHM(t).index,_=n.oxw(2);return _.onRatingColPointerup(_.oidsorted[a],i)}),n.TgZ(22,"ion-range",99),n.NdJ("ionFocus",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.onRatingSliderFocus(a.oidsorted[l])})("ionChange",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.onRatingSliderChange(a.oidsorted[l])})("ionBlur",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.onRatingSliderBlur(a.oidsorted[l])}),n.TgZ(23,"ion-label",100)(24,"div",101),n.O4$(),n.TgZ(25,"svg",102),n._UZ(26,"rect",103)(27,"line",104)(28,"line",105),n.qZA()(),n.kcU(),n.TgZ(29,"div",106),n.O4$(),n.TgZ(30,"svg",107),n._UZ(31,"text",108),n.qZA()(),n.kcU(),n.TgZ(32,"div",109),n.O4$(),n.TgZ(33,"svg",110),n._UZ(34,"line",111)(35,"circle",112),n.qZA()()()()(),n.YNc(36,Tn,7,11,"ion-col",113),n.qZA()()()(),n.kcU(),n.TgZ(37,"ion-row",27)(38,"ion-col",27)(39,"ion-grid",27)(40,"app-expandable",114)(41,"ion-row",115)(42,"ion-col",27)(43,"b")(44,"span",116),n._UZ(45,"span",117),n.ALo(46,"translate"),n.TgZ(47,"small"),n._UZ(48,"wbr")(49,"span",118),n.ALo(50,"translate"),n._uU(51,", "),n.qZA()(),n.TgZ(52,"small"),n._UZ(53,"wbr"),n.qZA(),n.TgZ(54,"span",119),n._UZ(55,"span",13),n.ALo(56,"translate"),n.qZA(),n.TgZ(57,"small"),n._UZ(58,"span",120),n.ALo(59,"translate"),n.qZA(),n.TgZ(60,"small"),n.YNc(61,vn,4,6,"span",121),n._uU(62,"\xa0 "),n.TgZ(63,"span",119),n._uU(64," ("),n.TgZ(65,"a",68),n.NdJ("click",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.explain_approval_dialog(a.oidsorted[l])}),n.ALo(66,"translate"),n.qZA(),n._uU(67,") "),n.qZA()()(),n.TgZ(68,"span"),n._UZ(69,"br"),n.qZA(),n.TgZ(70,"span")(71,"i"),n._UZ(72,"span",13),n._uU(73,"\xa0\xa0"),n.qZA()(),n.TgZ(74,"span")(75,"small"),n._uU(76," ("),n.TgZ(77,"span",46),n.NdJ("click",function(){const l=n.CHM(t).index,a=n.oxw(2);return a.G.open_url_in_new_tab(a.G.D.fix_url(a.p.options[a.oidsorted[l]].url))}),n._UZ(78,"ion-text",45),n.ALo(79,"translate"),n._uU(80,"\xa0"),n._UZ(81,"ion-icon",55),n.qZA(),n._uU(82,") "),n.qZA()()()()()()()()()()}if(2&o){const t=r.index,e=n.oxw(2);n.xp6(7),n.Q6J("id","pie_"+e.oidsorted[t]),n.xp6(1),n.uIk("display",e.option_expanded[e.oidsorted[t]]?"inline":"none"),n.xp6(6),n.Q6J("name",e.option_expanded[e.oidsorted[t]]?"chevron-down-outline":"chevron-forward-outline"),n.xp6(4),n.Q6J("innerHtml",e.p.options[e.oidsorted[t]].name,n.oJD),n.xp6(3),n.Q6J("id","_slider_"+e.oidsorted[t]+"_"+e.sortingcounter),n.xp6(1),n.Akn(e.rate_yourself_toggle[e.oidsorted[t]]||"agreed"!=e.delegation_status?"pointer-events:; --bar-height: 7px; --knob-size: 35px":"pointer-events: none; --bar-height: 5px; --knob-size: 17px"),n.Q6J("disabled",!e.running)("id","slider_"+e.oidsorted[t]+"_"+e.sortingcounter)("color",e.slidercolor[e.oidsorted[t]])("value",e.p.get_my_proxy_rating(e.oidsorted[t])),n.xp6(4),n.Q6J("id","bar_"+e.oidsorted[t]),n.xp6(4),n.uIk("display",e.option_expanded[e.oidsorted[t]]?"inline":"none"),n.xp6(1),n.Q6J("innerHtml",e.Math.round(e.p.T.approval_scores_map.get(e.oidsorted[t])/e.Math.max(1,e.p.T.n_not_abstaining)*1e3)/10+"%\xa0\xa0",n.oJD),n.xp6(1),n.Udp("display","agreed"==e.delegation_status&&e.rate_yourself_toggle[e.oidsorted[t]]?"inline":"none"),n.xp6(2),n.Q6J("id","del_needle_"+e.oidsorted[t]),n.xp6(1),n.Q6J("id","del_knob_"+e.oidsorted[t]),n.xp6(1),n.Q6J("ngIf","agreed"==e.delegation_status),n.xp6(4),n.Q6J("id","expander_"+e.oidsorted[t]+"_"+e.sortingcounter)("expanded",e.option_expanded[e.oidsorted[t]]),n.xp6(5),n.Q6J("innerHtml",n.xi3(46,39,"winner"==e.p.type?e.running?"poll.chance-to-win":"poll.final-chance-to-win":e.running?"poll.of-the-budget":"poll.final-budget",n.VKq(53,J,e.Math.round(1e3*e.p.T.shares_map.get(e.oidsorted[t]))/10)),n.oJD),n.xp6(4),n.Udp("display",e.votedfor==e.oidsorted[t]?"inline":"none"),n.Q6J("innerHtml",n.lcZ(50,42,"poll.including-your-share"),n.oJD),n.xp6(6),n.Q6J("innerHtml",n.xi3(56,44,"poll.approved-by",n.VKq(55,J,e.Math.round(e.p.T.approval_scores_map.get(e.oidsorted[t])/e.Math.max(1,e.p.T.n_not_abstaining)*1e3)/10)),n.oJD),n.xp6(3),n.Udp("display",e.approved[e.oidsorted[t]]?"inline":"none"),n.Q6J("innerHtml",n.lcZ(59,47,"poll.including-you"),n.oJD),n.xp6(3),n.Q6J("ngIf",t>0&&e.p.T.approval_scores_map.get(e.oidsorted[t-1])==e.p.T.approval_scores_map.get(e.oidsorted[t])||t<e.oidsorted.length-1&&e.p.T.approval_scores_map.get(e.oidsorted[t+1])==e.p.T.approval_scores_map.get(e.oidsorted[t])),n.xp6(4),n.Q6J("innerHtml",n.lcZ(66,49,"poll.explain"),n.oJD),n.xp6(3),n.Udp("display",e.p.options[e.oidsorted[t]].desc||e.p.options[e.oidsorted[t]].url?"inline":"none"),n.xp6(2),n.Udp("display",""!=e.p.options[e.oidsorted[t]].desc?"inline":"none"),n.xp6(2),n.Q6J("innerHtml",e.p.options[e.oidsorted[t]].desc,n.oJD),n.xp6(2),n.Udp("display",""!=e.p.options[e.oidsorted[t]].url?"inline":"none"),n.xp6(4),n.Q6J("innerHtml",n.lcZ(79,51,"read-more"),n.oJD)}}function bn(o,r){if(1&o){const t=n.EpF();n.ynx(0),n.TgZ(1,"ion-item",126)(2,"ion-fab-button",127),n.NdJ("click",function(i){return n.CHM(t),n.oxw(2).add_option(i)}),n._UZ(3,"ion-icon",128),n.qZA(),n.TgZ(4,"ion-button",129),n.NdJ("click",function(i){return n.CHM(t),n.oxw(2).add_option(i)}),n.ALo(5,"translate"),n.qZA()(),n.TgZ(6,"ion-item",130),n._UZ(7,"small",13),n.ALo(8,"translate"),n.qZA(),n.BQk()}2&o&&(n.xp6(4),n.Q6J("innerHtml",n.lcZ(5,2,"poll.add-option"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(8,4,"poll.add-option-info"),n.oJD))}function Un(o,r){if(1&o){const t=n.EpF();n.ynx(0),n._UZ(1,"ion-item"),n.TgZ(2,"ion-item",131)(3,"ion-col")(4,"small")(5,"p",132),n._uU(6),n.qZA()()(),n.TgZ(7,"ion-buttons",6)(8,"ion-toggle",133),n.NdJ("ngModelChange",function(i){return n.CHM(t),n.oxw(2).running=i}),n.qZA()()(),n.BQk()}if(2&o){const t=n.oxw(2);n.xp6(6),n.gL8(" Debugging info: state=",t.p.state,", vid=",t.p.myvid,", oids=",t.p.oids,", oidsorted=",t.oidsorted,"/",t.p.T.oids_descending,", scores_map=",t.G.map2str(t.p.T.scores_map),". Simulate state (off:closed, on:running): "),n.xp6(2),n.Q6J("ngModel",t.running)}}const kn=function(){return[]};function Cn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-content",23),n.NdJ("pointerup",function(i){return n.CHM(t),n.oxw().onBodyPointerup(i)})("ionScroll",function(i){return n.CHM(t),n.oxw().onScroll(i)}),n.TgZ(1,"ion-list",24),n.YNc(2,B,9,2,"ion-card",25),n.TgZ(3,"ion-item",26)(4,"ion-grid",27)(5,"ion-row",27)(6,"ion-col",27),n.YNc(7,V,3,6,"small",5),n.TgZ(8,"h3")(9,"b"),n._UZ(10,"i",13),n.qZA()()()()()(),n.YNc(11,X,9,6,"ion-item",28),n.TgZ(12,"ion-item",29)(13,"ion-grid",27)(14,"ion-row",27)(15,"ion-col",30),n.YNc(16,tn,5,1,"ion-button",31),n.TgZ(17,"small")(18,"span",32),n.YNc(19,en,2,3,"ion-badge",33),n.YNc(20,on,2,3,"span",20),n.YNc(21,ln,2,3,"span",20),n._uU(22,"\xa0"),n._UZ(23,"b",13),n.qZA(),n._uU(24,"\xa0\xa0\xa0\xa0 "),n.TgZ(25,"span",32),n._UZ(26,"ion-icon",34),n._uU(27,"\xa0"),n._UZ(28,"span",13),n.ALo(29,"translate"),n.qZA()(),n._UZ(30,"br"),n.TgZ(31,"small",32)(32,"span",32),n._UZ(33,"ion-icon",35),n._uU(34,"\xa0"),n.TgZ(35,"b"),n._uU(36),n.qZA(),n._uU(37,"\xa0"),n.TgZ(38,"span",36),n.NdJ("click",function(){return n.CHM(t),n.oxw().glossary("non-abstaining")}),n.ALo(39,"translate"),n.qZA(),n._uU(40,"\xa0\xa0\xa0 "),n._UZ(41,"br"),n.qZA()(),n.TgZ(42,"small",32)(43,"span",32),n._UZ(44,"ion-icon",34),n.TgZ(45,"b"),n._uU(46),n.qZA(),n._uU(47,"%\xa0"),n.TgZ(48,"span",36),n.NdJ("click",function(){return n.CHM(t),n.oxw().glossary("level-of-agreement")}),n.ALo(49,"translate"),n.qZA()(),n._uU(50,"\xa0\xa0\xa0 "),n.TgZ(51,"ion-badge",37),n._UZ(52,"ion-icon",38),n._uU(53,"\xa0"),n._UZ(54,"span",13),n.qZA()()()()()(),n.YNc(55,cn,5,4,"ng-container",5),n.YNc(56,pn,14,4,"ng-container",5),n.YNc(57,Zn,11,5,"ion-item",39),n.YNc(58,wn,14,5,"ion-item",40),n.YNc(59,Pn,22,7,"ion-item",40),n.TgZ(60,"ion-item",41)(61,"small",42),n.NdJ("click",function(){return n.CHM(t),n.oxw().glossary("share")}),n._UZ(62,"span",43),n.ALo(63,"translate"),n.qZA(),n.TgZ(64,"small",44),n.NdJ("click",function(){return n.CHM(t),n.oxw().glossary("wap")}),n._UZ(65,"span",45),n.ALo(66,"translate"),n.qZA(),n.TgZ(67,"small",46),n.NdJ("click",function(){return n.CHM(t),n.oxw().glossary("approve")}),n._UZ(68,"ion-icon",47)(69,"span",45),n.ALo(70,"translate"),n.qZA()(),n.YNc(71,An,83,57,"ion-item",48),n.YNc(72,bn,9,6,"ng-container",5),n.YNc(73,Un,9,7,"ng-container",5),n.qZA()()}if(2&o){const t=n.oxw();n.Q6J("scrollEvents",!0),n.xp6(2),n.Q6J("ngForOf",t.news),n.xp6(5),n.Q6J("ngIf",!!t.p.language&&t.p.language!=t.G.S.language),n.xp6(3),n.Q6J("innerHtml",t.p.title,n.oJD),n.xp6(1),n.Q6J("ngIf",""!=(t.p.desc||"")||""!=(t.p.url||"")),n.xp6(5),n.Q6J("ngIf",t.running),n.xp6(3),n.Q6J("ngIf",t.running&&t.p.is_closing_soon),n.xp6(1),n.Q6J("ngIf",t.running&&!t.p.is_closing_soon),n.xp6(1),n.Q6J("ngIf",!t.running),n.xp6(2),n.Q6J("innerHtml",t.G.D.format_date(t.p.due),n.oJD),n.xp6(3),n.Q6J("name","share"==t.p.type?"cut-outline":"trophy-outline"),n.xp6(2),n.Q6J("innerHtml",n.lcZ(29,31,"share"==t.p.type?"poll.type-share":"poll.type-winner"),n.oJD),n.xp6(8),n.Oqu(t.p.T.n_not_abstaining),n.xp6(2),n.Q6J("innerHtml",n.lcZ(39,33,"non-abstaining-voters"),n.oJD),n.xp6(6),n.Q6J("name",1==t.p.agreement_level?"checkmark-done-outline":"analytics-outline"),n.xp6(2),n.hij("\xa0",t.Math.round(1e3*t.p.agreement_level)/10,""),n.xp6(2),n.Q6J("innerHtml",n.lcZ(49,35,"level-of-agreement"),n.oJD),n.xp6(6),n.Q6J("innerHtml","<b>3</b> suggestions",n.oJD),n.xp6(1),n.Q6J("ngIf",t.running),n.xp6(1),n.Q6J("ngIf",!t.running),n.xp6(1),n.Q6J("ngIf",t.accepted_requests.length>0||t.declined_requests.length>0),n.xp6(1),n.Q6J("ngIf","pending"==t.delegation_status),n.xp6(1),n.Q6J("ngIf","agreed"==t.delegation_status),n.xp6(3),n.Q6J("innerHtml",n.lcZ(63,37,"share"),n.oJD),n.xp6(3),n.Q6J("innerHtml",n.lcZ(66,39,"wap"),n.oJD),n.xp6(2),n.Akn("padding-top: 8px!important; padding-right: "+("agreed"==t.delegation_status?62:10)+"px; color: #769596;"),n.xp6(2),n.Q6J("innerHtml",n.lcZ(70,41,"approval"),n.oJD),n.xp6(2),n.Q6J("ngForOf",n.DdM(43,kn).constructor(t.oidsorted.length)),n.xp6(1),n.Q6J("ngIf",t.running),n.xp6(1),n.Q6J("ngIf",!1)}}function Qn(o,r){if(1&o){const t=n.EpF();n.TgZ(0,"ion-footer",134)(1,"ion-item",73)(2,"ion-text")(3,"ion-button",135),n.NdJ("click",function(){return n.CHM(t),n.oxw().dismiss_glossary()}),n._UZ(4,"ion-icon",136),n.qZA(),n._UZ(5,"small",13),n.ALo(6,"translate"),n.qZA()()()}if(2&o){const t=n.oxw();n.xp6(5),n.Q6J("innerHtml",n.lcZ(6,1,"glossary."+t.glossary_key),n.oJD)}}let v=(()=>{class o{constructor(t,e,i,l,a,_,c,u,g,p){this.changeDetector=t,this.router=e,this.route=i,this.routerOutlet=l,this.loadingController=a,this.alertCtrl=_,this.popover=c,this.modalController=u,this.translate=g,this.G=p,this.Array=Array,this.Math=Math,this.Object=Object,this.window=window,this.environment=k.N,this.page="poll",this.running=!0,this.delegation_status="none",this.n_indirect_clients=1,this.accepted_requests=[],this.declined_requests=[],this.oidsorted=[],this.sortingcounter=0,this.approved={},this.votedfor=null,this.details_expanded=!0,this.incoming_delegation_expanded=!1,this.option_expanded={},this.pieradius=20,this.two_pi=2*Math.PI,this.slidercolor={},this.refresh_paused=!1,this.needs_refresh=!1,this.scroll_position=0,this.rate_yourself_toggle={},this.n_delegated=0,this.news=new Set,this.ready=!1,this.listeners=new Map,this.final_rand=0,this.dragged_oid=void 0,this.currentModal=null,this.show_glossary=!1,this.G.L.entry("PollsPage.constructor"),this.route.params.subscribe(f=>{this.pid=f.pid})}ngOnInit(){this.G.L.entry("PollsPage.ngOnInit")}ionViewWillEnter(){this.G.L.entry("PollPage.ionViewWillEnter"),this.G.D.page=this;const t=i=>{this.changeDetector.detectChanges()};window.addEventListener("offline",t),window.addEventListener("online",t);const e=JSON.parse(this.G.D.getp(this.pid,"poll_page")||"{}");this.details_expanded=0!=e.details_expanded,this.incoming_delegation_expanded=1==e.incoming_delegation_expanded,this.option_expanded=e.option_expanded||{},this.G.L.exit("PollPage.ionViewWillEnter",e)}ionViewDidEnter(){this.G.L.entry("PollPage.ionViewDidEnter"),this.G.D.ready&&this.onDataReady(),this.G.L.debug("PollPage.ready:",this.ready)}onDataReady(){if(this.G.L.entry("PollPage.onDataReady"),!(this.pid in this.G.P.polls))return this.G.L.warn("PollPage unknown pid ignored, redirecting to mypolls page",this.pid,this.G.P.polls),void this.router.navigate(["/mypolls"]);this.p=this.G.P.polls[this.pid],"draft"==this.p.state?(this.G.L.error("PollPage not showing draft poll, redirecting to mypolls page",this.pid),this.router.navigate(["/mypolls"])):this.G.L.info("PollPage showing poll",this.pid),this.p.tally_all(),this.oidsorted=[...this.p.T.oids_descending],this.ready=!0,this.update_order(!0),window.setTimeout(()=>{this.update_order.bind(this)(!0),this.show_stats.bind(this)()},200),this.update_delegation_info(),this.on_delegate_toggle_change(),this.p.have_seen=!0,this.G.L.exit("PollPage.onDataReady")}onDataChange(){this.G.L.entry("PollPage.onDataChange"),this.p.tally_all(),this.update_order(),this.update_delegation_info(),this.news=this.G.N.filter({pid:this.pid}),this.changeDetector.detectChanges(),this.G.L.exit("PollPage.onDataChange")}ionViewWillLeave(){for(let e of this.oidsorted)(!this.delegate||this.rate_yourself_toggle[e])&&this.p.set_my_own_rating(e,Math.round(this.get_slider_value(e)),!0);for(const e of this.news)e.auto_dismiss&&this.G.N.dismiss(e.key);const t={details_expanded:this.details_expanded,incoming_delegation_expanded:this.incoming_delegation_expanded,option_expanded:this.option_expanded};this.G.D.setp(this.pid,"poll_page",JSON.stringify(t)),this.G.L.exit("PollPage.ionViewWillLeave",t)}ionViewDidLeave(){this.G.L.entry("PollPage.ionViewDidLeave"),this.G.D.save_state(),this.G.L.exit("PollPage.ionViewDidLeave")}update_delegation_info(){this.n_indirect_clients=this.p.get_n_indirect_clients(this.p.myvid);const t=this.G.D.incoming_dids_caches[this.pid];if(this.accepted_requests=[],this.declined_requests=[],t)for(const[i,[l,a,_]]of t)"agreed"==_?this.accepted_requests.push({from:l,url:a}):_.startsWith("declined")&&this.declined_requests.push({from:l,url:a});const e=this.G.Del.get_my_outgoing_dids_cache(this.pid).get("*");if(this.G.L.trace("PollPage.update_delegation_info did",e),e){this.delegate=this.G.Del.get_delegate_nickname(this.pid,e);const i=this.G.Del.get_agreement(this.pid,e);this.G.L.trace("PollPage.update_delegation_info agreement",i),this.delegation_status=i.status}this.update_delegation_toggles()}update_delegation_toggles(){for(let t of this.oidsorted){let e=this.G.Del.get_my_outgoing_dids_cache(this.pid).get(t);if(e||(e=this.G.Del.get_my_outgoing_dids_cache(this.pid).get("*")),e){const i=this.G.Del.get_agreement(this.pid,e);this.G.L.trace("PollPage found did, agreement",t,e,i,[...i.accepted_oids],[...i.active_oids]),this.rate_yourself_toggle[t]=!i.active_oids.has(t)}else this.G.L.trace("PollPage found no did for",t),this.rate_yourself_toggle[t]=!0}}onScroll(t){return(0,x.mG)(this,void 0,void 0,function*(){this.scroll_position=t.detail.scrollTop})}on_rate_yourself_toggle_change(t){this.G.Del.update_my_delegation(this.pid,t,!this.rate_yourself_toggle[t]),this.on_delegate_toggle_change()}on_delegate_toggle_change(){let t=0;for(let[e,i]of Object.entries(this.rate_yourself_toggle))i||t++;this.n_delegated=t}show_stats(){if(!this.ready)return;this.G.L.entry("PollPage.show_stats");const t=this.p,e=t.T,i=t.myvid,l=e.approval_scores_map,a=e.shares_map,_=e.approvals_map;this.votedfor=e.votes_map.get(this.p.myvid);for(const c of t.oids){const u=l.get(c)/e.n_not_abstaining||0,g=a.get(c),p=document.getElementById("bar_"+c),f=document.getElementById("pie_"+c),h=this.pieradius,Mn=h*Math.sin(this.two_pi*g),Nn=h*(1-Math.cos(this.two_pi*g)),Gn=g>.5?1:0;if(this.approved[c]=_.get(c).get(i),p?(p.width.baseVal.valueAsString=(100*u).toString()+"%",p.x.baseVal.valueAsString=(100*(1-u)).toString()+"%"):this.G.L.warn("PollPage.show_stats couldn't change slider bar",c),f?f.setAttribute("d",g<1?"M 21,25 l 0,-"+h+" a "+h+" "+h+" 0 "+Gn+" 1 "+Mn+" "+Nn+" Z":"M 21,25 l 0,-20 a 20 20 0 1 1 0 "+2*h+" a 20 20 0 1 1 0 "+-2*h+" Z"):this.G.L.warn("PollPage.show_stats couldn't change pie piece",c),this.set_slider_color(c,t.get_my_proxy_rating(c)),this.rate_yourself_toggle[c]){const A=document.getElementById("del_needle_"+c),b=document.getElementById("del_knob_"+c),U=this.G.Del.get_potential_effective_delegate(this.pid,c);if(U){const y=(this.p.proxy_ratings_map.get(c)||new Map).get(U)||0;this.G.L.trace("PollPage.show_stats rating",y),A&&(A.x2.baseVal.valueAsString=y.toString()+"%"),b&&(b.cx.baseVal.valueAsString=y.toString()+"%")}}}}update_order(t=!1){return(0,x.mG)(this,void 0,void 0,function*(){if(this.final_rand=this.p.make_final_rand("umewgfwgemfzgwezfgwefugwfxewgofxiwemhfeoifuhewfiewfumwehxfewmgfgmewfzuwegxzugwef"),this.oidsorted.length!=this.p.oids.length)this.needs_refresh=!0;else for(let e in this.oidsorted)if(this.oidsorted[e]!=this.p.T.oids_descending[e]){this.needs_refresh=!0;break}if(t||this.needs_refresh&&!this.refresh_paused){const e=yield this.loadingController.create({message:this.translate.instant("poll.sorting"),spinner:"crescent",duration:100});yield e.present(),yield e.onDidDismiss(),this.oidsorted=[...this.p.T.oids_descending],this.sortingcounter++,this.needs_refresh=!1,setTimeout(()=>{this.show_stats.bind(this)();for(let i in this.oidsorted){const l=this.oidsorted[i],a=document.getElementById("_slider_"+this.oidsorted[i]+"_"+this.sortingcounter),_=p=>{this.onRatingColPointerdown.bind(this)(l,p)},c=p=>{this.onRatingColPointerup.bind(this)(l,p)},u=p=>{this.onRatingColTouchstart.bind(this)(l,p)},g=p=>{this.onRatingColTouchup.bind(this)(l,p)};if(a){if(this.listeners.has(a)){this.G.L.trace("PollPage.update_order removing old event listeners");const p=this.listeners.get(a);a.removeEventListener("pointerdown",p[0],!0),a.removeEventListener("pointerup",p[1],!0),a.removeEventListener("touchstart",p[2],!0),a.removeEventListener("touchup",p[3],!0)}a.addEventListener("pointerdown",_,!0),a.addEventListener("pointerup",c,!0),a.addEventListener("touchstart",u,!0),a.addEventListener("touchup",g,!0),this.listeners.set(a,[_,c,u,g])}}this.G.L.trace("PollPage.update_order registered event listeners",this.sortingcounter)},100)}})}set_slider_color(t,e){this.slidercolor[t]=0==e?"vodlered":this.votedfor==t?"vodledarkgreen":e+100*(this.p.T.approval_scores_map.get(t)/this.p.T.n_not_abstaining||0)<=100?"vodleblue":"vodlegreen"}expand(t){this.option_expanded[t]=!this.option_expanded[t]}get_slider(t){return this.G.L.trace("PollPage.get_slider ",this.sortingcounter),document.getElementById("slider_"+t+"_"+this.sortingcounter)}set_slider_values(){for(let t of this.p.oids)this.get_slider(t).value=this.p.proxy_ratings_map.get(t).get(this.p.myvid).toString()}get_slider_value(t){const e=this.get_slider(t);return e?Number(e.value):0}apply_sliders_rating(t){(!this.delegate||this.rate_yourself_toggle[t])&&this.p.set_my_own_rating(t,Math.round(this.get_slider_value(t)),!1),this.show_stats()}onRatingSliderFocus(t){return this.G.L.entry("PollPage.onRatingSliderFocus"),!0}onRatingSliderChange(t){var e=this.get_slider(t),i=Number(e.value);return this.set_slider_color(t,i),this.apply_sliders_rating(t),!0}onRatingSliderBlur(t){return this.G.L.entry("PollPage.onRatingSliderBlur"),this.rating_change_ended(t),!0}rating_change_ended(t){this.G.L.entry("PollPage.rating_change_ended"),this.p.have_acted=!0,(!this.delegate||this.rate_yourself_toggle[t])&&this.p.set_my_own_rating(t,Math.round(this.get_slider_value(t)),!0),this.update_order(),this.G.D.save_state()}onRatingColPointerdown(t,e){if(!this.running)return!1;this.dragged_oid=t;const i=this.get_knob_pos(t),l=e?e instanceof PointerEvent?e.clientX:e.touches[0].clientX:0;return this.G.L.entry("onRatingColPointerdown",this.sortingcounter,t,this.p.options[t].name,l,i),!(l<i.left||l>i.right)||(this.swallow_event(e),!1)}onRatingColTouchstart(t,e){if(!this.running)return!1;this.dragged_oid=t;const i=this.get_knob_pos(t),l=e?e instanceof PointerEvent?e.clientX:e.touches[0].clientX:0;return this.G.L.entry("onRatingColTouchstart",t,l,i),!(l<i.left||l>i.right)||(this.swallow_event(e),!1)}onRatingColPointerup(t,e){return!!this.running&&(this.G.L.entry("onRatingColPointerup",t,this.dragged_oid),t!=this.dragged_oid?(this.swallow_event(e),this.dragged_oid=null,!1):(this.rating_change_ended(t),this.dragged_oid=null,!0))}onRatingColTouchup(t,e){return!!this.running&&(this.G.L.entry("onRatingColTouchup",t,this.dragged_oid),t!=this.dragged_oid?(this.swallow_event(e),this.dragged_oid=null,!1):(this.rating_change_ended(t),this.dragged_oid=null,!0))}onRatingColClick(t,e){if(!this.running)return!1;const i=this.get_knob_pos(t),l=e.clientX;return this.G.L.entry("onRatingColClick",t,this.p.options[t].name,l,i),!(l<i.left||l>i.right)||(this.swallow_event(e),!1)}onBodyPointerup(t){return!!this.running&&(this.dragged_oid&&(this.G.L.entry("onBodyPointerup"),this.onRatingColPointerup(this.dragged_oid,t)),!0)}onBodyTouchup(t){return!!this.running&&(this.dragged_oid&&(this.G.L.entry("onBodyTouchup"),this.onRatingColTouchup(this.dragged_oid,t)),!0)}get_knob_pos(t){const e=this.get_slider(t),i=this.get_screen_coords(e),l=this.get_slider_value(t),a=i.left+(i.right-i.left)*l/100;return this.G.L.trace("pointer slider value",l),{left:a-20,right:a+20}}get_screen_coords(t){return t?t.getBoundingClientRect():new DOMRect}swallow_event(t){this.G.L.trace("swallowing event",t),t&&(t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault())}checkmark_clicked(){return(0,x.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({message:this.translate.instant("poll.checkmark-clicked"),buttons:[{text:this.translate.instant("OK"),role:"Ok",handler:()=>{}}]})).present()})}delegate_dialog(t){this.popover.create({event:t,component:C.DelegationDialogPage,translucent:!0,showBackdrop:!0,componentProps:{parent:this}}).then(e=>{e.present()})}assist_dialog(){return(0,x.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:Q.AssistPage,componentProps:{P:this},backdropDismiss:!1});t.present(),this.currentModal=t})}explain_approval_dialog(t){this.modalController.create({component:L.ExplainApprovalPage,cssClass:"explain-approval",showBackdrop:!0,componentProps:{parent:this,oid:t},swipeToClose:!0,presentingElement:this.routerOutlet.nativeEl}).then(e=>{e.present()})}revoke_delegation_dialog(){return(0,x.mG)(this,void 0,void 0,function*(){yield(yield this.alertCtrl.create({message:this.translate.instant("poll.revoke_delegation",{nickname:this.delegate}),buttons:[{text:this.translate.instant("cancel"),role:"Cancel",handler:()=>{console.log("Confirm Cancel.")}},{text:this.translate.instant("OK"),role:"Ok",handler:()=>{this.G.Del.revoke_delegation(this.pid,this.G.Del.get_my_outgoing_dids_cache(this.pid).get("*"),"*"),this.delegate=null,this.delegation_status="none",this.update_delegation_info(),this.G.D.save_state()}}]})).present()})}add_option(t){this.popover.create({component:H.AddoptionDialogPage,translucent:!0,showBackdrop:!0,cssClass:"add-option-class",componentProps:{parent:this}}).then(e=>{e.present()})}glossary(t){this.glossary_key=t,this.show_glossary=!0}dismiss_glossary(){this.show_glossary=!1}}return o.\u0275fac=function(t){return new(t||o)(n.Y36(n.sBO),n.Y36(m.F0),n.Y36(m.gz),n.Y36(s.jP),n.Y36(s.HT),n.Y36(s.Br),n.Y36(s.Dh),n.Y36(s.IN),n.Y36(P.sK),n.Y36(D.U))},o.\u0275cmp=n.Xpm({type:o,selectors:[["app-poll"]],viewQuery:function(t,e){if(1&t&&n.Gf(s.W2,5),2&t){let i;n.iGM(i=n.CRH())&&(e.content=i.first)}},decls:13,vars:8,consts:[[3,"pointerup","touchup"],[2,"padding-right","11px","padding-left","16px"],["slot","start",2,"margin-right","0px","margin-left","0px","padding-left","0px","padding-right","0px"],[2,"padding-left","0px!important","padding-right","0px!important","position","relative","left","-9px"],["style","font-weight: bold; font-size: larger; padding-left: 0px;",3,"innerHtml",4,"ngIf"],[4,"ngIf"],["slot","end"],["name","crescent","color","grey",4,"ngIf"],["class","ion-no-margin ion-no-padding","fill","clear",3,"click",4,"ngIf"],["shape","round","size","large","color","primary","class","ion-no-padding ion-no-margin",3,"click",4,"ngIf"],[3,"scrollEvents","pointerup","ionScroll",4,"ngIf"],["style","box-shadow: 0px -3px 4px #eeeeee;",4,"ngIf"],[2,"font-weight","bold","font-size","larger","padding-left","0px",3,"innerHtml"],[3,"innerHtml"],["name","cloud-offline-outline","color","grey",2,"position","relative","bottom","-1px"],["name","alert-outline","color","grey"],["name","crescent","color","grey"],["fill","clear",1,"ion-no-margin","ion-no-padding",3,"click"],["size","large","name","checkmark","color","grey","slot","icon-only"],["shape","round","size","large","color","primary",1,"ion-no-padding","ion-no-margin",3,"click"],[3,"innerHtml",4,"ngIf"],["shape","round","fill","solid","color","primary",1,"ion-no-margin","ion-no-padding",2,"position","relative","right","-4px"],["src","./assets/icon/delegate-simple.svg",1,"ion-no-margin","ion-no-padding"],[3,"scrollEvents","pointerup","ionScroll"],["lines","full",1,"ion-no-margin","ion-no-padding"],[4,"ngFor","ngForOf"],["color","primary","lines","none",1,"ion-no-margin"],[1,"ion-no-padding","ion-no-margin"],["color","primary","class","ion-padding-left ion-padding-right","style","cursor: pointer; --min-height: 0!important;","lines","none",3,"click",4,"ngIf"],["color","primary",1,"ion-no-margin","ion-padding-left","ion-padding-right"],[1,"ion-no-padding","ion-no-margin",2,"padding-bottom","8px"],["size","small","fill","clear","class","ion-float-right ion-no-padding ion-no-margin","style","position: relative; top: 5px; right: 10px; margin-left:20px;",3,"click",4,"ngIf"],[2,"white-space","nowrap"],["class","ion-no-margin","style","position: relative; bottom: -5.5px; font-size: 11.5px;","color","danger",3,"innerHtml",4,"ngIf"],["color","light",2,"position","relative","top","2px",3,"name"],["color","light","name","people-outline",2,"position","relative","top","2px"],[1,"externallink",3,"innerHtml","click"],["color","success",1,"ion-no-margin",2,"position","absolute","right","10px","bottom","7px","font-size","11.5px","padding-top","2px"],["name","bulb-outline",1,"ion-no-padding","ion-no-margin",2,"position","relative","top","1.5px"],["color","light",4,"ngIf"],["color","warning",4,"ngIf"],["lines","none",1,"ion-no-padding","ion-no-margin",2,"--min-height","0px!important","font-weight","bold"],[2,"padding-top","8px!important","padding-left","6px","width","68px!important","color","#769596","text-align","center",3,"click"],[1,"externallink",2,"width","100%!important",3,"innerHtml"],[2,"padding-left","6px!important","padding-top","8px!important","flex-grow","1","color","#769596",3,"click"],[1,"externallink",3,"innerHtml"],[3,"click"],["name","caret-down",2,"position","relative","top","2px"],["style","align-items:flex-start",4,"ngFor","ngForOf"],[1,"ion-no-margin","ion-no-padding"],["lines","none","color","warning",1,"ion-no-margin","ion-no-padding","item-text-wrap"],["slot","end","fill","clear","size","small",1,"ion-no-margin","ion-no-padding",3,"click"],["slot","icon-only","name","close-outline",2,"color","gray!important"],["color","primary","lines","none",1,"ion-padding-left","ion-padding-right",2,"cursor","pointer","--min-height","0!important",3,"click"],[1,"ion-no-padding","ion-padding-bottom","ion-no-margin",2,"width","100%"],["name","open-outline",2,"position","relative","top","2px"],["size","small","fill","clear",1,"ion-float-right","ion-no-padding","ion-no-margin",2,"position","relative","top","5px","right","10px","margin-left","20px",3,"click"],["style","color:#88e950; white-space: normal; text-align: right; font-size: 11.5px;",3,"innerHtml",4,"ngIf"],["shape","round","color","success",1,"ion-no-padding","ion-no-margin"],["name","color-wand-outline","slot","icon-only",2,"margin","5px"],[2,"color","#88e950","white-space","normal","text-align","right","font-size","11.5px",3,"innerHtml"],["color","danger",1,"ion-no-margin",2,"position","relative","bottom","-5.5px","font-size","11.5px",3,"innerHtml"],["color","danger",4,"ngIf"],["color","secondary",4,"ngIf"],["color","danger"],[2,"font-size","medium",3,"innerHtml"],[2,"cursor","pointer","white-space","nowrap",3,"click"],["name","help-circle-outline",2,"font-size","16px","position","relative","top","4px"],[3,"innerHtml","click"],["color","warning"],[1,"externallink",2,"font-size","medium",3,"innerHtml"],["name","help-circle-outline",2,"font-size","16px","position","relative","top","3px"],["color","secondary"],["color","light"],[1,"ion-no-padding","ion-no-margin",2,"padding-top","5px","padding-bottom","6px","cursor","pointer",3,"click"],[1,"ion-no-margin","ion-padding-right"],["size","smaller",1,"ion-no-margin",2,"color","black","position","relative","left","-2px","top","2px",3,"name"],[1,"ion-text-right"],["outline","true",3,"routerLink",4,"ngFor","ngForOf"],["outline","true",3,"routerLink"],["name","mail-open-outline","size","small",2,"color","grey"],[1,"ion-no-padding","ion-no-margin","ion-align-items-center"],[2,"font-size","medium"],["size","auto",1,"ion-no-margin"],["fill","clear",3,"disabled","click"],["name","trash-outline",2,"color","black"],["fill","clear",3,"click"],["size","auto",1,"ion-no-padding","ion-no-margin","ion-padding-left","ion-text-right",2,"padding-bottom","3px"],["name","arrow-down-outline",2,"position","relative","top","3px"],[2,"align-items","flex-start"],["size","auto",1,"ion-no-padding","ion-no-margin"],[2,"width","60px!important"],["xmlns","http://www.w3.org/2000/svg","width","60px","height","60px",2,"position","absolute","bottom","0px"],["cx","21","cy","25","r","20","fill","#bce4e5","stroke","none"],["d","M 21,25 l 0,-20 a 20 20 0 0 1 0 0 Z","fill","#9abcbd",3,"id"],["x1","21","y1","48","x2","21","y2","60","stroke","#769596","stroke-width","1","stroke-dasharray","1 1"],[1,"ion-no-padding","ion-no-margin",2,"padding-top","8px","cursor","pointer","position","relative","left","-6px","z-index","20",3,"click"],["size","small",1,"ion-no-margin",2,"color","black","position","relative","top","3px",3,"name"],[1,"ion-no-padding","ion-no-margin",3,"id","click","pointerdown","touchstart","touchup","pointerup"],["mode","md","pin","true","pinFormatter","(v)=>100-v","min","0","max","100","step","1","snaps","true","ticks","false",1,"ion-no-padding","ion-no-margin",3,"disabled","id","color","value","ionFocus","ionChange","ionBlur"],["slot","end",1,"ion-no-padding","ion-no-margin",2,"margin-right","12px"],[2,"position","absolute","bottom","0px","right","11px","z-index","-10","width","100%","padding-left","11px"],["xmlns","http://www.w3.org/2000/svg","width","100%","height","35px"],["x","100%","width","0%","y","8","height","18","fill","#bce4e5","stroke","none",3,"id"],["x1","100%","y1","0","x2","100%","y2","34","fill","none","stroke","#bce4e5","stroke-width","5"],["x1","0%","x2","100%","y1","17","y2","17","stroke","#b4dbdb","stroke-width","2","stroke-dasharray","2 2"],[2,"position","absolute","bottom","0px","right","11px","z-index","10","width","100%","padding-left","11px","pointer-events","none"],["xmlns","http://www.w3.org/2000/svg","width","100%","height","45px"],["x","100%","y","15","text-anchor","end","fill","#9abcbd",2,"font-weight","bold","font-size","12px",3,"innerHtml"],[2,"position","absolute","top","-2px","right","11px","z-index","-5","width","100%","padding-left","11px"],["xmlns","http://www.w3.org/2000/svg","width","100%","height","15px"],["x1","0","y1","8","x2","50%","y2","8","fill","none","stroke","#9abcbd","stroke-width","2","stroke-dasharray","3 2",3,"id"],["cx","50%","cy","8","r","5","fill","#9abcbd","stroke","none",3,"id"],["class","ion-no-margin ion-no-padding","size","auto",4,"ngIf"],[3,"id","expanded"],[1,"ion-no-padding","ion-padding-bottom","ion-no-margin"],[2,"color","#769596"],[2,"white-space","nowrap",3,"innerHtml"],[2,"color","#4c822e",3,"innerHtml"],[2,"color","#9abcbd","white-space","nowrap"],[2,"color","#62a73b",3,"innerHtml"],["style","color:#9abcbd",4,"ngIf"],["size","auto",1,"ion-no-margin","ion-no-padding"],[1,"ion-no-margin","ion-no-padding","ion-padding-bottom","ion-padding-top",2,"position","relative","top","-8px",3,"id","disabled","ngModel","ionChange","ngModelChange"],[2,"position","absolute","z-index","10","top","22px","right","1px","text-align","right"],[2,"color","#9abcbd"],["lines","none",1,"ion-no-padding",2,"padding-left","10px","padding-top","10px"],["size","small","fill","clear","color","primary",3,"click"],["name","add"],["fill","clear",1,"ion-no-padding","ion-no-margin",3,"innerHtml","click"],["lines","none",2,"padding-bottom","10px!important"],["lines","none",1,"ion-text-right"],[2,"color","grey"],["color","light",3,"ngModel","ngModelChange"],[2,"box-shadow","0px -3px 4px #eeeeee"],["fill","clear",1,"ion-float-right","ion-margin-right","ion-margin-left","ion-no-padding",2,"position","relative","right","-6px","top","3px",3,"click"],["slot","icon-only","name","close","color","primary",1,"ion-no-margin","ion-no-padding"]],template:function(t,e){1&t&&(n.TgZ(0,"ion-header",0),n.NdJ("pointerup",function(l){return e.onBodyPointerup(l)})("touchup",function(l){return e.onBodyTouchup(l)}),n.TgZ(1,"ion-toolbar",1)(2,"ion-buttons",2),n._UZ(3,"ion-menu-button",3),n.qZA(),n.YNc(4,G,2,3,"ion-text",4),n.YNc(5,I,3,1,"ion-text",5),n.TgZ(6,"ion-buttons",6),n.YNc(7,Y,3,0,"ng-container",5),n.YNc(8,E,1,0,"ion-spinner",7),n.YNc(9,z,2,0,"ion-button",8),n.YNc(10,R,4,1,"ion-button",9),n.qZA()()(),n.YNc(11,Cn,74,44,"ion-content",10),n.YNc(12,Qn,7,3,"ion-footer",11)),2&t&&(n.xp6(4),n.Q6J("ngIf",e.scroll_position<70),n.xp6(1),n.Q6J("ngIf",e.scroll_position>=70),n.xp6(2),n.Q6J("ngIf",!e.window.navigator.onLine),n.xp6(1),n.Q6J("ngIf",!!e.p&&e.p.syncing&&e.window.navigator.onLine),n.xp6(1),n.Q6J("ngIf",!!e.p&&e.p.have_acted&&!e.p.syncing&&e.window.navigator.onLine),n.xp6(1),n.Q6J("ngIf","agreed"!=e.delegation_status&&e.running),n.xp6(1),n.Q6J("ngIf",e.ready),n.xp6(1),n.Q6J("ngIf",e.show_glossary))},directives:[s.Gu,s.sr,s.Sm,s.fG,Z.O5,s.yW,s.gu,s.PQ,s.YG,s.W2,s.q_,Z.sg,s.PM,s.FN,s.Ie,s.Q$,s.jY,s.Nd,s.wI,s.yp,s.hM,s.YI,m.rH,s.I_,s.QI,s.ho,s.w,w.JJ,w.On,N,s.W4,s.fr],pipes:[P.X$],styles:[""]}),o})();const Hn=[{path:"",component:v}];let Ln=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[[m.Bz.forChild(Hn)],m.Bz]}),o})();var Dn=d(4496);let qn=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=n.oAB({type:o}),o.\u0275inj=n.cJS({imports:[[Z.ez,w.u5,s.Pc,Ln,Dn.m,P.aw.forChild()]]}),o})()}}]);
//# sourceMappingURL=186.e00448fc33aec9ee.js.map